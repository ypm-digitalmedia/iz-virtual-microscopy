/*
 Zoomify Image Viewer, version on line 25 below. Copyright Zoomify, Inc., 1999-2018. All rights reserved. You may
use this file on private and public websites, for personal and commercial purposes, with or without modifications, so long as this
notice is included. Redistribution via other means is not permitted without prior permission. Additional terms apply. For complete
license terms please see the Zoomify License Agreement in this product and on the Zoomify website at www.zoomify.com.
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
*/
(function(){(function(){return this}).call().Z={}})();Z.version="5.23.5 Enterprise";Z.setCallback=function(a,b){"undefined"===typeof Z.callbacks&&(Z.callbacks=[]);var e=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackName",a,null,"callbackFunction",b);-1==e&&(e=Z.callbacks.length);Z.callbacks[e]={callbackName:a,callbackFunction:b}};
Z.showImage=function(a,b,e){if(Z.showImage.done)Z.Utils.declareGlobals(),Z.pageContainerID=a,"undefined"!==typeof b&&Z.Utils.stringValidate(b)?Z.imagePath=Z.Utils.stringRemoveTrailingSlash(b):Z.imagePath=null,"undefined"!==typeof e&&(Z.parameters=Z.Utils.parseParameters(e)),Z.initialize();else{Z.showImage.done=!0;Z.Utils.addCrossBrowserMethods();Z.Utils.addCrossBrowserEvents();Z.Utils.declareGlobals();Z.pageContainerID=a;Z.setEditPermissionFunction=function(a){Z.externalEditPermissionFunction=a};
Z.clearCallback=function(a,b){var e=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackName",a,null,"callbackFunction",b);-1!=e&&(Z.callbacks=Z.Utils.arraySplice(Z.callbacks,e,1))};a="undefined"!==typeof b&&Z.Utils.stringValidate(b);var f="undefined"!==typeof e&&("string"===typeof e&&-1!=e.indexOf("zIIIFServer")||"object"===typeof e&&"undefined"!==typeof e.zIIIFServer);a&&-1!=b.indexOf("zXMLParametersPath")?(b=b.substring(19,b.length),Z.xmlParametersPath=Z.Utils.stringRemoveTrailingSlash(b)):
Z.imagePath=f?"IIIFImageServer":a?Z.Utils.stringRemoveTrailingSlash(b):null;"undefined"!==typeof e&&("string"===typeof e&&(e=unescape(e),e=Z.Utils.stringUnescapeAmpersandCharacters(e)),Z.parameters=Z.Utils.parseParameters(e));"complete"!=document.readyState?(Z.Utils.addEventListener(document,"DOMContentLoaded",Z.initialize),Z.Utils.addEventListener(window,"load",Z.initialize)):Z.initialize()}};
Z.initialize=function(){Z.Utils.removeEventListener(document,"DOMContentLoaded",Z.initialize);Z.Utils.removeEventListener(window,"load",Z.initialize);Z.Utils.detectBrowserFeatures();Z.pageContainer=document.getElementById(Z.pageContainerID);Z.xmlParametersPath&&!Z.parameters?Z.loadParametersXML():null!==Z.parameters&&"undefined"!==typeof Z.parameters.zXMLParametersPath?Z.Utils.setParameters(Z.parameters):(Z.Utils.setParameters(Z.parameters),(!Z.localUse||"ZoomifyZIFFile"!=Z.tileSource&&"ZoomifyPFFFile"!=
Z.tileSource)&&Z.createViewer(),1!=Z.debug&&2!=Z.debug&&3!=Z.debug||Z.Utils.trace(Z.Utils.getResource("z445"),!1,!0))};Z.createViewer=function(){Z.Viewer=new Z.ZoomifyImageViewer;"request"==Z.userLogin||0!=Z.userPanelVisible?Z.Utils.enforceUserLogin():Z.Utils.stringValidate(Z.copyrightPath)?Z.Utils.enforceCopyright():Z.Viewer.configureViewer()};Z.loadParametersXML=function(){Z.xmlParametersParsing=!0;var a=new Z.NetConnector,b=Z.Utils.cacheProofPath(Z.xmlParametersPath);a.loadXML(b,null,"loadingParametersXML")};
Z.ZoomifyImageViewer=function(){function a(a,b){"undefined"!==typeof a&&Z.Utils.stringValidate(a)||(a=Z.helpPath);"undefined"!==typeof b&&Z.Utils.stringValidate(b)||(b="helpCustom");(new Z.NetConnector).loadHTML(a,D.receiveHelpHTML,null,"loadingHelpHTML-"+b)}function b(a){if(a=Z.Utils.event(a)){var b=null;if(null!==Z.editing&&Z.Viewport.verifyEditsUnsaved())return b=Z.Utils.getResource("ALERT_UNSAVEDEDITSEXIST-BROWSER"),a.returnValue=b}}function e(){Z.Utils.showMessage(Z.Utils.getResource("z291")+
this.url,!0)}function f(a){(a=Z.Utils.event(a))&&S&&(Z.Utils.removeEventListener(S,"mousedown",f),Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",g),Z.Utils.addEventListener(Z.ViewerDisplay,"mouseup",k),a=Z.Utils.getMousePosition(a),dragPtStart=new Z.Utils.Point(a.x,a.y),new Z.Utils.Point(parseFloat(S.style.left),parseFloat(S.style.top)),S.mouseXPrior=dragPtStart.x,S.mouseYPrior=dragPtStart.y)}function g(a){if((a=Z.Utils.event(a))&&S){a=Z.Utils.getMousePosition(a);dragPtCurrent=new Z.Utils.Point(a.x,
a.y);var b=dragPtCurrent.x-S.mouseXPrior,e=dragPtCurrent.y-S.mouseYPrior;S.mouseXPrior=dragPtCurrent.x;S.mouseYPrior=dragPtCurrent.y;a=S.style;var b=parseFloat(a.left)+b,e=parseFloat(a.top)+e,f=parseFloat(a.width,10),g=parseFloat(a.height,10);0>b&&(b=0);b+f>Z.viewerW&&(b=Z.viewerW-f);0>e&&(e=0);e+g>Z.viewerH&&(e=Z.viewerH-g);a.left=b+"px";a.top=e+"px"}}function k(a){if((a=Z.Utils.event(a))&&S){a=Z.Utils.getMousePosition(a);a=Z.mouseOutDownPoint?Z.mouseOutDownPoint:new Z.Utils.Point(a.x,a.y);Z.Utils.removeEventListener(Z.ViewerDisplay,
"mousemove",g);Z.Utils.removeEventListener(Z.ViewerDisplay,"mouseup",k);Z.Utils.addEventListener(S,"mousedown",f);var b=a.x-S.mouseXPrior,e=a.y-S.mouseYPrior;a=S.style;b=parseFloat(a.left)+b;e=parseFloat(a.top)+e;a.left=b+"px";a.top=e+"px"}}function l(a){if(a=Z.Utils.event(a))if(a.preventDefault(),Z.interactive&&S&&(a=Z.Utils.getFirstTouch(a)))a=new Z.Utils.Point(a.pageX,a.pageY),dragPtStart=new Z.Utils.Point(a.x,a.y),S.mouseXPrior=a.x,S.mouseYPrior=a.y}function E(a){if(a=Z.Utils.event(a)){a.preventDefault();
if(!Z.interactive||!Z.mousePan)return;if(S&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);var b=S.style,e=parseFloat(b.left),f=parseFloat(b.top);b.left=e+(a.x-S.mouseXPrior)+"px";b.top=f+(a.y-S.mouseYPrior)+"px";S.mouseXPrior=a.x;S.mouseYPrior=a.y}}return!1}function n(a){if(a=Z.Utils.event(a))if(a.preventDefault(),Z.interactive&&S&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);a=new Z.Utils.Point(a.x,a.y);var b=a.x-S.mouseXPrior,e=a.y-S.mouseYPrior;a=S.style;
b=parseFloat(a.left)+b;e=parseFloat(a.top)+e;a.left=b+"px";a.top=e+"px"}}function w(a){if(a=Z.Utils.event(a))if(a.preventDefault(),Z.interactive&&S&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);a=new Z.Utils.Point(a.x,a.y);var b=a.x-S.mouseXPrior,e=a.y-S.mouseYPrior;a=S.style;b=parseFloat(a.left)+b;e=parseFloat(a.top)+e;a.left=b+"px";a.top=e+"px"}}function G(a){function b(){Z.clearCallback("readyViewer",b);Z.viewportCurrent=Z.Viewport0;Z.overlays&&(Z.imageSetStart=Z.imageSetLength-
1);D.viewportSelect(Z.imageSetStart)}Z.imagePath="multiple";Z.tileSourceMultiple&&Z.Utils.validateImagePath(a[0].media);Z.setCallback("readyViewer",b);for(var e=0,f=a.length;e<f;e++){Z["Viewport"+e.toString()]=new Z.ZoomifyViewport(e,a[e].media,Z.annotationFileShared?Z.imageSetAnnotationPath:a[e].annotationPath,Z.hotspotFileShared?Z.imageSetHotspotPath:a[e].hotspotPath,Z.trackingFileShared?Z.imageSetTrackingPath:a[e].trackingPath,Z.imageListFileShared?Z.imageSetImageListPath:a[e].imageListPath);var g=
e==Z.imageSetStart;g&&(Z.viewportCurrent=Z["Viewport"+e.toString()],D.viewportSelect(Z.imageSetStart));Z["Viewport"+e.toString()].setVisibility(g||Z.comparison||Z.overlays)}}function K(a,b){if("undefined"===typeof b||null===b)b="0";var e=document.getElementById("HotspotList"+b);e&&(e.style.visibility=a?"visible":"hidden")}function W(a,b){this.id=a.getAttribute("ID");this.name=a.getAttribute("NAME");this.internalID=b;this.media=a.getAttribute("MEDIA");this.imageListPath=a.getAttribute("IMAGELIST");
this.hotspotPath=a.getAttribute("HOTSPOTPATH");this.annotationPath=a.getAttribute("ANNOTATIONPATH");this.trackingPath=a.getAttribute("TRACKINGPATH");this.initialX=a.getAttribute("INITIALX");this.initialY=a.getAttribute("INITIALY");this.initialZoom=a.getAttribute("INITIALZOOM");this.minZoom=a.getAttribute("MINZOOM");this.maxZoom=a.getAttribute("MAXZOOM")}function J(a,b,e,f){switch(a){case "0":f=a=-1E3;break;case "1":f=a=15;break;case "2":a=e-b-15+2;f=10;break;case "3":a=e-b-15;f=0<Z.toolbarVisible&&
8!=Z.toolbarVisible?f-30:f-22.5;break;case "4":a=15;f=0<Z.toolbarVisible&&8!=Z.toolbarVisible?f-30:f-22.5;break;default:a=e-b,f=15}return new Z.Utils.Point(a,f)}function oa(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a),"null"!=a.options[a.selectedIndex].value){var b=Z.Utils.stringValidate(Z.imageSetListTitle)&&"none"!=Z.imageSetListTitle?1:0;D.viewportSelect(a.selectedIndex-b)}}function ga(){document.getElementsByTagName("body")?document.getElementsByTagName("body")[0].onorientationchange=ma:window.setTimeout(ga,
100)}function ma(a){Z.interactive&&Z.fullView&&(Z.Toolbar&&(Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!1),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!1),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!1)),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!1),Z.comparison&&Z.Navigator2&&
Z.Navigator2.setVisibility(!1)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!1),Z.Viewport&&1<Z.magnifierVisible&&Z.Viewport.setVisibilityMagnifier(!1),Z.Viewport&&(Z.Viewport.toggleFullViewMode(!1),Z.Viewport.toggleFullViewMode(!0)),Z.Viewport&&1<Z.magnifierVisible&&Z.Viewport.setVisibilityMagnifier(!0),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!0),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.comparison&&Z.Navigator2&&Z.Navigator2.setVisibility(!0)),
Z.Toolbar&&(!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!0),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!0),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!0),Z.toolbarAutoShowHide&&Z.Toolbar.show(!0)))}function fa(a){if(Z.interactive&&Z.keys&&"INPUT"!=document.activeElement.tagName&&"TEXTAREA"!=document.activeElement.tagName){a=Z.Utils.event(a);
var b=a.altKey;18==a.keyCode||a.altKey||(Z.viewportCurrent.zoomAndPanAllStop(!0,!0),Z.maskingSelection&&Z.viewportCurrent.clearMask());if(a){var e=a.type,f=a.keyCode;if("keydown"==e){Z.keyIsDown=!0;switch(f){case 90:Z.viewportCurrent.zoom("out");break;case 17:"macintosh"!=Z.platform&&Z.viewportCurrent.zoom("out");break;case 65:Z.viewportCurrent.zoom("in");break;case 16:"macintosh"!=Z.platform&&Z.viewportCurrent.zoom("in");break;case 37:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?
Z.viewportCurrent.pan("left"):Z.imageSet&&D.viewportPrior();break;case 38:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("up"):Z.imageSet&&D.viewportNext();break;case 40:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("down"):Z.imageSet&&D.viewportPrior();break;case 39:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("right"):Z.imageSet&&D.viewportNext();break;case 27:Z.fullView?Z.viewportCurrent.toggleFullViewMode(!1):
Z.viewportCurrent.reset();break;case 190:Z.rotationVisible&&Z.viewportCurrent.rotate("clockwise",b);break;case 188:Z.rotationVisible&&Z.viewportCurrent.rotate("counterwise",b);break;case 33:Z.imageSet&&!Z.overlays&&D.viewportNext();break;case 34:Z.imageSet&&!Z.overlays&&D.viewportPrior();break;case 76:b&&(Z.hotspots||Z.annotations)&&Z.viewportCurrent.setHotspotsVisibility(!Z.viewportCurrent.getHotspotsVisibility())}!Z.imageSet||33!=f&&34!=f||(a.preventDefault?a.preventDefault():a.returnValue=!1)}else"keyup"==
e&&(Z.keyIsDown=!1,90==f||17==f||65==f||16==f?Z.viewportCurrent.zoom("stop"):37==f||39==f||38==f||40==f?Z.tracking?37==f?Z.viewportCurrent.goToNextCell("left"):39==f?Z.viewportCurrent.goToNextCell("right"):38==f?Z.viewportCurrent.goToNextCell("up"):40==f&&Z.viewportCurrent.goToNextCell("down"):37==f||39==f?Z.viewportCurrent.pan("horizontalStop"):38!=f&&40!=f||Z.viewportCurrent.pan("verticalStop"):!Z.rotationVisible||190!=f&&188!=f?!Z.imageSet||33!=f&&34!=f?32==f?(Z.fullViewVisible||Z.fullScreenVisible||
Z.fullPageVisible)&&Z.viewportCurrent.toggleFullViewMode():46==f&&null!==Z.editMode&&(Z.annotations||Z.tracking)&&Z.viewportCurrent.deleteCurrentLabel():(Z.imageSet&&Z.viewportCurrent.updateView(!0),a.preventDefault?a.preventDefault():a.returnValue=!1):Z.viewportCurrent.rotate("stop"))}}}function v(a){a=Z.Utils.event(a);var b=a.type;if(a&&b){var e=Z.Utils.isRightMouseButton(a),f=a.altKey;if(!("mouseover"!=b&&"mouseout"!=b&&!Z.interactive||"mousedown"==b&&(!Z.interactive||Z.coordinatesVisible&&f)||
e)){Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=b&&"gesturechange"!=b&&a.preventDefault();switch(b){case "mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||"narrativeTextBox"===document.activeElement.id||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case "mouseout":Z.tracking||Z.Viewer.initializeViewerKeyDefaultListeners(!1)}var g;g=Z.Utils.event(a);var l=g.type;if(g&&l){var k;a=Z.Utils.target(g);e=Z.Utils.relatedTarget(g);"resize"!=l&&(k=Z.Utils.getMousePosition(g));
f=g.altKey;"DOMMouseScroll"==l&&(l="mousewheel");switch(l){case "mouseover":f=Z.Utils.nodeIsInViewer(a);g=Z.Utils.nodeIsInViewer(e);f&&g||"[object HTMLSelectElement]"==a||"[object HTMLOptionElement]"==a||"[object HTMLSelectElement]"==e||"[object HTMLOptionElement]"==e||(!Z.viewportCurrent||Z.narrative&&!Z.narrativeMode||Z.viewportCurrent.showLists(!0),Z.ToolbarDisplay&&Z.Toolbar&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!0),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.comparison&&
Z.Navigator2&&Z.Navigator2.setVisibility(!0)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!0),Z.Ruler&&1<Z.rulerVisible&&Z.Ruler.setVisibility(!0),Z.Toolbar&&(!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!0),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!0),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!0)),Z.viewportCurrent&&
1<Z.magnifierVisible&&Z.viewportCurrent.setVisibilityMagnifier(!0),Z.mouseOutDownPoint=null);break;case "mouseout":f=Z.Utils.nodeIsInViewer(a);g=Z.Utils.nodeIsInViewer(e);a="[object HTMLSelectElement]"==a||"[object HTMLOptionElement]"==a||"[object HTMLSelectElement]"==e||"[object HTMLOptionElement]"==e;Z.Utils.pointIsInViewer(k)||f&&g||a||(Z.mouseIsDown?Z.mouseOutDownPoint=new Z.Utils.Point(k.x,k.y):(Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),Z.ToolbarDisplay&&Z.Toolbar&&Z.toolbarAutoShowHide&&
Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!1),Z.comparison&&Z.Navigator2&&Z.Navigator2.setVisibility(!1)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!1),Z.Ruler&&1<Z.rulerVisible&&Z.Ruler.setVisibility(!1),Z.Toolbar&&(!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!1),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!1),2!=Z.userPanelVisible&&
3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!1)),Z.viewportCurrent&&1<Z.magnifierVisible&&Z.viewportCurrent.setVisibilityMagnifier(!1)));break;case "resize":da||(da=window.setTimeout(C,ja));break;case "mousewheel":0<Z.mouseWheel&&(k=Math.max(-1,Math.min(1,g.wheelDelta||-g.detail)),Z.viewportCurrent.mouseWheelHandler(k,f))}}if("mousedown"==b||"mousemove"==b)return!1}}}function C(){da&&(window.clearTimeout(da),da=null,u())}function u(){if(!Z.fullScreenEntering){var a=document.getElementById(Z.pageContainerID);
Z.viewerW=a.offsetWidth;Z.viewerH=a.offsetHeight;var a=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay),b=Z.viewportCurrent.calculateZoomForResize(Z.viewportCurrent.getZoom(),Z.viewerW,Z.viewerH,a.x,a.y);D.resizeViewer(a.x,a.y,b)}}var D=this,R=[];Z.ViewerDisplay=Z.Utils.createContainerElement("div","ViewerDisplay","inline-block","relative","hidden","100%","100%","0px","0px","none","0px","transparent","0px","0px","normal","pointer");Z.pageContainer=document.getElementById(Z.pageContainerID);
Z.Utils.getElementStyle(Z.pageContainer);Z.ViewerDisplay.style["-webkit-touch-callout"]="none";Z.ViewerDisplay.style["-moz-user-select"]="none";Z.ViewerDisplay.style["-khtml-user-select"]="none";Z.ViewerDisplay.style["-webkit-user-select"]="none";Z.ViewerDisplay.style["-ms-user-select"]="none";Z.ViewerDisplay.style["-o-user-select"]="none";Z.ViewerDisplay.style["user-select"]="none";var N=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay);Z.viewerW=N.x;Z.viewerH=N.y;Z.pageContainer.innerHTML=
"";Z.pageContainer.appendChild(Z.ViewerDisplay);Z.autoResize=Z.autoResize||Z.Utils.isElementFluid(Z.pageContainer);var ja=parseInt(Z.Utils.getResource("DEFAULT_AUTORESIZESKIPDURATION"),10),da;Z.mouseWheelCompleteDuration=parseInt(Z.Utils.getResource("z165"),10);if(Z.virtualPointerVisible)var S,xa;if(Z.imageSet)var La=[],pa=null,Ha=[];this.configureViewer=function(){if(!Z.Viewer.getStatus("configureCalled")){var a=function(){Z.clearCallback("readyViewer",a);Z.Utils.getMessage()!=Z.Utils.getResource("ALERT_LOADINGIMAGESET")&&
Z.Utils.getMessage()!=Z.Utils.getResource("ALERT_LOADINGANNOTATIONS")||Z.Utils.hideMessage();Z.imageSet&&!Z.comparison&&z619Delayed();Z.tracking&&Z.viewportCurrent.syncTrackingToViewport()},b=function(){Z.clearCallback(e,b);D.initializeViewerKeyEventListeners(!0);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseover",v);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseout",v);Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",
v);0<Z.mouseWheel&&Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",Z.Utils.preventDefault);ga();Z.autoResize&&Z.Utils.addEventListener(window,"resize",Z.Viewer.viewerEventsHandler);Z.tracking&&Z.Viewer.initializeViewerKeyDefaultListeners(!0);var a=Z["Viewport"+(Z.imageSetLength-1).toString()];D.configureComponents(Z.overlays?a:Z.viewportCurrent)};Z.Viewer.setStatus("configureCalled",!0);var e=Z.imageSet?"initializedViewer":"initializedViewport";Z.setCallback(e,b);Z.setCallback("readyViewer",
a);if(Z.narrative)Z.Narrative=new Z.ZoomifyNarrative;else if(Z.imageSet)if(Z.Utils.showMessage(Z.Utils.getResource("ALERT_LOADINGIMAGESET"),!1,null,"center"),"undefined"!==typeof Z.overlayJSONObject&&"object"===typeof Z.overlayJSONObject&&null!==Z.overlayJSONObject){var f=Z.Utils.jsonConvertObjectToXMLText(Z.overlayJSONObject),f=Z.Utils.xmlConvertTextToDoc(f);D.parseImageSetXML(f,"overlay")}else{var g=new Z.NetConnector;".xml"!=Z.imageSetPath.toLowerCase().substring(Z.imageSetPath.length-4,Z.imageSetPath.length)&&
(Z.imageSetPath=Z.imageSetPath+"/"+Z.Utils.getResource("DEFAULT_IMAGESETXMLFILE"));f=Z.Utils.cacheProofPath(Z.imageSetPath);g.loadXML(f,null,"loadingImageSetXML")}else Z.Viewport=new Z.ZoomifyViewport,Z.viewportCurrent=Z.Viewport}};this.validateComponents=function(a){"undefined"!==typeof Z.parameters&&null!==Z.parameters&&(Object.keys(Z.parameters),Z.Utils.clearComponent(Z.Navigator),Z.Utils.clearComponent(Z.Gallery),Z.Utils.clearComponent(Z.Ruler),Z.Utils.clearComponent(Z.Toolbar))};this.configureComponents=
function(b){0<Z.toolbarVisible&&!Z.Toolbar&&(Z.Toolbar=new Z.ZoomifyToolbar(b));0<Z.navigatorVisible&&(Z.Navigator||(Z.Navigator=new Z.ZoomifyNavigator(b)),Z.Navigator&&Z.Navigator.z682(),Z.comparison&&!Z.Navigator2&&(Z.Navigator2=new Z.ZoomifyNavigator(Z.Viewport1)),Z.Navigator2&&Z.Navigator2.z682());0<Z.galleryVisible&&(Z.Gallery||(Z.Gallery=new Z.ZoomifyGallery(b)),Z.Gallery&&Z.Gallery.validateGalleryGlobals());0<Z.rulerVisible&&!Z.Ruler&&(Z.Ruler=new Z.ZoomifyRuler(b));Z.helpCustom&&a()};this.loadHelp=
function(b,e){a(b,e)};this.receiveHelpHTML=function(a){4==a.readyState&&200==a.status&&Z.Utils.stringValidate(a.responseText)&&a.zType&&(-1!=a.zType.indexOf("helpCustom")?(Z.helpContent=a.responseText,Z.Utils.validateCallback("helpLoadedCustom")):-1!=a.zType.indexOf("helpNarrative")&&(Z.narrativeHelpContent=a.responseText,Z.Utils.validateCallback("helpLoadedNarrative")))};this.getVersion=function(){return Z.version};this.setSizeAndPosition=function(a,b,e,f,g){Z.viewerW=a;Z.viewerH=b;Z.ViewerDisplay.style.width=
a+"px";Z.ViewerDisplay.style.height=b+"px";Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setSizeAndPosition(a,b,0,0);var l=Z.toolbarBackgroundVisible?0:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST"),10),l=1==Z.toolbarPosition?b-Z.toolbarH-l:0+l;Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(Z.Toolbar.setSizeAndPosition(a,null,null,l),0!=Z.toolbarVisible&&8!=Z.toolbarVisible&&Z.Toolbar.show(!0));Z.Navigator&&Z.Navigator.getInitialized()&&(Z.Navigator.setSizeAndPosition(null,
null,0==Z.navigatorL?e:Z.navigatorL+Z.navigatorW>a?a-Z.navigatorW:Z.navigatorL,0!=Z.navigatorT?Z.navigatorT:f,Z.navigatorFit),1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.narrative?e=a+Z.navigatorW:Z.comparison&&Z.Navigator2&&(Z.Navigator2.setSizeAndPosition(null,null,a-Z.navigatorW,f,Z.navigatorFit),Z.Navigator2.setVisibility(!0))));if(S){var l=parseInt(S.style.left,10),k=parseInt(S.style.top,10),u=parseInt(S.style.width,10),v=parseInt(S.style.height,10);0>l&&(l=0);l+u>Z.viewerW&&(l=Z.viewerW-
u);0>k&&(k=0);k+v>Z.viewerH&&(k=Z.viewerH-v);S.style.left=l+"px";S.style.top=k+"px"}Z.imageList&&Z.Viewport.getStatus("initializedImageList")&&Z.Viewport.setSizeAndPositionImageList();Z.annotationFileList&&Z.Viewport.getStatus("initializedAnnotationFileList")&&Z.Viewport.setSizeAndPositionAnnotationFileList();Z.slideList&&"undefined"!==typeof slideList&&null!==slideList&&(l=Z.Viewport.calculateSlideListCoords(Z.viewerW,Z.viewerH),slideList.style.left=l.x+"px",slideList.style.top=l.y+"px");Z.Gallery&&
Z.Gallery.getInitialized()&&(Z.Gallery.setSizeAndPosition(a,b,e,f),Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!0));0<Z.magnifierVisible&&D.getStatus("magnifierInitializedViewport")&&D.sizeAndPositionMagnifier(null,null,null,null);g&&Z.Viewport.updateView(!0)};this.getImagePath=function(){return D.getImage()};this.getImage=function(){return Z.imagePath};this.setImagePath=function(a,b){"undefined"!==typeof b&&Z.Utils.stringValidate(b)&&(Z.imageProperties=b);D.setImage(a)};this.setImage=function(a,
b,e,f){Z.narrative&&null===Z.imagePath&&(Z.imagePath=Z.Utils.stringRemoveTrailingSlash(a),Z.Utils.validateImagePath());if(Z.Viewport&&(Z.Viewport.getStatus("initializedViewport")||e)){Z.Viewport.zoomAndPanAllStop(!0);var g=!0;null!==Z.editing&&(g=!0,null!==Z.editing&&Z.Viewport.verifyEditsUnsaved()&&(g=confirm(Z.Utils.getResource("ALERT_UNSAVEDEDITSEXIST-CUSTOM"))));g&&(Z.maskingSelection&&D.clearMask(),Z.overlays||Z.Utils.clearImageParameters(),Z.imagePath=Z.Utils.stringRemoveTrailingSlash(a),Z.Utils.validateImagePath(),
g="undefined"===typeof f||null===f||0==f?Z.Viewport:Z["Viewport"+f.toString()],g.setImagePath(Z.imagePath),"undefined"!==typeof b&&null!==b&&(Z.parameters=Z.Utils.parseParameters(b)),(e||Z.narrative)&&Z.Utils.setParameters(Z.parameters),"unconverted"==Z.tileSource?g.loadUnconvertedImage(a):Z.imageProperties?(a=Z.Utils.xmlConvertTextToDoc(Z.imageProperties),g.z602(a)):(a=new Z.NetConnector,g.loadImageProperties(Z.imagePath,a,f)))}else f=b?b.substring(b.indexOf("zAnnotationPath=")+16,b.length):null,
Z.Viewport=new Z.ZoomifyViewport(0,a,f),Z.viewportCurrent=Z.Viewport,Z.Toolbar&&Z.Toolbar.setViewport(Z.viewportCurrent)};this.setImageWithFade=function(a,b,e,f){if(Z.Viewport&&(Z.Viewport.getStatus("initializedViewport")||e)){if("undefined"===typeof f||null===f)f=50;Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler("out",a,b,e)},1)}};this.setTourPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setHotspotPath(a,b)};
this.setHotspotPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setHotspotPath(a,b)};this.setAnnotationPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setAnnotationPath(a,b)};this.setTrackingPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setTrackingPath(a,b)};this.initializePageExitEventHandler=function(){Z.Utils.addEventListener(window,"beforeunload",b)};this.disablePageExitEventHandler=
function(){Z.Utils.removeEventListener(window,"beforeunload",b)};this.getStatus=function(a){a=Z.Utils.arrayIndexOfObjectValue(R,"state",a);return-1==a?!1:R[a].status};this.setStatus=function(a,b){var e=!1,f=Z.Utils.arrayIndexOfObjectValue(R,"state",a);-1==f?(e=b,R[R.length]={state:a,status:b}):(!R[f].status&&b&&(e=!0),R[f].status=b);e&&(Z.Utils.validateCallback(a),D.validateViewerReady(a))};this.validateViewerStatus=function(a){var b=!0;if(Z.imageSet)for(var e=0,f=Z.imageSetLength;e<f;e++)if(!Z["Viewport"+
e.toString()].getStatus(a)){b=!1;break}b&&(b=a.indexOf("Viewport"),-1!=b&&(a=a.substring(0,b)),D.setStatus(a+"Viewer",!0))};this.validateViewerReady=function(a){a=Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&("unconverted"==Z.tileSource||Z.Viewport.getStatus("precacheLoadedViewport")&&Z.Viewport.getStatus("backfillLoadedViewport")&&Z.Viewport.getStatus("backfillDrawnViewport"))&&Z.Viewport.getStatus("displayLoadedViewport")&&Z.Viewport.getStatus("displayDrawnViewport");var b=!Z.hotspots||
Z.Viewport&&Z.Viewport.getStatus("hotspotsLoadedViewport"),e=!Z.annotations||Z.Viewport&&Z.Viewport.getStatus("annotationsLoadedViewport")&&(!Z.annotationPanelVisible||Z.Viewport.getStatus("annotationPanelInitializedViewport")),f=0==Z.toolbarVisible||Z.Toolbar&&Z.Toolbar.getInitialized(),g=!Z.navigatorVisible||Z.Navigator&&Z.Navigator.getInitialized(),l=!Z.galleryVisible||Z.Gallery&&Z.Gallery.getInitialized(),k=!Z.rulerVisible||Z.Ruler&&Z.Ruler.getInitialized(),u=!Z.imageSet||Z.Viewer&&Z.Viewer.getStatus("initializedViewer")&&
("unconverted"==Z.tileSource||Z.Viewer.getStatus("precacheLoadedViewer")&&Z.Viewer.getStatus("backfillLoadedViewer")&&Z.Viewer.getStatus("backfillDrawnViewer"))&&Z.Viewer.getStatus("displayLoadedViewer")&&Z.Viewer.getStatus("displayDrawnViewer"),v=!Z.imageSet||!Z.hotspots||Z.Viewer&&Z.Viewer.getStatus("hotspotsLoadedViewer"),n=!Z.imageSet||!Z.annotations||Z.Viewer&&Z.Viewer.getStatus("annotationsLoadedViewer")&&(!Z.annotationPanelVisible||Z.Viewer.getStatus("annotationPanelInitializedViewer"));(a=
a&&b&&e&&f&&g&&l&&k&&u&&v&&n)&&Z.Viewer.setStatus("readyViewer",!0);return a};this.createVirtualPointer=function(){if(!xa)xa=new Image,xa.url=Z.virtualPointerPath,xa.onload=D.createVirtualPointer,xa.onerror=e,xa.src=Z.virtualPointerPath;else if(!S){var a=xa.width,b=xa.height,g=Z.narrative?Z.viewerW-100:Z.viewerW/2+100,k=0==Z.magnifierVisible?Z.viewerH-200:Z.viewerH-275,u=xa.cloneNode(!1);u.width=a;u.height=b;S=Z.Utils.createContainerElement("div","piC","inline-block","absolute","hidden",a+"px",b+
"px",g+"px",k+"px","none","0px","transparent","0px","0px","normal");S.appendChild(u);Z.ViewerDisplay.appendChild(S);S.setAttribute("title",Z.Utils.getResource("z398"));S.style.zIndex=(Z.baseZIndex+44).toString();Z.Utils.addEventListener(S,"mousedown",f);Z.Utils.addEventListener(S,"touchstart",l);Z.Utils.addEventListener(S,"touchmove",E);Z.Utils.addEventListener(S,"touchend",n);Z.Utils.addEventListener(S,"touchcancel",w);Z.Utils.addEventListener(u,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(u,
"mousedown",Z.Utils.preventDefault)}};this.setVirtualPointerVisibility=function(a){S&&(S.style.display=a?"inline-block":"none")};this.setVirtualPointerSizeAndPosition=function(a,b,e,f,g){if(S){if("undefined"===typeof a||null===a)a=xa.width;if("undefined"===typeof b||null===b)b=xa.height;"undefined"!==typeof e&&null!==e&&!isNaN(e)||"undefined"!==typeof S.style.left&&null!==S.style.left||(e=Z.viewerW/2+100);"undefined"!==typeof f&&null!==f&&!isNaN(f)||"undefined"!==typeof S.style.top&&null!==S.style.top||
(f=Z.viewerH-200);"undefined"!==typeof g&&null!==g&&(f=Z.Viewport.z478(e,f),e=f.x,f=f.y);S.style.width=a+"px";S.style.height=b+"px";S.firstChild.width=a;S.firstChild.height=b;S.style.left=e+"px";S.style.top=f+"px"}};this.prez581s=function(){if(Z.Viewer.getStatus("readyViewer")){Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGE-DATA"),!1,Z.messageDurationLong,"center");for(var a=0,b=Z.imageSetLength;a<b;a++)Z["Viewport"+a.toString()].prez581s(!0)}};this.syncComparisonViewport=function(a){if(Z.syncComparison&&
Z.Viewport&&Z.Viewport0&&Z.Viewport0.getStatus("initializedViewport")&&Z.Viewport1&&Z.Viewport1.getStatus("initializedViewport")){var b=Z.Viewport.getViewportID(),e=0==b?Z.Viewport0:Z.Viewport1,f=0==b?Z.Viewport1:Z.Viewport0;if(a)b=e.getCoordinatesFull(!0),f.setView(b.x,b.y,b.z,b.r,null,null);else if(a=e.getCoordinatesDisplayFull(),f.setViewNoUpdate(a.cLeft,a.cTop,a.vWidth,a.vHeight,a.vLeft,a.vTop,a.bWidth,a.bHeight,a.bLeft,a.bTop,a.cRotation),b=0==b?Z.Navigator2:Z.Navigator)"stop"!=Z.zooming?b.syncToViewport():
(a=new Z.Utils.Point(parseFloat(a.cLeft),parseFloat(a.cTop)),f=f.calculateCurrentCenterCoordinates(a,Z.imageZ,Z.imageR),b.z658(f))}};this.syncOverlayViewports=function(a,b){var e=Z["Viewport"+(Z.imageSetLength-1).toString()];if(Z.overlays&&e&&e.getStatus("initializedViewport"))if(a)for(var f=e.getCoordinatesFull(!0),e=0,g=Z.imageSetLength-1;e<g;e++)b!=e&&Z["Viewport"+e.toString()].setView(f.x,f.y,f.z,f.r,null,null);else for(f=e.getCoordinatesDisplayFull(),e=0,g=Z.imageSetLength-1;e<g;e++)Z["Viewport"+
e.toString()].setViewNoUpdate(f.cLeft,f.cTop,f.vWidth,f.vHeight,f.vLeft,f.vTop,f.bWidth,f.bHeight,f.bLeft,f.bTop,f.cRotation)};this.parseImageSetXML=function(a,b){Z.Utils.arrayClear(La);Z.Utils.arrayClear(Ha);Z.imageSetListPosition=Z.Utils.getResource("DEFAULT_IMAGESETLISTPOSITION");var e=Z.Utils.getResource("DEFAULT_IMAGESETLISTSOURCE");Z.imageSetListTitle=Z.Utils.getResource("UI_IMAGESETLISTTITLE");Z.imageSetStart=parseInt(Z.Utils.getResource("UI_IMAGESETSTART"),10);Z.imageSetLoop="1"==Z.Utils.getResource("UI_IMAGESETLOOP");
Z.sliderImageSetVisible="1"==Z.Utils.getResource("UI_IMAGESETSLIDER");var f=a.getElementsByTagName("SETUP")[0];if(f){var g=f.getAttribute("CHOICELIST");Z.Utils.stringValidate(g)&&(Z.imageSetListPosition=g);g=f.getAttribute("LISTSOURCE");Z.Utils.stringValidate(g)&&(e=g);g=f.getAttribute("LISTTITLE");Z.Utils.stringValidate(g)&&(Z.imageSetListTitle=g);g=f.getAttribute("HOTSPOTPATH");Z.Utils.stringValidate(g)&&(Z.imageSetHotspotPath=g,Z.hotspotFileShared=!0);g=f.getAttribute("ANNOTATIONPATH");Z.Utils.stringValidate(g)&&
(Z.imageSetAnnotationPath=g,Z.annotationFileShared=!0);g=f.getAttribute("TRACKINGPATH");Z.Utils.stringValidate(g)&&(Z.imageSetTrackingPath=g,Z.trackingFileShared=!0);g=f.getAttribute("IMAGELISTPATH");Z.Utils.stringValidate(g)&&(Z.imageSetImageListPath=g,Z.imageListFileShared=!0);g=f.getAttribute("START");Z.Utils.stringValidate(g)&&(Z.imageSetStart=parseInt(g,10)-1);g=f.getAttribute("LOOP");Z.Utils.stringValidate(g)&&(Z.imageSetLoop="1"==g);g=f.getAttribute("SLIDER");Z.Utils.stringValidate(g)&&(Z.sliderImageSetVisible=
"1"==g);Z.overlays&&(g=f.getAttribute("INITIALVISIBILITY"),Z.overlaysInitialVisibility=Z.Utils.stringValidate(g)?"1"==g||"true"==g:"1"==Z.Utils.getResource("DEFAULT_OVERLAYSVISIBLE"));Z.animation&&(g=f.getAttribute("AXIS"),Z.animationAxis=Z.Utils.stringValidate(g)?g:null!==Z.animationAxis?Z.animationAxis:Z.Utils.getResource("DEFAULT_ANIMATIONAXIS"),g=f.getAttribute("ANIMATOR"),Z.animator=Z.Utils.stringValidate(g)?g:null!==Z.animator?Z.animator:Z.Utils.getResource("DEFAULT_ANIMATOR"),g=f.getAttribute("FLIP"),
Z.animationFlip=Z.Utils.stringValidate(g)?"1"==g:null!==Z.animationFlip?Z.animationFlip:"1"==Z.Utils.getResource("DEFAULT_ANIMATIONFLIP"));Z.comparison&&(Z.initialSync="1"==Z.Utils.getResource("DEFAULT_COMPARISONINITIALSYNC"),Z.syncComparison="1"==Z.Utils.getResource("DEFAULT_COMPARISONSYNC"),g=f.getAttribute("INITIALSYNC"),Z.Utils.stringValidate(g)&&(Z.initialSync="1"==g,Z.initialSync||(Z.syncComparison=!1)),f=f.getAttribute("SYNCVISIBLE"),Z.syncVisible=Z.Utils.stringValidate(f)?"1"==f:"1"==Z.Utils.getResource("DEFAULT_COMPARISONSYNCVISIBLE"))}Z.overlays&&
(g=a.createElement("OVERLAY"),g.setAttribute("MEDIA",Z.imagePath),g.setAttribute("NAME","Base Image"),f=a.getElementsByTagName("OVERLAY"),a.documentElement.insertBefore(g,f[0]));for(var f=a.getElementsByTagName("animation"==b||"comparison"==b?"IMAGE":"overlay"==b?"OVERLAY":"SLIDE"),g=0,l=f.length;g<l;g++){var k=new W(f[g],g);La[La.length]=k;var u="NAME"==e?k.name:k.media.substring(k.media.lastIndexOf("/")+1,k.media.length);Ha[Ha.length]={text:u,value:k.internalID}}Z.animationFlip&&(La.reverse(),Ha.reverse());
Z.comparison&&(e=La[0],f=La[1],e.initialX!=f.initialX||e.initialY!=f.initialY||e.initialZoom!=f.initialZoom||e.minX!=f.minX||e.maxX!=f.maxX)&&(Z.initialSync=!1);Z.imageSetLength=La.length;Z.comparison||Z.overlays||(k=Z.imageSetListPosition,e=Z.imageSetListTitle,f=Ha,g="0"==k?"hidden":"visible",l=parseInt(Z.Utils.getResource("DEFAULT_IMAGESETLISTWIDTH"),10),k=J(k,l,Z.viewerW,Z.viewerH),"undefined"===typeof pa||null===pa?(pa=new Z.Utils.createSelectElement("imageSetList",e,f,l,k.x,k.y,null,g,oa,"change"),
Z.ViewerDisplay.appendChild(pa),e=Z.Utils.stringValidate(Z.imageSetListTitle)&&"none"!=Z.imageSetListTitle?1:0,pa.selectedIndex=e):Z.Utils.arrayClear(f),pa.style.zIndex=(Z.baseZIndex+32).toString());G(La)};z619Delayed=function(){for(var a=0,b=Z.imageSetLength;a<b;a++){var e=Z["Viewport"+a.toString()];e.getStatus("backfillPrecachedViewport")||e.z619(!0)}};this.viewportChange=function(a){"stop"!=a?("forward"==a?Z.Viewer.viewportNext():Z.Viewer.viewportPrior(),Z.animation&&(Z.viewportChangeTimeout=window.setTimeout(function(){Z.Viewer.viewportChange(a)},
10))):Z.viewportChangeTimeout&&(window.clearTimeout(Z.viewportChangeTimeout),Z.viewportChangeTimeout=null)};this.viewportPrior=function(a){a="undefined"===typeof a||null===a?0:Math.round(a);var b=Z.imageSetLength-1;a=Z.viewportCurrentID-(1-a);0>a&&(Z.imageSetLoop?(a<-b&&(a=-(-a%b)),0>a&&(a+=b+1)):a=0);D.viewportSelect(a)};this.viewportNext=function(a){a="undefined"===typeof a||null===a?0:Math.round(a);var b=Z.imageSetLength-1;a=Z.viewportCurrentID+(1+a);a>b&&(a=Z.imageSetLoop?a%(b+1):b);D.viewportSelect(a)};
this.viewportSelect=function(a,b){var e=Z.mouseIsDown||Z.buttonIsDown||Z.keyIsDown,f=null===Z.Viewport;if("undefined"===typeof a||null===a)a=0;a=Math.abs(a);if(a!=Z.viewportCurrentID||!e){var g=a.toString(),l=Z["Viewport"+g],k=l==Z.viewportCurrent;"undefined"===typeof l||k&&!f&&e||(e=Z.viewportCurrentID.toString(),f=Z.viewportCurrent,Z.viewportCurrent=l,Z.viewportCurrentID=a,Z.comparison||Z.viewportCurrent.setVisibility(!0),Z.Viewport=Z.viewportCurrent,k||Z.comparison||Z.overlays||f.setVisibility(!1),
Z.Utils.validateCallback("viewportChanged"),Z.comparison&&Z.Viewport0&&Z.Viewport1&&(l=document.getElementById("viewportContainer0"),k=document.getElementById("viewportContainer1"),Z.Utils.swapZIndices(l,k),l=a,Z.Navigator&&Z.Navigator.setSelected(0==l),Z.Navigator2&&Z.Navigator2.setSelected(1==l)),Z.viewportCurrent&&Z.viewportCurrent.getStatus("initializedViewport")&&(l=Z.viewportCurrent.getViewW()!=Z.viewerW||Z.viewportCurrent.getViewH()!=Z.viewerH,Z.comparison||(l?Z.viewportCurrent.syncViewportResize(Z.imageX,
Z.imageY,Z.imageZ,Z.imageR):(0!=Z.imageR&&Z.viewportCurrent.rotateSet(Z.imageR,!1,!0),Z.viewportCurrent.updateView(!0))),f&&(Z.hotspotFileShared||Z.annotationFileShared)&&(l=f.getHotspots())&&Z.viewportCurrent.setHotspots(l),!Z.comparison&&Z.Navigator&&Z.Navigator.getInitialized()&&0<Z.navigatorVisible&&Z.Navigator.setViewport(Z.viewportCurrent),!Z.comparison&&Z.Gallery&&Z.Gallery.getInitialized()&&0<Z.galleryVisible&&(Z.Gallery.setViewport(Z.viewportCurrent),Z.Gallery.syncGalleryToViewport(slideCurrentInList)),
Z.Toolbar&&Z.Toolbar.getInitialized()&&(0<Z.toolbarVisible&&8!=Z.toolbarVisible&&(Z.comparison||"undefined"!==typeof b&&null!==b&&b||Z.Toolbar.syncSliderToViewportImageSet(Z.viewportCurrentID),Z.Toolbar.setViewport(Z.viewportCurrent)),Z.annotationFileShared&&(f=f.getCurrentLabel().internalID,Z.viewportCurrent.setCurrentLabel(f,!0),Z.viewportCurrent.setEditModeLabel(Z.labelMode,!0,null,!0)),Z.annotationPanelVisibleState&&(Z.annotationFileShared?Z.Toolbar.setVisibilityAnnotationPanel(!0,"0"):(Z.Toolbar.setVisibilityAnnotationPanel(!1,
e),Z.Toolbar.setVisibilityAnnotationPanel(!0,g))),Z.magnifierVisible&&(Z.viewportCurrent.setVisibilityMagnifier(!1,e),Z.viewportCurrent.setVisibilityMagnifier(!0,g)),Z.trackingPanelVisibleState&&(Z.trackingFileShared?Z.Toolbar.setVisibilityTrackingPanel(!0,"0"):(Z.Toolbar.setVisibilityTrackingPanel(!1,e),Z.Toolbar.setVisibilityTrackingPanel(!0,g))),Z.userPanelVisibleState&&(Z.Toolbar.setVisibilityUserPanel(!1),Z.Toolbar.setVisibilityUserPanel(!0))),Z.hotspots&&(K(!1,e),K(!0,g)),pa&&(pa.blur(),g=Z.Utils.stringValidate(Z.imageSetListTitle)&&
"none"!=Z.imageSetListTitle?1:0,pa.selectedIndex=Z.viewportCurrentID+g)))}};this.setVisibilityHotspotChoiceList=function(a,b){K(a,b)};this.sizeAndPositionImageSetList=function(){if(pa){var a=parseInt(Z.Utils.getResource("z65"),10)+2;pa.style.width=a+"px";a=J(Z.imageSetListPosition,a,Z.viewerW,Z.viewerH);pa.style.left=a.x+"px";pa.style.top=a.y+"px"}};this.setVisibilityImageSetChoiceList=function(a){var b=document.getElementById("imageSetList");b&&(b.style.visibility=a?"visible":"hidden")};this.syncToolbarImageSetSliderToViewport=
function(a){Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.imageSet&&Z.sliderImageSetVisible&&(a=Z["Viewport"+a].getZoom(),Z.Toolbar.syncSliderToViewportZoom(a))};this.initializeViewerKeyEventListeners=function(a){a?(Z.Utils.addEventListener(document,"keydown",fa),Z.Utils.addEventListener(document,"keyup",fa)):(Z.Utils.removeEventListener(document,"keydown",fa),Z.Utils.removeEventListener(document,"keyup",fa))};this.initializeViewerKeyDefaultListeners=function(a){a?(Z.Utils.addEventListener(document,
"keydown",Z.Utils.preventDefault),Z.Utils.addEventListener(document,"keyup",Z.Utils.preventDefault)):(Z.Utils.removeEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.removeEventListener(document,"keyup",Z.Utils.preventDefault))};this.viewerEventsHandler=function(a){v(a)};this.autoResizeViewer=function(){u()};this.resizeViewer=function(a,b,e){D.setSizeAndPosition(a,b,0,0,!1);Z.viewportCurrent.resizeViewport(Z.imageX,Z.imageY,e,Z.imageR);if(Z.comparison)(a=0==Z.viewportCurrent.getViewportID()?
Z.Viewport1:Z.Viewport0)&&a.syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else if(Z.overlays)for(a=0,b=Z.imageSetLength-1;a<b;a++)Z["Viewport"+a.toString()].syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else Z.narrative&&(Z.Narrative.drawLayoutNarrativePanel(),Z.narrativeMode&&Z.Narrative.drawLayoutFileManagerPanel())};this.z586=function(a){Z.mouseWheelIsDown=!1;Z.mouseWheelCompleteTimer&&(window.clearTimeout(Z.mouseWheelCompleteTimer),Z.mouseWheelCompleteTimer=null,Z.zooming=
"stop",Z.viewportCurrent.updateView(!0))};this.magnifierMouseMoveHandler=function(a){Z.interactive&&Z.viewportCurrent.updateViewMagnifier(a)}};
Z.ZoomifyViewport=function(a,b,e,f,g,k){function l(){var h=Z.Utils.getResource("DEFAULT_IMAGELISTXMLFILE");".xml"!=Z.imageListPath.toLowerCase().substring(Z.imageListPath.length-4,Z.imageListPath.length)&&(Z.imageListPath=Z.imageListPath+"/"+h);XMLPath=Z.Utils.cacheProofPath(Z.imageListPath);"undefined"!==typeof XMLPath&&Z.Utils.stringValidate(XMLPath)&&(new Z.NetConnector).loadXML(XMLPath,a,"loadingImageListXML")}function E(h){h=Z.Utils.getResource("z209");".xml"!=Z.slidePath.toLowerCase().substring(Z.slidePath.length-
4,Z.slidePath.length)&&(Z.slidePath=Z.slidePath+"/"+h);XMLPath=Z.Utils.cacheProofPath(Z.slidePath);"undefined"!==typeof XMLPath&&Z.Utils.stringValidate(XMLPath)&&(h=new Z.NetConnector,h.loadXML(XMLPath,null,"loadingSlidesXML"))}function n(h,a,t,b,rb,e,f,g,Ma,l,k){J();"ZoomifyPFFFile"==Z.tileSource&&Z.pffJPEGHeadersSeparate||(Z.imageW=h,Z.imageH=a,Z.imageCtrX=Z.imageW/2,Z.imageCtrY=Z.imageH/2,Z.imageD=Math.round(Math.sqrt(h*h+a*a)),Ri=e,Si=f,ua=g,Nh=rb,Bb=t,Hb=b);null!==Ma&&null!==l&&null!==k&&(Z.sourceMagnification=
Ma,Z.focal=l,Z.quality=k);v();oa(ka,ha,Ig,Jg);m.validateXYZDefaults();Nb>cg?(Lc=la(H,Z.initialZ),Ga&&Ib.scale(Lc,Lc)):Bc&&(Bc.width="0px",Bc.height="0px");od=la(fc,Z.initialZ);pd=Ia=la(Sa,Z.initialZ);if(Z.useCanvas)try{kb.scale(Ia,Ia)}catch(r){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE"),!1,Z.messageDurationStandard,"center"),console.log("In function initializeViewportContinue scaling canvas:  "+r)}Ob&&Zc();Z.virtualPointerVisible&&Z.Viewer.createVirtualPointer();
0<Z.rulerVisible&&Z.narrative&&Nd(Ja);Z.screensaver&&(Z.Utils.validateCallback("screensaverStarting"),Z.Utils.functionCallWithDelay(function(){m.tourStart()},750));Ka&&(Z.annotations&&m.setDrawingColor("buttonColor0"+Ja,!0),Z.hotspots||Z.tour?Od(Ja):(Z.annotations||Z.narrative)&&gc(Ja));0<Z.magnifierVisible&&Ub(Ja);Z.tracking&&Pd(Ja);"unconverted"!=Z.tileSource&&m.z619();Ti(Z.initialX,Z.initialY,Z.initialZ,Z.initialR,null,!0);Z.coordinatesVisible&&m.setCoordinatesDisplayVisibility(!0);Z.geoCoordinatesVisible&&
Qd();Z.initialFullPage&&m.toggleFullViewMode(!0);Z.Utils.addEventListener(eb,"mousedown",fd);Z.Utils.addEventListener(eb,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(eb,"touchstart",fd);Z.Utils.addEventListener(eb,"touchmove",fd);Z.Utils.addEventListener(eb,"touchend",fd);Z.Utils.addEventListener(eb,"touchcancel",fd);Z.Utils.addEventListener(eb,"gesturestart",fd);Z.Utils.addEventListener(eb,"gesturechange",fd);Z.Utils.addEventListener(eb,"gestureend",fd);Z.Utils.addEventListener(za,
"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(wa,"contextmenu",Z.Utils.preventDefault);Ob&&Z.Utils.addEventListener(Ob,"contextmenu",Z.Utils.preventDefault);Ka&&Z.Utils.addEventListener(Ka,"contextmenu",Z.Utils.preventDefault);m.setStatus("initializedViewport",!0);m.syncViewportRelated();Z.setCallback("imageChanged",Z.Viewport.updateImageComponents);Z.slideshow&&(h=Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0,"undefined"!==typeof je&&(je.selectedIndex=h),
Ui&&!Z.slideshowPlaying?m.slideshowStart():Z.slideshowPlaying&&m.nextSlide());"multiple"==Z.imagePath&&(h=Z.hotspots?"hotspotsLoadedViewer":Z.annotations?"annotationsLoadedViewer":null,null!==h&&Z.setCallback(h,function(){window.setTimeout(function(){Z.viewportCurrent.z623()},1500)}))}function w(h,gh,t,b,rb,e,f,g,Ma,l,k){m.setStatus("initializedViewport",!1);m.clearAll(!0,!1,!0,!0);"ZoomifyPFFFile"==Z.tileSource&&Z.pffJPEGHeadersSeparate||(Z.imageW=h,Z.imageH=gh,Z.imageCtrX=Z.imageW/2,Z.imageCtrY=
Z.imageH/2,Z.imageD=Math.round(Math.sqrt(h*h+gh*gh)),Ri=e,Si=f,ua=g,Nh=rb,Bb=t,Hb=b);Z.Utils.setParameters(Z.parameters);Z.imageList&&(Z.tileW!=t&&(Bb=Z.tileW),Z.tileH!=b&&(Hb=Z.tileH));v();null!==Z.hotspotPath&&(Ld=Z.hotspotPath,dg=Z.hotspotFolder);null!==Z.annotationPath&&(Mc=Z.annotationPath,Fd=Z.annotationFolder);W();J();m.validateXYZDefaults();Nb>cg?(Lc=la(H,Z.initialZ),Ga&&(Ib.restore(),Ib.scale(Lc,Lc))):Bc&&(Bc.width="0px",Bc.height="0px");od=la(fc,Z.initialZ);pd=Ia=la(Sa,Z.initialZ);Z.useCanvas&&
(kb.restore(),kb.scale(Ia,Ia));Ob&&Zc();Ka&&(m.setDrawingColor("buttonColor0"+Ja,!0),Z.hotspots||Z.tour?Od(Ja):(Z.annotations||Z.narrative)&&gc(Ja));Z.virtualPointerVisible&&Z.Viewer.createVirtualPointer();"unconverted"!=Z.tileSource&&m.z619();if(Z.narrative||Z.comparison)ka=Z.viewerW;m.setSizeAndPosition(ka,ha,Ig,Jg);h="undefined"!==typeof Z.parameters&&null!==Z.parameters&&("undefined"!==typeof Z.parameters.zInitialX||"undefined"!==typeof Z.parameters.zInitialY||"undefined"!==typeof Z.parameters.zInitialZoom);
!Z.comparison&&!Z.overlays||h?Ti(Z.initialX,Z.initialY,Z.initialZ,Z.initialR,null,!0):Ti(Z.priorX,Z.priorY,Z.priorZ,Z.priorR,null,!0);Z.Utils.validateCallback("imageChanged");m.setStatus("initializedViewport",!0);(h=0==a?Z.Navigator:Z.Navigator2)&&h.setImage(m.getImagePath());Z.tracking&&Pd(Ja);Z.comparison&&(h=(0==m.getViewportID()?Z.Viewport1:Z.Viewport0).getCoordinatesFull(!0),m.setView(h.x,h.y,h.z,h.r,null,null));h=Z["Viewport"+(Z.imageSetLength-1).toString()];Z.Viewer.configureComponents(Z.overlays?
h:Z.viewportCurrent);m.syncViewportRelated();Z.Utils.validateCallback("reinitializedViewport");Z.slideshowPlaying&&m.nextSlide()}function G(){Gf=Se=qd=0;"undefined"!==typeof uc&&Z.Utils.arrayClear(uc);"undefined"!==typeof Pb&&Z.Utils.arrayClear(Pb);"undefined"!==typeof vd&&Z.Utils.arrayClear(vd);"undefined"!==typeof Ge&&Z.Utils.arrayClear(Ge);"undefined"!==typeof va&&Z.Utils.arrayClear(va);"undefined"!==typeof gd&&Z.Utils.arrayClear(gd);"undefined"!==typeof Hd&&Z.Utils.arrayClear(Hd);"undefined"!==
typeof He&&Z.Utils.arrayClear(He);"undefined"!==typeof ke&&Z.Utils.arrayClear(ke);"undefined"!==typeof wd&&Z.Utils.arrayClear(wd);"undefined"!==typeof le&&Z.Utils.arrayClear(le);"undefined"!==typeof eg&&Z.Utils.arrayClear(eg);"undefined"!==typeof fg&&Z.Utils.arrayClear(fg);"undefined"!==typeof Ie&&Z.Utils.arrayClear(Ie);"undefined"!==typeof Cb&&Z.Utils.arrayClear(Cb);"undefined"!==typeof xd&&Z.Utils.arrayClear(xd);"undefined"!==typeof yd&&Z.Utils.arrayClear(yd);"undefined"!==typeof Je&&Z.Utils.arrayClear(Je);
"undefined"!==typeof Hf&&Z.Utils.arrayClear(Hf);"undefined"!==typeof Te&&Z.Utils.arrayClear(Te);"undefined"!==typeof Ue&&Z.Utils.arrayClear(Ue);"undefined"!==typeof Ve&&Z.Utils.arrayClear(Ve);"undefined"!==typeof fullImageTilesAllCachedNames&&Z.Utils.arrayClear(fullImageTilesAllCachedNames)}function K(){Nb=1;fc=Sa=0;gg=hh=ih=Q=!1;"undefined"!==typeof Vb&&Z.Utils.arrayClear(Vb);"undefined"!==typeof Nc&&Z.Utils.arrayClear(Nc);"undefined"!==typeof vb&&Z.Utils.arrayClear(vb);"undefined"!==typeof Oc&&
Z.Utils.arrayClear(Oc);"undefined"!==typeof hd&&Z.Utils.arrayClear(hd);"undefined"!==typeof If&&Z.Utils.arrayClear(If);"undefined"!==typeof aa&&Z.Utils.arrayClear(aa);"undefined"!==typeof We&&Z.Utils.arrayClear(We);"undefined"!==typeof jh&&Z.Utils.arrayClear(jh);"undefined"!==typeof Jf&&Z.Utils.arrayClear(Jf);"undefined"!==typeof mf&&Z.Utils.arrayClear(mf);"undefined"!==typeof me&&Z.Utils.arrayClear(me);"undefined"!==typeof pi&&Z.Utils.arrayClear(pi);"undefined"!==typeof hg&&Z.Utils.arrayClear(hg);
"undefined"!==typeof ac&&Z.Utils.arrayClear(ac);"undefined"!==typeof Oh&&Z.Utils.arrayClear(Oh)}function W(h){if("undefined"===typeof h||null===h)h=0;var a=h.toString();Z.useCanvas&&!Ga&&(nf=Z.Utils.createContainerElement("canvas","oversizeDisplay"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),Z.ViewerDisplay.appendChild(nf),Ga=nf,Bc=Ga.style);!Z.comparison&&!Z.narrative||ig||(Kg=Z.Utils.createContainerElement("div","comparisonMaskContainer"+
a,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),Z.ViewerDisplay.appendChild(Kg),ig=Kg,Lg=ig.style);eb||(hc=Z.Utils.createContainerElement("div","viewportContainer"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),Z.comparison||Z.narrative?Kg.appendChild(hc):Z.ViewerDisplay.appendChild(hc),eb=hc,L=eb.style);za||(Ph=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportBackfillDisplay"+
a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(Ph),za=Ph,Ea=za.style,Z.hideOverlayBackfill&&0!=h&&(Ea.display="none"));wa||(Mg=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportDisplay"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(Mg),wa=Mg,hb=wa.style);Z.useCanvas&&(jd||(kh=Z.Utils.createContainerElement("canvas","transitionCanvas",
"none","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(kh),jd=kh,Xe=jd.style),Z.imageFilters&&(ne||(lh=Z.Utils.createContainerElement("canvas","imageFilterBackfillCanvas","none","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(lh),ne=lh,jg=ne.style),oe||(mh=Z.Utils.createContainerElement("canvas","imageFilterCanvas","none","absolute","visible","1px","1px","0px","0px","none","0px",
"transparent","0px","0px","normal"),hc.appendChild(mh),oe=mh,Qh=oe.style)));Z.watermarks&&!Ob&&(Rh=Z.Utils.createContainerElement("div","watermarkDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(Rh),Ob=Rh,Ye=Ob.style);Z.maskVisible&&!sb&&(ic=Z.Utils.createContainerElement("canvas","maskCanvas","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(ic),
sb=ic,Cc=sb.style,Cc.display="none");h=Z.zoomRectangle||Z.measureVisible||Z.tour&&!Z.screensaver||Z.hotspots||Z.annotations;var a=Z.useCanvas&&(h||Z.hotspots&&Z.labelShapesInternal),t=Z.useCanvas&&(Z.zoomRectangle||Z.measureVisible||null!==Z.editMode),b=a&&Z.saveImageHandlerProvided;a&&!Wb&&(Sh=Z.Utils.createContainerElement("canvas","drawingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(Sh),Wb=Sh,$c=Wb.style);t&&
!tb&&(Th=Z.Utils.createContainerElement("canvas","editingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(Th),tb=Th,oc=tb.style);h&&!Ka&&(Kf=Z.Utils.createContainerElement("div","hotspotDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(Kf),Ka=Kf,jc=Ka.style,Z.Utils.addEventListener(Kf,"mousedown",Z.Utils.preventDefault));b&&!lb&&(Xb=
Z.Utils.createContainerElement("canvas","savingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),hc.appendChild(Xb),lb=Xb,Jb=lb.style,Jb.display="none");Z.useCanvas||(za.innerHTML="",wa.innerHTML="");Ob&&(Ob.innerHTML="");Ka&&(Ka.innerHTML="")}function J(){Z.useCanvas&&(Ga&&(Ib=Ga.getContext("2d")),pe=za.getContext("2d"),kb=wa.getContext("2d"),of=jd.getContext("2d"),Wb&&(kg=Wb.getContext("2d")),tb&&(na=tb.getContext("2d")),sb&&(T=
sb.getContext("2d")),lb&&(ra=lb.getContext("2d")),Z.imageFilters&&(Lf=oe.getContext("2d"),Kb=ne.getContext("2d")))}function oa(h,gh,t,b){if("undefined"===typeof t||null===t)t=0;if("undefined"===typeof b||null===b)b=0;ka=Z.narrative?h-Z.narrativeW:Z.comparison?h/2:h;h=1==Z.toolbarVisible&&Z.toolbarBackgroundVisible?null!==Z.toolbarH?Z.toolbarH:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARHEIGHT"),10):0;ha=Z.viewerH-h;Ig=0;Jg=0==Z.toolbarPosition?h:0;h=1;if(Z.rotationVisible||0!=Z.imageR)h=Math.sqrt(ka*
ka+ha*ha)/((ka+ha)/2);qb=ka*Ng*h;cb=ha*Ng*h;h=Z.imageSet?lg:"unconverted"==Z.tileSource&&Z.mobileDevice?mg:"unconverted"==Z.tileSource&&Z.browser==Z.browsers.FIREFOX?nh:qi;gh=Z.constrainPanStrict?Z.imageW:2*Z.imageW;var rb=Z.constrainPanStrict?Z.imageH:2*Z.imageH;qb>h&&(qb=h);cb>h&&(cb=h);qb>gh&&(qb=gh);cb>rb&&(cb=rb);qb<ka&&(qb=ka);cb<ha&&(cb=ha);ad=Z.Utils.roundToFixed(qb/2,4);Dc=Z.Utils.roundToFixed(cb/2,4);Pc=Z.Utils.roundToFixed(-((qb-ka)/2)+t,4);Z.Utils.roundToFixed((qb-ka)/2+t,4);pc=Z.Utils.roundToFixed(-((cb-
ha)/2)+b,4);Z.Utils.roundToFixed((cb-ha)/2+b,4);Ga&&(Ga.width=ka,Ga.height=ha,Bc.width=ka+"px",Bc.height=ha+"px",Bc.left="0px",Bc.top="0px");if(Z.narrative||Z.comparison)ig.width=ka,ig.height=ha,Lg.width=ka+"px",Lg.height=ha+"px",Lg.left=Z.narrative?Z.narrativeW+"px":0==a?"0px":ka+"px",Lg.top="0px";eb.width=qb;eb.height=cb;L.width=qb+"px";L.height=cb+"px";L.left=Pc+"px";L.top=pc+"px";wa.width=qb;wa.height=cb;hb.width=qb+"px";hb.height=cb+"px";Ob&&(Ob.width=qb,Ob.height=cb,Ye.width=qb+"px",Ye.height=
cb+"px",Ye.zIndex=(Z.baseZIndex+2).toString());sb&&(sb.width=qb,sb.height=cb,Cc.width=qb+"px",Cc.height=cb+"px");Ka&&(Ka.width=qb,Ka.height=cb,jc.width=qb+"px",jc.height=cb+"px",oh&&(t=parseInt(Z.Utils.getResource("z133"),10),t=qe(Vi,t,ka,ha),ph.left=t.x+"px",ph.top=t.y+"px"));Wb&&(Wb.width=qb,Wb.height=cb,$c.width=qb+"px",$c.height=cb+"px");tb&&(tb.width=qb,tb.height=cb,oc.width=qb+"px",oc.height=cb+"px");Mf&&(t=new m.calculateAnnotationPanelDimensions(Nf,rd,pf,qf),b=m.calculateAnnotationPanelCoords(Wi,
t.w,t.h,ka,ha),m.sizeAndPositionAnnotationPanel(Of,t.w,t.h,b.x,b.y));Z.imageSet&&Z.Viewer.sizeAndPositionImageSetList();Z.magnifierVisible&&(m.sizeAndPositionMagnifier(null,null,null,null),Xi&&m.toggleMagnifierMinimize(!1));if(Z.useCanvas){Ga&&(Ib.translate(ka/2,ha/2),Ib.save());try{kb.translate(ad,Dc)}catch(e){Z.Utils.showMessage(Z.Utils.getResource("ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE"),!1,Z.messageDurationStandard,"center")}kb.save();sb&&(T.translate(ad,Dc),T.save());Wb&&(kg.translate(ad,
Dc),kg.save());tb&&(na.translate(ad,Dc),na.save())}}function ga(h,a,t){if("ZoomifyZIFFile"==Z.tileSource){var b=parseFloat(Z.Utils.getResource("z125")),rb=parseFloat(Z.Utils.getResource("z124"));a.loadByteRange(h,b,rb,"loadingZIFFileBytes","header",null,null,t)}else"ZoomifyImageFolder"==Z.tileSource?(h=Z.Utils.cacheProofPath(h+"/ImageProperties.xml"),a.loadXML(h,t,"loadingImagePropertiesXML")):"ZoomifyPFFFile"==Z.tileSource?null===Z.tileHandlerPathFull?(b=parseFloat(Z.Utils.getResource("z125")),rb=
parseFloat(Z.Utils.getResource("z123")),a.loadByteRange(h,b,rb,"loadingPFFFileBytes","header",null,null,t)):(b=Z.Utils.getResource("z125"),rb=Z.Utils.getResource("z123"),h=h.replace(".","%2E"),a.loadXML(Z.tileHandlerPathFull+"?file="+h+"&requestType=1&begin="+b+"&end="+rb,t,"loadingPFFPropertiesServletXML")):"DZIFolder"==Z.tileSource?(h=ca(h,"properties"),a.loadXML(h,t,"loadingDZIPropertiesXML")):"IIIFImageServer"==Z.tileSource&&a.loadJSON(h+"/info.json",t,"loadingIIIFJSON")}function ma(h,a,t,b,rb,
e,f,g,Ma,l,k){"ZoomifyPFFFile"==Z.tileSource&&Z.pffJPEGHeadersSeparate||!isNaN(h)&&0<h&&!isNaN(a)&&0<a&&!isNaN(t)&&0<t&&!isNaN(b)&&0<b&&0<rb?m.getStatus("initializedViewport")?w(h,a,t,b,rb,e,f,g,Ma,l,k):n(h,a,t,b,rb,e,f,g,Ma,l,k):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}function fa(h,a){K();if("undefined"===typeof m.getStatus)window.setTimeout(function(){fa(h,a)},100);else{var t=null,b=null,rb=null,e=null,f=null,g=null,Ma=null,l=null,k=null,r=null,q=null;
"ZoomifyImageFolder"==Z.tileSource?(t=parseInt(h.documentElement.getAttribute("WIDTH"),10),b=parseInt(h.documentElement.getAttribute("HEIGHT"),10),f=parseInt(h.documentElement.getAttribute("NUMTILES"),10),parseInt(h.documentElement.getAttribute("NUMIMAGES"),10),g=parseInt(h.documentElement.getAttribute("VERSION"),10),rb=e=parseInt(h.documentElement.getAttribute("TILESIZE"),10)):"DZIFolder"==Z.tileSource?(g=f=1,t=h.getElementsByTagName("Image")[0],rb=e=parseInt(t.getAttribute("TileSize"),10),parseInt(t.getAttribute("Overlap"),
10),Z.tileType=t.getAttribute("Format"),b=t.getElementsByTagName("Size")[0],t=parseInt(b.getAttribute("Width"),10),b=parseInt(b.getAttribute("Height"),10)):"ZoomifyPFFFile"==Z.tileSource?(t=parseInt(h.documentElement.getAttribute("WIDTH"),10),b=parseInt(h.documentElement.getAttribute("HEIGHT"),10),rb=e=parseInt(h.documentElement.getAttribute("TILESIZE"),10),f=parseInt(h.documentElement.getAttribute("NUMTILES"),10),parseInt(h.documentElement.getAttribute("NUMIMAGES"),10),g=parseInt(h.documentElement.getAttribute("VERSION"),
10),Ma=parseInt(h.documentElement.getAttribute("HEADERSIZE"),10),l=1060+Ma):"IIIFImageServer"==Z.tileSource?(t=parseInt(h.documentElement.getAttribute("WIDTH"),10),b=parseInt(h.documentElement.getAttribute("HEIGHT"),10),f=g=rb=e=null):"ImageServer"==Z.tileSource&&(t=parseInt(h.documentElement.getAttribute("WIDTH"),10),b=parseInt(h.documentElement.getAttribute("HEIGHT"),10),e=h.documentElement.getAttribute("TILESIZE"),rb=Z.Utils.stringValidate(e)?parseInt(e,10):Bb,e=Z.Utils.stringValidate(e)?parseInt(e,
10):Hb,k=h.documentElement.getAttribute("MAGNIFICATION"),k=Z.Utils.stringValidate(k)?parseInt(k,10):Z.sourceMagnification,r=h.documentElement.getAttribute("FOCAL"),r=Z.Utils.stringValidate(r)?parseInt(r,10):Z.focal,q=h.documentElement.getAttribute("QUALITY"),q=Z.Utils.stringValidate(q)?parseInt(q,10):Z.quality);null!==Z.tileW&&(rb=Z.tileW);null!==Z.tileH&&(e=Z.tileH);if("ZoomifyImageFolder"==Z.tileSource||"IIIFImageServer"==Z.tileSource||"ImageServer"==Z.tileSource){if(null===rb||isNaN(rb))rb=Bb;
if(null===e||isNaN(e))e=Hb;if(null===f||isNaN(f))f=1}!isNaN(t)&&0<t&&!isNaN(b)&&0<b&&!isNaN(rb)&&0<rb&&!isNaN(e)&&0<e&&0<f?m.getStatus("initializedViewport")?w(t,b,rb,e,f,g,Ma,l,k,r,q,a):n(t,b,rb,e,f,g,Ma,l,k,r,q,a):"ZoomifyImageFolder"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z252"),!1,Z.messageDurationStandard,"center"):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}}function v(){if("unconverted"==Z.tileSource)Vb[0]=Z.imageW,Nc[0]=Z.imageH,vb[0]=
1,Oc[0]=1,re=Nb=hd[0]=1;else if("ZoomifyZIFFile"==Z.tileSource){for(var h=Nb-1;0<=h;h--)vb[h]=Math.ceil(Vb[h]/Bb),Oc[h]=Math.ceil(Nc[h]/Hb),hd[h]=vb[h]*Oc[h];qh=vb[re]-1;rh=Oc[re]-1}else{for(var a=Z.imageW,t=Z.imageH;a>Bb||t>Hb;)a/=2,t/=2,Nb++;for(var a=Z.imageW,t=Z.imageH,h=0,b=Nb-1;0<=b;b--)Vb[b]=a,Nc[b]=t,vb[b]=Math.ceil(Vb[b]/Bb),Oc[b]=Math.ceil(Nc[b]/Hb),hd[b]=vb[b]*Oc[b],a/=2,t/=2,h+=hd[b];re=Nb-1;qh=vb[re]-1;rh=Oc[re]-1;if("DZIFolder"==Z.tileSource){a=Vb[0];t=Nc[0];for(b=0;1<a||1<t;)a/=2,t/=
2,b++;Z.dziSubfoldersToSkip=b-1}if(h!=Nh&&("ZoomifyImageFolder"==Z.tileSource||"ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)){Vb=[];Nc=[];vb=[];Oc=[];Nb=1;h=Z.imageW;a=Z.imageH;for(t=2;h>Bb||a>Hb;)h=Math.floor(Z.imageW/t),a=Math.floor(Z.imageH/t),t*=2,h%2&&h++,a%2&&a++,Nb++;re=Nb-1;qh=vb[re]-1;rh=Oc[re]-1;h=Z.imageW;a=Z.imageH;t=2;tileCounter=0;for(b=Nb-1;0<=b;b--)vb[b]=Math.floor(h/Bb),h%Bb&&vb[b]++,Oc[b]=Math.floor(a/Hb),a%Hb&&Oc[b]++,hd[b]=vb[b]*Oc[b],tileCounter+=hd[b],Vb[b]=
h,Nc[b]=a,h=Math.floor(Z.imageW/t),a=Math.floor(Z.imageH/t),t*=2,h%2&&h++,a%2&&a++;h=tileCounter;h!=Nh&&Z.Utils.showMessage(Z.Utils.getResource("z254"),!1,Z.messageDurationStandard,"center")}}}function C(h,a){for(var t=vb[h]-1,b=Oc[h]-1,rb=0;rb<=t;rb++)for(var e=0;e<=b;e++)a[a.length]=h+"-"+rb+"-"+e}function u(){Q=!1;fc=0;Sa>cg?(fc=Sa-ri,Q=!0):fc=Sa>Og?Ke:Sa>Pg?Pf:Ze;for(var h=fc.toString(),a=0,t=Pb.length;a<t;a++)Pb[a].substring(0,1)==h&&(vd[vd.length]=Pb[a]);tierBackfillScalePrior=od=la(fc,Z.imageZ);
var h=Vb[fc],a=Nc[fc],t=Z.imageX*Z.imageZ,b=Z.imageY*Z.imageZ;Q?(h=Uh,Le=qb*h,se=cb*h,zd=-(qb/h),Rd=-(cb/h),ng=ad*h,Qg=Dc*h,za.width=Le,za.height=se,Ea.width=za.width+"px",Ea.height=za.height+"px",Ea.left=zd+"px",Ea.top=Rd+"px",Z.useCanvas&&(Ga&&(Lc=la(H,Z.imageZ),Ib.restore(),Ib.save(),Ib.scale(Lc,Lc),0!=Z.imageR&&Ib.rotate(Z.imageR*Math.PI/180)),pe.restore(),pe.translate(ng,Qg),pe.save(),pe.scale(od,od))):(Le=h*od,se=a*od,zd=ad-t,Rd=Dc-b,za.width=h,za.height=a,Z.useCanvas&&(Ea.width=Le+"px",Ea.height=
se+"px"),Ea.left=zd+"px",Ea.top=Rd+"px")}function D(h){if(h){h=m.z542(fc);Z.Utils.arrayClear(Pb);Z.Utils.arrayClear(vd);a=h.l;for(t=h.r;a<=t;a++)for(b=h.t,rb=h.b;b<=rb;b++)e=fc+"-"+a+"-"+b,vd[vd.length]=e,Pb[Pb.length]=e;xa(Pb,ya,"simple","image-backfill");qd=va.length;m.traceDebugValues("tilesBackfillToDisplay",null,vd.length,vd);m.traceDebugValues("tilesBackfillInCache",null,Pb.length,Pb)}else{Z.Utils.arrayClear(Ge);Z.Utils.arrayClear(He);Z.Utils.arrayClear(ke);Z.Utils.arrayClear(va);h=m.z542();
for(var a=h.l,t=h.r;a<=t;a++)for(var b=h.t,rb=h.b;b<=rb;b++){var e=Sa+"-"+a+"-"+b;Ge[Ge.length]=e;va[va.length]=e}if(m.getStatus("initializedViewport")&&0<uc.length&&(Sa==Ze||Sa==Pf||Sa==Ke))for(a=0,t=uc.length;a<t;a++)(b=uc[a])&&b.t==Sa&&b.c>=h.l&&b.c<=h.r&&b.r>=h.t&&b.r<=h.b&&(ke[ke.length]=b.name,He[He.length]=b,rb=Z.Utils.arrayIndexOf(va,b.name),-1!=rb&&(va=Z.Utils.arraySplice(va,rb,1)));a=0;for(t=gd.length;a<t;a++)(b=gd[a])&&b.t==Sa&&b.c>=h.l&&b.c<=h.r&&b.r>=h.t&&b.r<=h.b&&(rb=Z.Utils.arrayIndexOf(ke,
b.name),-1==rb&&(ke[ke.length]=b.name,He[He.length]=b),b=Z.Utils.arrayIndexOf(va,b.name),-1!=b&&(va=Z.Utils.arraySplice(va,b,1)));if(0!=Se){a=0;for(t=wd.length;a<t;a++)b=wd[a],b.alpha=1;Z.Utils.arrayClear(wd);Z.Utils.arrayClear(le)}qd=va.length;m.traceDebugValues("tilesToDisplay",null,Ge.length,Ge);m.traceDebugValues("tilesInCache",null,ke.length,ke);m.traceDebugValues("tilesToLoad",null,va.length,va)}}function R(h,a,t,b,e,p){e||Z.Utils.clearDisplay(h);if("canvasCopy"==b)Z.Utils.clearDisplay(wa),
kb.restore(),kb.save(),kb.scale(1,1),kb.drawImage(jd,-ad,-Dc),kb.restore(),kb.save(),kb.scale(Ia,Ia);else{e=m.z542(a);p=[];if(null===t)for(var f=0,g=He.length;f<g;f++)p[f]=He[f];else if(0<t.length)for(f=0,g=t.length;f<g;f++){var Ma=t[f];Ma&&Ma.t==a&&(a==fc&&!Q||Ma.c>=e.l&&Ma.c<=e.r&&Ma.r>=e.t&&Ma.r<=e.b)&&(p[p.length]=t[f])}if(0<p.length)if(m.traceDebugValues("z622-"+h.id,null,null,p),"centerOut"==b)for(f=Math.floor(p.length/2),g=p.length;f<g;f++)Va(h,a,p[f]),p.length-f-1!=f&&Va(h,a,p[p.length-f-
1]);else for(f=0,g=p.length;f<g;f++)Va(h,a,p[f]);else m.traceDebugValues("No cached tiles in view");m.traceDebugValues("blankLine")}}function N(h,a){var t=m.z542();syncTransitionCanvas();for(var b=0,e=a.length;b<e;b++){var p=a[b];p&&p.t==h&&(h==fc||p.c>=t.l&&p.c<=t.r&&p.r>=t.t&&p.r<=t.b)&&Va(jd,h,p)}}function ja(h){Wa=null;Wa=new Image;Wa.onload=da;Wa.onerror=S;Wa.src=h}function da(){if("undefined"!==typeof Wa){var h=Z.Utils.createContainerElement("div","testImageContainer","inline-block","absolute",
"hidden",ka+"px",ha+"px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);h.appendChild(Wa);h.removeChild(Wa);var h=null,h=Wa.width,a=Wa.height;0!=h&&0!=a?n(h,a,h,a,null,null,null,null,null,null,null):window.setTimeout(function(){da()},100)}else window.setTimeout(function(){da()},100)}function S(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNCONVERTEDIMAGEPATHINVALID"))}function xa(h,a,t,b){var e="undefined"!==typeof b&&null!==b?"-"+b:"";if(0<h.length){m.traceDebugValues("z577"+
e,null,null,h);e=(new Date).getTime();if("centerOut"==t&&4<h.length){var p=[],f=0,g=0,Ma=0,l=0;for(t=0;t<h.length;t++){var k=h[t];k&&(k=new La(k,b),p[p.length]=k,0==t?(f=g=k.c,Ma=l=k.r):(k.c<f?f=k.c:k.c>g&&(g=k.c),k.r<Ma?Ma=k.r:k.r>l&&(l=k.r)))}h=f+(g-f)/2;b=Ma+(l-Ma)/2;for(t=0;t<p.length;t++)p[t].r-=b,p[t].c-=h;p.sort(function(h,a){return h.r*h.r+h.c*h.c-(a.r*a.r+a.c*a.c)});for(t=0;t<p.length;t++)p[t].r+=b,p[t].c+=h,qa(p[t],e,a)}else for(t=0,p=h.length;t<p;t++)if(k=h[t])k=new La(k,b),qa(k,e,a);m.traceDebugValues("blankLine")}else m.traceDebugValues("z577"+
e,"No new tiles requested")}function La(h,a){this.imagePath=Z.imagePath;this.name=h;var t=new pa(h);this.t=t.t;this.c=t.c;this.r=t.r;this.x=Math.floor(this.c*Bb);this.y=Math.floor(this.r*Hb);this.image=null;this.alpha=0;this.url=m.formatTilePath(this.t,this.c,this.r,a);this.style=this.elmt=this.loadTime=null}function pa(h){this.t=parseInt(h.substring(0,h.indexOf("-")),10);this.c=parseInt(h.substring(h.indexOf("-")+1,h.lastIndexOf("-")),10);this.r=parseInt(h.substring(h.lastIndexOf("-")+1),10)}function Ha(h,
a,t){t=a+t*vb[h];a=8*t+If[h];t=Math.floor(t/Qc);var b=t*Qc,b=b+Qc>hd[h]?8*(hd[h]-b):tk;this.chunkStart=If[h]+t*tk;this.chunkEnd=this.chunkStart+b;this.offsetStartInChunk=a-this.chunkStart;this.chunkID=h.toString()+"-"+t.toString()}function F(h,a,t){t=a+t*vb[h];a=4*t+Jf[h];t=Math.floor(t/Qc);var b=t*Qc,b=b+Qc>hd[h]?4*(hd[h]-b):uk;this.chunkStart=Jf[h]+t*uk;this.chunkEnd=this.chunkStart+b;this.bcStartInChunk=a-this.chunkStart;this.chunkID=h.toString()+"-"+t.toString()}function ca(h,a,t,b,e){"tile"==
h?(h=(parseInt(a,10)+Z.dziSubfoldersToSkip+1).toString(),t=Z.imagePath+"/"+Z.dziImageSubfolder+"/"+h+"/"+t+"_"+b+"."+Z.tileType):t=Z.imagePath+"/"+Z.dziImagePropertiesFilename;if(Z.browser==Z.browsers.IE&&9>Z.browserVersion||0==te)t=Z.Utils.cacheProofPath(t);return t}function V(h,a,t){var b=m.getViewportID();Oh[h]=t;var e=new Z.NetConnector;null===Z.tileHandlerPathFull?e.loadByteRange(Z.imagePath,h,a,"loadingPFFFileBytes","offset",null,t,b):(t=kd.replace(".","%2E"),e.loadXML(Z.tileHandlerPathFull+
"?filePath="+t+"&requestType=2&begin="+h+"&end="+a,"loadingPFFChunkServletXML"))}function bb(h,a){for(var t=0,b=Cb.length;t<b;t++){var e=Cb[t].split(",");e[0]==h&&e[5]==a&&("undefined"!==typeof e[4]&&("image-display"==e[4]?xd[xd.length]=e[1]+"-"+e[2]+"-"+e[3]:"image-backfill"==e[4]?yd[yd.length]=e[1]+"-"+e[2]+"-"+e[3]:"image-magnifier"==e[4]&&(Je[Je.length]=e[1]+"-"+e[2]+"-"+e[3])),Cb=Z.Utils.arraySplice(Cb,t,1),t--,b--)}0<xd.length&&(xd.sort(),xd=Z.Utils.arrayUnique(xd),m.traceDebugValues("selectTilesRetry",
xd),t=m.getStatus("imageSaving")?wb:Ua,Ab(xd,t,"simple","image-display"));0<yd.length&&(yd.sort(),yd=Z.Utils.arrayUnique(yd),t=m.getStatus("imageSaving")?fb:ya,Ab(yd,t,"simple","image-backfill"));Je&&0<Je.length&&(Je.sort(),Je=Z.Utils.arrayUnique(Je),t=qc,Ab(Je,t,"simple","image-magnifier"))}function Ab(h,a,t,b){t=(new Date).getTime();for(var e=0,p=h.length;e<p;e++){var f=null;if(f=h[e])h=Z.Utils.arraySplice(h,e,1),e--,p--,index=Z.Utils.arrayIndexOfObjectValue(Ie,"name",f),-1!=index?(f=Ie[index],
Ie=Z.Utils.arraySplice(Ie,index,1),f.url=m.formatTilePath(f.t,f.c,f.r,b)):f=new La(f,b),null!=f&&-1==f.url.indexOf("NaN")?(m.traceDebugValues("z577Retry",f.name+"  "+f.url),qa(f,t,a)):-1==f.url.indexOf("NaN")&&Z.Utils.showMessage(Z.Utils.getResource("z280-ZIF")+f.name+".jpg",!1,Z.messageDurationShort,"center",!1)}}function qa(h,a,t){var b=h.name;if("z647"==h.url.substr(0,8)){bd(h);t=h.name;var e=Z.Utils.arrayIndexOf(va,t);-1!=e&&(va=Z.Utils.arraySplice(va,e,1));if("ZoomifyZIFFile"==Z.tileSource||
"ZoomifyPFFFile"==Z.tileSource)e=Z.Utils.arrayIndexOf(xd,t),-1!=e&&(xd=Z.Utils.arraySplice(xd,e,1));wd[wd.length]=h;le[le.length]=t}else if("offsetLoading"==h.url)-1==Z.Utils.arrayIndexOfObjectValue(Ie,"name",b)&&(Ie[Ie.length]=h),m.traceDebugValues("z581DelayForOffset",b);else if("offsetLoading"!=h.url){t==Ua||Z.enterpriseParamsEnabled&&t==wb?e="image-display":t==ya||t==fb?e="image-backfill":t==qc&&(e="image-magnifier");var p=h.t==Ze&&ih||h.t==Pf&&hh||h.t==Ke&&gg;"image-display"==e&&p||(h.loadTime=
a,m.traceDebugValues("z581-"+e,b),a=m.getViewportID(),sh.loadImage(h.url,Z.Utils.createCallback(null,t,h),"loadingImageTile",e,h,a))}}function Ua(h,a){if(h&&a&&h.imagePath==Z.imagePath){h.image=a;var t=h.name,b=Z.Utils.arrayIndexOf(va,t);if(-1!=b){va=Z.Utils.arraySplice(va,b,1);bd(h);if(Z.preloadVisible&&!Z.imageSet&&h.t!=Sa){Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADING-STORINGORDRAWINGTILES")+"   Tile: "+t,!1,Z.messageDurationShort/10,"center");h.alpha=1;return}-1==Z.Utils.arrayIndexOf(le,
t)&&(le[le.length]=t,wd[wd.length]=h);Z.preloadVisible&&Z.imageSet&&m.getViewportID()!=Z.viewportCurrentID&&(t=(m.getViewportID()+1).toString()+" of "+Z.imageSetLength.toString()+"   Tile: "+t,Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADING-STORINGORDRAWINGTILES")+t,!1,Z.messageDurationShort/10,"center"));og||(og=window.setInterval(Ra,50));Se=va.length;0==Se&&(Z.useCanvas&&0<te&&(th?(N(Sa,gd),R(wa,Sa,gd,"canvasCopy",!1,"4. Updating view: all new tiles loaded"),window.setTimeout(function(){Z.Utils.clearDisplay(jd)},
200),th=!1):R(wa,Sa,gd,"centerOut",!1,"4. Updating view: all new tiles loaded")),Z.imageFilters&&(m.cacheCanvasImage(),uh&&m.applyImageFilter(null,null,"canvas")),Qb(),qd=0);m.traceDebugValues("onTileLoad",h.name,h.loadTime);m.updateProgress(qd,Se)}Rg==Qf+$e&&m.setStatus("displayLoadedViewport",!0)}else"undefined"!==typeof a&&null!==a||console.log(Z.Utils.getResource("z280")+h.name+".jpg")}function ya(h,a){if(h&&a&&h.imagePath==Z.imagePath){h.image=a;var t=h.name;uc[uc.length]=h;var b=Z.Utils.arrayIndexOf(Pb,
t);-1!=b&&(Pb=Z.Utils.arraySplice(Pb,b,1));if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)t=Z.Utils.arrayIndexOf(yd,t),-1!=t&&(yd=Z.Utils.arraySplice(yd,t,1));h.alpha=1;h.t==fc&&Va(za,fc,h);m.traceDebugValues("onTileBackfillPrecache",h.name);Vh==Gf&&(m.setStatus("precacheLoadedViewport",!0),0<Z.navigatorVisible&&Z.Utils.validateCallback(Z.comparison&&0!=Ja?"navigator2TileLoaded":"navigatorTileLoaded"));m.traceDebugValues("onTileLoadBackfill",h.name);vh<=0+wh&&m.setStatus("backfillLoadedViewport",
!0);h.t==Sa&&Ua(h,a)}else if("undefined"===typeof a||null===a)Z.mobileDevice?console.log(Z.Utils.getResource("z280")+h.name+".jpg"):Z.Utils.showMessage(Z.Utils.getResource("z280")+h.name+".jpg")}function Ra(){for(var h=0,a=0,t=wd.length;a<t;a++){var b=wd[a];b.t==Sa?(Z.fadeIn&&0!=Wh&&1>b.alpha+Wh?b.alpha+=Wh:(b.alpha=1,h++),Va(wa,Sa,b),h>=t&&(window.clearInterval(og),og=null,a=t)):(wd=Z.Utils.arraySplice(wd,a,1),le=Z.Utils.arraySplice(le,a,1),b=Z.Utils.arrayIndexOf(va,b.name),-1!=b&&(va=Z.Utils.arraySplice(va,
b,1)),t--)}}function Va(h,a,t){if("z647"!=t.url.substr(0,8)&&0!=t.image.width&&0!=t.image.height){var b=t.x,e=t.y;a=Aa(a,1);Lc=la(H,m.getZoom());var p=8<Lc;Z.useCanvas?(h==wa||h==jd||h==za&&Q?(b-=Z.imageX*a,e-=Z.imageY*a):h==Ga&&(Q||p)&&(p=m.calculateCurrentCenterCoordinates(),b-=p.x*a,e-=p.y*a),jb(h,t,b,e)):(h==wa?(b-=Z.imageX*a-ad/Ia,e-=Z.imageY*a-Dc/Ia,a=Ia):a=od,t.elmt||(t.elmt=Z.Utils.createContainerElement("img"),t.elmt.onmousedown=Z.Utils.preventDefault,Z.Utils.addEventListener(t.elmt,"contextmenu",
Z.Utils.preventDefault),t.elmt.src=t.url,t.style=t.elmt.style,t.style.position="absolute",Z.Utils.renderQuality(t,Z.renderQuality),Z.cssTransformsSupported&&(t.style[Z.cssTransformProperty+"Origin"]="0px 0px")),t.elmt.parentNode!=h&&h.appendChild(t.elmt),p=t.style,p.display="none",Z.cssTransformsSupported?p[Z.cssTransformProperty]=["matrix(",(t.image.width/t.elmt.width*a).toFixed(8),",0,0,",(t.image.height/t.elmt.height*a).toFixed(8),",",(b*a).toFixed(8),Z.cssTransformNoUnits?",":"px,",(e*a).toFixed(8),
Z.cssTransformNoUnits?")":"px)"].join(""):(p.width=t.image.width*a+"px",p.height=t.image.height*a+"px",p.left=b*a+"px",p.top=e*a+"px"),p.display="inline-block",Z.Utils.setOpacity(t,t.alpha),2!=Z.debug&&4!=Z.debug||Lb(h,t.name,b,e,a));h==wa?(m.traceDebugValues("z507",t.name),Rg==rf&&m.setStatus("displayDrawnViewport",!0)):(m.traceDebugValues("z507Backfill",t.name),vh<=pg&&m.setStatus("backfillDrawnViewport",!0))}}function jb(h,a,t,b){var e=h.getContext("2d");Z.alphaSupported&&1>a.alpha&&"transitionCanvas"!=
h.id&&-1==h.id.indexOf("oversizeDisplay")&&"savingDisplay"!=h.id&&!uh&&(e.globalAlpha=a.alpha);if(Z.imageFilters&&0!=Xa.length)if(uh)-1!=h.id.indexOf("oversizeDisplay")?e=Ib:-1!=h.id.indexOf("viewportDisplay")?e=Lf:-1!=h.id.indexOf("viewportBackfillDisplay")?e=Kb:-1!=h.id.indexOf("transitionCanvas")?e=Lf:"savingDisplay"==h.id&&(e=ra),e.drawImage(a.image,t,b);else{var p;p=a.name;var f=Z.Utils.getImageData(a.image);p=ue(p,f);Z.Utils.clearDisplay(jd);of.putImageData(p,0,0);e.drawImage(jd,t,b)}else e.drawImage(a.image,
t,b);Z.alphaSupported&&1>a.alpha&&"transitionCanvas"!=h.id&&-1==h.id.indexOf("oversizeDisplay")&&"savingDisplay"!=h.id&&!uh&&(e.globalAlpha=1);2!=Z.debug&&4!=Z.debug||Lb(h,a.name,t,b,Ia)}function Lb(h,a,t,b,e){if(Z.useCanvas){var p=parseInt(Z.Utils.getResource("z129"),10),f=parseInt(Z.Utils.getResource("z160"),10),g=parseInt(Z.Utils.getResource("z151"),10),p=Math.round(p*e),f=2*(p<f?f:p>g?g:p);h=h.getContext("2d");h.font=f+"px verdana";h.textAlign="left";h.textBaseline="top";f=Bb*e/2;e=Hb*e/2;h.fillStyle=
"#FFFFFF";h.fillText(a,t+f,b+e);h.fillStyle="#000000";h.fillText(a,t+f+1,b+e+1)}else{var p=parseInt(Z.Utils.getResource("z129"),10),f=parseInt(Z.Utils.getResource("z160"),10),g=parseInt(Z.Utils.getResource("z151"),10),p=Math.round(p*e),m=2*(p<f?f:p>g?g:p),f=parseInt(Z.Utils.getResource("z130"),10)*e,g=Z.Utils.createContainerElement("div","tileNameTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent","0px",f+"px","nowrap"),p=document.createTextNode(a);g.appendChild(p);
h.appendChild(g);Z.Utils.setTextNodeStyle(p,"white","verdana",m+"px","none","normal","normal","normal","normal","1em","center","none");var k=Z.Utils.createContainerElement("div","tileNameTextBox2","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent","0px",f+"px","nowrap"),l=document.createTextNode(a);k.appendChild(l);h.appendChild(k);Z.Utils.setTextNodeStyle(l,"black","verdana",m+"px","none","normal","normal","normal","normal","1em","center","none");f=parseFloat(g.style.padding);
h=parseFloat(Z.Utils.getElementStyleProperty(g,"width"));isNaN(h)&&(h=parseFloat(Z.Utils.getResource("z115")),h=parseFloat(g.style.fontSize)/h,h=Math.round(parseFloat(a.length*h)));a=Bb*e/2;m=Hb*e/2;g.style.left=t*e+(a-h/2-f)+"px";g.style.top=b*e+m+"px";k.style.left=1+t*e+(a-h/2-f)+"px";k.style.top=1+b*e+m+"px";Z.Utils.addEventListener(g,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(p);Z.Utils.addEventListener(k,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(l)}}
function P(h,a){var t=Aa(a,1),b=Math.floor(h.l*t/Bb),e=Math.floor(h.r*t/Bb),f=Math.floor(h.t*t/Hb),t=Math.floor(h.b*t/Hb);0>b&&(b=0);e>vb[a]-1&&(e=vb[a]-1);0>f&&(f=0);t>Oc[a]-1&&(t=Oc[a]-1);this.l=b;this.r=e;this.t=f;this.b=t}function ta(h,a,t,b,e,f,Yd,g,m){"undefined"===typeof g||null===g?(this.l=h+t/Yd,this.r=h+b/Yd,this.t=a+e/Yd,this.b=a+f/Yd):(Yd=ka/Vb[g],g=ha/Nc[g],this.l=h+t*Yd,this.r=h+b*Yd,this.t=a+e*g,this.b=a+f*g);m&&(this.l-=256-this.l%256,this.r+=256-this.r%256,this.t-=256-this.t%256,
this.b+=256-this.b%256)}function Aa(h,a){return Vb[h]/Z.imageW*a}function la(h,a){return a/(Vb[h]/Z.imageW)}function Fa(h,a,t,b,e){if(Z.constrainPan&&0==b){t="undefined"!==typeof t&&null!==t?t:Z.imageZ;b="undefined"!==typeof b&&null!==b?Math.round(b):Math.round(Z.imageR);0>b&&(b+=360);var f=h,Yd=a;"image"==e&&(a=m.convertImageCoordsToViewportEdgeCoords(h,a,t,b),h=a.x,a=a.y);var g=Z.imageW,Ma=Z.imageH,k=Math.round(g*t),l=Math.round(Ma*t);Math.round(g*t/2);Math.round(Ma*t/2);var g=ka,Ma=ha,r=Math.round(.1*
ka),q=Math.round(.1*ha),u=Math.round(.5*ka),U=Math.round(.5*ha),v,n;v=u-Pc+(Z.imageCtrX-Z.imageX)*t+h;n=U-pc+(Z.imageCtrY-Z.imageY)*t+a;var O=v+k/2,Da=n-l/2,D=v+k/2,Ub=n+l/2,C=v-k/2,A=n+l/2,P=Z.Utils.getPositionRotated(v-k/2,n-l/2,v,n,b),O=Z.Utils.getPositionRotated(O,Da,v,n,b),D=Z.Utils.getPositionRotated(D,Ub,v,n,b),A=Z.Utils.getPositionRotated(C,A,v,n,b);v=Math.min(P.x,O.x,D.x,A.x);n=Math.min(P.y,O.y,D.y,A.y);C=Math.max(P.x,O.x,D.x,A.x);P=Math.max(P.y,O.y,D.y,A.y);C-v>g||!Z.constrainPanStrict?
3==Z.constrainPanLimit?h=0<v?h-v:C<g?h-(C-g):h:2==Z.constrainPanLimit?h=v>u?h-(v-u):C<u?h-(C-u):h:1==Z.constrainPanLimit&&(h=v>9*r?h-(v-9*r):C<r?h-(C-r):h):h=v>u-k/2?h-(v-(u-k/2)):C<u+k/2?h-(C-(u+k/2)):h;P-n>Ma||!Z.constrainPanStrict?3==Z.constrainPanLimit?a=0<n?a-n:P<Ma?a-(P-Ma):a:2==Z.constrainPanLimit?a=n>U?a-(n-U):P<U?a-(P-U):a:1==Z.constrainPanLimit&&(a=n>9*q?a-(n-9*q):P<q?a-(P-q):a):a=n>U-l/2?a-(n-(U-l/2)):P<U+l/2?a-(P-(U+l/2)):a;"image"==e&&(a=m.convertViewportEdgeCoordsToImageCoords(h,a,t,
b),h=a.x,a=a.y);if(h!=f||a!=Yd)h=Math.round(h),a=Math.round(a),Z.Utils.validateCallback("panConstrained")}return new Z.Utils.Point(h,a)}function Na(h){h>Z.maxZ?(h=Z.maxZ,Z.Utils.validateCallback("zoomConstrainedMax")):h<Z.minZ&&(h=Z.minZ,Z.Utils.validateCallback("zoomConstrainedMin"));return h}function Qa(h){Z.rotationFree||(h=90*Math.round(Math.abs(h)/90)*Z.Utils.getSign(h));-360>=h?h+=360:360<=h&&(h-=360);return h}function xb(){Z.comparison&&0!=Ja?Z.Navigator2&&Z.Navigator2.syncToViewport():Z.Navigator&&
Z.Navigator.syncToViewport()}function Qb(h){if(h)for(;af.length>te;)af=Z.Utils.arraySplice(af,0,1);else for(;Hd.length>te&&gd.length>te;)Hd=Z.Utils.arraySplice(Hd,0,1),gd=Z.Utils.arraySplice(gd,0,1)}function bd(h){if(0<te){var a=Z.Utils.arrayIndexOf(Hd,h.name);-1!=a&&(Hd=Z.Utils.arraySplice(Hd,a,1),gd=Z.Utils.arraySplice(gd,a,1));Hd[Hd.length]=h.name;gd[gd.length]=h}}function Yb(){window.clearTimeout(Rf);Rf=null;sf=((new Date).getTime()-tilesTimeStart)/1E3;var h=Sf*sf,h=bf&&$e<h,a=bf&&$e>=qg;if(2==
Z.debug||3==Z.debug)Z.Utils.trace("View validation-time elapsed: "+sf),0<bf&&(h?Z.Utils.trace("Loading delay - re-calling updateView"):a?Z.Utils.trace("Display delay - re-calling updateView"):Z.Utils.trace("Progress slow, resetting timer")),Z.Utils.trace(""),Z.traces.scrollTop=Z.traces.scrollHeight,Z.Utils.traceTileSpeed(sf,Sf);0<bf?Tf<si?h||a?(Tf+=1,m.updateView(!0)):Rf=window.setTimeout(Yb,Xh):console.log(Z.Utils.getResource("ERROR_VALIDATEVIEW")):(Tf=0,Z.Utils.validateCallback("viewUpdateComplete"),
Z.Utils.validateCallback("viewUpdateCompleteGetLabelIDs"))}function Zc(){Sg=new Image;vk=parseFloat(Z.Utils.getResource("z234"));Sg.url=Z.watermarkPath;Sg.onload=kc;Sg.onerror=bc;Sg.src=Z.watermarkPath}function kc(){if(Ob)for(var h=parseFloat(Z.Utils.getResource("z235")),a=parseFloat(Z.Utils.getResource("z237")),t=parseFloat(Z.Utils.getResource("z236")),b=m.getZoom(),e=(Z.imageW*b-Ob.width)/2,f=(Z.imageH*b-Ob.height)/2,Yd=(Z.imageW/2-Z.imageX)*b,g=(Z.imageH/2-Z.imageY)*b,Ma=b<h?h:b,a=Math.round(Z.imageW/
a),t=Math.round(Z.imageH/t),h=m.z541(),k=Sg.width*Ma,Ma=Sg.height*Ma,l=0,r=0,q=1;q<=a;q++)for(var u=1;u<=t;u++){var v=Math.round(Z.imageW/(a+1)*q),U=Math.round(Z.imageH/(t+1)*u);if(v>h.l&&v<h.r&&U>h.t&&U<h.b){var n=Math.round(v*b-k/2-e+Yd),O=Math.round(U*b-Ma/2-f+g);if(4E3<Z.imageW){U=r+100;if(n<l+100&&O<U)continue;l=n;r=O}var U=k,v=Ma,D=O,O=Sg.cloneNode(!1);Z.Utils.setOpacity(O,vk);O.width=U;O.height=v;U=Z.Utils.createContainerElement("div","wiC","inline-block","absolute","hidden",U+"px",v+"px",
n+"px",D+"px","none","0px","transparent","0px","0px","normal");U.appendChild(O);Ob.appendChild(U);Z.Utils.addEventListener(O,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(O,"mousedown",Z.Utils.preventDefault)}}}function bc(){Z.Utils.showMessage(Z.Utils.getResource("z292")+this.url)}function ib(h){if(lb&&Jb&&ra){var a=new m.HotspotsAllBoundingBoxInPixels,t=Math.min(a.l,0),b=Math.min(a.t,0),e=Math.max(Z.imageW,a.r),a=Math.max(Z.imageH,a.b),f=2*parseInt(Z.Utils.getResource("DEFAULT_SAVEIMAGELABELMARGIN"),
10);if(0>t||0>b||e>Z.imageW||a>Z.imageH)t-=0>t?0:f,b-=0>b?0:f,e+=e>Z.imageW?0:f,a+=a>Z.imageH?0:f;var Yd,g;if(h){var f=h?1:m.getZoom(),Ma=e-t,k=a-b;h=Ma*f;f*=k;Yd=h+"px";g=f+"px";b=a-Z.imageH+b;t=parseInt(Ma/2-(e-Z.imageW+t)/2,10);e=parseInt(k/2-b/2,10)}else h=ka,f=ha,Yd=ka+"px",g=ha+"px",t=ka/2,e=ha/2;lb.width=h;lb.height=f;Jb.width=Yd;Jb.height=g;ra.restore();ra.save();ra.translate(t,e);Z.Utils.colorCanvas(lb,Z.saveImageBackColor)}}function gb(h){Z.setCallback("loadingTilesFullImageComplete",function(){Db(h)});
Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVELOADINGDATA"),!1,"none","center");B()}function B(){for(var h=Nb-1;1E4<Vb[h]||1E4<Vb[h];)h--;var a=h>Og?Ke:h>Pg?Pf:Ze;G();C(a,Te);for(var a=0,t=Te.length;a<t;a++)va[va.length]=Te[a];C(h,Ve);a=0;for(t=Ve.length;a<t;a++)va[va.length]=Ve[a];qd=va.length;xa(Te,fb,"simple","image-backfill");xa(Ve,wb,"simple","image-display")}function fb(h,a){wb(h,a,!0)}function wb(h,a,t){h&&a?(h.image=a,a=Z.Utils.arrayIndexOf(va,h.name),va=Z.Utils.arraySplice(va,a,
1),t?(Te[Te.length]=h.name,Hf[Hf.length]=h):(Ve[Ve.length]=h.name,Ue[Ue.length]=h),Se=va.length,0==Se&&(qd=0),m.traceDebugValues("onTileLoad",h.name,h.loadTime),m.updateProgress(qd,Se),Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVERECEIVINGTILE")+h.name,!1,"none","center"),0==qd&&Z.Utils.validateCallback("loadingTilesFullImageComplete")):"undefined"!==typeof a&&null!==a||console.log(Z.Utils.getResource("z280")+h.name+".jpg")}function Db(h){if(ra)if(h)if("unconverted"!=Z.tileSource){for(var a=
Nb-1;1E4<Vb[a]||1E4<Vb[a];)a--;var t=a>Og?Ke:a>Pg?Pf:Ze;ra.save();var b=la(t,1);ra.scale(b,b);b=-Vb[t]/2;t=-Nc[t]/2;ra.translate(b,t);b=0;for(t=Hf.length;b<t;b++){var e=Hf[b];Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVEDRAWINGTILE")+e.name,!1,"none","center");jb(lb,e,e.x,e.y)}ra.restore();ra.save();b=la(a,1);ra.scale(b,b);b=-Vb[a]/2;t=-Nc[a]/2;ra.translate(b,t);b=0;for(t=Ue.length;b<t;b++)e=Ue[b],Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVEDRAWINGTILE")+e.name,!1,"none","center"),
jb(lb,e,e.x,e.y);ra.restore()}else ra.drawImage(Wa,-Wa.width/2,-Wa.height/2);else ra.save(),ra.scale(od,od),a=Aa(fc,1),b=-(Z.imageX-Z.imageW/2)*a,t=-(Z.imageY-Z.imageH/2)*a,ra.translate(b,t),Q?ra.drawImage(Ga,-Ga.width/2,-Ga.height/2,Ga.width,Ga.height):ra.drawImage(za,-za.width/2,-za.height/2,za.width,za.height),ra.restore(),ra.save(),ra.drawImage(wa,-wa.width/2,-wa.height/2,wa.width,wa.height),ra.restore();h&&(a=1/m.getZoom(),ra.scale(a,a));xh=0;if(Ka&&jc&&"inline-block"==jc.display&&0<A.length)for(a=
new yb,b=0,t=A.length;b<t;b++){Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVEDRAWINGANNOTATION")+A[b].name,!1,"none","center");var e=A[b],f=e.media,g=e.mediaType,Qi=!1,Ma=!1;Z.Utils.stringValidate(f)&&(Qi=-1!=f.indexOf("/circle.")||-1!=f.indexOf("/square.")||-1!=f.indexOf("/triangle.")||-1!=f.indexOf("/arrowDownLeft.")||-1!=f.indexOf("/arrowDownRight.")||-1!=f.indexOf("/arrowUpLeft.")||-1!=f.indexOf("/arrowUpRight.")||-1!=f.indexOf("/arrowUp.")||-1!=f.indexOf("/arrowDown.")||-1!=f.indexOf("/arrowLeft.")||
-1!=f.indexOf("/arrowRight.")||-1!=f.indexOf("/lineHorizontal.")||-1!=f.indexOf("/lineVertical."),Ma="fov"==f||"arrow"==f||"line"==f||"square"==f||"rectangle"==f||"circle"==f||"ellipse"==f||"triangle"==f||"polygon"==f||"counter"==f||"polyLine"==f);Qi=("counter"==g||"shape"==g)&&(!f||"External Graphics File"!=f)&&(Ma||Qi&&Z.labelShapesInternal);f=f&&"polygon"==f;"fieldofview"==g&&null!==Z.editMode?Yh(e,a):Qi?Me(e,a,null,null,!0,h):f?cf(e,null,null,null,!0,h,b):$a(e,null,null,null,!0,h,b)}else Z.Utils.validateCallback("drawLabelsOnCanvasComplete")}
function $a(h,a,t,b,e,f,g){if(h.visibility&&(Z.Utils.stringValidate(h.media)||"text"==h.mediaType)){var m=new yb;t="polygon"!=h.media?h.z/100:1;targetCtx=ra;if("text"==h.mediaType){targetCtx.save();b=f?Z.imageW/2:Z.imageX;g=f?Z.imageH/2:Z.imageY;hCaption=Ec(h,m);Ka.appendChild(hCaption);var Ma=new Fc(hCaption,t,!0);Ka.removeChild(hCaption);targetCtx.translate((h.x-Ma.w/2/t-b)*Z.imageZ,(h.y-Ma.h/2/t-g)*Z.imageZ);ia(h,m,a,null,null,!0);targetCtx.restore();e&&sd()}else{var k=document.createElement("img");
k.src=h.media;k.onload=function(){targetCtx.save();var t=m.currentZ/(h.z/100)/(Ia/pd);"shape"!=h.mediaType&&"polygon"!=h.mediaType&&(0<m.constrainedScaleMin&&t<m.constrainedScaleMin&&(t=m.constrainedScaleMin),0<m.constrainedScaleMax&&t>m.constrainedScaleMax&&(t=m.constrainedScaleMax));targetCtx.translate((h.x-(f?Z.imageW/2:Z.imageX))*Z.imageZ-k.width/2*t,(h.y-(f?Z.imageH/2:Z.imageY))*Z.imageZ-k.height/2*t);targetCtx.save();var b=h.xScale/100*t,t=h.yScale/100*t;1!=b&&1!=t&&targetCtx.scale(b,t);b=this.rotation;
"undefined"!==typeof b&&null!==b&&0!=b&&targetCtx.rotate(b*Math.PI/180);targetCtx.drawImage(k,0,0);targetCtx.restore();ia(h,m,a,null,null,!0);targetCtx.restore();e&&sd()}}}}function ia(h,a,t,b,e,f,g){if(Z.Utils.stringValidate(h.caption)||Z.Utils.stringValidate(h.captionHTML)||"measure"==h.mediaType){b=h.media;var m=!1;Z.Utils.stringValidate(b)&&(m=-1!=b.indexOf("/circle.")||-1!=b.indexOf("/square.")||-1!=b.indexOf("/triangle.")||-1!=b.indexOf("/arrowDownLeft.")||-1!=b.indexOf("/arrowDownRight.")||
-1!=b.indexOf("/arrowUpLeft.")||-1!=b.indexOf("/arrowUpRight.")||-1!=b.indexOf("/arrowUp.")||-1!=b.indexOf("/arrowDown.")||-1!=b.indexOf("/arrowLeft.")||-1!=b.indexOf("/arrowRight.")||-1!=b.indexOf("/lineHorizontal.")||-1!=b.indexOf("/lineVertical."));var Ma=b&&"polygon"==b,k=h.mediaType&&"shape"==h.mediaType,l=0,r=0;e=b=0;f=100;var q=20,r=l=0,U=Z.captionBoxes||"measure"==h.mediaType;captionFontWeight="normal";var v=!U,u=null,n=ra,O=Z.Utils.stringValidate(h.textColor)?h.textColor:rg,D=Z.Utils.stringValidate(h.backColor)?
h.backColor:uj;Z.captionBoxes&&Z.captionsColorsDefault&&"measure"!=h.mediaType&&!Z.annotationXMLAperioLoad&&(O=h.backColor,background=h.textColor);O==D&&("#ffffff"==O?D="#000000":"#000000"==O&&(D="#ffffff"));var C=Ma?1:h.z/100,u=Ma?a.currentZ/C:1;Ma||k||(0<a.constrainedScaleMin&&u<a.constrainedScaleMin&&(u=a.constrainedScaleMin),0<a.constrainedScaleMax&&u>a.constrainedScaleMax&&(u=a.constrainedScaleMax));k=Ma?new Z.Utils.PolygonDimensions(h.polygonPts):new ld(h,a,t);t=h.xScale/100*u*k.w;k=h.yScale/
100*u*k.h;u=Ec(h,a);Ka.appendChild(u);t=Rc(u,h.captionPosition,t,k,Z.imageR,ea==h.internalID&&"polygon"==h.media,!m);Ma&&(m=g?Z.imageH/2:Z.imageY,l=(h.x-(g?Z.imageW/2:Z.imageX))*a.currentZ,r=(h.y-m)*a.currentZ);l=t.x+l;r=t.y+r;a=parseFloat(u.style.padding);g=u.style.fontSize;t=parseInt(Z.Utils.getResource("z160"),10);parseInt(g,10)<t+2&&!U&&(captionFontWeight="bold");U&&(q=new Fc(u,C,!0),b=l,e=r,l+=a,r+=a,f=q.w+2*a,q=q.h);Ka.removeChild(u);U&&(n.beginPath(),n.rect(b,e,f,q),n.fillStyle=D,n.globalAlpha=
parseFloat(Z.Utils.getResource("DEFAULT_POLYGONALPHA")),n.fill(),n.globalAlpha=1,n.lineWidth=1,n.strokeStyle="#696969",n.stroke());"undefined"!==typeof h.captionHTML&&Z.Utils.stringValidate(h.captionHTML)?Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVEHTMLCAPTIONUNSUPPORTED"),!1,Z.messageDurationShort,"center"):"undefined"!==typeof h.caption&&Z.Utils.stringValidate(h.caption)&&(n.textBaseline="hanging",v&&(n.fillStyle=D,n.font=captionFontWeight+"  "+g+" Verdana",n.fillText(h.caption,l+1,
r+1)),n.fillStyle=O,n.font=captionFontWeight+"  "+g+" Verdana",n.fillText(h.caption,l,r))}}function ld(h,a,t,b){var e,f;b=b?1:a.currentZ;var g=h.z/100,g=b/g,g=g<a.constrainedScaleMin?a.constrainedScaleMin:g>a.constrainedScaleMax?a.constrainedScaleMax:g;"text"==h.mediaType?(a=new yb,g=h.z/100,hCaption=Ec(h,a),Ka.appendChild(hCaption),h=new Fc(hCaption,g,!0),Ka.removeChild(hCaption),e=h.w/b*g,f=h.h/b*g):"shape"==h.mediaType?(e=h.w,f=h.h,e=h.xScale/100*e*g,f=h.yScale/100*f*g):"polygon"==h.media&&(a=
new Z.Utils.PolygonDimensions(h.polygonPts,t),e=a.w,f=a.h,e=h.xScale/100*e*g,f=h.yScale/100*f*g);this.w=e;this.h=f}function sd(){xh++;xh==A.length&&Z.Utils.validateCallback("drawLabelsOnCanvasComplete")}function Qd(){if(Z.Utils.stringValidate(Z.geoCoordinatesPath)){var h=Z.Utils.cacheProofPath(Z.geoCoordinatesPath);(new Z.NetConnector).loadXML(h,null,"loadingGeoCoordinatesXML")}}function Nd(h){if(Z.imagePath){var a=Z.imagePath.substring(0,Z.imagePath.lastIndexOf("."))+".xml";(new Z.NetConnector).loadXML(a,
h,"loadingImageMetadataXML")}}function X(h){Z.imageMetadataXML=h;var a;if(h=h.getElementsByTagName("RULER")[0])a=parseFloat(h.getAttribute("UNITSPERIMAGE")),Z.unitsPerImage=isNaN(a)?null:a,a=parseFloat(h.getAttribute("PIXELSPERUNIT")),Z.pixelsPerUnit=isNaN(a)?null:a,a=h.getAttribute("UNITS"),Z.units=Z.Utils.stringValidate(a)?a:this.getResource("z231"),a=parseFloat(h.getAttribute("LISTTYPE")),Z.rulerListType=isNaN(a)?parseInt(this.getResource("z193"),10):a,a=parseFloat(h.getAttribute("SOURCEMAGNIFICATION")),
Z.sourceMagnification=isNaN(a)?parseInt(this.getResource("z212"),10):a,Z.Ruler&&Z.Ruler.getInitialized()&&(Z.Ruler.populateRulerSettings(),Z.Ruler.updateRulerDisplay())}function Od(h){var a;Z.Utils.stringValidate(Ld)&&(Z.simplePath?a=Ld:(".xml"!=Ld.toLowerCase().substring(Ld.length-4,Ld.length)&&(a=Z.tour?Z.Utils.getResource("z227"):Z.Utils.getResource("z135"),Ld=Ld+"/"+a),a=Z.Utils.cacheProofPath(Ld)));"undefined"!==typeof a&&Z.Utils.stringValidate(a)&&(vpIDTemp=Z.imageSet?h:null,h=new Z.NetConnector,
-1!=a.toLowerCase().indexOf(".xml")?h.loadXML(a,vpIDTemp,"loadingAnnotationsXML"):-1!=a.toLowerCase().indexOf(".json")&&h.loadJSON(a,vpIDTemp,"loadingAnnotationsJSON"))}function Zd(h,a){var t=Z.Utils.arrayIndexOfObjectValue(rc,"media",h.media);if(-1!=t){var b=new Image;b.src=h.media;var e=b.width,b=b.height;rc[t].element&&(h.image=rc[t].element.cloneNode(!1));h.w=e;h.h=b;a&&(t=new yb,vc(h,t))}else rc[rc.length]={media:h.media,element:null},t=(new Date).getTime(),e=h.media,wk.loadImage(e,Z.Utils.createCallback(null,
ve,e,t),"loadingHotspotMedia")}function Sd(h){var a;a=h.getAttribute("ID");this.id=""!=a?a:Gb("labelExternal");a=h.getAttribute("INTERNALID");this.internalID=isNaN(parseInt(a))?mb?Gb("hotspot"):Gb("label"):a;this.poiID=h.getAttribute("POIID");a=h.getAttribute("NAME");this.name=""!=a?a:this.id;this.mediaType=h.getAttribute("MEDIATYPE");this.media=h.getAttribute("MEDIA");this.image=null;a=h.getAttribute("X");a="center"==a?Z.imageCtrX:parseFloat(a);this.x=isNaN(a)?0:a;a=h.getAttribute("Y");a="center"==
a?Z.imageCtrY:parseFloat(a);this.y=isNaN(a)?0:a;a=parseFloat(h.getAttribute("ZOOM"));this.z=isNaN(a)?-1:a;a=parseFloat(h.getAttribute("XSCALE"));this.xScale=isNaN(a)?100:a;a=parseFloat(h.getAttribute("YSCALE"));this.yScale=isNaN(a)?100:a;a=parseFloat(h.getAttribute("RADIUS"));this.radius=isNaN(a)?null:a;var t=this.media,b=this.mediaType,e=!1,f=!1;Z.Utils.stringValidate(t)&&(e=-1!=t.indexOf("/circle.")||-1!=t.indexOf("/square.")||-1!=t.indexOf("/triangle.")||-1!=t.indexOf("/arrowDownLeft.")||-1!=t.indexOf("/arrowDownRight.")||
-1!=t.indexOf("/arrowUpLeft.")||-1!=t.indexOf("/arrowUpRight.")||-1!=t.indexOf("/arrowUp.")||-1!=t.indexOf("/arrowDown.")||-1!=t.indexOf("/arrowLeft.")||-1!=t.indexOf("/arrowRight.")||-1!=t.indexOf("/lineHorizontal.")||-1!=t.indexOf("/lineVertical."),f="fov"==t||"arrow"==t||"line"==t||"square"==t||"rectangle"==t||"circle"==t||"ellipse"==t||"triangle"==t||"polygon"==t||"counter"==t||"polyLine"==t,isInternalMedia="External Graphics File"!=t&&(f||e&&Z.labelShapesInternal));a=parseFloat(h.getAttribute("ZMIN"));
this.zMin=isNaN(a)?0:a;a=parseFloat(h.getAttribute("ZMAX"));this.zMax=isNaN(a)?0:a;a=parseFloat(h.getAttribute("ROTATION"));this.rotation=isNaN(a)?0:a;a=h.getAttribute("CLICKURL");this.clickURL="function"==a?a:Z.Utils.stringValidateURLScheme(h.getAttribute("CLICKURL"));this.urlTarget=h.getAttribute("URLTARGET");a=h.getAttribute("ROLLOVER");this.rollover="1"==a||"true"==a;this.caption=h.getAttribute("CAPTION");a=h.getAttribute("ROLLOVERCAPTION");this.rolloverCaption="1"==a||"true"==a;this.comment=
h.getAttribute("COMMENT");this.tooltip=h.getAttribute("TOOLTIP");this.user=h.getAttribute("USER");this.initials=h.getAttribute("INITIALS");this.date=h.getAttribute("DATE");this.textColor=(a=h.getAttribute("TEXTCOLOR"))?Z.Utils.stringValidateColorValue(a):Z.Utils.getResource("z25");this.backColor=(a=h.getAttribute("BACKCOLOR"))?Z.Utils.stringValidateColorValue(a):Z.Utils.getResource("z22");this.lineColor=(a=h.getAttribute("LINECOLOR"))?Z.Utils.stringValidateColorValue(a):Z.Utils.getResource("CONTENT_LABELLINECOLOR");
this.fillColor=(a=h.getAttribute("FILLCOLOR"))?Z.Utils.stringValidateColorValue(a):Z.Utils.getResource("CONTENT_LABELFILLCOLOR");a=h.getAttribute("TEXTVISIBLE");this.textVisible="false"!=a&&"0"!=a&&(Z.captionTextVisible||"text"==this.mediaType||"measure"==this.mediaType);a=h.getAttribute("BACKVISIBLE");this.backVisible="false"!=a&&"0"!=a&&(Z.captionBackVisible||"text"==this.mediaType||"measure"==this.mediaType);a=h.getAttribute("LINEVISIBLE");this.lineVisible="false"!=a&&"0"!=a&&Z.labelLineVisible;
a=h.getAttribute("FILLVISIBLE");this.fillVisible="true"==a||"1"==a||Z.labelFillVisible;a=h.getAttribute("CAPTIONPOSITION");this.captionPosition="fieldofview"==this.mediaType?"5":Z.Utils.stringValidate(a)?a:Z.captionPosition?Z.captionPosition:"8";a=h.getAttribute("SAVED");this.saved=null===a?!0:a;this.visibilityCaption=this.visibility=!0;a=h.getElementsByTagName("CAPTION");0<a.length&&(this.captionHTML=unescape(Z.Utils.xmlConvertDocToText(a[0])));a=h.getElementsByTagName("TOOLTIP");0<a.length&&(this.tooltipHTML=
unescape(Z.Utils.xmlConvertDocToText(a[0])));this.popup=h.getAttribute("POPUP");this.popupImage=null;a=parseFloat(h.getAttribute("POPOFFSETX"));this.popupOffsetX=isNaN(a)?0:a;a=parseFloat(h.getAttribute("POPOFFSETY"));this.popupOffsetY=isNaN(a)?0:a;a=h.getAttribute("MEDIA");if(("freehand"==a||"rectangle"==a||"polygon"==a||"measure"==a||Z.annotationXMLAperioLoad&&"arrow"==a)&&0<h.getElementsByTagName("POLYGON").length){a=h.getElementsByTagName("POLYGON")[0].getElementsByTagName("POINT");for(var g=
[],m=0,Ma=a.length;m<Ma;m++){var k=parseFloat(a[m].getAttribute("X")),k=isNaN(k)?0:k,l=parseFloat(a[m].getAttribute("Y")),l=isNaN(l)?0:l;g[g.length]={x:k,y:l}}this.polygonPts=g;this.polyClosed="0"!=h.getAttribute("CLOSED")&&!Z.annotationXMLAperioLoad&&"freehand"!=this.mediaType&&2!=a.length}e=("counter"==b||"shape"==b)&&(!t||"External Graphics File"!=t)&&(f||e&&Z.labelShapesInternal);if("fieldofview"==b)this.w=parseFloat(h.getAttribute("WIDTH")),this.h=parseFloat(h.getAttribute("HEIGHT"));else if(e)if(Z.annotationXMLAperioLoad&&
-1!=t.indexOf("arrow"))t=this.polygonPts.length,this.w=2==t?Math.abs(this.polygonPts[1].x-this.polygonPts[0].x):400,this.h=2==t?Math.abs(this.polygonPts[1].y-this.polygonPts[0].y):400,400>this.w&&(this.w=400),400>this.h&&(this.h=400);else if(b=parseFloat(h.getAttribute("WIDTH")),e=parseFloat(h.getAttribute("HEIGHT")),isNaN(b)&&isNaN(e)){if(this.w=ti,this.h=yh,"rectangle"==t||"ellipse"==t)this.w*=1.2,this.h*=.8}else this.w=b?b:this.radius?2*this.radius:"rectangle"==t||"ellipse"==t?2*yh:ti,this.h=e?
e:this.radius?2*this.radius:"line"==t?yh/4:yh;else this.h=this.w=null;this.audio=h.getAttribute("AUDIO");Z.Utils.stringValidate(this.audio)&&(Z.audioContent=!0);a=parseFloat(h.getAttribute("SHOWFOR"));this.showFor=isNaN(a)?0:a;this.transition=h.getAttribute("TRANSITION");a=parseFloat(h.getAttribute("CHANGEFOR"));this.changeFor=isNaN(a)?0:a;this.category=h.getAttribute("CATEGORY");this.zIndex=A.length.toString();a=h.getAttribute("EDITABLE");this.editable="false"!=a&&"0"!=a;this.lineStyle=h.getAttribute("LINESTYLE");
this.rolloverCaptionPrior=this.rolloverPrior=this.highlight=!1}function $d(h,a,t){if(h&&a&&t){a=new yb;for(var b=0,e=A.length;b<e;b++){var f=A[b];if(f.popup==h){var g=Z.Utils.arrayIndexOfObjectValue(Ad,"popup",h);-1!=g?Ad[g].element=t:Ad[Ad.length]={popup:h,element:t};f.popupImage=t.cloneNode(!1);vc(f,a)}}}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_HOTSPOTPOPUPPATHINVALID"),!0,null,"center")}function ve(h,a,t){if(h&&a&&t){a=new yb;for(var b=0,e=A.length;b<e;b++){var f=A[b];if(f.media==h){var g=
Z.Utils.arrayIndexOfObjectValue(rc,"media",h);-1!=g?rc[g].element=t:rc[rc.length]={media:h,element:t};f.image=t.cloneNode(!1);f.w=t.width;f.h=t.height;vc(f,a)}}}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_HOTSPOTMEDIAPATHINVALID"),!0,null,"center")}function Eb(){Ka&&m.getStatus("initializedViewport")&&(Z.Utils.clearDisplay(Ka),Wb&&Z.Utils.clearDisplay(Wb),tb&&Z.Utils.clearDisplay(tb),"inline-block"==jc.display&&we())}function we(){for(var h=new yb,a=0,t=A.length;a<t;a++)vc(A[a],h);0==Ka.childNodes.length?
(h=Z.Utils.createContainerElement("div","hotspotImmortal","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),Ka.appendChild(h)):m.deleteHotspot("hotspotImmortal",null,!0)}function vc(h,a){if(0<ui.length){var t=Z.Utils.arrayIndexOf(ui,h.id);if(-1==t)return}else if(0<vi.length&&(t=Z.Utils.arrayIndexOf(vi,h.internalID),-1==t))return;var t=Math.round(100*a.currentZ),b=-1==h.zMin?Math.round(100*Z.initialZ):Math.round(h.zMin),e=-1==h.zMax?Math.round(100*
Z.initialZ):Math.round(h.zMax);if((0==b||b<=t)&&(0==e||e>=t)){if(!Z.hotspotsDrawOnlyInView||h.x+Tg>a.box.l&&h.x-Tg<a.box.r&&h.y+Tg>a.box.t&&h.y-Tg<a.box.b){var b=h.media,t=h.mediaType,f=e=!1;Z.Utils.stringValidate(b)&&(e=-1!=b.indexOf("/circle.")||-1!=b.indexOf("/square.")||-1!=b.indexOf("/triangle.")||-1!=b.indexOf("/arrowDownLeft.")||-1!=b.indexOf("/arrowDownRight.")||-1!=b.indexOf("/arrowUpLeft.")||-1!=b.indexOf("/arrowUpRight.")||-1!=b.indexOf("/arrowUp.")||-1!=b.indexOf("/arrowDown.")||-1!=b.indexOf("/arrowLeft.")||
-1!=b.indexOf("/arrowRight.")||-1!=b.indexOf("/lineHorizontal.")||-1!=b.indexOf("/lineVertical."),f="fov"==b||"arrow"==b||"line"==b||"square"==b||"rectangle"==b||"circle"==b||"ellipse"==b||"triangle"==b||"polygon"==b||"counter"==b||"polyLine"==b);e=("counter"==t||"shape"==t)&&(!b||"External Graphics File"!=b)&&(f||e&&Z.labelShapesInternal);b=b&&"polygon"==b;"fieldofview"==t&&null!==Z.editMode?Yh(h,a):e?Me(h,a):b&&cf(h)}(!Z.hotspotsDrawOnlyInView||h.x>a.box.l&&h.x<a.box.r&&h.y>a.box.t&&h.y<a.box.b)&&
ae(h,a,null,(Z.mouseIsDown||0==h.rollover)&&"true"==h.visibility)}}function ae(h,b,t,tj){-1!=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h.internalID)&&Gc(h.internalID);"text"==h.mediaType?(t=new ld(h,b,null,!1),h.w=t.w,h.h=t.h):Z.useCanvas&&"polygon"==h.media&&h.polygonPts&&(t=new Z.Utils.PolygonDimensions(h.polygonPts,t),h.w=t.w,h.h=t.h);t=!Z.Utils.stringValidate(h.media);var e=!Z.Utils.stringValidate(h.caption)&&!Z.Utils.stringValidate(h.captionHTML)&&"measure"!=h.mediaType||null===Z.editMode&&
"fieldofview"==h.mediaType,f=null===h.w||null===h.h,g="polygon"!=h.media;if(!(t&&e&&f&&g)){t="polygon"!=h.media?h.z/100:1;f=b.currentZ/t;"polygon"!=h.media&&(Z.annotationXMLAperioLoad||"shape"==h.mediaType?Z.annotationXMLAperioLoad&&(f*=t):(0<b.constrainedScaleMin&&f<b.constrainedScaleMin&&(f=b.constrainedScaleMin),0<b.constrainedScaleMax&&f>b.constrainedScaleMax&&(f=b.constrainedScaleMax)));t=h.xScale/100*f*h.w;var f=h.yScale/100*f*h.h,k;"placeholder"!=h.media&&h.image&&(k=h.image,k.align="top",
k.width=t,k.height=f);var Ma=Math.round(h.x*b.currentZ-t/2-b.displayOffsetL+b.imageOffsetL),l=Math.round(h.y*b.currentZ-f/2-b.displayOffsetT+b.imageOffsetT),r=g=null;e||(Z.captionBoxes||"measure"==h.mediaType?g=Ec(h,b):(r=Ec(h,b,!0,!0),g=Ec(h,b,!0,!1)));var q=Z.Utils.createContainerElement("div","hCloak","inline-block","absolute","visible");b="hot"+h.internalID.toString()+(Z.imageSet?"-"+a.toString():"");var u=t,U=f;"fieldofview"==h.mediaType?(u=100*Z.imageZ,U=100*Z.imageZ):-1!=h.media.indexOf("arrow")&&
(u*=.7,U*=.7,Ma+=(t-u)/2,l+=(f-U)/2);b=Z.Utils.createContainerElement("div",b,"inline-block","absolute","visible",u+"px",U+"px",Ma+"px",l+"px","none","0px","transparent","0px","0px","normal");"undefined"===typeof wi||null===wi||"TOOLTIP"==wi?b.title=Z.Utils.stringValidate(h.tooltip)?h.tooltip:"":"COMMENT"==wi&&(b.title=Z.Utils.stringValidate(h.comment)?h.comment:"");if((!Z.labelClickSelect||null===Z.editMode)&&Z.Utils.stringValidate(h.clickURL)){if(null!==Z.editMode)Z.Utils.addEventListener(q,"mousedown",
xe),Z.Utils.addEventListener(q,"touchstart",be);else if("function"==h.clickURL)Zh&&null===ea&&(ea=A.length),Z.Utils.addEventListener(b,"mousedown",df),Z.Utils.addEventListener(b,"touchstart",df),Z.Utils.addEventListener(b,"touchmove",df),Z.Utils.addEventListener(b,"mouseup",Ne),Z.Utils.addEventListener(b,"touchend",Ne),Z.Utils.addEventListener(b,"touchcancel",Ne);else{if("shape"==h.mediaType||"polygon"==h.mediaType){var u=Z.Utils.createContainerElement("div","hClicker","inline-block","absolute","visible",
u+"px",U+"px","0px","0px","none","0px","transparent","0px","0px","normal"),v=document.createElement("a");v.setAttribute("href",h.clickURL);v.setAttribute("target",h.urlTarget);v.setAttribute("outline","none");v.appendChild(u);u.style.cursor="help"}if(k){var n=document.createElement("a");n.setAttribute("href",h.clickURL);n.setAttribute("target",h.urlTarget);n.setAttribute("outline","none");n.appendChild(k);k.style.cursor="help";k.style.border="none"}if(g){var O=document.createElement("a");O.setAttribute("href",
h.clickURL);O.setAttribute("target",h.urlTarget);O.setAttribute("outline","none");r&&(O.appendChild(r),r.style.cursor="help");O.appendChild(g);g.style.cursor="help"}q.style.border="none"}null===Z.editMode&&(Z.clickZoom||Z.clickPan)&&(Z.Utils.addEventListener(b,"mousedown",Uf),Z.Utils.addEventListener(b,"touchstart",Vf))}Z.labelClickSelect&&null!==Z.editMode||!Z.Utils.stringValidate(h.clickURL)||null!==Z.editMode||"function"==h.clickURL?(k&&q.appendChild(k),r&&q.appendChild(r),g&&q.appendChild(g)):
(v&&q.appendChild(v),n&&q.appendChild(n),O&&q.appendChild(O));"placeholder"!=h.popup&&h.popupImage&&(O=h.popupImage,O.style.display="none",O.id="popup",v=Z.Utils.createContainerElement("div","hPopupContainer","inline-block","absolute","visible"),v.appendChild(O),q.appendChild(v),n=-(O.width/2)+t/2,O=-(O.height/2)+f/2,n=0!=h.popupOffsetX?h.popupOffsetX+n:n,O=0!=h.popupOffsetY?h.popupOffsetY+O:O,0!=n&&0!=O&&(v.style.left=n+"px",v.style.top=O+"px"));b.appendChild(q);Ka.appendChild(b);b.zIndex=h.zIndex;
b.style.zIndex=h.zIndex;Z.annotationXMLAperioLoad&&!e&&Z.captionBoxes&&!h.rolloverCaption&&(n=(Z.Utils.stringValidate(h.backColor)?h.backColor:uj).toString())&&(e=Z.Utils.hexToRGB(n).r,v=Z.Utils.hexToRGB(n).g,n=Z.Utils.hexToRGB(n).b,g.style.backgroundColor="rgba("+e+","+v+","+n+","+hl+")");h.rollover&&(q.rollover=h.rollover);b.internalID=h.internalID;tj?(e=!h.rollover&&h.visibility,(q=b.firstChild)&&q.style&&(q.style.visibility="visible",tj=e?"visible":"hidden",q.style.backgroundColor=e?"":"#FFFFFF",
Z.Utils.setOpacity(q,e?1:.01),e=b.firstChild.childNodes.length,0<e&&(e=b.firstChild.childNodes[e-1])&&e.style&&(e.style.visibility=tj))):m.setHotspotVisibility(b,!h.rollover&&h.visibility);m.setHotspotCaptionVisibility(b,!h.rolloverCaption&&h.visibilityCaption);k&&(e=m.getRotation(),0!=e&&Z.Utils.rotateElement(k.style,-e),k=this.rotation,"undefined"!==typeof k&&null!==k&&0!=k&&Z.Utils.rotateElement(b,k));r&&Sc(h,r,t,f,!0);Sc(h,g,t,f);null!==Z.editMode&&Z.labelClickDrag&&(Z.Utils.addEventListener(b,
"mouseover",tf),Z.Utils.addEventListener(b,"mouseout",ce));h.rollover&&(Z.Utils.addEventListener(b,"mouseover",uf),Z.Utils.addEventListener(b,"mouseout",vf));h.rolloverCaption&&(Z.Utils.addEventListener(b,"mouseover",sg),Z.Utils.addEventListener(b,"mouseout",dc));Z.labelHighlight&&(Z.Utils.addEventListener(b,"mouseover",tg),Z.Utils.addEventListener(b,"mouseout",wf));h.popup&&(null===Z.editMode&&Z.mobileDevice?(Z.Utils.addEventListener(b,"touchstart",Hc),(h=Z.Utils.getChildElementByID(b,"popup"))&&
Z.Utils.addEventListener(h,"touchstart",ye)):(Z.Utils.addEventListener(b,"mouseover",Hc),Z.Utils.addEventListener(b,"mouseout",ye)));Z.Utils.addEventListener(b,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"contextmenu",Z.Utils.preventDefault);Z.Utils.validateCallback("labelDrawnGetIDs")}}function yb(h){Ka&&(this.box=m.z541(h),this.currentZ=m.getZoom(),this.constrainedScale=this.currentZ<$h?$h:this.currentZ>ai?ai:this.currentZ,this.constrainedScaleMax=ai,this.constrainedScaleMin=
$h,this.displayOffsetL=(Z.imageW*this.currentZ-Ka.width)/2,this.displayOffsetT=(Z.imageH*this.currentZ-Ka.height)/2,this.imageOffsetL=(Z.imageW/2-Z.imageX)*this.currentZ,this.imageOffsetT=(Z.imageH/2-Z.imageY)*this.currentZ)}function ub(h){if("undefined"===typeof h||null===h)h=document.getElementById("progressTextBox");var a=null;-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")?a=h:h.parentNode&&-1!=h.parentNode.id.indexOf("hot")&&-1==h.parentNode.id.indexOf("hotspotDisplay")?a=h.parentNode:
h.parentNode.parentNode&&-1!=h.parentNode.parentNode.id.indexOf("hot")&&-1==h.parentNode.parentNode.id.indexOf("hotspotDisplay")?a=h.parentNode.parentNode:h.parentNode.parentNode.parentNode&&-1!=h.parentNode.parentNode.parentNode.id.indexOf("hot")&&-1==h.parentNode.parentNode.parentNode.id.indexOf("hotspotDisplay")&&(a=h.parentNode.parentNode.parentNode);return a}function de(h,a){for(var b=a.x-h.x,e=a.y-h.y,f=h.polygonPts.slice(0),p=0,g=f.length;p<g;p++)f[p].x+=b,f[p].y+=e;h.polygonPts=f.slice(0)}
function Ec(h,a,b,e){var f=e?"captionTextBoxDropShadow":"captionTextBox",p=a.currentZ/(h.z/100),g="text"!=h.mediaType?1:(h.xScale+h.yScale)/2/100;h.rolloverCaption||h.rolloverCaptionPrior?p=1:"text"==h.mediaType?p*=g:(0<a.constrainedScaleMin&&p<a.constrainedScaleMin&&(p=a.constrainedScaleMin),0<a.constrainedScaleMax&&p>a.constrainedScaleMax&&(p=a.constrainedScaleMax));a=Math.round(xk*p);a="text"==h.mediaType?a:a<Yi?Yi:a>Zi?Zi:a;"counter"==h.mediaType&&(a+=2);var p=il*p,g=p<yk?yk:p>zk?zk:p,m,k,p=Z.Utils.stringValidate(h.textColor)?
h.textColor:rg;k=Z.Utils.stringValidate(h.backColor)?h.backColor:uj;"undefined"!==typeof b&&null!==b&&b?(m="0px",k="transparent",b="counter"!=h.mediaType?"normal":"bold"):(m="1px",b="normal");"undefined"!==typeof e&&null!==e&&e&&(p=h.backColor);h.textVisible||(p="transparent");Z.captionBoxes&&Z.captionsColorsDefault&&"measure"!=h.mediaType&&!Z.annotationXMLAperioLoad&&(p=h.backColor,k=h.textColor);p==k&&("#ffffff"==p?k="#000000":"#000000"==p&&(k="#ffffff"));e=Z.Utils.createContainerElement("div",
f,"inline-block","absolute","hidden","auto","auto","1px","1px","solid",m,k,"0px",g+"px","pre");"undefined"!==typeof h.captionHTML&&Z.Utils.stringValidate(h.captionHTML)?(e.innerHTML=h.captionHTML,Z.Utils.setHTMLTextDefaultCaptionStyle(e,h.captionHTML,p,"verdana",a+"px","none","normal","normal","normal","normal","1em","center","none")):"transparent none"!=p&&"undefined"!==typeof h.caption&&Z.Utils.stringValidate(h.caption)?(h=document.createTextNode(h.caption),e.appendChild(h),Z.Utils.setTextNodeStyle(h,
p,"verdana",a+"px","none","normal","normal","normal",b,"1em","center","none"),Z.Utils.disableTextInteraction(h)):"measure"==h.mediaType&&(f=new Z.Utils.Point(h.x,h.y),Tc(h,f));Z.Utils.addEventListener(e,"contextmenu",Z.Utils.preventDefault);return e}function Sc(h,a,b,e,f){a&&("arrow"==h.media&&(h.captionPosition=180<h.rotation?"2":"8"),h=Rc(a,h.captionPosition,b,e,Z.imageR,ea==h.internalID&&"polygon"==h.media))&&(f=f?1:0,a.style.left=h.x+f+"px",a.style.top=h.y+f+"px")}function Rc(h,a,b,e,f,p,g){var m=
h.style,k=p&&("addLabel"==Z.editing||"editLabel"==Z.editing||null===Z.editMode&&"measure"==Z.labelMode)?40:0,k=k*Z.imageZ,l="undefined"!==typeof g&&g?0:null!==Z.captionOffset?Z.captionOffset:parseFloat(m.padding);0>f&&(f+=360);var r=new Fc(h);h=(b-r.w)/2-l;p=(e-r.h)/2-l;Z.Utils.rotateElement(m,-f);if(0==f%90){m=f;a=parseInt(a,10);0>m&&(m+=360);switch(a){case 1:a=0==m?a:90==m?7:180==m?9:270==m?3:5;break;case 2:a=0==m?a:90==m?4:180==m?8:270==m?6:5;break;case 3:a=0==m?a:90==m?1:180==m?7:270==m?9:5;break;
case 4:a=0==m?a:90==m?8:180==m?6:270==m?2:5;break;case 6:a=0==m?a:90==m?2:180==m?4:270==m?8:5;break;case 7:a=0==m?a:90==m?9:180==m?3:270==m?1:5;break;case 8:a=0==m?a:90==m?6:180==m?2:270==m?4:5;break;case 9:a=0==m?a:90==m?3:180==m?1:270==m?7:5}a=a.toString();a=parseInt(a,10);m=b/2+r.w/2+l+k;k=e/2+r.h+l+k;if(90==f||270==f)f=m,m=k,k=f;switch(a){case 1:h-=m;p-=k;break;case 2:p-=k;break;case 3:h+=m;p-=k;break;case 4:h-=m;break;case 6:h+=m;break;case 7:h-=m;p+=k;break;case 8:p+=k;break;case 9:h+=m,p+=
k}}g&&(h-=b/2,p-=e/2);return new Z.Utils.Point(h,p)}function Fc(h,a,b){if("undefined"===typeof a||null===a)a=1;var e=h.style,f=m.getZoom(),p=parseFloat(Z.Utils.getElementStyleProperty(h,"width"));isNaN(p)&&(p=parseFloat(Z.Utils.getResource("z115")),p=parseFloat(e.fontSize)/p,p=Math.round(parseFloat(h.firstChild.length*p)));h=parseInt(Z.Utils.getResource("z129"),10);parseFloat(e.fontSize);var e=2*parseFloat(Z.Utils.getResource("z160")),g=2*parseFloat(Z.Utils.getResource("z151"));a=1.7*h*f/a;b&&(a<
e?a=e:a>g&&(a=g));this.w=p;this.h=a}function Tc(h,a){var b=h.polyClosed,e=h.polygonPts.slice(0),f=e.length,p="",g=0,m="",k="pixels"==Z.units?0:4,l="um"!=Z.units?Z.units:"\u03bcm";0==f?(p=jl,g=Z.Utils.polygonPerimeter(e,b,a,k),captionText=p+g.toString()+"  "+l):0<f&&!b?("view"==Z.labelMode&&(a=null),p=kl,g=Z.Utils.polygonPerimeter(e,b,a,k),captionText=p+g.toString()+"  "+l):(p=ll,g=Z.Utils.polygonPerimeter(e,b,a,k),m=ml,captionText=p+g.toString()+"  "+l,p=nl,g=Z.Utils.polygonArea(e,b,a,k),captionText+=
"\n"+p+g.toString()+"  "+l+m);h.caption=captionText;ba&&ug&&ug.firstChild&&ug.firstChild.value&&(ug.firstChild.value=ba.caption)}function Bd(h,a,b,e){if("undefined"===typeof e||null===e)e=Ja;e=e.toString();var f="0"==h||Z.imageSet?"hidden":"visible",p=parseInt(Z.Utils.getResource("z133"),10),g=parseInt(Z.Utils.getResource("DEFAULT_IMAGESETLISTWIDTH"),10),p=Z.imageSet?g:p,g=qe(h,p,ka,ha);"undefined"===typeof mb||null===mb?(Z["HotspotList"+e]=new Z.Utils.createSelectElement("HotspotList"+e,a,b,p,g.x,
g.y,null,f,xf,"mousedown"),oh=mb=Z["HotspotList"+e],ph=oh.style,"0"!=h&&Z.ViewerDisplay.appendChild(mb),Z.tour&&(Ug=0),h=Z.Utils.stringValidate(Z.hotspotListTitle)&&"none"!=Z.hotspotListTitle?1:0,mb.selectedIndex=h):Z.Utils.arrayClear(b)}function Gc(h){h=document.getElementById("hot"+h+(Z.imageSet?"-"+a.toString():""));null!==h&&h.parentNode.removeChild(h)}function Ic(h,a,b){var e=Z.Utils.stringValidate(a.textColor)?a.textColor:rg;"undefined"!==typeof b&&null!==b&&b&&(e=a.backColor);b=new yb;var f=
b.currentZ/(a.z/100),p="text"!=a.mediaType?1:(a.xScale+a.yScale)/2/100;a.rolloverCaption||a.rolloverCaptionPrior?f=1:"text"==a.mediaType?f*=p:(0<b.constrainedScaleMin&&f<b.constrainedScaleMin&&(f=b.constrainedScaleMin),0<b.constrainedScaleMax&&f>b.constrainedScaleMax&&(f=b.constrainedScaleMax));b=Math.round(xk*f);Z.Utils.setTextNodeStyle(h.firstChild,e,"verdana",("text"==a.mediaType?b:b<Yi?Yi:b>Zi?Zi:b)+"px","none","normal","normal","normal",Z.captionBoxes||"measure"==a.mediaType||"counter"!=a.mediaType?
"normal":"bold","1em","center","none")}function qe(h,a,b,e){var f=Z.imageSet?13:25;switch(h){case "0":e=h=0;break;case "1":e=h=f;break;case "2":h=b-a-f;e=Z.imageSet?32:20;break;case "3":h=b-a-f;e=0<Z.toolbarVisible&&8!=Z.toolbarVisible?e-2*f:e-1.5*f;break;case "4":h=f;e=0<Z.toolbarVisible&&8!=Z.toolbarVisible?e-2*f:e-1.5*f;break;default:h=b-a,e=f}return new Z.Utils.Point(h,e)}function Gb(h){var a=0,b=[];switch(h){case "image":if(ef){h=0;for(var e=ef.length;h<e;h++)b[b.length]=parseInt(ef[h].value,
10)}break;case "slide":if(td)for(h=0,e=td.length;h<e;h++)b[b.length]=parseInt(td[h].internalID,10);break;case "hotspot":if(A)for(h=0,e=A.length;h<e;h++)b[b.length]=parseInt(A[h].internalID,10);break;case "poi":if(db)for(h=0,e=db.length;h<e;h++)b[b.length]=parseInt(db[h].value,10);break;case "label":if(Ta)for(h=0,e=Ta.length;h<e;h++)b[b.length]=parseInt(Ta[h].value,10);break;case "labelExternal":if(A)for(h=0,e=A.length;h<e;h++)b[b.length]=parseInt(A[h].id,10);break;case "note":if(zb)for(h=0,e=zb.length;h<
e;h++)b[b.length]=parseInt(zb[h].value,10);break;case "fov":if(A)for(h=0,e=A.length;h<e;h++)"fieldofview"==A[h].mediaType&&(b[b.length]=parseInt(A[h].id.substring(3),10))}0<b.length&&(b=Z.Utils.arraySortNumericAscending(b),a=b[b.length-1]+1);return a.toString()}function gc(h){var a;Z.Utils.stringValidate(Mc)&&(Z.simplePath?a=Mc:(".json"!=Mc.toLowerCase().substring(Mc.length-5,Mc.length)&&".xml"!=Mc.toLowerCase().substring(Mc.length-4,Mc.length)&&(Mc=Mc+"/"+Z.Utils.getResource("z69")),a=Z.Utils.cacheProofPath(Mc)));
"undefined"!==typeof a&&Z.Utils.stringValidate(a)?(vpIDTemp=Z.imageSet?h:null,h=new Z.NetConnector,-1!=a.toLowerCase().indexOf(".xml")?h.loadXML(a,vpIDTemp,"loadingAnnotationsXML"):-1!=a.toLowerCase().indexOf(".json")&&h.loadJSON(a,vpIDTemp,"loadingAnnotationsJSON")):"string"===typeof Z.annotationXMLText&&Z.Utils.stringValidate(Z.annotationXMLText)?(a=Z.Utils.xmlConvertTextToDoc(Z.annotationXMLText),m.parseAnnotationsXML(a)):"undefined"!==typeof Z.annotationJSONObject&&"object"===typeof Z.annotationJSONObject&&
null!==Z.annotationJSONObject?(a=Z.Utils.jsonConvertObjectToXMLText(Z.annotationJSONObject),a=Z.Utils.xmlConvertTextToDoc(a),m.parseAnnotationsXML(a)):Z.measureVisible&&null===Z.editMode&&(a=Z.Utils.xmlConvertTextToDoc("<ANNOTATIONDATA></ANNOTATIONDATA>"),m.parseAnnotationsXML(a))}function Td(h){var a=h.getAttribute("MEDIATYPE"),b=h.getAttribute("MEDIA"),e=!1,f=!1;if(Z.Utils.stringValidate(b)){var e=-1!=b.indexOf("/circle.")||-1!=b.indexOf("/square.")||-1!=b.indexOf("/triangle.")||-1!=b.indexOf("/arrowDownLeft.")||
-1!=b.indexOf("/arrowDownRight.")||-1!=b.indexOf("/arrowUpLeft.")||-1!=b.indexOf("/arrowUpRight.")||-1!=b.indexOf("/arrowUp.")||-1!=b.indexOf("/arrowDown.")||-1!=b.indexOf("/arrowLeft.")||-1!=b.indexOf("/arrowRight.")||-1!=b.indexOf("/lineHorizontal.")||-1!=b.indexOf("/lineVertical."),f="fov"==b||"arrow"==b||"line"==b||"square"==b||"rectangle"==b||"circle"==b||"ellipse"==b||"triangle"==b||"polygon"==b||"counter"==b||"polyLine"==b,p=null;if(Z.labelShapesInternal)if(e){if("symbol"==a||"icon"==a||"shape"==
a)p=b.substring(b.lastIndexOf("/")+1,b.indexOf("."))}else"symbol"==a&&(p=Fd+"/noSubstitutePlaceholder.png");else null===Z.labelShapesInternal||Z.labelShapesInternal||"symbol"==a&&(p=f?Fd+"/"+b+".png":Fd+"/noSubstitutePlaceholder.png");p&&(h.setAttribute("MEDIATYPE","shape"),h.setAttribute("MEDIA",p),xi=!0)}return h}function Cd(){return Z.Utils.xmlConvertTextToDoc("<ANNOTATIONDATA></ANNOTATIONDATA>")}function nb(h,a){var b;switch(a){case "root":b=h.getElementsByTagName("ANNOTATIONDATA")[0];break;case "setup":b=
h.createElement("SETUP");b.setAttribute("PANELPOSITION","2");b.setAttribute("INITIALVISIBILITY","1");b.setAttribute("POIVISIBILITY",Z.Utils.getResource("z66"));b.setAttribute("LABELVISIBILITY",Z.Utils.getResource("z52"));b.setAttribute("NOTEVISIBILITY",Z.Utils.getResource("z60"));b.setAttribute("COMMENTVISIBILITY",Z.Utils.getResource("DEFAULT_ANNOTATIONCOMMENTVISIBILITY"));b.setAttribute("MINSCALE","0.2");b.setAttribute("MAXSCALE","2");break;case "poi":b=h.createElement("POI");b.setAttribute("ID",
"0");b.setAttribute("NAME",Z.Utils.getResource("z43"));b.setAttribute("EDITABLE",Z.Utils.getResource("CONTENT_EDITABLE"));b.setAttribute("X","center");b.setAttribute("Y","center");b.setAttribute("ZOOM","-1");b.setAttribute("USER",Z.Utils.getResource("z44"));b.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());break;case "label":b=h.createElement("LABEL");b.setAttribute("ID","0");b.setAttribute("NAME",Z.Utils.getResource("z37"));b.setAttribute("MEDIATYPE","text");b.setAttribute("MEDIA","");b.setAttribute("X",
"center");b.setAttribute("Y","center");b.setAttribute("ZOOM","100");b.setAttribute("XSCALE","100");b.setAttribute("YSCALE","100");b.setAttribute("RADIUS","");b.setAttribute("ZMIN","0");b.setAttribute("ZMAX","0");b.setAttribute("CLICKURL","");b.setAttribute("URLTARGET","");b.setAttribute("ROLLOVER","0");b.setAttribute("CAPTION","");b.setAttribute("ROLLOVERCAPTION","0");b.setAttribute("COMMENT","");b.setAttribute("TOOLTIP","");b.setAttribute("USER",Z.Utils.getResource("z39"));b.setAttribute("DATE",
Z.Utils.getCurrentUTCDateAsString());b.setAttribute("TEXTCOLOR",Z.Utils.getResource("z25"));b.setAttribute("BACKCOLOR",Z.Utils.getResource("z22"));b.setAttribute("LINECOLOR",Z.Utils.getResource("CONTENT_LABELLINECOLOR"));b.setAttribute("FILLCOLOR",Z.Utils.getResource("CONTENT_LABELFILLCOLOR"));b.setAttribute("TEXTVISIBLE",Z.Utils.getResource("z26"));b.setAttribute("BACKVISIBLE",Z.Utils.getResource("z23"));b.setAttribute("LINEVISIBLE",Z.Utils.getResource("CONTENT_LABELLINEVISIBLE"));b.setAttribute("FILLVISIBLE",
Z.Utils.getResource("CONTENT_LABELFILLVISIBLE"));b.setAttribute("CAPTIONPOSITION",Z.Utils.getResource("z24"));b.setAttribute("ROTATION","0");b.setAttribute("CATEGORY","");b.setAttribute("POPUP","");b.setAttribute("POPOFFSETX","");b.setAttribute("POPOFFSETY","");b.setAttribute("EDITABLE","1");b.setAttribute("LINESTYLE",Z.Utils.getResource("CONTENT_LINESTYLE"));break;case "polygon":b=h.createElement("POLYGON");break;case "point":b=h.createElement("POINT");b.setAttribute("X","0");b.setAttribute("Y",
"0");break;case "note":b=h.createElement("NOTE"),b.setAttribute("ID","0"),b.setAttribute("NAME",Z.Utils.getResource("z40")),b.setAttribute("EDITABLE","1"),b.setAttribute("TEXT",Z.Utils.getResource("z41")),b.setAttribute("USER",Z.Utils.getResource("z42")),b.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString())}return b}function Ud(h,a,b,e,f,p,g){h=Z.Utils.arrayToArrayOfStrings([h,a,b,e,f,p,g]);h=Z.Utils.xmlConvertTextToDoc('<POI ID="'+h[0]+'" NAME="'+h[1]+'" X="'+h[2]+'" Y="'+h[3]+'" ZOOM="'+h[4]+
'" INTERNALID="'+h[5]+'" EDITABLE="'+h[6]+'" ></POI>').getElementsByTagName("POI")[0];ze(h,!0)}function ze(h,a){m.saveEditsPOI(!0);a&&(h=ee(h,"poi"));var b=h.getAttribute("INTERNALID"),e=h.getAttribute("EDITABLE"),e="0"!=e&&"false"!=e,f=Z.Utils.arrayIndexOfObjectValue(db,"value",b);-1==f&&(f=db.length);db[f]={text:h.getAttribute("NAME"),value:b,id:h.getAttribute("ID"),x:h.getAttribute("X"),y:h.getAttribute("Y"),z:h.getAttribute("ZOOM"),user:h.getAttribute("USER"),date:h.getAttribute("DATE"),editable:e}}
function Ae(h,a){m.saveEditsNote(!0);a&&(h=ee(h,"note"));var b=h.getAttribute("INTERNALID"),e=h.getAttribute("EDITABLE"),e="0"!=e&&"false"!=e,f=Z.Utils.arrayIndexOfObjectValue(zb,"value",b);-1==f&&(f=zb.length);zb[f]={text:h.getAttribute("NAME"),value:b,noteText:h.getAttribute("TEXT"),poiID:h.getAttribute("POIID"),id:h.getAttribute("ID"),user:h.getAttribute("USER"),date:h.getAttribute("DATE"),editable:e}}function ee(h,a){var b,e;switch(a){case "hotspot":b=mb?Gb("hotspot"):Gb("label");e=Z.Utils.stringValidate(Z.labelMode)?
Z.labelMode:"";Z.Utils.stringValidate(h.getAttribute("ID"))||h.setAttribute("ID",b);var f=null;Z.Utils.stringValidate(h.getAttribute("NAME"))||(f=mb?Z.Utils.getResource("z34"):Z.Utils.getResource("z37"),h.setAttribute("NAME",f+b+": "+e));null===f||Z.Utils.stringValidate(h.getAttribute("CAPTION"))||"freehand"==Z.labelMode||Z.tourPath||Z.Utils.stringValidate(h.getAttribute("MEDIA"))||Z.Utils.stringValidate(h.getAttribute("MEDIA")&&"polygon"==h.getAttribute("MEDIA"))||(e=mb?Z.Utils.getResource("z33"):
Z.Utils.getResource("z35"),h.setAttribute("CAPTION",e+b));Z.Utils.stringValidate(h.getAttribute("X"))||h.setAttribute("X",Z.imageX.toString());Z.Utils.stringValidate(h.getAttribute("Y"))||h.setAttribute("Y",Z.imageY.toString());Z.Utils.stringValidate(h.getAttribute("ZOOM"))||h.setAttribute("ZOOM",(100*Z.imageZ).toString());Z.Utils.stringValidate(h.getAttribute("ZMIN"))||h.setAttribute("ZMIN","0");Z.Utils.stringValidate(h.getAttribute("ZMAX"))||h.setAttribute("ZMAX","0");!Z.Utils.stringValidate(h.getAttribute("CLICKURL"))&&
Z.Utils.stringValidate(h.getAttribute("URL"))&&h.setAttribute("CLICKURL",h.getAttribute("URL"));isNaN(parseInt(h.getAttribute("INTERNALID"),10))&&h.setAttribute("INTERNALID",b);var p=h.getAttribute("MEDIATYPE");Z.Utils.stringValidate(h.getAttribute("TEXTCOLOR"))&&Z.Utils.stringValidate(h.getAttribute("BACKCOLOR"))&&(Z.captionsColorsDefault=!1);(Z.captionBoxes||"measure"==p)&&Z.captionsColorsDefault&&(h.setAttribute("TEXTCOLOR",Z.Utils.getResource("z25")),h.setAttribute("BACKCOLOR",Z.Utils.getResource("z22")));
!Z.Utils.stringValidate(h.getAttribute("USER"))&&Z.Utils.stringValidate(Z.userName)&&h.setAttribute("USER",Z.userName);Z.Utils.stringValidate(h.getAttribute("DATE"))||h.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());break;case "poi":b=Gb("poi");Z.Utils.stringValidate(h.getAttribute("ID"))||h.setAttribute("ID",b);Z.Utils.stringValidate(h.getAttribute("NAME"))||h.setAttribute("NAME",Z.Utils.getResource("z43")+b);Z.Utils.stringValidate(h.getAttribute("X"))||h.setAttribute("X",Z.imageX.toString());
Z.Utils.stringValidate(h.getAttribute("Y"))||h.setAttribute("Y",Z.imageY.toString());Z.Utils.stringValidate(h.getAttribute("ZOOM"))||h.setAttribute("ZOOM",(100*Z.imageZ).toString());isNaN(parseInt(h.getAttribute("INTERNALID"),10))&&h.setAttribute("INTERNALID",b);Z.Utils.stringValidate(h.getAttribute("EDITABLE"))||h.setAttribute("EDITABLE","1");!Z.Utils.stringValidate(h.getAttribute("USER"))&&Z.Utils.stringValidate(Z.userName)&&h.setAttribute("USER",Z.userName);Z.Utils.stringValidate(h.getAttribute("DATE"))||
h.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());break;case "label":b=Gb("label");e=Z.Utils.stringValidate(Z.labelMode)?Z.labelMode:"";Z.Utils.stringValidate(h.getAttribute("ID"))||h.setAttribute("ID",b);if(!Z.Utils.stringValidate(h.getAttribute("NAME"))){var f=Z.Utils.getResource("z37"),p=h.getAttribute("MEDIATYPE"),g=h.getAttribute("MEDIA");h.setAttribute("NAME",f+b+": "+("fieldofview"==p?"field of view":"shape"==p?g:e))}p=h.getAttribute("MEDIATYPE");g=h.getAttribute("MEDIA");Z.Utils.stringValidate(g)||
"fieldofview"==p||"text"==p||(h.setAttribute("MEDIA",Fd+"/"+Z.Utils.getResource("z57")),h.setAttribute("MEDIATYPE",Z.Utils.getResource("z57TYPE")));Z.Utils.stringValidate(h.getAttribute("TEXTCOLOR"))&&Z.Utils.stringValidate(h.getAttribute("BACKCOLOR"))&&(Z.captionsColorsDefault=!1);(Z.captionBoxes||"measure"==p)&&Z.captionsColorsDefault&&(h.setAttribute("TEXTCOLOR",Z.Utils.getResource("z25")),h.setAttribute("BACKCOLOR",Z.Utils.getResource("z22")));Z.Utils.stringValidate(h.getAttribute("CAPTION"))||
"fieldofview"==p||"freehand"==p||(e=Z.Utils.getResource("z35"),h.setAttribute("CAPTION",e+b));Z.Utils.stringValidate(h.getAttribute("COMMENT"))||h.setAttribute("COMMENT",Z.Utils.getResource("CONTENT_LABELCOMMENT"));"fieldofview"!=p||Z.Utils.stringValidate(h.getAttribute("TOOLTIP"))||(p=Math.round(parseFloat(h.getAttribute("X"))).toString(),e=Math.round(parseFloat(h.getAttribute("Y"))).toString(),f=Math.round(parseFloat(h.getAttribute("ZOOM"))).toString()+"%",p="("+p+"x, "+e+"y, "+f+")",h.setAttribute("TOOLTIP",
Z.Utils.getResource("CONTENT_TOOLTIPFOV")+p));!Z.Utils.stringValidate(h.getAttribute("CLICKURL"))&&Z.Utils.stringValidate(h.getAttribute("URL"))&&h.setAttribute("CLICKURL",h.getAttribute("URL"));Z.Utils.stringValidate(h.getAttribute("X"))||h.setAttribute("X",Z.imageX.toString());Z.Utils.stringValidate(h.getAttribute("Y"))||h.setAttribute("Y",Z.imageY.toString());Z.Utils.stringValidate(h.getAttribute("ZOOM"))||h.setAttribute("ZOOM",(100*Z.imageZ).toString());Z.Utils.stringValidate(h.getAttribute("ZMIN"))||
h.setAttribute("ZMIN","0");Z.Utils.stringValidate(h.getAttribute("ZMAX"))||h.setAttribute("ZMAX","0");isNaN(parseInt(h.getAttribute("INTERNALID"),10))&&h.setAttribute("INTERNALID",b);isNaN(parseInt(h.getAttribute("POIID"),10))&&"undefined"!==typeof sa&&h.setAttribute("POIID",sa.options[sa.selectedIndex].value);Z.Utils.stringValidate(h.getAttribute("EDITABLE"))||h.setAttribute("EDITABLE","1");!Z.Utils.stringValidate(h.getAttribute("USER"))&&Z.Utils.stringValidate(Z.userName)&&h.setAttribute("USER",
Z.userName);Z.Utils.stringValidate(h.getAttribute("DATE"))||h.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());break;case "note":b=Gb("note"),Z.Utils.stringValidate(h.getAttribute("ID"))||h.setAttribute("ID",b),Z.Utils.stringValidate(h.getAttribute("NAME"))||h.setAttribute("NAME",Z.Utils.getResource("z40")+b),Z.Utils.stringValidate(h.getAttribute("TEXT"))||h.setAttribute("TEXT",""),isNaN(parseInt(h.getAttribute("INTERNALID"),10))&&h.setAttribute("INTERNALID",b),isNaN(parseInt(h.getAttribute("POIID"),
10))&&"undefined"!==typeof sa&&h.setAttribute("POIID",sa.options[sa.selectedIndex].value),Z.Utils.stringValidate(h.getAttribute("EDITABLE"))||h.setAttribute("EDITABLE","1"),!Z.Utils.stringValidate(h.getAttribute("USER"))&&Z.Utils.stringValidate(Z.userName)&&h.setAttribute("USER",Z.userName),Z.Utils.stringValidate(h.getAttribute("DATE"))||h.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString())}return h}function ec(h,a){var b=0,e="",f="";if("none"!=Z.annotationSort){switch(Z.annotationSort){case "id":e=
h.value.toLowerCase();f=a.value.toLowerCase();break;case "name":e=h.text.toLowerCase(),f=a.text.toLowerCase()}e<f?b=-1:e>f&&(b=1)}return b}function Vd(h){var a=h.toString(),b=Z.Toolbar.getSkinArray(),e=Z.Toolbar.getSkinSizes(),f=parseInt(Z.Utils.getResource("z63"),10);if("markup"!=Z.editMode)var p=parseFloat(Z.Utils.getResource("DEFAULT_BACKGROUNDSMALLDALPHA")/1.5),g=Z.Utils.getResource("z83"),m=Z.Utils.getResource("z83NOALPHA");if("markup"!=Z.editMode){var k=Z.Utils.createContainerElement("div",
"buttonContainerPOI"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default",!0);Ya.appendChild(k);Z.Utils.addEventListener(k,"mouseover",Z.Toolbar.backgroundEventsHandler);var l=Z.Utils.createTextElement("poiNameTextElement"+a,"","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.Utils.addEventListener(l.firstChild,"focus",Be);Z.Utils.addEventListener(l.firstChild,"blur",fe);Ya.appendChild(l);
var r=document.getElementById("textBoxFor-poiNameTextElement"+a);r&&(r.style.visibility="hidden");var q=new Z.Utils.Button("buttonPOIAdd"+a,null,Z.skinPath,b[133],b[134],b[135],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z373");k.appendChild(q.elmt);var u=new Z.Utils.Button("buttonPOIEdit"+a,null,Z.skinPath,b[136],b[137],b[138],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z376");k.appendChild(u.elmt);var v=new Z.Utils.Button("buttonPOIDelete"+a,null,Z.skinPath,b[127],b[128],b[129],
"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z375");k.appendChild(v.elmt);var U=new Z.Utils.Button("buttonPOICancel"+a,null,Z.skinPath,b[139],b[140],b[141],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z374");k.appendChild(U.elmt);if(Z.fileHandlerProvided){var n=new Z.Utils.Button("buttonPOISave"+a,null,Z.skinPath,b[130],b[131],b[132],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z377");k.appendChild(n.elmt)}var O=g,D=Z.Utils.createContainerElement("div","overlayPOIDisable"+a,"none",
"absolute","visible","1px","1px","0px","0px","none","0px",O,"0px","0px","normal","default",!0);Z.Utils.setOpacity(D,p,m);Ya.appendChild(D)}if(null!==Z.editMode){var C=Z.Utils.createTextElement("labelNameTextElement"+a,"","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.Utils.addEventListener(C.firstChild,"focus",Be);Z.Utils.addEventListener(C.firstChild,"blur",fe);Ya.appendChild(C);if("markup"!=Z.editMode){var Da=document.getElementById("textBoxFor-labelNameTextElement"+
a);Da&&(Da.style.visibility="hidden")}}if("markup"!=Z.editMode){var Ub=Z.Utils.createContainerElement("div","buttonBorderLabel"+a,"inline-block","absolute","visible","1px","1px","0px","0px","solid","1px","transparent","0px","0px","normal","default",!0);Ya.appendChild(Ub)}var P=Z.Utils.createContainerElement("div","buttonContainerLabelModes"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default",!0);Ya.appendChild(P);var A=Z.Utils.createContainerElement("div",
"buttonContainerLabelEdit"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default",!0);Ya.appendChild(A);Z.Utils.addEventListener(P,"mouseover",Z.Toolbar.backgroundEventsHandler);Z.Utils.addEventListener(A,"mouseover",Z.Toolbar.backgroundEventsHandler);var qc=Z.Utils.createContainerElement("div","buttonBorderLg"+a,"inline-block","absolute","hidden","1px","1px","1px","1px","solid","2px","transparent","0px","0px","normal",null,!0);qc.style.borderColor=
Z.Utils.getResource("z87");P.appendChild(qc);bblG=qc;bblgS=bblG.style;var w=new Z.Utils.Button("buttonViewMode"+a,null,Z.skinPath,b[78],b[79],b[80],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z397");P.appendChild(w.elmt);if(Z.fieldOfViewVisible){var E=new Z.Utils.Button("buttonEditModeFieldOfView"+a,null,Z.skinPath,b[82],b[83],b[84],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_EDITMODEFIELDOFVIEW");P.appendChild(E.elmt)}if(Z.textVisible){var H=new Z.Utils.Button("buttonEditModeText"+
a,null,Z.skinPath,b[85],b[86],b[87],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z340");P.appendChild(H.elmt)}if(Z.shapeVisible){var N=new Z.Utils.Button("buttonEditModeShape"+a,null,Z.skinPath,b[88],b[89],b[90],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_EDITMODESHAPE");P.appendChild(N.elmt)}if(Z.freehandVisible){var gb=new Z.Utils.Button("buttonEditModeFreehand"+a,null,Z.skinPath,b[91],b[92],b[93],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z335");P.appendChild(gb.elmt)}if(Z.polygonVisible){var xb=
new Z.Utils.Button("buttonEditModePolygon"+a,null,Z.skinPath,b[94],b[95],b[96],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z338");P.appendChild(xb.elmt)}if(Z.measureVisible){var Ca=new Z.Utils.Button("buttonEditModeMeasure"+a,null,Z.skinPath,b[46],b[47],b[48],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z337");P.appendChild(Ca.elmt)}var I=new Z.Utils.Button("buttonEditColorPicker"+a,null,Z.skinPath,b[97],b[98],b[99],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z334");P.appendChild(I.elmt);
var pb=new Z.Utils.Button("buttonEditLineStyle"+a,null,Z.skinPath,b[124],b[125],b[126],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_EDITMODELINESTYLE");P.appendChild(pb.elmt);var F=Z.Utils.createContainerElement("div","buttonContainerLabelShapes"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default",!1);Ya.appendChild(F);g=Z.Utils.getResource("z83");F.style.display="none";for(var B=Z.Utils.getResource("UI_ANNOTATIONLABELSHAPECHOICELISTTEXT").split(","),
ta=Z.Utils.getResource("UI_ANNOTATIONLABELSHAPECHOICELISTVALUES").split(","),M=0,R=B.length;M<R;M++)yi[yi.length]={text:B[M],value:ta[M]};var Aa=new Z.Utils.createSelectElement("labelShapeList"+a,"",yi,1,1,0,f,"visible",Id,"change","7");F.appendChild(Aa);Aa.style.zIndex=(Z.baseZIndex+19).toString();var fb=Z.Utils.createContainerElement("div","buttonContainerLabelLineStyles"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default",!1);
Ya.appendChild(fb);g=Z.Utils.getResource("z83");fb.style.display="none";for(var Q=Z.Utils.getResource("UI_ANNOTATIONLABELLINESTYLECHOICELISTTEXT").split(","),G=Z.Utils.getResource("UI_ANNOTATIONLABELLINESTYLECHOICELISTVALUES").split(","),M=0,R=Q.length;M<R;M++)labelLineStyleListDP[labelLineStyleListDP.length]={text:Q[M],value:G[M]};var T=new Z.Utils.createSelectElement("labelLineStyleList"+a,"",labelLineStyleListDP,1,1,0,f,"visible",Wd,"change","3");fb.appendChild(T);T.style.zIndex=(Z.baseZIndex+
19).toString();var S=Z.Utils.createContainerElement("div","labelCaptionTextBox"+a,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),J=document.createTextNode(Z.Utils.getResource("z407"));S.appendChild(J);var Qb=Z.Utils.getResource("z35");ug=Z.Utils.createTextElement("captionTextElement"+a,Qb,"1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.Utils.addEventListener(ug.firstChild,"focus",
Be);Z.Utils.addEventListener(ug.firstChild,"input",vg);Z.Utils.addEventListener(ug.firstChild,"blur",fe);Ya.appendChild(S);Ya.appendChild(ug);if("markup"!=Z.editMode){var K=Z.Utils.createContainerElement("div","labelTooltipTextBox"+a,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),Pd=document.createTextNode(Z.Utils.getResource("z413"));K.appendChild(Pd);var ja=Z.Utils.getResource("z38"),La=Z.Utils.createTextElement("tooltipTextElement"+
a,ja,"1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.Utils.addEventListener(La.firstChild,"focus",Be);Z.Utils.addEventListener(La.firstChild,"blur",fe);Ya.appendChild(K);Ya.appendChild(La)}if("markup"!=Z.editMode||Z.clickURLEntryVisible){var dd=Z.Utils.createContainerElement("div","labelClickURLTextBox"+a,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),Y=document.createTextNode(Z.Utils.getResource("z414"));
dd.appendChild(Y);var aa=Z.Utils.getResource("z36"),wb=Z.Utils.createTextElement("clickURLTextElement"+a,aa,"1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.Utils.addEventListener(wb.firstChild,"focus",Be);Z.Utils.addEventListener(wb.firstChild,"blur",fe);Ya.appendChild(dd);Ya.appendChild(wb)}if("markup"!=Z.editMode){for(var W=Z.Utils.getResource("z401").split(","),la=Z.Utils.getResource("z402").split(","),M=0,R=W.length;M<R;M++)labelCaptionPositionListDP[labelCaptionPositionListDP.length]=
{text:W[M],value:la[M]};var X=new Z.Utils.createSelectElement("labelCaptionPositionList"+a,"",labelCaptionPositionListDP,1,1,0,f,"hidden",Dd,"change");Ya.appendChild(X);for(var V=Z.Utils.getResource("z405").split(","),ba=Z.Utils.getResource("z406").split(","),M=0,R=V.length;M<R;M++)labelTargetListDP[labelTargetListDP.length]={text:V[M],value:ba[M]};var Jd=new Z.Utils.createSelectElement("labelTargetList"+a,"",labelTargetListDP,1,1,0,f,"hidden",ge,"change");Ya.appendChild(Jd)}var Rb=Z.Utils.createContainerElement("div",
"labelRolloverTextBox"+a,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),da=document.createTextNode(Z.Utils.getResource("z411"));Rb.appendChild(da);var ka=new Z.Utils.Checkbox("checkboxRollover"+a,"test","1px","1px","1px","1px","click",Md,"z379");Ya.appendChild(Rb);Ya.appendChild(ka);var L=new Z.Utils.Checkbox("checkboxCaptionRollover"+a,"test","1px","1px","1px","1px","click",Vg,"TIP_CAPTIONROLLOVER");Ya.appendChild(L);var bd=Z.Utils.createContainerElement("div",
"labelRolloverGraphicTextBox"+a,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),ea=document.createTextNode(Z.Utils.getResource("UI_ANNOTATIONPANELLABELGRAPHICROLLOVER"));bd.appendChild(ea);Ya.appendChild(bd);var fa=Z.Utils.createContainerElement("div","labelRolloverCaptionTextBox"+a,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),Fa=document.createTextNode(Z.Utils.getResource("z407ROLLOVER"));
fa.appendChild(Fa);Ya.appendChild(fa);var ha=Z.Utils.createContainerElement("div","buttonContainerLabelColors"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default",!0);P.appendChild(ha);var g=Z.Utils.getResource("z83"),sa=Z.Utils.createContainerElement("div","buttonContainerLabelColorsBackground"+a,"inline-block","absolute","visible","1px","1px","0px","0px","solid","1px",g,"0px","0px","normal",null,!0);ha.appendChild(sa);ha.style.display=
"none";var ca=Z.Utils.createContainerElement("div","buttonBorderSm"+a,"inline-block","absolute","hidden","1px","1px","1px","1px","solid","2px","transparent","0px","0px","normal",null,!0);ca.style.borderColor=Z.Utils.getResource("z87");ha.appendChild(ca);bbsM=ca;bbsmS=bbsM.style;var ma=new Z.Utils.Button("buttonColor0"+a,null,Z.skinPath,b[100],b[101],b[102],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z324");ha.appendChild(ma.elmt);var Yb=new Z.Utils.Button("buttonColor1"+a,null,Z.skinPath,
b[103],b[104],b[105],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z325");ha.appendChild(Yb.elmt);var ga=new Z.Utils.Button("buttonColor2"+a,null,Z.skinPath,b[106],b[107],b[108],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z326");ha.appendChild(ga.elmt);var pa=new Z.Utils.Button("buttonColor3"+a,null,Z.skinPath,b[109],b[110],b[111],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z327");ha.appendChild(pa.elmt);var wa=new Z.Utils.Button("buttonColor4"+a,null,Z.skinPath,b[112],b[113],
b[114],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z328");ha.appendChild(wa.elmt);var Jc=new Z.Utils.Button("buttonColor5"+a,null,Z.skinPath,b[115],b[116],b[117],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z329");ha.appendChild(Jc.elmt);var na=new Z.Utils.Button("buttonColor6"+a,null,Z.skinPath,b[118],b[119],b[120],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z330");ha.appendChild(na.elmt);var ua=new Z.Utils.Button("buttonColor7"+a,null,Z.skinPath,b[121],b[122],b[123],"1px",
"1px","1px","1px","mouseover",Z.Toolbar.z457,"z331");ha.appendChild(ua.elmt);if("edit"==Z.editMode){var oa=new Z.Utils.Button("buttonLabelAdd"+a,null,Z.skinPath,b[133],b[134],b[135],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z353");A.appendChild(oa.elmt);var Db=new Z.Utils.Button("buttonLabelEdit"+a,null,Z.skinPath,b[136],b[137],b[138],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z356");A.appendChild(Db.elmt);var ra=new Z.Utils.Button("buttonLabelCancel"+a,null,Z.skinPath,b[139],b[140],
b[141],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z354");A.appendChild(ra.elmt)}if("markup"==Z.editMode){var Qa=Z.Utils.createContainerElement("div","markupPanelDivider","inline-block","absolute","visible","1px","1px","1px","1px","none","0px","grey","0px","0px","normal","default");Ya.appendChild(Qa)}if(Z.fileHandlerProvided&&Z.saveButtonVisible||Z.narrativeMode){var qa=new Z.Utils.Button("buttonLabelDelete"+a,null,Z.skinPath,b[127],b[128],b[129],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,
"z355");A.appendChild(qa.elmt);var Ka=new Z.Utils.Button("buttonLabelSave"+a,null,Z.skinPath,b[130],b[131],b[132],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z357");A.appendChild(Ka.elmt)}if("markup"!=Z.editMode){var O=g,Na=Z.Utils.createContainerElement("div","overlayLabelDisable"+a,"none","absolute","visible","1px","1px","0px","0px","none","0px",O,"0px","0px","normal","default",!0),O=g,Ja=Z.Utils.createContainerElement("div","overlayLabelDetailDisable"+a,"none","absolute","visible","1px",
"1px","0px","0px","none","0px",O,"0px","0px","normal","default",!0),O=g,Ea=Z.Utils.createContainerElement("div","overlayLabelDetailEditableDisable"+a,"none","absolute","visible","1px","1px","0px","0px","none","0px",O,"0px","0px","normal","default",!0),ya=Z.Utils.createTextElement("overlayMessageBox"+a,"","1px","1px","4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null),O=g,Ga=Z.Utils.createContainerElement("div","overlayLabelNameEditableDisable"+a,"none","absolute",
"visible","1px","1px","0px","0px","none","0px",O,"0px","0px","normal","default",!0),O=g,za=Z.Utils.createContainerElement("div","overlayLabelCaptionPositionDisable"+a,"none","absolute","visible","1px","1px","0px","0px","none","0px",O,"0px","0px","normal","default",!0);Z.Utils.setOpacity(Na,p,m);Z.Utils.setOpacity(Ja,p,m);Z.Utils.setOpacity(Ea,p,m);Z.Utils.setOpacity(Ga,p,m);Z.Utils.setOpacity(za,p,m);Ya.appendChild(Na);Ya.appendChild(Ja);Ya.appendChild(Ea);Ya.appendChild(ya);Ya.appendChild(Ga);Ya.appendChild(za);
Z.overlayMessage=document.getElementById("overlayMessageBox"+a);var ia=document.getElementById("textBoxFor-overlayMessageBox"+a);Z.overlayMessage&&ia&&(Z.overlayMessage.value=Z.Utils.getResource("z4SHORT"),Z.Utils.setHTMLTextStyle(Z.overlayMessage,"#666666","verdana","12px","none","normal","normal","normal","normal","1em","center","none"),ia.style.display="none");ha.style.zIndex=(Z.baseZIndex+20).toString();P.style.zIndex=(Z.baseZIndex+22).toString();F.style.zIndex=(Z.baseZIndex+24).toString();Ja.style.zIndex=
(Z.baseZIndex+26).toString();Na.style.zIndex=(Z.baseZIndex+28).toString()}if("markup"!=Z.editMode){var Oa=Z.Utils.createTextElement("noteNameTextElement"+a,"","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.Utils.addEventListener(Oa.firstChild,"focus",Be);Z.Utils.addEventListener(Oa.firstChild,"blur",fe);Ya.appendChild(Oa);var xa=document.getElementById("textBoxFor-noteNameTextElement"+a);xa&&(xa.style.visibility="hidden");var va=Z.Utils.createContainerElement("div",
"buttonContainerNote"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default",!0);Ya.appendChild(va);Z.Utils.addEventListener(va,"mouseover",Z.Toolbar.backgroundEventsHandler);var Ta=new Z.Utils.Button("buttonNoteAdd"+a,null,Z.skinPath,b[133],b[134],b[135],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z364");va.appendChild(Ta.elmt);var ud=new Z.Utils.Button("buttonNoteEdit"+a,null,Z.skinPath,b[136],b[137],b[138],"1px","1px","1px",
"1px","mouseover",Z.Toolbar.z457,"z367");va.appendChild(ud.elmt);var Ha=new Z.Utils.Button("buttonNoteDelete"+a,null,Z.skinPath,b[127],b[128],b[129],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z366");va.appendChild(Ha.elmt);var Sa=new Z.Utils.Button("buttonNoteCancel"+a,null,Z.skinPath,b[139],b[140],b[141],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z365");va.appendChild(Sa.elmt);if(Z.fileHandlerProvided){var Wa=new Z.Utils.Button("buttonNoteSave"+a,null,Z.skinPath,b[130],b[131],b[132],
"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z368");va.appendChild(Wa.elmt)}var O=g,Xa=Z.Utils.createContainerElement("div","overlayNoteDetailDisable"+a,"none","absolute","visible","1px","1px","0px","0px","none","0px",O,"0px","0px","normal","default",!0);Z.Utils.setOpacity(Xa,p,m);var O=g,db=Z.Utils.createContainerElement("div","overlayNoteDisable"+a,"none","absolute","visible","1px","1px","0px","0px","none","0px",O,"0px","0px","normal","default",!0);Z.Utils.setOpacity(db,p,m);Ya.appendChild(Xa);
Ya.appendChild(db)}if(1==Z.helpVisible||2==Z.helpVisible)if("markup"==Z.editMode){var $a=new Z.Utils.Button("buttonHelpMarkup"+a,null,Z.skinPath,b[43],b[44],b[45],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z342MARKUP");A.appendChild($a.elmt)}else if("edit"==Z.editMode){var gf=new Z.Utils.Button("buttonHelpAnnotation"+a,null,Z.skinPath,b[43],b[44],b[45],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"z342ANNOTATION");va.appendChild(gf.elmt)}Uc(e,h);wc();Z.unsavedEditsTest&&Z.Viewer.initializePageExitEventHandler()}
function Uc(h,a){var b=a.toString(),e=new m.calculateAnnotationPanelDimensions(Nf,rd,pf,qf),f=m.calculateAnnotationPanelCoords(Wi,e.w,e.h,ka,ha);m.sizeAndPositionAnnotationPanel(Of,e.w,e.h,f.x,f.y);Z.annotationPanelVisibleState=!(0==Z.annotationPanelVisible||3==Z.annotationPanelVisible||4==Z.annotationPanelVisible||"0"==Wi||Z.zoomRectangle&&!Z.annotations||Z.measureVisible&&null===Z.editMode&&1!=Z.annotationPanelVisible&&2!=Z.annotationPanelVisible&&!Z.narrative||Z.imageSet&&Z.annotationFileShared&&
0==a);Of.display=Z.annotationPanelVisibleState?"inline-block":"none";var p=h[6],g=h[7],k=h[8],l=h[4],r=h[5],q=parseInt(Z.Utils.getResource("z53"),10),u=parseInt(Z.Utils.getResource("z51"),10),v=parseInt(Z.Utils.getResource("z55"),10),U=parseInt(Z.Utils.getResource("z54"),10),n=parseInt(Z.Utils.getResource("z56"),10),O=parseInt(Z.Utils.getResource("z62"),10);parseInt(Z.Utils.getResource("z63"),10);var D=parseInt(Z.Utils.getResource("z64"),10),C=parseInt(Z.Utils.getResource("z72SMALL"),10),P=parseInt(Z.Utils.getResource("z72"),
10),Da=parseFloat(Z.Utils.getResource("z82")),Ub=Z.Utils.getResource("z83"),A=Z.Utils.getResource("z83LIGHT"),qc=Z.Utils.getResource("z83NOALPHA"),w=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONCOMMENTHEIGHT"),10),E=parseInt(Z.Utils.getResource("z59"),10);qf||(w=0);var H=9,N=v-24,gb=0,xb=0,Ca=0;15<p&&(p=15);15<g&&(g=15);22<k&&(k=22);1<l&&(l=1);18<r&&(r=18);var I=e.w-n-p-5,M=Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.SAFARI?2:0,F=0,pb=0,R=0,B=0,ta=0,fb=0,Aa=0,Q=0,G=0;if("edit"==Z.editMode)var T=
0,S=0,J=0,Qb=0,K=0,Pd=0,La=0,ja=0,dd=0,Y=0,aa=0,wb=0;var W=0;if(null===Z.editMode){Nf&&(T=n+4,W=T+18);if(rd||Z.narrative)F=W+4+2,Aa=F+18+4,W=qf?Aa+w:F+18;pf&&(dd=W+4+1,Y=dd+18+4)}else{var la=.75*p,X=.75*g,V=2*la,ba=.5*g,Rb=1.75*n,Jd=e.w-2*n-2,da=7*g+49,L=0,bd=e.w-2*n,I=e.w-n-p-5,ea=I-k,fa=ea-k,Fa=0,ca=0,Id=0,ma=e.w-2*n-3-("edit"==Z.editMode?14:0),Yb=1.8*X,ga=(e.w-ma)/2-1-(Z.narrative?1:0),pa=1.5*g,wa=2*g+2;if("markup"==Z.editMode){H=0;Rb=n+4;v=e.w-2*n;N=v-24;pb=2;R=ba;B=5;Qb=R+g+ba+5;ta=pb+2*g-1;
rShapeList=pb-2;F=pb+18+18;fb=F+15+8;Z.clickURLEntryVisible&&(gb=23);Aa=fb+15+8+gb;qf&&(xb=w+5);Q=fb+15+5+gb+xb;G=ba-5;if(1==Z.helpVisible||2==Z.helpVisible)Ca=k;Fa=4;ja=fb+g+9-2+gb+xb;ca=e.w-p;Id=1;G+=2*g+2}else"edit"==Z.editMode&&(Nf&&(T=n+4,S=T+18-1,J=ba,W=S+pa+4),rd&&(F=W+n,pb=F+18+4+1,R=ba+1,Qb=R+g+ba,B=5,ta=pb+2*g-1,rShapeList=13.5,fb=pb+pa+9+4,Aa=fb+g+9,K=qf?Aa+w+5:fb+g+9,Pd=K+g+9,La=Pd+g+9,ja=La+g+9-3,Q=ja+g+9+5,G=ba-5,W=Q+pa+4-5),pf&&(dd=W+n,Y=dd+18+4+1,aa=Y+E+2,wb=ba))}var Jc=document.getElementById("textBoxFor-labelNameTextElement"+
b),na=document.getElementById("buttonContainerLabelModes"+b);Jc&&na&&(Z.narrativeMode||Z.markupMode||Z.editMode?(Jc.style.display="inline-block",na.style.display="inline-block"):(Jc.style.display="none",na.style.display="none"));var ua=document.getElementById("annotationPanelBackground"+b);if(ua){var oa=ua.style;oa.width=e.w+"px";oa.height=e.h+"px";oa.backgroundColor=Ub;Z.Utils.setOpacity(ua,Da,qc)}if(Nf){var Db=document.getElementById("labelPOITextBox"+b);if(Db&&sa){var va=Db.style;va.width=q-k+
"px";va.height="15px";va.left=n+"px";va.top=T+3+"px";va.visibility="visible";Z.Utils.setTextNodeStyle(Db.firstChild,"black","verdana",O+"px","none","normal","normal","normal","normal","1em","left","none");var ra=sa.style;ra.width=v-k+"px";ra.left=q+"px";ra.top=T+M+"px";ra.visibility="visible";var Na=document.getElementById("buttonPOIGo"+b);if(Na){Z.Utils.buttonSize(Na,p,g);var Qa=Na.style;Qa.left=I+4+"px";Qa.top=T+1+"px"}if(null!==Z.editMode){var qa=document.getElementById("textBoxFor-poiNameTextElement"+
b);if(qa){var Ja=qa.style;Ja.width=N-k+"px";Ja.height="15px";Ja.left=q+"px";Ja.top=T+"px";Z.Utils.setTextAreaStyle(qa,"black","verdana",D+"px","none","normal","normal","normal","normal","1em","left","none",C+"px")}var Ka=document.getElementById("buttonContainerPOI"+b);if(Ka){var Ea=Ka.style;Ea.width=e.w+"px";Ea.height=pa+"px";Ea.left="0px";Ea.top=S+"px"}var Ga=document.getElementById("buttonPOIEdit"+b);if(Ga){Z.Utils.buttonSize(Ga,p,g);var za=Ga.style;za.left=I+"px";za.top=J+"px"}var ia=document.getElementById("buttonPOIAdd"+
b);if(ia){Z.Utils.buttonSize(ia,p,g);var ya=ia.style;ya.left=ea+"px";ya.top=J+"px"}var xa=document.getElementById("buttonPOISave"+b);if(xa){Z.Utils.buttonSize(xa,p,g);var ge=xa.style;ge.left=I+"px";ge.top=J+"px";ge.display="none"}var Ta=document.getElementById("buttonPOICancel"+b);if(Ta){Z.Utils.buttonSize(Ta,p,g);var ud=Ta.style;ud.left=xa?ea+"px":I+"px";ud.top=J+"px";ud.display="none"}var Ha=document.getElementById("buttonPOIDelete"+b);if(Ha){Z.Utils.buttonSize(Ha,p,g);var Xa=Ha.style;Xa.left=xa&&
Ta?fa+"px":xa?ea+"px":I+"px";Xa.top=J+"px";Xa.display="none"}var db=document.getElementById("overlayPOIDisable"+b);if(db){var Sa=db.style;Sa.width=e.w+"px";Sa.height=n+15+g+18+4+"px";Sa.left="0px";Sa.top="0px"}}}}if(rd||Z.narrative){var Wa=document.getElementById("labelLabelTextBox"+b);if(Wa){var $a=Wa.style;$a.width=q+"px";$a.height="15px";$a.left=n+"px";$a.top=F+3+"px";$a.visibility="visible";Z.narrativeMode||($a.display="inline-block");Z.Utils.setTextNodeStyle(Wa,"black","verdana",O+"px","none",
"normal","normal","normal","normal","1em","left","none")}}if(rd||"markup"==Z.editMode){if(Oa){var Ya=Oa.style;Ya.width=v-k+"px";Ya.height="18px";Ya.left="markup"==Z.editMode?n+"px":q+"px";Ya.top=F+"px";Ya.visibility="visible"}var gf=document.getElementById("buttonLabelGo"+b);if(gf){Z.Utils.buttonSize(gf,p,g);var Ua=gf.style;Ua.left=I+4+"px";Ua.top=F+1+"px"}}if("edit"==Z.editMode||"markup"==Z.editMode){if(Jc=document.getElementById("textBoxFor-labelNameTextElement"+b)){var Ba=Jc.style;Ba.width=N-k+
4+"px";Ba.height="15px";Ba.left="markup"==Z.editMode?n+"px":q+"px";Ba.top=F+(Z.narrative?1:0)+"px";Z.Utils.setTextAreaStyle(Jc,"black","verdana",D+"px","none","normal","normal","normal","normal","1em","left","none",C+"px")}var Pa=document.getElementById("buttonBorderLabel"+b);if(Pa){var Ia=Pa.style;Ia.width=Jd+"px";Ia.height=da+"px";Ia.left=n+"px";Ia.top=pb+"px"}if(na=document.getElementById("buttonContainerLabelModes"+b)){var hb=na.style;hb.width=e.w-2+"px";hb.height="markup"==Z.editMode?wa+"px":
.7*wa+"px";hb.left="edit"==Z.editMode?"6px":"0px";hb.top=pb+"px"}var jb=document.getElementById("buttonViewMode"+b);if(jb){L+=Rb-2;Z.Utils.buttonSize(jb,18,18);var bb=jb.style;bb.left=L+"px";bb.top=R+"px"}if("edit"!=Z.editMode){var Ra=document.getElementById("buttonEditModeFieldOfView"+b);if(Ra){L+=k+4-2;Z.Utils.buttonSize(Ra,18,18);var Va=Ra.style;Va.left=L+"px";Va.top=R+"px"}}var kc=document.getElementById("buttonEditModeText"+b);if(kc){L+=k;Z.Utils.buttonSize(kc,18,18);var nb=kc.style;nb.left=
L+"px";nb.top=R+"px"}var Zc=document.getElementById("buttonEditModeShape"+b);if(Zc){L+=k;Z.Utils.buttonSize(Zc,18,18);var mb=Zc.style;mb.left=L+"px";mb.top=R+"px"}var Af=document.getElementById("buttonEditModeFreehand"+b);if(Af){L+=k;Z.Utils.buttonSize(Af,18,18);var kb=Af.style;kb.left=L+"px";kb.top=R+"px"}var lb=document.getElementById("buttonEditModePolygon"+b);if(lb){L+=k;Z.Utils.buttonSize(lb,18,18);var qb=lb.style;qb.left=L+"px";qb.top=R+"px"}var cb=document.getElementById("buttonEditModeMeasure"+
b);if(cb){L+=k;Z.Utils.buttonSize(cb,18,18);var zb=cb.style;zb.left=L+"px";zb.top=R+"px"}var Md=document.getElementById("buttonEditLineStyle"+b);if(Md){L+=k+3;Z.Utils.buttonSize(Md,18,18);var ab=Md.style;ab.left=L+"px";ab.top=R+"px"}var sb=document.getElementById("buttonEditColorPicker"+b);if(sb){L+=k;Z.Utils.buttonSize(sb,18,18);var ub=sb.style;ub.left=L+"px";ub.top=R+"px"}var Dh=document.getElementById("buttonContainerLabelColorsBackground"+b);if(Dh){var ue=Dh.style;ue.width=ma+"px";ue.height=Yb+
"px";ue.left="edit"==Z.editMode?"-5px":"0px";ue.top="0px"}var ib=document.getElementById("buttonContainerLabelColors"+b);if(ib){var Wd=ib.style;Wd.left=Z.narrative?ga+"px":ga-1+"px";Wd.top=Qb+"px"}var Dd=document.getElementById("buttonColor0"+b);if(Dd){L=n+4+1+1-("edit"==Z.editMode?12:0);Z.Utils.buttonSize(Dd,la,X);var Bb=Dd.style;Bb.left=L+"px";Bb.top=B+"px"}var eb=document.getElementById("buttonColor1"+b);if(eb){L+=V;Z.Utils.buttonSize(eb,la,X);var Cb=eb.style;Cb.left=L+"px";Cb.top=B+"px"}var yb=
document.getElementById("buttonColor2"+b);if(yb){L+=V;Z.Utils.buttonSize(yb,la,X);var Ab=yb.style;Ab.left=L+"px";Ab.top=B+"px"}var tb=document.getElementById("buttonColor3"+b);if(tb){L+=V;Z.Utils.buttonSize(tb,la,X);var Jb=tb.style;Jb.left=L+"px";Jb.top=B+"px"}var Hb=document.getElementById("buttonColor4"+b);if(Hb){L+=V;Z.Utils.buttonSize(Hb,la,X);var Nb=Hb.style;Nb.left=L+"px";Nb.top=B+"px"}var Kb=document.getElementById("buttonColor5"+b);if(Kb){L+=V;Z.Utils.buttonSize(Kb,la,X);var Gb=Kb.style;Gb.left=
L+"px";Gb.top=B+"px"}var Eb=document.getElementById("buttonColor6"+b);if(Eb){L+=V;Z.Utils.buttonSize(Eb,la,X);var Sb=Eb.style;Sb.left=L+"px";Sb.top=B+"px"}var Ob=document.getElementById("buttonColor7"+b);if(Ob){L+=V;Z.Utils.buttonSize(Ob,la,X);var Vb=Ob.style;Vb.left=L+"px";Vb.top=B+"px"}var Zb=document.getElementById("buttonBorderLg"+b);if(Zb){var Za=Zb.style;Za.width="18px";Za.height="18px";jb?(Za.left=parseFloat(bb.left)-2+"px",Za.top=parseFloat(bb.top)-2+"px"):Af?(Za.left=parseFloat(kb.left)-
2+"px",Za.top=parseFloat(kb.top)-2+"px"):bEMR?(Za.left=parseFloat(bemrS.left)-2+"px",Za.top=parseFloat(bemrS.top)-2+"px"):lb?(Za.left=parseFloat(qb.left)-2+"px",Za.top=parseFloat(qb.top)-2+"px"):cb&&(Za.left=parseFloat(zb.left)-2+"px",Za.top=parseFloat(zb.top)-2+"px")}var Zg=document.getElementById("buttonBorderSm"+b);if(Zg&&Bb){var Pb=Zg.style;Pb.width=la+"px";Pb.height=X+"px";Pb.left=parseFloat(Bb.left)-2+"px";Pb.top=parseFloat(Bb.top)-2+"px"}}if("edit"==Z.editMode&&rd||"markup"==Z.editMode){var Xb=
document.getElementById("labelCaptionTextBox"+b),bc=document.getElementById("textBoxFor-captionTextElement"+b);if(Xb&&bc){var Mb=Xb.style;Mb.width=q+"px";Mb.height="15px";Mb.left=Rb-Fa+"px";Mb.top=fb+3+"px";Z.Utils.setTextNodeStyle(Xb.firstChild,"black","verdana",O+"px","none","normal","normal","normal","normal","1em","left","none");var Ib=bc.style;Ib.width=e.w-2*n-q-("edit"==Z.editMode?19:7)+"px";Ib.height="15px";Ib.left=Rb+q+"px";Ib.top=fb+"px";Z.Utils.setTextAreaStyle(bc,"black","verdana",D+"px",
"none","normal","normal","normal","normal","1em","left","none",C+"px")}}var ac=document.getElementById("textBoxFor-commentTextElement"+b);if(ac){var fc=e.w-2*n-(null===Z.editMode?2:3),Wb=ac.style;Wb.width=fc+"px";Wb.height=w+"px";Wb.left=n+"px";Wb.top=Aa+"px";Wb.visibility="visible";Z.Utils.setTextAreaStyle(ac,"black","verdana",D+"px","none","normal","normal","normal","normal","1.5em","left","none","0px");var jc=document.getElementById("commentTextElement"+b),n=fc*(1-.98);jc.style.marginLeft=n+"px";
jc.style.width="98%"}if("edit"==Z.editMode&&rd){var Qc=document.getElementById("labelTooltipTextBox"+b),Lb=document.getElementById("textBoxFor-tooltipTextElement"+b);if(Qc&&Lb){var $b=Qc.style;$b.width=q+"px";$b.height="15px";$b.left=Rb-Fa+"px";$b.top=K+3+"px";$b.visibility="visible";Z.Utils.setTextNodeStyle(Qc.firstChild,"black","verdana",O+"px","none","normal","normal","normal","normal","1em","left","none");var vb=Lb.style;vb.width=u+H+"px";vb.height="15px";vb.left=Rb+q-Fa+"px";vb.top=K+"px";Z.Utils.setTextAreaStyle(Lb,
"black","verdana",D+"px","none","normal","normal","normal","normal","1em","left","none",C+"px")}}if("edit"==Z.editMode||Z.clickURLEntryVisible){var hc=document.getElementById("labelClickURLTextBox"+b),ic=document.getElementById("textBoxFor-clickURLTextElement"+b);if(hc&&ic){var Tb=hc.style;Tb.width=Z.clickURLEntryVisible?Ib.width:q+"px";Tb.height="15px";Tb.left=Z.clickURLEntryVisible?Mb.left:Rb+"px";Tb.top=Pd+3+"px";Tb.visibility="visible";Z.Utils.setTextNodeStyle(hc.firstChild,"black","verdana",
O+"px","none","normal","normal","normal","normal","1em","left","none");vb=ic.style;vb.width=Z.clickURLEntryVisible?Ib.width:u+H+"px";vb.height="15px";vb.left=Rb+q+"px";vb.top=Pd+"px";Z.Utils.setTextAreaStyle(ic,"black","verdana",D+"px","none","normal","normal","normal","normal","1em","left","none",C+"px")}}if("edit"==Z.editMode&&rd){var mc=document.getElementById("labelCaptionPositionList"+b);if(mc){var cc=mc.style;cc.width=U+"px";cc.left=Rb+"px";cc.top=La+"px";cc.visibility="visible"}var fd=document.getElementById("labelTargetList"+
b);if(fd){var Mc=fd.style;Mc.width=U+"px";Mc.left=Rb+U+k-p+"px";Mc.top=La+"px";Mc.visibility="visible"}}if("markup"==Z.editMode||Z.narrative||rd){var Fd=document.getElementById("labelRolloverTextBox"+b),dc=document.getElementById("labelRolloverGraphicTextBox"+b),bj=document.getElementById("containerFor-checkboxRollover"+b),nc=document.getElementById("checkboxRollover"+b),gc=document.getElementById("labelRolloverCaptionTextBox"+b),uc=document.getElementById("containerFor-checkboxCaptionRollover"+b),
oc=document.getElementById("checkboxCaptionRollover"+b);if(Fd&&dc&&bj&&nc&&gc&&uc&&oc){var L=n,Fb=Fd.style;Fb.width=q+10+"px";Fb.height="15px";var kf=null!=Z.editMode?7:0;Fb.left=L+kf+"px";Fb.top=ja+3+"px";Fb.visibility="visible";Z.Utils.setTextNodeStyle(Fd.firstChild,"black","verdana",O+"px","none","normal","normal","normal","normal","1em","left","none");var L=L+(q+15),Bc=dc.style;Bc.width=q+"px";Bc.height="15px";kf="edit"==Z.editMode?2:0;Bc.left=L-kf+"px";Bc.top=ja+3+"px";Bc.visibility="visible";
Z.Utils.setTextNodeStyle(dc.firstChild,"black","verdana",O+"px","none","italic","normal","normal","normal","1em","left","none");var L=L+(q-4),pc=bj.style;pc.width=1.5*p+"px";pc.height=1.5*g+"px";kf="edit"==Z.editMode?2:0;pc.left=L-kf+"px";pc.top=ja+"px";nc.width=p;nc.height=g;var L=L+(p+10),ld=gc.style;ld.width=q+"px";ld.height="15px";kf="edit"==Z.editMode?6:0;ld.left=L-kf+"px";ld.top=ja+3+"px";ld.visibility="visible";Z.Utils.setTextNodeStyle(gc.firstChild,"black","verdana",O+"px","none","italic",
"normal","normal","normal","1em","left","none");var L=L+(q-4),ec=uc.style;ec.width=1.5*p+"px";ec.height=1.5*g+"px";kf="edit"==Z.editMode?8:0;ec.left=L-kf+"px";ec.top=ja+"px";oc.width=p;oc.height=g}}if("edit"==Z.editMode&&rd||"markup"==Z.editMode){var Ei=document.getElementById("buttonContainerLabelEdit"+b);if(Ei){var tc=Ei.style;tc.width=e.w+"px";tc.height=pa+"px";tc.left="0px";tc.top=Q+"px"}}if("edit"==Z.editMode&&rd){var Ac=document.getElementById("buttonLabelEdit"+b);if(Ac){Z.Utils.buttonSize(Ac,
p,g);var Nc=Ac.style;Nc.left=I+"px";Nc.top=G+"px"}var Cc=document.getElementById("buttonLabelAdd"+b);if(Cc){Z.Utils.buttonSize(Cc,p,g);var Pc=Cc.style;Pc.left=ea+"px";Pc.top=G+"px"}}if("edit"==Z.editMode&&rd||"markup"==Z.editMode){var kd=document.getElementById("buttonLabelSave"+b);if(kd){Z.Utils.buttonSize(kd,p,g);var sc=kd.style;sc.left=I-Ca+"px";sc.top=G+"px";"markup"!=Z.editMode&&(sc.display="none")}}if("edit"==Z.editMode&&rd){var yc=document.getElementById("buttonLabelCancel"+b);if(yc){Z.Utils.buttonSize(yc,
p,g);var Bh=yc.style;Bh.left=kd?ea+"px":I+"px";Bh.top=G+"px";"markup"!=Z.editMode&&(Bh.display="none")}}if("markup"==Z.editMode){var Xc=document.getElementById("markupPanelDivider");if(Xc){var zc=Xc.style;zc.width=ca-7+"px";zc.height=Id+"px";zc.left="11px";zc.top=ja+g+9+3+"px"}}if("edit"==Z.editMode&&rd||"markup"==Z.editMode){var Kc=document.getElementById("buttonLabelDelete"+b);if(Kc){Z.Utils.buttonSize(Kc,p,g);var Ld=Kc.style;Ld.left=kd&&yc?fa-Ca+"px":kd?ea-Ca+"px":I-Ca+"px";Ld.top=G+"px";"markup"!=
Z.editMode&&(Ld.display="none")}}if("markup"==Z.editMode){var jd=document.getElementById("buttonHelpMarkup"+b);if(jd){Z.Utils.buttonSize(jd,p,g);var $c=jd.style;$c.left=I+"px";$c.top=G+"px"}}if("edit"==Z.editMode&&rd||"markup"==Z.editMode){var Ec=document.getElementById("buttonContainerLabelShapes"+b);if(Ec){var Fc=Ec.style;Fc.left=n/2+"px";Fc.top=ta+"px"}var wc=document.getElementById("labelShapeList"+b);if(wc){var Wc=wc.style;Wc.width=bd+"px";Wc.left=n/2+"px";Wc.top=rShapeList+"px"}var ji=document.getElementById("buttonContainerLabelLineStyles"+
b);if(ji){var ed=ji.style;ed.left=n/2+"px";ed.top=ta+"px"}var Kd=document.getElementById("labelLineStyleList"+b);if(Kd){var Yc=Kd.style;Yc.width=bd+"px";Yc.left=n/2+"px";Yc.top=rShapeList+"px"}}if("edit"==Z.editMode&&rd){var gd=document.getElementById("overlayLabelDisable"+b);if(gd){var Oc=gd.style;Oc.width=e.w+"px";Oc.height=da+2*ba+2*g+8+"px";Oc.left="0px";Oc.top=F+"px"}var hd=document.getElementById("overlayLabelDetailDisable"+b);if(hd&&Ia){var Dc=hd.style;Dc.width=parseFloat(Ia.width)+2+"px";
Dc.height=parseFloat(Ia.height)+2+"px";Dc.left=parseFloat(Ia.left)+"px";Dc.top=parseFloat(Ia.top)+"px";Dc.display="inline-block"}var Rc=document.getElementById("overlayLabelDetailEditableDisable"+b);if(Rc){var vc=Rc.style;vc.width=parseFloat(Ia.width)+"px";vc.height=parseFloat(Ia.height)+"px";vc.left=parseFloat(Ia.left)+1+"px";vc.top=parseFloat(Ia.top)+1+"px"}var md=document.getElementById("overlayMessageBox"+b),nd=document.getElementById("textBoxFor-overlayMessageBox"+b);if(md&&nd){var Lc=nd.style;
Lc.width=Jd-50+"px";Lc.height="25px";Lc.left=parseFloat(Ia.left)+21+"px";Lc.top=parseFloat(Ia.top)+45+"px";Lc.backgroundColor=A;md.style.backgroundColor=A}var pd=document.getElementById("overlayLabelNameEditableDisable"+b);if(pd){var ad=pd.style;ad.width=e.w+"px";ad.height="25px";ad.left="0px";ad.top=F-4+"px"}var sd=document.getElementById("overlayLabelCaptionPositionDisable"+b);if(sd){var Gc=sd.style;Gc.width=e.w/2-12+"px";Gc.height="25px";Gc.left=n+1+"px";Gc.top=parseFloat(cc.top)-4+"px"}}if(pf){var Tc=
document.getElementById("labelNoteTextBox"+b),Uc=document.getElementById("textBoxFor-noteTextElement"+b);if(Tc&&ob&&Uc){var xc=Tc.style;xc.width=q+"px";xc.height="15px";xc.left=n+"px";xc.top=dd+3+"px";xc.visibility="visible";Z.Utils.setTextNodeStyle(Tc.firstChild,"black","verdana",O+"px","none","normal","normal","normal","normal","1em","left","none");var lc=ob.style;lc.width=v+"px";lc.left=q+"px";lc.top=dd+M+"px";lc.visibility="visible";var Eh=e.w-2*n-2,rc=Uc.style;rc.width=Eh+"px";rc.height=E+"px";
rc.left=n+"px";rc.top=Y+"px";rc.visibility="visible";Z.Utils.setTextAreaStyle(Uc,"black","verdana",D+"px","none","normal","normal","normal","normal","1.5em","left","none","0px");var Ad=document.getElementById("noteTextElement"+b),n=Eh*(1-.98);Ad.style.marginLeft=n+"px";Ad.style.width="98%";if(null!==Z.editMode){var Sc=document.getElementById("textBoxFor-noteNameTextElement"+b);if(Sc){var Hc=Sc.style;Hc.width=N+"px";Hc.height="15px";Hc.left=q+"px";Hc.top=dd+"px";Z.Utils.setTextAreaStyle(Sc,"black",
"verdana",D+"px","none","normal","normal","normal","normal","1em","left","none",C+"px")}var Bd=document.getElementById("buttonContainerNote"+b);if(Bd){var Ic=Bd.style;Ic.width=e.w+"px";Ic.height=wa+"px";Ic.left="0px";Ic.top=aa+"px"}var td=document.getElementById("buttonNoteEdit"+b);if(td){Z.Utils.buttonSize(td,p,g);var Cd=td.style;Cd.left=I+"px";Cd.top=wb+"px"}var cd=document.getElementById("buttonNoteAdd"+b);if(cd){Z.Utils.buttonSize(cd,p,g);var Ed=cd.style;Ed.left=ea+"px";Ed.top=wb+"px"}var Vc=
document.getElementById("buttonNoteSave"+b);if(Vc){Z.Utils.buttonSize(Vc,p,g);var Ih=Vc.style;Ih.left=I+"px";Ih.top=wb+"px";Ih.display="none"}var od=document.getElementById("buttonNoteCancel"+b);if(od){Z.Utils.buttonSize(od,p,g);var vd=od.style;vd.left=Vc?ea+"px":I+"px";vd.top=wb+"px";vd.display="none"}var wd=document.getElementById("buttonNoteDelete"+b);if(wd){Z.Utils.buttonSize(wd,p,g);var xd=wd.style;xd.left=Vc&&od?fa+"px":Vc?ea+"px":I+"px";xd.top=wb+"px";xd.display="none"}if("edit"==Z.editMode){var zd=
document.getElementById("buttonHelpAnnotation"+b);if(zd){Z.Utils.buttonSize(zd,p,g);var Gd=zd.style;Gd.left=Rb+"px";Gd.top=wb+"px"}}var Qd=document.getElementById("overlayNoteDetailDisable"+b);if(Qd){var qd=Qd.style;qd.width=parseFloat(rc.width)+2+"px";qd.height=parseFloat(rc.height)+2+"px";qd.left=parseFloat(rc.left)+"px";qd.top=parseFloat(rc.top)+"px";qd.display="inline-block"}var Hd=document.getElementById("overlayNoteDisable"+b);if(Hd){var yd=Hd.style;yd.width=e.w+"px";yd.height=24+E+P+9+g+4+
"px";yd.left="0px";yd.top=dd+"px"}}}}0<a&&(Of.display="none")}function wc(){O("0");m.getStatus("annotationPanelInitializedViewport")||"edit"==Z.editMode&&!document.getElementById("buttonLabelSave"+Ja.toString())||m.setStatus("annotationPanelInitializedViewport",!0)}function sc(){sb&&(sb.width=wa.width,sb.height=wa.height,Cc.width=hb.width,Cc.height=hb.height,Cc.left=hb.left,Cc.top=hb.top,T.restore(),T.save(),T.translate(ad,Dc))}function cd(){if(sb){Z.Utils.clearDisplay(sb);T.save();T.scale(od,od);
var h=Aa(fc,1);T.translate(-(Z.imageX-Z.imageW/2)*h,-(Z.imageY-Z.imageH/2)*h);T.drawImage(za,-za.width/2,-za.height/2,za.width,za.height);T.restore();T.drawImage(wa,-wa.width/2,-wa.height/2,wa.width,wa.height);h=T.getImageData(0,0,sb.width,sb.height);h=Z.Utils.filterImage(h,"grayscale","",void 0);T.putImageData(h,0,0)}}function xc(h,a){("undefined"===typeof h||null===h)&&"undefined"!==typeof wg&&null!==wg&&0<wg.length&&(h=wg);if("undefined"===typeof a||null===a)a=!1;if("undefined"!==typeof h&&null!==
h&&0<h.length){wg=h.slice(0);for(var b=0,e=A.length;b<e;b++){var f=A[b],p=a?f.internalID:f.id,g=Z.Utils.arrayMap(h,String);if(-1!=Z.Utils.arrayIndexOf(g,p))if(Z.useCanvas){if(f.visibility||f.rollover||rollover){T.save();T.globalCompositeOperation="xor";T.translate((f.x-Z.imageX)*Z.imageZ,(f.y-Z.imageY)*Z.imageZ);T.lineWidth=1E-6;T.strokeStyle=f.lineColor;T.globalAlpha=1;var g=Ia/pd,k=m.getZoom(),p=f.xScale/100/g*k,g=f.yScale/100/g*k;1!=p&&1!=g&&T.scale(p,g);p=f.x;g=f.y;T.beginPath();if("shape"!=f.mediaType&&
"undefined"!==typeof f.polygonPts&&null!==f.polygonPts&&0<f.polygonPts.length){var k=f.polygonPts.slice(0),l=k[0].x-p,r=k[0].y-g;T.moveTo(l,r);for(var q=1,n=k.length;q<n;q++)T.lineTo(k[q].x-p,k[q].y-g);"freehand"!=f.mediaType&&f.polyClosed&&(T.lineTo(l,r),T.closePath())}else k=100/f.z*f.w*Z.maskScale,l=100/f.z*f.h*Z.maskScale,p=0,g=-1==f.media.indexOf("triangle")?0:.23*f.h,k=Math.max(k,l)/2*1.2,T.arc(p,g,k,0,2*Math.PI);T.fill();T.restore();Z.maskBorder&&!f.polygonPts&&(T.save(),T.translate((f.x-Z.imageX)*
Z.imageZ,(f.y-Z.imageY)*Z.imageZ),T.lineWidth=3,T.globalAlpha=1,T.strokeStyle="#000000",T.stroke(),T.lineWidth=2,T.strokeStyle="#ffffff",T.stroke(),T.restore())}}else bi||(Z.Utils.showMessage(Z.Utils.getResource("z9")),bi=!0)}}}function tf(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h),b=Z.Utils.relatedTarget(h),e=ub(a),f=m.getZoom(),p=Z.Utils.getMousePosition(h);h=m.getClickCoordsInImage(h,f,p);null!=ab(h,Z.labelMode)||null===e||null===b||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||
"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||(a.style.cursor="all-scroll")}}function ce(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);null===ub(a)||null===h||"captionTextBox"==h.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||(a.style.cursor="pointer")}}function uf(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);
var b=ub(a);null===b||null===h||"captionTextBox"==h.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||m.setHotspotVisibility(b,!0)}}function vf(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);var b=ub(a);null===b||null===h||"captionTextBox"==h.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||
m.setHotspotVisibility(b,!1)}}function sg(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);var b=ub(a);null===b||null===h||"captionTextBox"==h.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||m.setHotspotCaptionVisibility(b,!0)}}function dc(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);var b=ub(a);null===b||null===h||"captionTextBox"==h.id&&
-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||m.setHotspotCaptionVisibility(b,!1)}}function Hc(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);var b=ub(a);null===b||null===h||"captionTextBox"==h.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||m.setHotspotPopupVisibility(b,
!0)}}function ye(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);var b=ub(a);null===b||null===h||"captionTextBox"==h.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||m.setHotspotPopupVisibility(b,!1)}}function tg(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);var b=ub(a);null===b||null===h||"captionTextBox"==h.id&&-1!=a.id.indexOf("hot")&&
-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||(a=b.id.substring(3,b.id.length),m.setLabelHighlightByDisplayID(a,!0))}}function wf(h){if(h=Z.Utils.event(h)){var a=Z.Utils.target(h);h=Z.Utils.relatedTarget(h);var b=ub(a);null===b||null===h||"captionTextBox"==h.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||"captionTextBox"==a.id&&-1!=h.id.indexOf("hot")&&-1==h.id.indexOf("hotspotDisplay")||(a=b.id.substring(3,
b.id.length),m.clearLabelHighlightByID(!1,a))}}function Uf(h){if(h=Z.Utils.event(h))Z.clickZoomAndPanBlock=!0}function Vf(h){if(h=Z.Utils.event(h))Z.clickZoomAndPanBlock=!0}function xe(h){(h=Z.Utils.event(h))&&!h.altKey&&(h=Z.Utils.target(h),h=ub(h),h=h.id.substring(3,h.id.length),Z.Utils.arrayIndexOfObjectValue(A,"internalID",h),h=Z.Utils.getResource("z3"),Z.Utils.showMessage(h,!0,null,"center",!0))}function be(h){(h=Z.Utils.event(h))&&!h.altKey&&(h=Z.Utils.target(h),h=ub(h),h=h.id.substring(3,h.id.length),
Z.Utils.arrayIndexOfObjectValue(A,"internalID",h),h=Z.Utils.getResource("z3"),Z.Utils.showMessage(h,!0,null,"center",!0))}function df(h){var a=h.type,b=Z.Utils.target(h);b&&(b=ub(b),ea=b.id.substring(3,b.id.length));"touchstart"==a?(h=Z.Utils.getFirstTouch(h),"undefined"!==typeof h&&(zi=new Z.Utils.Point(h.pageX,h.pageY),Ai=(new Date).getTime())):"touchmove"==a?(h=Z.Utils.getFirstTouch(h),"undefined"!==typeof h&&(ci=new Z.Utils.Point(h.pageX,h.pageY))):(zi=Z.Utils.getMousePosition(h),Ai=(new Date).getTime())}
function Ne(h){var a=h.type;"touchend"==a||"touchcancel"==a?(a=Z.Utils.getFirstTouch(h),"undefined"!==typeof a?ci=new Z.Utils.Point(a.pageX,a.pageY):null!==Ai&&(new Date).getTime()-Ai<di&&(ci=zi,Ai=null)):ci=Z.Utils.getMousePosition(h);a=Z.Utils.calculatePointsDistance(zi.x,zi.y,ci.x,ci.y);h=h?h.altKey:null;a<ol&&!h&&(h=Z.Viewport.getTargetHotspot(this),h=h.id.substring(3,h.id.length),h=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h),-1!=h&&(h=unescape(A[h].urlTarget),h=new Function(h),window.setTimeout(h,
200)))}function xf(h){Z.Utils.removeEventListener(mb,"mousedown",xf);if(!Z.hotspotListTitle||!Z.Utils.stringValidate(Z.hotspotListTitle)||"none"==Z.hotspotListTitle)if(h=Z.Utils.getResource("UI_LISTMOUSEDOWNTEXT"),mb.options[0].text!=h){var a=document.createElement("option");a.text=h;a.value=null;mb.add(a,0)}mb.selectedIndex=0;Z.Utils.addEventListener(mb,"change",r)}function r(h){if(h=Z.Utils.event(h))Z.tourPlaying&&m.tourStop(),h=Z.Utils.target(h),h=h.options[h.selectedIndex].value,isNaN(parseInt(h),
10)||(h=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h),-1!=h&&((h=A[h])&&Z.maskVisible&&m.setHotspotMaskByID(h.id,!1),ea=h.internalID,Z.Utils.playAudio(Bi,h.audio),m.zoomAndPanToView(h.x,h.y,h.z/100,h.rotation))),Z.Utils.removeEventListener(mb,"change",r),window.setTimeout(function(){Z.Utils.addEventListener(mb,"mousedown",xf)},10)}function O(h,a,b){db.sort(ec);Z.Utils.updateSelectElement(sa,db,h);if("undefined"===typeof h||null===h)0==sa.options.length&&(h=Z.Utils.getResource("z27"),Ud("0",h,
"center","center","-1","0","1"),ei="0"),h="0";else{var e=Z.Utils.arrayIndexOfObjectValue(db,"value",h);-1!=e&&(h=db[e].value)}var f=Ja.toString(),e=Z.Utils.arrayIndexOfObjectValue(db,"value",h);(f=document.getElementById("poiNameTextElement"+f))&&-1!=e&&(f.value=db[e].text);Da(h,a);"markup"!=Z.editMode&&Rb(h,b)}function Da(h,a,b){Ta.sort(ec);Sb="markup"==Z.editMode||Z.annotationXMLAperioLoad?Z.Utils.arrayClone("labels",Ta,Sb):Wf(Ta,h);Z.Utils.updateSelectElement(Oa,Sb,a);if("undefined"===typeof a||
null===a)a=Oa&&0<Oa.options.length?Oa.options[0].value:null;pb(a,b);Z.Utils.validateCallback("labelListUpdated")}function pb(h,a){var b=Ja.toString();ea=h;Xf=null;var e=Z.Utils.arrayIndexOfObjectValue(A,"internalID",ea);ba=-1!=e?A[e]:null;var f=!m.getLabelEditable(ea);if(qf){var p=document.getElementById("commentTextElement"+b);if(p){var g="undefined"!==sa&&null!==sa&&0<sa.options.length&&sa.options[sa.selectedIndex].text!=Z.Utils.getResource("UI_LISTMOUSEDOWNTEXT")&&"undefined"===typeof Ta||null===
Ta.length||0==Ta.length;p.value="markup"==Z.editMode&&g?Z.Utils.getResource("CONTENT_LABELCOMMENTMARKUPNOLABELS"):"";null!==ba&&(g=ba.comment,null!==g&&Z.Utils.stringValidate(g)&&(p.value=g),p.readOnly=f)}}if(null!==Z.editMode){if(p=document.getElementById("labelNameTextElement"+b))p.value=null!==ba?ba.name:"",p.readOnly=f;if(p=document.getElementById("captionTextElement"+b))p.value="",null!==ba&&(g=ba.captionHTML,"undefined"!==typeof g&&Z.Utils.stringValidate(g)?p.value=g:p.value=ba.caption,p.readOnly=
f);if(Z.narrative||!("markup"==Z.editMode||a||"addLabel"==Z.editing&&Ak)){f=document.getElementById("labelShapeList"+b);p=document.getElementById("checkboxRollover"+b);g=document.getElementById("checkboxCaptionRollover"+b);if(f&&p&&g&&(p.checked=!1,g.checked=!1,null!==ba)){if("shape"==ba.mediaType){var e=ba.media,k=!1,l=!1;Z.Utils.stringValidate(e)&&(k=-1!=e.indexOf("/circle.")||-1!=e.indexOf("/square.")||-1!=e.indexOf("/triangle.")||-1!=e.indexOf("/arrowDownLeft.")||-1!=e.indexOf("/arrowDownRight.")||
-1!=e.indexOf("/arrowUpLeft.")||-1!=e.indexOf("/arrowUpRight.")||-1!=e.indexOf("/arrowUp.")||-1!=e.indexOf("/arrowDown.")||-1!=e.indexOf("/arrowLeft.")||-1!=e.indexOf("/arrowRight.")||-1!=e.indexOf("/lineHorizontal.")||-1!=e.indexOf("/lineVertical."),l="fov"==e||"arrow"==e||"line"==e||"square"==e||"rectangle"==e||"circle"==e||"ellipse"==e||"triangle"==e||"polygon"==e||"counter"==e||"polyLine"==e);var r=null;l?r=e:k&&(k=e.lastIndexOf("/")+1,l=e.lastIndexOf("."),-1!=k&&-1!=l&&(r=e.substring(k,l).toLowerCase()));
r&&(e=Z.Utils.arrayIndexOfObjectValueSubstring(f,"value",r,null,!0),-1!=e&&(f.selectedIndex=e))}p.checked=1==ba.rollover;g.checked=1==ba.rolloverCaption}p=document.getElementById("tooltipTextElement"+b);g=document.getElementById("labelCaptionPositionList"+b);f=document.getElementById("labelTargetList"+b);p&&g&&f&&(p.value="",g.selectedIndex=0,f.selectedIndex=0,null!==ba&&(e=ba.captionPosition,Z.Utils.stringValidate(e)&&(e=Z.Utils.arrayIndexOfObjectValue(g,"value",e),-1!=e&&(g.selectedIndex=e)),g=
ba.tooltipHTML,"undefined"!==typeof g&&Z.Utils.stringValidate(g)?p.value=g:p.value=ba.tooltip,p=ba.urlTarget,Z.Utils.stringValidate(p)&&(e=Z.Utils.arrayIndexOfObjectValue(f,"value",p),-1!=e&&(f.selectedIndex=e))))}(Z.clickURLEntryVisible||Z.narrative||!("markup"==Z.editMode||a||"addLabel"==Z.editing&&Ak))&&(b=document.getElementById("clickURLTextElement"+b))&&null!==ba&&(b.value="",f=ba.clickURL,Z.Utils.stringValidate(f)&&(b.value=f))}null!==ba&&(ea=ba.internalID);ea!=xg&&Z.Viewer.getStatus("readyViewer")&&
Z.Utils.validateCallback("currentLabelChangedGetID");Zb?Tb():Eb()}function Rb(h,a){if(ob){zb.sort(ec);yc=Wf(zb,h);Z.Utils.updateSelectElement(ob,yc,a);if("undefined"===typeof a||null===a)a=null,ob.selectedIndex=0,0<ob.options.length&&(a=ob.options[0].value);ud(a)}}function ud(h){var a=Ja.toString();h=Z.Utils.arrayIndexOfObjectValue(yc,"value",h);if(null!==Z.editMode){var b=document.getElementById("noteNameTextElement"+a);b&&(b.value=-1!=h?yc[h].text:"")}if(a=document.getElementById("noteTextElement"+
a))a.value=-1!=h?yc[h].noteText:""}function Jd(h){if(h=Z.Utils.event(h))h=Z.Utils.target(h),(h=h.options[h.selectedIndex].value)&&!isNaN(parseInt(h),10)&&(m.saveEditsPOI(!0),O(h))}function Jc(h){if(h=Z.Utils.event(h))if(h=Z.Utils.target(h),(h=h.options[h.selectedIndex].value)&&!isNaN(parseInt(h,10))){m.saveEditsLabel(!0,!1,!1);pb(h);ea=h;he=!0;h=Z.Utils.arrayIndexOfObjectValue(A,"internalID",ea);if(ba=-1!=h?A[h]:null)"shape"==ba.mediaType&&ba.polygonPts&&(ba.polygonPts=[]),Z.maskVisible&&(Z.Utils.arrayClear(wg),
wg[wg.length]=ba.id,m.setHotspotMaskByIDList(wg,!1));null===Z.editing||Z.narrative&&!Z.narrativeMode||(ba.editable?m.setEditModeLabel(ba.mediaType,!0,ba.media,!0):m.setEditModeLabel("view"))}}function Id(h){m.toggleLabelShapePicker(!1);h=Z.Utils.event(h);h=Z.Utils.target(h);h=h[h.selectedIndex].value;"view"==Z.labelMode||null===Z.editing||Z.narrative&&!Z.narrativeMode||m.setEditModeLabel(Z.labelMode);null===ea||"view"==Z.labelMode||"edit"!=Z.editMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing||
(h=Z.labelShapesInternal?h:Fd+"/"+h,m.modifyLabel(ea,"mediaType","shape",!0,!0),m.modifyLabel(ea,"media",h,!1,!0))}function Wd(h){m.toggleLabelLineStylePicker(!1);h=Z.Utils.event(h);h=Z.Utils.target(h);h=h[h.selectedIndex].value;"view"==Z.labelMode||null===Z.editMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing||m.modifyLabel(ea,"lineStyle",h,!1,!0)}function Dd(h){if(h=Z.Utils.event(h))if(h=Z.Utils.target(h))h=labelCaptionPositionListDP[h.selectedIndex].value,"shim"!==h&&m.modifyLabel(ea,"captionPosition",
h,!1,!0)}function ge(h){if(h=Z.Utils.event(h))if(h=Z.Utils.target(h))h=labelTargetListDP[h.selectedIndex].value,"shim"!==h&&m.modifyLabel(ea,"urlTarget",h,!1,!0)}function Md(h){(h=Z.Utils.event(h))&&(h=Z.Utils.target(h))&&m.modifyLabel(ea,"rollover",h.checked,!1,!0)}function Vg(h){(h=Z.Utils.event(h))&&(h=Z.Utils.target(h))&&m.modifyLabel(ea,"rolloverCaption",h.checked,!1,!0)}function Wg(h){(h=Z.Utils.event(h))&&(h=Z.Utils.target(h))&&(h=h.options[h.selectedIndex].value)&&!isNaN(parseInt(h,10))&&
(m.saveEditsNote(!0),ud(h))}function Be(h){if(h=Z.Utils.event(h))if(h=Z.Utils.target(h))yg(h.id),Z.Viewer.initializeViewerKeyEventListeners(!1),Z.Utils.removeEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.removeEventListener(document,"keyup",Z.Utils.preventDefault)}function vg(h){if(h=Z.Utils.event(h))if(h=Z.Utils.target(h)){var a=Z.viewportCurrentID;h.id=="captionTextElement"+(Z.annotationFileShared?"0":a)&&(property=(a=h.value)&&-1!=a.indexOf("<CAPTION>")?"captionHTML":"caption",
null!==property&&m.setHotspotCaptionInHTMLByID(ea,h.value))}}function fe(h){if(h=Z.Utils.event(h)){if(h=Z.Utils.target(h)){var a=Z.viewportCurrentID,b=Z.annotationFileShared?"0":a;if(0==Oa.options.length&&(h.id=="labelNameTextElement"+b||h.id=="captionTextElement"+b||h.id=="tooltipTextElement"+b||h.id=="clickURLTextElement"+b)){Z.Utils.showMessage(Z.Utils.getResource("z4"),!0,Z.messageDurationLong,"center",!0);return}a=null;switch(h.id){case "poiNameTextElement"+b:b=sa.selectedIndex;db[b].text=h.value;
b=sa[b].value;db.sort(ec);Z.Utils.updateSelectElement(sa,db,b);break;case "labelNameTextElement"+b:b=Oa.selectedIndex;Sb[b].text=h.value;b=Oa[b].value;if("undefined"===typeof e||null===e)e="0";e=Z.Utils.arrayIndexOfObjectTwoValues(Ta,"poiID",e,null,"value",b);-1!=e&&(Ta[e].text=h.value,Z.Utils.validateCallback("labelListUpdated"));Ta.sort(ec);Sb.sort(ec);Z.Utils.updateSelectElement(Oa,Sb,b);e=Z.Utils.arrayIndexOfObjectValue(A,"internalID",ea);-1!=e&&(A[e].name=h.value);break;case "captionTextElement"+
b:a=(a=h.value)&&-1!=a.indexOf("<CAPTION>")?"captionHTML":"caption";break;case "commentTextElement"+b:b=Z.Utils.arrayIndexOfObjectValue(A,"internalID",ea);-1!=b&&(A[b].comment=h.value);break;case "tooltipTextElement"+b:a=(a=h.value)&&-1!=a.indexOf("<TOOLTIP>")?"tooltipHTML":"tooltip";break;case "clickURLTextElement"+b:a="clickURL";break;case "noteNameTextElement"+b:b=ob.selectedIndex;yc[b].text=h.value;var e=yc[b].poiID,b=yc[b].value,e=Z.Utils.arrayIndexOfObjectTwoValues(zb,"poiID",e,null,"value",
b);-1!=e&&(zb[e].text=h.value);zb.sort(ec);yc.sort(ec);Z.Utils.updateSelectElement(ob,yc,b);break;case "noteTextElement"+b:b=ob.selectedIndex,yc[b].noteText=h.value,e=yc[b].poiID,b=yc[b].value,e=Z.Utils.arrayIndexOfObjectTwoValues(zb,"poiID",e,null,"value",b),-1!=e&&(zb[e].noteText=h.value)}null!==a&&Z.viewportCurrent.modifyLabel(ea,a,h.value,!1,!0)}Z.Viewer.initializeViewerKeyEventListeners(!0);Z.Viewer.initializeViewerKeyDefaultListeners(!0)}}function yg(h){var a=Ja.toString();if("markup"==Z.editMode){var b=
document.getElementById("labelNameTextElement"+a),e=document.getElementById("captionTextElement"+a),f=document.getElementById("commentTextElement"+a),p=f?1:0;if(b&&e)switch(h){case "labelNameTextElement"+a:b.tabIndex=1;e.tabIndex=2;f&&(f.tabIndex=3);break;case "captionTextElement"+a:b.tabIndex=3;e.tabIndex=1;f&&(f.tabIndex=2);break;case "commentTextElement"+a:b.tabIndex=2,e.tabIndex=3,f&&(f.tabIndex=1)}}else if(null!==Z.editMode){var p=document.getElementById("poiNameTextElement"+a),b=document.getElementById("labelNameTextElement"+
a),e=document.getElementById("captionTextElement"+a),f=document.getElementById("commentTextElement"+a),g=document.getElementById("tooltipTextElement"+a),m=document.getElementById("clickURLTextElement"+a),k=document.getElementById("noteNameTextElement"+a),a=document.getElementById("noteTextElement"+a);p&&(p.tabIndex="");b&&(b.tabIndex="");e&&(e.tabIndex="");f&&(f.tabIndex="");g&&(g.tabIndex="");m&&(m.tabIndex="");k&&(k.tabIndex="");a&&(a.tabIndex="");switch(h){case "poi":p.tabIndex=1;break;case "label":p=
f?1:0;b.tabIndex=1;e.tabIndex=2;f&&(f.tabIndex=3);g.tabIndex=3+p;m.tabIndex=4+p;break;case "note":k.tabIndex=1;a.tabIndex=2;break;case "noteNameTextElement":k.tabIndex=1;a.tabIndex=2;break;case "noteTextElement":k.tabIndex=2;a.tabIndex=1;break;case "clickURLTextElement":b.tabIndex=2;e.tabIndex=3;g.tabIndex=4;m.tabIndex=1;break;default:b.tabIndex=1,e.tabIndex=2,g.tabIndex=3,m.tabIndex=4}}}function Wf(h,a){for(var b=[],e=0,f=h.length;e<f;e++)h[e].poiID==a&&(b[b.length]=h[e]);return b}function Me(h,
a,b,e,f,p,g){var k=h.media,l=h.mediaType,r=!1,q=!1;Z.Utils.stringValidate(k)&&(r=-1!=k.indexOf("/circle.")||-1!=k.indexOf("/square.")||-1!=k.indexOf("/triangle.")||-1!=k.indexOf("/arrowDownLeft.")||-1!=k.indexOf("/arrowDownRight.")||-1!=k.indexOf("/arrowUpLeft.")||-1!=k.indexOf("/arrowUpRight.")||-1!=k.indexOf("/arrowUp.")||-1!=k.indexOf("/arrowDown.")||-1!=k.indexOf("/arrowLeft.")||-1!=k.indexOf("/arrowRight.")||-1!=k.indexOf("/lineHorizontal.")||-1!=k.indexOf("/lineVertical."),q="fov"==k||"arrow"==
k||"line"==k||"square"==k||"rectangle"==k||"circle"==k||"ellipse"==k||"triangle"==k||"polygon"==k||"counter"==k||"polyLine"==k);l=("counter"==l||"shape"==l)&&(!k||"External Graphics File"!=k)&&(q||r&&Z.labelShapesInternal);if(Z.useCanvas&&(l||e)){if(h.visibility||h.rollover||b)if(b=(l="shape"==Z.labelMode&&("addLabel"==Z.editing||"editLabel"==Z.editing)&&h.internalID==ea&&1==h.editable&&!e&&!f)?na:e?T:f?ra:kg){b.save();b.translate((h.x-(p?Z.imageW/2:Z.imageX))*Z.imageZ,(h.y-(p?Z.imageH/2:Z.imageY))*
Z.imageZ);q=a.currentZ/(h.z/100);r=q/(Ia/pd);Z.annotationXMLAperioLoad&&(r=r*h.z/100);a=h.xScale/100*r;r*=h.yScale/100;1!=a&&1!=r&&b.scale(a,r);e?b.lineWidth=1E-6:(Z.annotationXMLAperioLoad?(e=vj/(2*Z.imageZ),b.lineWidth=h.lineVisible?10>e?10:e:0):(e=vj/q,b.lineWidth=h.lineVisible?8>e?e:8:0),b.fillStyle=h.fillColor);b.strokeStyle=h.lineColor;b.globalAlpha=1;e=h.w;q=h.h;y=x=0;var n=h.rotation?h.rotation:0;l||yf||!h.highlight||(h.rollover&&(h.rolloverPrior=!0,h.rollover=!1),m.drawHighlight(b,k,e,q,
x,y,n,null,null,null,null,h));m.drawShape(b,k,e,q,x,y,n,h.lineColor,h.lineStyle,h.fillColor,h.fillVisible);l&&(k=m.getZoom(),m.drawShapeEditor(h,b,e,q,x,y,k,n,1/((a+r)/2)));b.restore();a=new yb;k=h.internalID;f?ia(h,a,g,null,null,!0,p):Z.mouseIsDown&&"undefined"!==typeof k&&null!==k&&"undefined"!==typeof g&&!Zb&&ae(h,a,g,!0);b.restore()}f&&sd()}}function cf(h,a,b,e,f,p,g){if(Z.useCanvas&&("polygon"==h.media||e)){if(h.visibility||h.rollover||b){b=h.internalID;if("undefined"!==typeof h.polygonPts&&
null!==h.polygonPts&&0<h.polygonPts.length||e){g=e?T:b===ea||f?f?ra:na:kg;g.save();g.translate((h.x-(p?Z.imageW/2:Z.imageX))*Z.imageZ,(h.y-(p?Z.imageH/2:Z.imageY))*Z.imageZ);var k=Ia/pd,l=m.getZoom(),r=(h.xScale+h.yScale)/2/100,q=h.xScale/100/k*l,k=h.yScale/100/k*l;1!=q&&1!=k&&g.scale(q,k);e?g.lineWidth=1E-6:"freehand"==h.mediaType?g.lineWidth=Bk/l:(Z.annotationXMLAperioLoad?(q=vj/(2*Z.imageZ),g.lineWidth=h.lineVisible?15>q?15:q:0):g.lineWidth=h.lineVisible?Ck/l/r:0,g.fillStyle=h.fillColor);q=h.lineColor==
Z.Utils.getResource("CONTENT_LABELLINECOLOR");g.strokeStyle="measure"==h.mediaType&&q?"#000000":h.lineColor;q=h.x;k=h.y;g.beginPath();if(h.polygonPts){var n=h.polygonPts.slice(0);"measure"!=Z.labelMode||h.polyClosed||he||"undefined"===typeof a||null===a||(n[n.length]={x:a.x,y:a.y});!yf&&h.highlight&&m.drawHighlight(g,null,null,null,q,k,null,null,null,null,null,h,n,e);zg(g,h,n,q,k,e)}else{var u=100/h.z*h.w,v=100/h.z*h.h,q=0,k=-1==h.media.indexOf("triangle")?0:.23*h.h,u=Math.max(u,v)/2*1.2;g.arc(q,
k,u,0,2*Math.PI);g.stroke()}if(!e&&"view"!=Z.labelMode&&(null===Z.editMode&&"measure"==Z.labelMode||"addLabel"==Z.editing||"editLabel"==Z.editing)&&("shape"==Z.labelMode&&4==n.length||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&h.internalID==ea&&"undefined"!==typeof h&&null!==h&&"freehand"!=h.mediaType&&(!Z.narrative||Z.narrativeMode))for(l=1/l/r,r=0,u=n.length;r<u;r++)Oe(n[r].x-q,n[r].y-k,!he&&0==r,l);g.restore()}f?(e=new yb,ia(h,e,a,null,null,!0,p)):!Z.mouseIsDown||e&&"polygon"!=h.media||"undefined"===
typeof b||null===b||"undefined"===typeof a||Zb||Fb(b,a,f,p)}f&&sd()}else bi||(Z.Utils.showMessage(Z.Utils.getResource("z9")),bi=!0)}function zg(h,a,b,e,f,p){var g=b[0].x-e,k=b[0].y-f;h.moveTo(g,k);for(var l=1,r=b.length;l<r;l++)h.lineTo(b[l].x-e,b[l].y-f);"freehand"!=a.mediaType&&(a.polyClosed||Z.mouseIsDown&&0==Xf)&&(a.polyClosed&&(h.lineTo(g,k),h.closePath()),!p&&a.fillVisible&&(a.polyClosed||a.internalID&&ea&&a.internalID!=ea)&&(h.globalAlpha=pl,h.fill()),h.globalAlpha=1);h.stroke();if("measure"==
a.mediaType&&2==a.polygonPts.length){b=a.polygonPts[0].x-e;p=a.polygonPts[0].y-f;e=a.polygonPts[1].x-e;a=a.polygonPts[1].y-f;var l=20/m.getZoom(),q=Math.atan2(a-p,e-b),n=Math.PI/2,r=q+n;f=b+Math.cos(r)*l/2;var g=p+Math.sin(r)*l/2,k=e+Math.cos(r)*l/2,r=a+Math.sin(r)*l/2,u=q-n,q=b+Math.cos(u)*l/2,n=p+Math.sin(u)*l/2,v=e+Math.cos(u)*l/2,l=a+Math.sin(u)*l/2;h.save();h.beginPath();h.moveTo(q,n);h.lineTo(b,p);h.lineTo(f,g);h.stroke();h.beginPath();h.moveTo(v,l);h.lineTo(e,a);h.lineTo(k,r);h.stroke();h.restore()}}
function Oe(h,a,b,e,f){var p=$i*e;na.save();na.setLineDash([]);na.lineWidth=ql*e;na.strokeStyle=rl;na.fillStyle=b?sl:tl;na.beginPath();na.arc(h,a,p,0,2*Math.PI,!1);na.closePath();na.globalAlpha=.5;"undefined"!==typeof f&&null!==f&&(na.fillStyle=0==f?"white":1==f?"red":2==f?"blue":"yellow");na.fill();na.globalAlpha=1;na.stroke();na.restore()}function Ce(h,a,b){Z.Utils.clearDisplay(tb);Dk();var e=Z.Utils.arrayIndexOfObjectValue(A,"internalID",ea);if(-1!=e){e=A[e];cf(e);var f=m.getZoom(),p=e.polygonPts;
if(p){var g=p[p.length-1],p=(g.x-Z.imageX)*f,f=(g.y-Z.imageY)*f;e.polyClosed||(na.lineWidth=Ck,na.strokeStyle=zh,na.beginPath(),na.moveTo(p,f),na.lineTo(h,a),na.closePath(),na.stroke())}"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||null===ea||Fb(ea,b)}}function Tb(h){Wb&&Z.Utils.clearDisplay(Wb);tb&&Z.Utils.clearDisplay(tb);if("inline-block"==jc.display)for(var a=new yb,b=0,e=A.length;b<e;b++){var f=A[b],p=Math.round(100*a.currentZ),g=-1==f.zMin?Math.round(100*Z.initialZ):Math.round(f.zMin),m=-1==
f.zMax?Math.round(100*Z.initialZ):Math.round(f.zMax);if((0==g||g<=p)&&(0==m||m>=p)&&(g=f.media,m=f.mediaType,-1!=g.indexOf("/circle.")||-1!=g.indexOf("/square.")||-1!=g.indexOf("/triangle.")||-1!=g.indexOf("/arrowDownLeft.")||-1!=g.indexOf("/arrowDownRight.")||-1!=g.indexOf("/arrowUpLeft.")||-1!=g.indexOf("/arrowUpRight.")||-1!=g.indexOf("/arrowUp.")||-1!=g.indexOf("/arrowDown.")||-1!=g.indexOf("/arrowLeft.")||-1!=g.indexOf("/arrowRight.")||-1!=g.indexOf("/lineHorizontal.")||g.indexOf("/lineVertical."),
p="fov"==g||"arrow"==g||"line"==g||"square"==g||"rectangle"==g||"circle"==g||"ellipse"==g||"triangle"==g||"counter"==g||"polyLine"==g,g=g&&"polygon"==g,((m="fieldofview"==m&&null!==Z.editMode)||p||g)&&f.visibility&&(h||"fieldofview"!=Z.labelMode&&"shape"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||"undefined"===typeof ea||null===ea||ea!==b))){var k=f.x,l=f.y;if(!Z.hotspotsDrawOnlyInView||k+Tg>a.box.l&&k-Tg<a.box.r&&l+Tg>a.box.t&&l-Tg<a.box.b)m?Yh(f,a):p?Me(f,a,h,null,null,null):
g&&cf(f,null,h)}}}function ff(h){var a=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h);if(-1!=a){var b=A[a],a=b.w,b=b.h;if(25>a||25>b)if(a=document.getElementById("labelShapeList"+Ja.toString()))b=a[a.selectedIndex].value,a=this.radius?2*this.radius:"rectangle"==b||"ellipse"==b?2*ti:ti,b=this.radius?2*this.radius:"line"==b?yh/4:yh,m.modifyLabel(h,"w",a,!0,!0),m.modifyLabel(h,"h",b,!1,!0)}}function De(h,a,b){Z.Utils.clearDisplay(tb);Dk();var e=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h);if(-1!=
e){h=A[e];var f=0==h.rotation?b:Z.Utils.rotatePointOffCenter(h.x,h.y,b.x,b.y,-h.rotation);h.polygonPts[a]=f;var p=h.polygonPts.length;if(4==p&&yf||5==p&&"shape"==Z.labelMode&&4!=a)h.polygonPts=Za(h.polygonPts,a);"shape"==h.mediaType&&4==a&&(a=A[e],e=Math.round(b.x-a.x),b=Math.round(b.y-a.y),p=180*Math.atan(b/e)/Math.PI,a.rotation=Math.round((0>e?180:0<=e&&0>b?360:0)+p),b=new yb,Me(a,b));"shape"==h.mediaType?(b=new yb,a=h.z/100,e=h.polygonPts,h.w=(e[2].x-e[0].x)*a,h.h=(e[2].y-e[0].y)*a,0==h.rotation&&
(h.x=(e[2].x+e[0].x)/2,h.y=(e[2].y+e[0].y)/2),Me(h,b,null,null,!1,!1,f)):cf(h,f)}}function Za(h,a){var b=h[a].x,e=h[a].y,f=a-1;0>f&&(f+=4);var p=a+1;3<p&&(p-=4);1==f||3==f?(h[f].x=b,h[p].y=e):(h[p].x=b,h[f].y=e);return h}function Pa(h,a,b,e){e&&(b.x=Math.round(b.x),b.y=Math.round(b.y));var f;h=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h);-1!=h&&(f=A[h],h=f.polygonPts?f.polygonPts:[],h[h.length]={x:b.x,y:b.y},f.polyClosed=!1,f.polygonPts=h,f.saved=!1);"shape"!=Z.labelMode&&"polygon"!=Z.labelMode&&
"measure"!=Z.labelMode||"undefined"===typeof f||null===f||"freehand"==f.mediaType||(f=m.getZoom(),Oe((b.x-Z.imageX)*f,(b.y-Z.imageY)*f,!1,1));a&&Tb()}function ab(h,a){var b=null;if(A)for(var e=($i+1)/Z.imageZ,f=0,p=A.length;f<p;f++){var g=A[f];if("freehand"!=g.mediaType&&g.internalID==ea&&("shape"==g.mediaType||"polygon"==g.media)&&"undefined"!==typeof g.polygonPts&&null!==g.polygonPts)for(var m=g.polygonPts.slice(0),g=0==g.rotation?h:Z.Utils.rotatePointOffCenter(g.x,g.y,h.x,h.y,-g.rotation),k=0,
l=m.length;k<l;k++){var r=m[k];if(Z.Utils.calculatePointsDistance(g.x,g.y,r.x,r.y)<e){b=k;break}}}return b}function Ba(h,b){Z.Utils.clearDisplay(tb);var t=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h);A[t].polyClosed=b;he=!0;if(-1!=t){var t=A[t],e=Z.Utils.polygonCenter(t.polygonPts,t.polyClosed);t.x=e.x;t.y=e.y;!yf&&"view"!=Z.labelMode&&"freehand"!=Z.labelMode&&""==t.caption&&"undefined"===typeof t.captionHTML&&(e=Z.Utils.getResource("z45"),t.caption=e+h.toString(),e=document.getElementById("captionTextElement"+
a.toString()))&&(e.value=t.caption);e=new yb;vc(t,e)}}function Fb(h,b,t,e){var f=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h);if(-1!=f){f=A[f];if(!yf&&"view"!=Z.labelMode)if("measure"==Z.labelMode&&"measure"==f.mediaType)Tc(f,b);else if("freehand"!=Z.labelMode&&"freehand"!=f.mediaType&&""==f.caption&&"undefined"===typeof f.captionHTML){var p=Z.Utils.getResource("z45");f.caption=p+h.toString();if(h=document.getElementById("captionTextElement"+a.toString()))h.value=f.caption}h=f.polyClosed;p=f.polygonPts?
f.polygonPts.slice(0):[];h=Z.Utils.polygonCenter(p,h,b);p=new Z.Utils.PolygonDimensions(f.polygonPts);f.x=h.x;f.y=h.y;f.w=p.w;f.h=p.h;h=new yb;Zb?(t=b=null,(b=document.getElementById("hot"+f.internalID+(Z.imageSet?"-"+a.toString():"")))&&(t=Z.Utils.getChildElementByID(b,"captionTextBox")),b=t,t=new Z.Utils.PolygonDimensions(f.polygonPts),e=h.currentZ/("polygon"!=f.media?f.z/100:1),Sc(f,b,f.xScale/100*e*t.w,f.yScale/100*e*t.h)):t?ia(f,h,b,null,null,!0,e):ae(f,h,b,!0)}}function lc(h,a){var b=Ja.toString(),
b=Z.annotationFileShared?"0":b;Z.editing=a;var e=null!==a?"none":"inline-block",f=null!==a||"markup"==Z.editMode?"inline-block":"none";switch(h){case "poi":var p=document.getElementById("buttonPOIAdd"+b),g=document.getElementById("buttonPOIEdit"+b),m=document.getElementById("buttonPOIDelete"+b),k=document.getElementById("buttonPOICancel"+b),l=document.getElementById("buttonPOISave"+b);break;case "labelPartial":p=document.getElementById("buttonLabelAdd"+b);g=document.getElementById("buttonLabelEdit"+
b);m=document.getElementById("buttonLabelDelete"+b);k=document.getElementById("buttonLabelCancel"+b);l=document.getElementById("buttonLabelSave"+b);break;case "label":p=document.getElementById("buttonLabelAdd"+b);g=document.getElementById("buttonLabelEdit"+b);m=document.getElementById("buttonLabelDelete"+b);k=document.getElementById("buttonLabelCancel"+b);l=document.getElementById("buttonLabelSave"+b);break;case "note":p=document.getElementById("buttonNoteAdd"+b),g=document.getElementById("buttonNoteEdit"+
b),m=document.getElementById("buttonNoteDelete"+b),k=document.getElementById("buttonNoteCancel"+b),l=document.getElementById("buttonNoteSave"+b)}p&&(Z.Utils.setButtonDefaults(p),p.style.display=e);g&&(Z.Utils.setButtonDefaults(g),g.style.display=e);m&&(Z.Utils.setButtonDefaults(m),m.style.display=f);k&&(Z.Utils.setButtonDefaults(k),k.style.display=f);l&&(Z.Utils.setButtonDefaults(l),l.style.display=f);var p=document.getElementById("overlayPOIDisable"+b),g=document.getElementById("overlayLabelDisable"+
b),m=document.getElementById("overlayLabelDetailDisable"+b),k=document.getElementById("overlayLabelDetailEditableDisable"+b),l=parseFloat(Z.Utils.getResource("z82")),e=Z.Utils.getResource("z83NOALPHA"),f=document.getElementById("textBoxFor-overlayMessageBox"+b),r=document.getElementById("overlayLabelNameEditableDisable"+b),q=document.getElementById("overlayLabelCaptionPositionDisable"+b),n=document.getElementById("overlayNoteDisable"+b),u=document.getElementById("overlayNoteDetailDisable"+b),v=document.getElementById("textBoxFor-poiNameTextElement"+
b),U=document.getElementById("textBoxFor-labelNameTextElement"+b),O=document.getElementById("commentTextElement"+b),D=document.getElementById("textBoxFor-noteNameTextElement"+b),b=document.getElementById("noteTextElement"+b);if(p&&g&&m&&k&&r&&q&&u&&v&&U&&D)if(null===a)Z.Viewer.initializeViewerKeyEventListeners(!0),p.style.display="none",g.style.display="none",m.style.display="inline-block",k.style.display="none",Z.Utils.setOpacity(k,l,e),f&&(f.style.display="none"),r.style.display="none",q.style.display=
"none",n.style.display="none",u.style.display="inline-block",v.style.visibility="hidden",U.style.visibility="hidden",D.style.visibility="hidden",O&&(O.readOnly=!0),b.readOnly=!0;else{switch(h){case "poi":v.style.visibility="visible";g.style.display="inline-block";m.style.display="none";n.style.display="inline-block";u.style.display="none";break;case "labelPartial":m.style.display="none";k.style.display="inline-block";Z.Utils.setOpacity(k,l,e);f&&(f.style.display="inline-block");r.style.display="inline-block";
q.style.display="text"==Z.labelMode?"inline-block":"none";U.style.visibility="visible";p.style.display="inline-block";n.style.display="inline-block";u.style.display="none";break;case "label":m.style.display="none";k.style.display="none";Z.Utils.setOpacity(k,l,e);f&&(f.style.display="none");r.style.display="none";q.style.display="text"==Z.labelMode?"inline-block":"none";U.style.visibility="visible";p.style.display="inline-block";n.style.display="inline-block";u.style.display="none";O&&(O.readOnly=
!1);break;case "note":p.style.display="inline-block",g.style.display="inline-block",m.style.display="none",u.style.display="none",D.style.visibility="visible",b.readOnly=!1}yg(h)}}function q(h,a){switch(a){case "pois":"save"==h?wj=Z.Utils.arrayClone("pois",db,wj):db=Z.Utils.arrayClone("pois",wj,db);break;case "labels":var b=Z.Utils.arrayIndexOfObjectValue(A,"internalID",xg);if("save"==h)ba&&ba.polygonPts&&(aj=Z.Utils.arrayClone("polygon",ba.polygonPts,aj)),xj=Z.Utils.arrayClone("labels",Ta,xj),yj=
Z.Utils.arrayClone("hotspots",A,yj),ba=-1!=b?A[b]:null;else if(Ta=Z.Utils.arrayClone("labels",xj,Ta),A=Z.Utils.arrayClone("hotspots",yj,A),ba=-1!=b?A[b]:null)0<aj.length?ba.polygonPts=Z.Utils.arrayClone("polygon",aj,ba.polygonPts):"polygon"!=ba.media&&Z.Utils.arrayClear(ba.polygonPts);break;case "notes":"save"==h?zj=Z.Utils.arrayClone("notes",zb,zj):zb=Z.Utils.arrayClone("notes",zj,zb)}}function U(h){var a=Cd(),b=nb(a,"root"),e=nb(a,"setup");h=h.getElementsByTagName("SETUP")[0];var f;f=h.getAttribute("PANELPOSITION");
Z.Utils.stringValidate(f)&&e.setAttribute("PANELPOSITION",f);f=h.getAttribute("INITIALVISIBILITY");Z.Utils.stringValidate(f)&&e.setAttribute("INITIALVISIBILITY",f);f=h.getAttribute("POIVISIBILITY");Z.Utils.stringValidate(f)&&e.setAttribute("POIVISIBILITY",f);f=h.getAttribute("LABELVISIBILITY");Z.Utils.stringValidate(f)&&e.setAttribute("LABELVISIBILITY",f);f=h.getAttribute("NOTEVISIBILITY");Z.Utils.stringValidate(f)&&e.setAttribute("NOTEVISIBILITY",f);f=h.getAttribute("COMMENTVISIBILITY");Z.Utils.stringValidate(f)&&
e.setAttribute("COMMENTVISIBILITY",f);f=h.getAttribute("TOOLTIPSOURCE");Z.Utils.stringValidate(f)&&e.setAttribute("TOOLTIPSOURCE",f);f=h.getAttribute("MINSCALE");Z.Utils.stringValidate(f)&&!isNaN(parseFloat(f))&&0<=parseFloat(f)&&e.setAttribute("MINSCALE",f);f=h.getAttribute("MAXSCALE");Z.Utils.stringValidate(f)&&!isNaN(parseFloat(f))&&0<=parseFloat(f)&&e.setAttribute("MAXSCALE",f);b.appendChild(e);h=0;for(e=db.length;h<e;h++){f=nb(a,"poi");var p=db[h],g=Z.Utils.xmlEscapeMinimal(p.text);Z.Utils.stringValidate(g)&&
f.setAttribute("NAME",g);g=p.value;Z.Utils.stringValidate(g)&&f.setAttribute("INTERNALID",g);var g=p.id;Z.Utils.stringValidate(g)&&f.setAttribute("ID",g);g=p.x;Z.Utils.stringValidate(g)&&!isNaN(parseFloat(g))&&f.setAttribute("X","center"==g?Z.imageCtrX.toString():g);g=p.y;Z.Utils.stringValidate(g)&&!isNaN(parseFloat(g))&&f.setAttribute("Y","center"==g?Z.imageCtrY.toString():g);g=p.z;Z.Utils.stringValidate(g)&&!isNaN(parseFloat(g))&&f.setAttribute("ZOOM",g);g=p.user;Z.Utils.stringValidate(g)&&f.setAttribute("USER",
g);g=p.date;Z.Utils.stringValidate(g)&&f.setAttribute("DATE",g);b.appendChild(f);labelListTempDP=Wf(Ta,db[h].value);if(0<labelListTempDP.length){p=a.createElement("LABELS");f.appendChild(p);for(var g=0,k=labelListTempDP.length;g<k;g++){var l=nb(a,"label"),r=Z.Utils.arrayIndexOfObjectValue(A,"internalID",labelListTempDP[g].value);-1!=r&&(l=m.convertLabelToXML(A[r]));p.appendChild(l)}}noteListTempDP=Wf(zb,db[h].value);if(0<noteListTempDP.length)for(p=a.createElement("NOTES"),f.appendChild(p),f=0,g=
noteListTempDP.length;f<g;f++)k=nb(a,"note"),l=noteListTempDP[f],r=Z.Utils.xmlEscapeMinimal(l.text),Z.Utils.stringValidate(r)&&k.setAttribute("NAME",r),r=l.value,Z.Utils.stringValidate(r)&&k.setAttribute("INTERNALID",r),r=Z.Utils.xmlEscapeMinimal(l.noteText),Z.Utils.stringValidate(r)&&k.setAttribute("TEXT",r),r=l.poiID,Z.Utils.stringValidate(r)&&k.setAttribute("POIID",r),r=l.id,Z.Utils.stringValidate(r)&&k.setAttribute("ID",r),r=l.user,Z.Utils.stringValidate(r)&&k.setAttribute("USER",r),r=l.date,
Z.Utils.stringValidate(r)&&k.setAttribute("DATE",r),p.appendChild(k)}return a}function Ub(h){if(Z.useCanvas){var a=h.toString();if(Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){Xg=parseInt(Z.Utils.getResource("DEFAULT_MAGNIFIERBUTTONDIMENSION"),10);Z.Utils.getResource("UI_MAGNIFIERACCESSIBILITYALTATTRIBUTE");magPtPrior=new Z.Utils.Point(Z.imageCtrX,Z.imageCtrY);Z["MagnifierContainer"+a]=Z.Utils.createContainerElement("div","MagnifierContainer"+a,"inline-block","absolute","hidden","1px",
"1px","1px","1px","solid","1px","transparent","0px","0px","normal","default",!0);Ah=Ee=Z["MagnifierContainer"+a];Yg=Ah.style;Z.ViewerDisplay.appendChild(Ee);Yg.zIndex=(Z.baseZIndex+5).toString();var a=parseFloat(Z.Utils.getResource("z82")),b=Z.Utils.getResource("z83"),e=Z.Utils.getResource("z83NOALPHA"),b=Z.Utils.createContainerElement("div","magnifierBackground","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",b,"0px","0px","normal",null,!0);Z.Utils.setOpacity(b,a,e);Ee.appendChild(b);
Ci=b;Di=Ci.style;a=Z.Utils.createContainerElement("canvas","magnifierDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal");Ee.appendChild(a);zf=a;Pe=zf.style;Aj=zf.getContext("2d");a=Z.Toolbar.getSkinArray();e=new Z.Utils.Button("buttonMagnifierMaximize",null,Z.skinPath,a[37],a[38],a[39],"15px","15px","1px","1px","click",Ca,"TIP_TOGGLEMAGNIFIERMAXIMIZE");Ee.appendChild(e.elmt);document.getElementById("buttonMagnifierMaximize");a=new Z.Utils.Button("buttonMagnifierMinimize",
null,Z.skinPath,a[40],a[41],a[42],"15px","15px","1px","1px","click",Ca,"TIP_TOGGLEMAGNIFIERMINIMIZE");Ee.appendChild(a.elmt);document.getElementById("buttonMagnifierMinimize");m.sizeAndPositionMagnifier(null,null,null,null);m.setVisibilityMagnifier(h==Z.Viewport.getViewportID()&&(1==Z.magnifierVisible||2==Z.magnifierVisible));m.toggleMagnifierMinimize(!0);Z.Utils.addEventListener(zf,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Viewer.magnifierMouseMoveHandler);
Z.narrative&&(Z.Utils.addEventListener(Z.NarrativeDisplay,"mouseover",function(h){Z.Utils.removeEventListener(Z.ViewerDisplay,"mousemove",Z.Viewer.magnifierMouseMoveHandler)}),Z.Utils.addEventListener(Z.NarrativeDisplay,"mouseout",function(h){(h=Z.Utils.relatedTarget(h))&&Z.Utils.stringValidate(h.id)&&Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Viewer.magnifierMouseMoveHandler)}));m.updateViewMagnifier(null,Z.imageCtrX,Z.imageCtrY);m.setStatus("magnifierInitializedViewport",!0)}else window.setTimeout(function(){Ub(h)},
100)}else Z.Utils.showMessage(Z.Utils.getResource("ALERT_MAGNIFIERREQUIRESCANVAS")),Z.magnifierVisible=0}function qc(h,a){if(h&&a&&h.imagePath==Z.imagePath){h.image=a;var b=Z.Utils.arrayIndexOf(eg,h.name);-1!=b&&(eg=Z.Utils.arraySplice(eg,b,1));if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)b=Z.Utils.arrayIndexOf(Je,h.name),-1!=b&&(Je=Z.Utils.arraySplice(Je,b,1));fg[fg.length]={name:h.name,x:h.x,y:h.y,image:h.image};fg.length>te&&(fg=Z.Utils.arraySplice(fg,0,1));0==eg.length&&m.updateViewMagnifier()}}
function Ca(h){Z.interactive&&m.toggleMagnifierMinimize()}function Pd(h){var a;Z.Utils.stringValidate(Z.trackingPath)&&(Z.simplePath?a=Z.trackingPath:(".json"!=Z.trackingPath.toLowerCase().substring(Z.trackingPath.length-5,Z.trackingPath.length)&&".xml"!=Z.trackingPath.toLowerCase().substring(Z.trackingPath.length-4,Z.trackingPath.length)&&(Z.trackingPath=Z.trackingPath+"/"+Z.Utils.getResource("DEFAULT_TRACKINGXMLFILE")),a=Z.Utils.cacheProofPath(Z.trackingPath)));"undefined"!==typeof a&&Z.Utils.stringValidate(a)?
(vpIDTemp=Z.imageSet?h:null,h=new Z.NetConnector,-1!=a.toLowerCase().indexOf(".xml")?h.loadXML(a,vpIDTemp,"loadingTrackingXML"):-1!=a.toLowerCase().indexOf(".json")&&h.loadJSON(a,vpIDTemp,"loadingTrackingJSON")):"string"===typeof Z.trackingXMLText&&Z.Utils.stringValidate(Z.trackingXMLText)?(a=Z.Utils.xmlConvertTextToDoc(Z.trackingXMLText),m.parseTrackingXML(a)):"undefined"!==typeof Z.trackingJSONObject&&"object"===typeof Z.trackingJSONObject&&null!==Z.trackingJSONObject&&(a=Z.Utils.jsonConvertObjectToXMLText(Z.trackingJSONObject),
a=Z.Utils.xmlConvertTextToDoc(a),m.parseTrackingXML(a))}function bj(h){var a=Z.Toolbar.getSkinSizes(),b=h.toString(),e=parseInt(Z.Utils.getResource("DEFAULT_TRACKINGPANELWIDTH"),10);viewModeAdj=0;var f=viewModeAdj+parseInt(Z.Utils.getResource("DEFAULT_TRACKINGPANELHEIGHT"),10),g=m.calculateTrackingPanelCoords(Z.trackingPanelPosition,e,f,ka,ha);m.sizeAndPositionTrackingPanel(Mb,e,f,g.x,g.y);Z.trackingPanelVisibleState=!(0==Z.trackingPanelVisible||"0"==Z.trackingPanelPosition||Z.imageSet&&Z.trackingFileShared&&
0==h);Mb.display=Z.trackingPanelVisibleState?"inline-block":"none";var k=parseInt(Z.Utils.getResource("DEFAULT_TRACKINGLABELWIDTH"),10);parseInt(Z.Utils.getResource("DEFAULT_TRACKINGLABELTEXTWIDTH"),10);parseInt(Z.Utils.getResource("DEFAULT_TRACKINGLISTWIDTH"),10);parseInt(Z.Utils.getResource("DEFAULT_TRACKINGLISTNARROWWIDTH"),10);parseInt(Z.Utils.getResource("DEFAULT_TRACKINGMARGIN"),10);var l=parseInt(Z.Utils.getResource("DEFAULT_TRACKINGPANELLABELFONTSIZE"),10);parseInt(Z.Utils.getResource("DEFAULT_TRACKINGPANELLISTFONTSIZE"),
10);parseInt(Z.Utils.getResource("DEFAULT_TRACKINGPANELTEXTFONTSIZE"),10);parseInt(Z.Utils.getResource("DEFAULT_TRACKINGTEXTPADDINGSMALL"),10);parseInt(Z.Utils.getResource("DEFAULT_TRACKINGTEXTPADDING"),10);var r=parseFloat(Z.Utils.getResource("z82")),q=Z.Utils.getResource("z83");Z.Utils.getResource("z83LIGHT");var n=Z.Utils.getResource("z83NOALPHA"),u=e-30,v=-(.9*viewModeAdj)+(f-45-17-4),g=a[6],U=a[7];h=a[8];var O=a[4],D=a[5];18<g&&(g=18);18<U&&(U=18);22<h&&(h=22);1<O&&(O=1);18<D&&(D=18);var C=k/
2,a=(U-D)/2,P=g/2,Da=document.getElementById("trackingPanelBackground"+b);if(Da){var Ub=Da.style;Ub.width=e+"px";Ub.height=f+"px";Ub.backgroundColor=q;Z.Utils.setOpacity(Da,r,n)}dx=19;if(r=document.getElementById("containerCounterLabels"+b))q=r.style,q.width=e+"px",q.height="15px",q.left=dx+"px",q.top="15px",q.visibility="visible",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none");dx=0;if(r=document.getElementById("labelAddTextBox"+
b))q=r.style,q.width=k+"px",q.height="15px",q.left="0px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=C+8;if(r=document.getElementById("labelShowTextBox"+b))q=r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=k-4;if(r=document.getElementById("labelNameTextBox"+
b))q=r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=2*k+16;if(r=document.getElementById("labelCountPerCellTextBox"+b))q=r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=k-12;if(r=document.getElementById("labelCountPerImageTextBox"+
b))q=r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=C;if(r=document.getElementById("labelListTextBox"+b))q=r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none");dx=19;if(r=document.getElementById("containerCounterListLabels"+
b))q=r.style,q.width=e+"px",q.height="15px",q.left=dx+"px",q.top="15px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none");if(r=document.getElementById("labelCellTextBox"+b))q=r.style,q.width=k+"px",q.height="15px",q.left="0px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=k-12;if(r=document.getElementById("labelXTextBox"+b))q=
r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=C+4;if(r=document.getElementById("labelYTextBox"+b))q=r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=C;if(r=document.getElementById("labelZoomTextBox"+b))q=
r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=k+4;if(r=document.getElementById("labelUserNameTextBox"+b))q=r.style,q.width=k+"px",q.height="15px",q.left=dx+"px",q.top="0px",Z.Utils.setTextNodeStyle(r.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none");dy=34;q=document.getElementById("containerTracking"+
b);n=document.getElementById("rowCounterFilteredList"+b);q&&n&&(r=q.style,r.width=u+"px",r.height=v+"px",r.left="15px",r.top=dy+"px",q.size=6,q=n.style,q.width=u+2+"px",q.height=v+2+"px",q.left=r.left,q.top=r.top);if(v=document.getElementById("buttonCounterListHide"+b))Z.Utils.buttonSize(v,g,U),v=v.style,v.left=u-2*g+"px",v.top="13px",v.display="none";dx="edit"==Z.trackingEditMode?19.5:75;dy=f-U-4-2;if(f=document.getElementById("labelCurrentCellTextBox"+b))u=f.style,u.width=k/2+"px",u.height="15px",
u.left=dx+"px",u.top=dy+2+2+"px",Z.Utils.setTextNodeStyle(f.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=k/2+4;if(f=document.getElementById("currentCellTextBox"+b))u=f.style,u.width=k+"px",u.height="15px",u.left=dx+"px",u.top=dy+2+2+"px",Z.Utils.setTextNodeStyle(f.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx="edit"==Z.trackingEditMode?dx+k+4:dx+k+30;if(f=document.getElementById("countingDivider"+
b))Z.Utils.graphicSize(f,O,D),f=f.style,f.left=dx+"px",f.top=dy+a+2+"px",dx+=P;if(f=document.getElementById("labelCountingCompleteTextBox"+b))u=f.style,u.width=C+"px",u.height="15px",u.left=dx+"px",u.top=dy+2+2+"px",Z.Utils.setTextNodeStyle(f.firstChild,"black","verdana",l+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=k+12;l=document.getElementById("containerFor-checkboxCountingComplete"+b);k=document.getElementById("checkboxCountingComplete"+b);l&&k&&(l=l.style,l.left=
dx+"px",l.top=dy-3+3+"px",Z.Utils.scaleElement(l,.9),dx="edit"==Z.trackingEditMode?dx+h+3+15:dx+h+3+29,"edit"!=Z.trackingEditMode&&(k.disabled=!0));if(k=document.getElementById("buttonToggleTrackingNav"+b))Z.Utils.buttonSize(k,g,U),k=k.style,k.left=dx+"px",k.top=dy+"px";if("edit"==Z.trackingEditMode){dx=e-(5*h+4);if(e=document.getElementById("buttonTrackingClearLast"+b))Z.Utils.buttonSize(e,g,U),e=e.style,e.left=dx+"px",e.top=dy+"px",dx+=h;if(e=document.getElementById("buttonTrackingClearType"+b))Z.Utils.buttonSize(e,
g,U),e=e.style,e.left=dx+"px",e.top=dy+"px",dx+=h;if(e=document.getElementById("buttonTrackingClearAll"+b))Z.Utils.buttonSize(e,g,U),e=e.style,e.left=dx+"px",e.top=dy+"px",dx+=h;if(e=document.getElementById("trackingDivider"+b))Z.Utils.graphicSize(e,O,D),O=e.style,O.left=dx+"px",O.top=dy+a+"px",dx+=P;if(b=document.getElementById("buttonTrackingSave"+b))Z.Utils.buttonSize(b,g,U),b=b.style,b.left=dx+"px",b.top=dy+"px",dx+=h}}function Ei(h){var a=Z.Navigator.getSizeAndPositionNavigatorImage();a?(m.setSizeAndPositionNavigatorTrackingOverlay(a.width,
a.height,a.left,a.top,h),Z.Navigator.drawNavigatorTrackingOverlay(Fe,a)):window.setTimeout(function(){Ei(h)},10)}function Zg(h,a){var b;switch(a){case "root":b=h.getElementsByTagName("TRACKINGDATA")[0];break;case "setup":b=h.createElement("SETUP");b.setAttribute("PANELPOSITION","2");break;case "type":b=h.createElement("TYPE");b.setAttribute("ID","0");b.setAttribute("NAME",Z.Utils.getResource("CONTENT_COUNTERNAME"));b.setAttribute("MEDIATYPE","counter");b.setAttribute("MEDIA","circle");b.setAttribute("RADIUS",
"40");b.setAttribute("CAPTION","");b.setAttribute("CAPTIONPOSITION",Z.Utils.getResource("CONTENT_COUNTERCAPTIONPOSITION"));b.setAttribute("FILLCOLOR",Z.Utils.getResource("CONTENT_COUNTERFILLCOLOR"));break;case "cell":b=h.createElement("CELL");b.setAttribute("ID",Z.Utils.getResource("CONTENT_COUNTERCELL"));b.setAttribute("COMPLETE","0");b.setAttribute("USER",Z.Utils.getResource("CONTENT_COUNTERUSER"));b.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());break;case "label":b=h.createElement("LABEL"),
b.setAttribute("ID","0"),b.setAttribute("CATEGORY","0"),b.setAttribute("NAME",Z.Utils.getResource("CONTENT_COUNTERNAME")),b.setAttribute("MEDIATYPE","counter"),b.setAttribute("MEDIA","circle"),b.setAttribute("RADIUS","40"),b.setAttribute("CAPTION",""),b.setAttribute("CAPTIONPOSITION",Z.Utils.getResource("CONTENT_COUNTERCAPTIONPOSITION")),b.setAttribute("FILLCOLOR",Z.Utils.getResource("CONTENT_COUNTERFILLCOLOR")),b.setAttribute("CELL",Z.Utils.getResource("CONTENT_COUNTERCELL")),b.setAttribute("X",
"center"),b.setAttribute("Y","center"),b.setAttribute("ZOOM","100"),b.setAttribute("USER",Z.Utils.getResource("CONTENT_COUNTERUSER")),b.setAttribute("INITIALS",Z.Utils.getResource("CONTENT_COUNTERUSERINITIALS")),b.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString())}return b}function Bh(h){if(h=Z.Utils.event(h)){var a=h.type;if(h=Z.Utils.target(h))switch(a){case "mouseover":Z.Utils.setOpacity(h,.2,"");break;case "mousedown":for(var a=0,b=Ch.children.length;a<b;a++)Z.Utils.setOpacity(Ch.childNodes[a].firstChild,
.4,"");Z.Utils.setOpacity(h,1,"");Bj=h;h=h.id;Z.trackingTypeCurrent=h.substring(h.length-1,h.length);break;case "mouseout":Z.Utils.setOpacity(h,.4,""),Z.Utils.setOpacity(Bj,1,"")}}}function Af(h){if(h){var b=document.getElementById("rowCounterFilteredList"+a.toString()).selectedIndex;h=parseInt(Ag[b].x,10);var t=parseInt(Ag[b].y,10),b=parseFloat(Ag[b].zoom);m.zoomAndPanToView(h,t,b)}}function gf(h,a,b){if(!Ed){var e=m.getStatus("initializedViewport"),f=!0,g=!0;if("undefined"===typeof Yf||null===Yf)Yf=
"1";"1"==Yf&&(f=!Z.NavigatorVisible||Z.Navigator&&Z.Navigator.getInitialized(),g=!Z.RulerVisible||Z.Ruler&&Z.Ruler.getInitialized());e&&(!Z.narrative||f&&g)?(e="0"==fi?"hidden":"visible",cj=Z.tracking||Z.navigatorVisible||null!==Z.navigatorW?Z.navigatorW+2:parseInt(Z.Utils.getResource("DEFAULT_IMAGELISTWIDTH"),10),listCoords=m.calculateImageListCoords(ka,ha,b),f="undefined"!==typeof b&&Z.Utils.stringValidate(b)?b.toString():"","undefined"===typeof Ed||null===Ed?(Ed=new Z.Utils.createSelectElement("imageList"+
f,h,a,cj,listCoords.x,listCoords.y,null,e,Dh,"change"),Z.ViewerDisplay.appendChild(Ed),Ed.style.zIndex=(Z.baseZIndex+10).toString(),Ed.selectedIndex=0,m.setStatus("initializedImageList",!0)):Z.Utils.arrayClear(a),e=m.getImagePath(),e=Z.Utils.arrayIndexOfObjectValue(a,"value",e),-1==e&&(e=0),f=Z.Utils.stringValidate(h)&&"none"!=h?1:0,Ed.selectedIndex=e+f):Z.imageListTimeout=window.setTimeout(function(){gf(h,a,b)})}}function Dh(h){if(h=Z.Utils.event(h)){Z.Viewer.viewportSelect(a);var b=Z.Utils.target(h),
t=b.options[b.selectedIndex];"null"!=t.value&&(h=null,Vc&&(t=Z.Utils.arrayIndexOfObjectValue(Vc.options,"text",t.text+"-annotations"),-1!=t&&(t=Vc.options[t].value,Z.annotationPath!=t&&(h="zAnnotationPath="+t))),t=Z.Utils.stringValidate(Z.imageListTitle)&&"none"!=Z.imageListTitle?1:0,b=b.selectedIndex-t,"null"!=ef[b].value&&(t=ef[b].optionalParams,null===h&&null!==t&&(h=t),Z.Viewer.setImage(ef[b].media,h,!1,a)))}}function ul(h){if(h=Z.Utils.event(h))h=Z.Utils.target(h),h=h.options[h.selectedIndex].value,
Z.Utils.stringValidate(h)&&Z.Viewer.setAnnotationPath(h)}function I(h){var a;this.id=h.getAttribute("ID");this.name=h.getAttribute("NAME");this.internalID=h.getAttribute("INTERNALID");isNaN(parseInt(this.internalID,10))&&(this.internalID=Gb("slide"));this.media=h.getAttribute("MEDIA");this.audio=h.getAttribute("AUDIO");Z.Utils.stringValidate(this.audio)&&(Z.audioContent=!0);this.initialX=h.getAttribute("INITIALX");this.initialY=h.getAttribute("INITIALY");this.initialZoom=h.getAttribute("INITIALZOOM");
this.minZoom=h.getAttribute("MINZOOM");this.maxZoom=h.getAttribute("MAXZOOM");this.hotspotPath=h.getAttribute("HOTSPOTPATH");this.annotationPath=h.getAttribute("ANNOTATIONPATH");a=parseFloat(h.getAttribute("SHOWFOR"));this.showFor=isNaN(a)?0:a;this.transition=h.getAttribute("TRANSITION");a=parseFloat(h.getAttribute("CHANGEFOR"));this.changeFor=isNaN(a)?0:a}function vl(h){if(h=Z.Utils.event(h))if(Z.slideshowPlaying&&m.slideshowStop(),h=Z.Utils.target(h),"null"!=h.options[h.selectedIndex].value){var a=
Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0;m.goToSlide(h.selectedIndex-a,null,!0)}}function Ek(h){if("undefined"!==typeof je&&null!==je&&0<je.length){var a=Z.slideshowPlaying?td[Zf].showFor:0;Z.Utils.stringValidate(td[Zf].audio)&&(a+=500);var b=Eh(Zf,h,td.length-1);null!==b?Z.Utils.functionCallWithDelay(function(){m.goToSlide(b,null,null,!0)},a):m.slideshowStop()}}function Eh(h,a,b){for(var e=Cj||Dj,f="Skip";"Skip"==f;)"next"==a?(h+=1,h>b&&(h=e?0:null)):(--h,0>h&&(h=e?
b:null)),f=Z.hotspots?null!==h?A[h].transition:null:Z.slideshow?null!==h?td[h].transition:null:null;return h}function Fk(){var h=Z.imageX!=Z.priorX||Z.imageY!=Z.priorY||Z.imageZ!=Z.priorZ||Z.imageR!=Z.priorR;!Z.preventDupCall&&h&&(Z.priorX=Z.imageX,Z.priorY=Z.imageY,Z.priorZ=Z.imageZ,Z.priorR=Z.imageR);Z.preventDupCall="undefined"!==typeof called&&null!==called}function Ti(h,a,b,e,f,g){g||m.zoomAndPanAllStop();Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();if("undefined"===typeof h||null===
h)h=Z.imageX;if("undefined"===typeof a||null===a)a=Z.imageY;if("undefined"===typeof b||null===b)b=Z.imageZ;if("undefined"===typeof e||null===e)e=Z.imageR;if("center"==h||isNaN(parseFloat(h)))h=Z.imageCtrX;if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrY;if(-1==b||isNaN(parseFloat(b)))b=Z.fitZ;"undefined"===typeof b||null===b?b=Z.fitZ:1<b&&b>Z.maxZ&&(b/=100);if("undefined"===typeof e||null===e)e=Z.imageR;b=Na(b);e=Qa(e);h=Fa(h,a,b,e,"image");Z.imageX=Ej=h.x;Z.imageY=Fj=h.y;Z.imageZ=b;e!=Z.imageR&&
Z.Utils.rotateElement(L,e);Z.imageR=e;m.updateView(!0);"function"===typeof f&&f()}function M(){if(hf&&(0!=Wc||0!=md||0!=nd))if(Z.tracking&&0==nd)m.zoomAndPanToView(m.getX()+Wc,m.getY()+md);else{var h=Wc,a=md,b=nd,e=m.getZoom();0!=b&&(e=Aa(Sa,Ia*(1+b)),e=Na(e),e!=Z.imageZ&&Gj(e));if(0!=h||0!=a)h=parseFloat(L.left)+h,a=parseFloat(L.top)+a,e=Fa(h,a,e,Z.imageR,"container"),L.left=Math.round(e.x)+"px",L.top=Math.round(e.y)+"px",a=e.x-Pc,e=e.y-pc,Ga&&Q&&(Z.mobileDevice||Math.abs(a)>ka/2||Math.abs(e)>ha/
2)&&R(Ga,H,uc,"simple",!1,"Updating backfill oversize display");A&&30<A.length?0==Fi%2&&m.syncViewportRelated():m.syncViewportRelated();Fi++;hf=window.setTimeout(M,Fh)}}function Gk(h,a,b,e,f,g,k){if(Z.zoomAndPanInProgressID==h.toString()+"-"+a.toString()+"-"+b.toString()+"-"+e.toString()){gi++;var l=f/g,r=gi*l,q=Z.Utils.easing(Z.imageX,h,r,f),n=Z.Utils.easing(Z.imageY,a,r,f),u=Z.Utils.easing(Z.imageZ,b,r,f),r=Z.Utils.easing(Z.imageR,e,r,f),n=m.convertImageCoordsToViewportEdgeCoords(q,n,u),q=n.x,n=
n.y,v=!1,U=syncOversize=!1;if(parseFloat(L.left)!=q||parseFloat(L.top)!=n)L.left=q+"px",L.top=n+"px",U=!0,Ga&&Q&&(syncOversize=!0);u!=Z.imageZ&&(Gj(u,!1),v=U=!0,Ga&&Q&&(Ib.restore(),Ib.save(),Ib.scale(Lc,Lc),syncOversize=!0));r!=Z.imageR&&(Z.Utils.rotateElement(L,r),Ga&&Q&&(Ib.rotate((r-Z.imageR)*Math.PI/180),syncOversize=!0),Z.imageR=r,U=!0);syncOversize&&R(Ga,H,uc,"simple",!1,"Updating backfill oversize display");m.syncViewportRelated(!1,A&&40>A.length,!1,!1,!1);0==gi%2&&m.syncViewportRelated(!1,
!1,v,U,v);u=Z.tour&&Z.tourStop&&0==Math.round(Z.imageR%90);gi<g+1&&!u?Zh=window.setTimeout(function(){Gk(h,a,b,e,f,g,k)},l):(u&&(Z.tourPlaying=!1),Z.interactive=!0,dd(),m.updateView(),m.toggleWatermarks(!0),A&&39<A.length&&m.setHotspotsVisibility(!0),"function"===typeof k&&k())}}function Hk(){Fi=nd=md=Wc=0;hf&&(window.clearTimeout(hf),hf=null)}function dd(){if(null!==Z.zoomAndPanInProgressID||Zh)Z.zoomAndPanInProgressID=null,gi=dj,window.clearTimeout(Zh),Zh=null}function Gj(h,a){var b=!1,e=la(Sa,
h);if(e!=Ia){Ia=e;var b=e/pd,f=qb*b,g=cb*b,k=(qb-f)/2,l=(cb-g)/2;e<pd&&(e=Fa(parseFloat(L.left),parseFloat(L.top),h,Z.imageR,"container"),L.left=e.x+"px",L.top=e.y+"px");if(Z.useCanvas)if(hb.width=f+"px",hb.height=g+"px",hb.left=k+"px",hb.top=l+"px",sb&&(Cc.width=f+"px",Cc.height=g+"px",Cc.left=k+"px",Cc.top=l+"px"),Wb&&($c.width=f+"px",$c.height=g+"px",$c.left=k+"px",$c.top=l+"px"),tb&&(oc.width=f+"px",oc.height=g+"px",oc.left=k+"px",oc.top=l+"px"),Lc=la(H,m.getZoom()),e=8<Lc,Q||e){if(null!==Ib&&
"undefined"===typeof a||null===a||a&&Ga&&("in"!=Z.zooming||f>Z.scaleThreshold||g>Z.scaleThreshold))Ib.restore(),Ib.save(),Ib.scale(Lc,Lc),Ib.rotate(Z.imageR*Math.PI/180),R(Ga,H,uc,"simple",!1,"Updating backfill oversize display");od=b=la(fc,h);f=b/tierBackfillScalePrior;b=Le*f;f*=se;g=zd+(Le-b)/2;e=Rd+(se-f)/2;Ea.width=b+"px";Ea.height=f+"px";Ea.left=g+"px";Ea.top=e+"px"}else Ga&&Z.Utils.clearDisplay(Ga),f=Le*b,g=se*b,k=zd+Z.imageX*(1-b)*Z.imageZ,l=Rd+Z.imageY*(1-b)*Z.imageZ,Ea.width=f+"px",Ea.height=
g+"px",Ea.left=k+"px",Ea.top=l+"px";else R(wa,Sa,gd,"centerOut",!1,"Scaling: non-canvas zoom"),Q?(b=Uh,Le=qb*b,se=cb*b,zd=-(qb/b),Rd=-(cb/b),ng=ad*b,Qg=Dc*b,za.width=Le,za.height=se,Ea.width=za.width+"px",Ea.height=za.height+"px"):(b=Nc[fc],za.width=Vb[fc],za.height=b,b=Z.imageY*h,zd=ad-Z.imageX*h,Rd=Dc-b),Ea.left=zd+"px",Ea.top=Rd+"px",R(za,fc,uc,"simple",!1,"Scaling: non-canvas zoom - backfill");b=!0}return b}function Ik(){if(Gh&&0!=jf){var h=Z.Utils.arrayIndexOfObjectValue(A,"internalID",ea);if(-1!=
h){var h=A[h],a=h.yScale*(1+jf);m.modifyLabel(ea,"xScale",h.xScale*(1+jf),!0,!0);m.modifyLabel(ea,"yScale",a,!1,!0);Gh=window.setTimeout(Ik,Jk)}}}function wl(){m.toggleFullViewMode(!1)}function Kk(){Gd&&0!=$f&&(m.rotateStep($f,!1),Gd=window.setTimeout(Kk,Hh),m.syncViewportRelated(!1,A&&40>A.length,!1,!0,!1))}function Lk(h,a){var b=a?Xa.length-1:Z.Utils.arrayIndexOfObjectValue(Xa,"filter",h);-1!=b&&(Z.Toolbar&&"external"!=Z.imageFilters&&Z.Toolbar.clearImageFilterInPanel(h,a),Xa=Z.Utils.arraySplice(Xa,
b,1),2<Xa.length&&"undefined"!==typeof Xa[b]&&"undefined"!==typeof Xa[b-1]&&Xa[b].filter==Xa[b-1].filter&&(Xa[b-1].value+=Xa[b].value,Xa=Z.Utils.arraySplice(Xa,b,1)),validateImageFiltersConvolve(),m.updateView(!0))}function xl(h,a,b){if(Gi&&kb){kb.putImageData(Gi,0,0);var e=kb.getImageData(0,0,wa.width,wa.height);h=Z.Utils.filterImage(e,h,a,b);kb.putImageData(h,0,0)}}function Ih(h,a,b,e,f){var g=-1!=h.id.indexOf("viewportDisplay");"canvas"!=e?(g&&null!==ej&&kb.putImageData(ej,0,0),g||null===fj||pe.putImageData(fj,
0,0),e=h.getContext("2d")):e=g?Lf:Kb;0<h.width&&0<h.height&&(e=e.getImageData(0,0,h.width,h.height),a="undefined"!==typeof a&&null!==a?Z.Utils.filterImage(e,a,b,f):ue(a,e),h.getContext("2d").putImageData(a,0,0))}function ue(h,a,b){h="undefined"!=typeof h&&Z.Utils.stringValidate(h)?Z.Utils.arrayIndexOfObjectValue(af,"filter",h):-1;if(-1!=h)a=af[h].image;else{for(var e=0,f=Xa.length;e<f;e++)if(h=Xa[e].filter,"undefined"===typeof b||!Z.Utils.stringValidate(b)||b!=h){var g=Xa[e].value,k=Xa[e].value2;
g!=m.getImageFilterDefault(h)&&(a=Z.Utils.filterImage(a,h,g,k),Z.Utils.stringValidate(h)&&m.cacheTileImage(h,a))}Qb(!0)}return a}function kf(h){Z.imageFilters&&uh&&oe&&ne&&("frontfill"==h?(Z.Utils.clearDisplay(oe),oe.width=wa.width,oe.height=wa.height,Qh.width=hb.width,Qh.height=hb.height,Lf.translate(ad,Dc),Lf.scale(Ia,Ia)):(Z.Utils.clearDisplay(ne),ne.width=za.width,ne.height=za.height,jg.width=Ea.width,jg.height=Ea.height))}function fd(h){h=Z.Utils.event(h);var a=h.type;if(h&&a){var b=!he&&("polygon"==
Z.labelMode||"measure"==Z.labelMode),e=Z.Utils.isRightMouseButton(h),f=h.altKey;if("mouseover"!=a&&"mouseout"!=a&&!Z.interactive||"mousedown"==a&&(!Z.interactive||Z.coordinatesVisible&&f)||e&&!b)Z.tourStop=!0;else{if("mousedown"==a||"touchstart"==a||Z.tourPlaying&&Z.tourStop)m.zoomAndPanAllStop(),Z.tour&&m.tourStop(),Z.tourStop=!0,Z.interactive=!0;Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=a&&"gesturechange"!=a&&h.preventDefault();if("mousedown"==a)window.setTimeout(function(){m.zoomAndPanAllStop(!1,
!0)},1),Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();else if("touchstart"==a||"gesturestart"==a)b=!1,Xc=Z.Utils.getFirstTouch(h),"undefined"!==typeof Xc&&null!==Xc&&(e=ub(Xc.target),null===e?b=!0:(e=e.id.substring(3,e.id.length),e=Z.Utils.arrayIndexOfObjectValue(A,"internalID",e),-1!=e&&(e=A[e],null!==e&&"function"==e.clickURL&&(b=!0)))),b&&h.preventDefault(),m.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();switch(a){case "mouseover":Z.fullView||
"TEXTAREA"==document.activeElement.tagName||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case "mousedown":!Z.fullView&&document.activeElement&&document.activeElement.blur();Z.Viewer.initializeViewerKeyEventListeners(!0);Z.Utils.addEventListener(document,"mousemove",fd);Z.Utils.addEventListener(document,"mouseup",fd);break;case "mouseup":("undefined"===typeof he||he)&&Z.Utils.removeEventListener(document,"mousemove",fd),Z.Utils.removeEventListener(document,"mouseup",fd)}yl(h);if("mousedown"==
a||"mousemove"==a)return!1}}}function yl(h){var b=Ja.toString();Z.annotations&&(m.toggleLabelShapePicker(!1),m.toggleLabelColorPicker(!1),m.toggleLabelLineStylePicker(!1));h=Z.Utils.event(h);var e=h.type,f=h.altKey;if(h&&e){var g;if("touchstart"==e||"touchmove"==e||"touchend"==e||"touchcancel"==e){if(Xc=Z.Utils.getFirstTouch(h))g=Xc.target,tc=new Z.Utils.Point(Xc.pageX,Xc.pageY);Z.gestureSupport||(Bf=Z.Utils.getSecondTouch(h))&&(hi=new Z.Utils.Point(Bf.pageX,Bf.pageY))}else g=Z.Utils.target(h),Z.Utils.relatedTarget(h),
Z.Utils.isRightMouseButton(h),"resize"!=e&&(tc=Z.Utils.getMousePosition(h));Z.smoothPan&&tc&&(Qe=tc);var p=m.getZoom(),k=(100*p).toString(),e=tc?m.getClickCoordsInImage(h,p,tc):null;hi&&!Z.gestureSupport&&m.getClickCoordsInImage(h,p,hi);var l=h.type,r=h.touches&&1<h.touches.length,q=null;if("gesturestart"==l||"gesturechange"==l||"gestureend"==l)Re&&Jh(),q=l;else if(!Bg)if(("mousedown"==l||"touchstart"==l)&&!Cf)r?(Re&&Jh(),q="pinchstart"):q="start";else if("mousemove"==l||"touchmove"==l)r||ag||$g?
r&&(q="pinchchange"):q="move";else if("mouseup"==l||"touchend"==l||"touchcancel"==l)q=r||ag||Cf||$g?"pinchend":"end";ah=q;switch(ah){case "start":q=g;p=null;if(Z.interactive)if(!A&&(Z.clickZoom||Z.clickPan||Z.mousePan))p="navigateImage";else{var l="function"!==typeof Z.externalEditPermissionFunction||Z.externalEditPermissionFunction(),r=null!==Z.editMode||"measure"==Z.labelMode,n=!f&&("addLabel"==Z.editing||"editLabel"==Z.editing),r=l&&r&&n,n=ub(q),q=ab(e,Z.labelMode);if(null!==n&&null===q&&he)q=
m.getLabelEditable(n.internalID),r&&q?p="editLabel":l&&Z.labelClickSelect&&(p="selectLabel");else if(null!==q&&(r||!r&&"measure"==Z.labelMode))l=Z.Utils.arrayIndexOfObjectValue(A,"internalID",ea),-1!=l&&(p=A[l],p=p.polyClosed||0!=q||2>=p.polygonPts.length||he?"editControlPoint":"completeLabelPolygon");else if(0==bg)"fieldofview"==Z.labelMode||"text"==Z.labelMode||"counter"==Z.labelMode?p="createLabelSimple":"shape"==Z.labelMode?p="createLabelShape":!he||"editLabel"==Z.editing||"freehand"!=Z.labelMode&&
"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||(p="createLabelAndControlPoint"),"counter"!=Z.labelMode&&(bg=1);else if(0!=bg&&!he)p=f?"completeLabelPolygon":"z489";else if("view"==Z.labelMode&&f&&Z.zoomRectangle)p="zoomRectangleImage";else if(Z.clickZoom||Z.clickPan||Z.mousePan)f||"view"==Z.labelMode||m.setEditModeLabel("view",null,null,null,!1,null),p="navigateImage"}Cg=p;Df=new Z.Utils.Point(tc.x,tc.y);ii=(new Date).getTime();Z.mouseIsDown=!0;Z.altKeyIsDown=f;p=Z.captionPosition?Z.captionPosition:
"8";ag=$g=!1;switch(Cg){case "navigateImage":Z.comparison&&-1!=g.id.indexOf("viewportDisplay")&&Z.Viewer.viewportSelect(parseInt(g.id.substring(g.id.indexOf("viewportDisplay")+15,g.id.length)));Z.smoothPan?1<Z.smoothPanEasing&&(Jh(void 0),bh=Df,null===Ef&&(Ef=new Z.Utils.Point(parseFloat(L.left),parseFloat(L.top))),null===Re&&(Re=window.setInterval(zl,50))):(eb.mouseXPrior=tc.x,eb.mouseYPrior=tc.y);break;case "zoomRectangleImage":yf=!0;h=(100*m.getZoom()).toString();Mk=ea;ea=A.length.toString();m.createHotspotFromParameters("zoomRectangle",
null,"polygon","polygon",null,e.x.toString(),e.y.toString(),h,null,null,null,null,null,"0","0",null,null,null,null,null,null,rg,null,zh,null,null,null,null,null,null,"8","0",ea,"0",null,null,"1",[{x:e.x,y:e.y},{x:e.x+1,y:e.y},{x:e.x+1,y:e.y+1},{x:e.x,y:e.y+1}],null,null,null,null,"1",null,null,null,null,null,null,null);Xf=2;if("none"==jc.display||"none"==oc.display||"none"==$c.display)jc.display=oc.display=$c.display="inline-block",Z.Utils.addEventListener(Kf,"mousedown",Z.Utils.preventDefault);break;
case "createLabelSimple":"fieldofview"==Z.labelMode?m.createLabelFromParameters(null,null,Z.labelMode,null,null,Z.imageX.toString(),Z.imageY.toString(),k,ka,ha,null,null,null,"0","0",null,null,null,"FOV",null,null,rg,null,null,null,null,null,null,null,null,"5","0",null,null):"counter"==Z.labelMode?m.createLabelCounter(e):m.createLabelFromParameters(null,null,Z.labelMode,null,null,e.x.toString(),e.y.toString(),k,null,null,null,null,null,"0","0",null,null,null,null,null,null,rg,null,null,null,null,
null,null,null,null,"5","0",null,null);"counter"!=Z.labelMode&&m.updateAnnotationPanelForNewLabel();break;case "createLabelShape":if(h=document.getElementById("labelShapeList"+b))m.createLabelFromParameters(null,null,Z.labelMode,h[h.selectedIndex].value,null,e.x.toString(),e.y.toString(),k,null,null,null,null,null,"0","0",null,null,null,null,null,null,rg,null,zh,Nk,null,null,null,null,null,p,"0",null,null),m.updateAnnotationPanelForNewLabel(),ff(ea);break;case "createLabelAndControlPoint":h=[];h[0]=
{x:e.x,y:e.y};he=polygonClosed=!1;"freehand"==Z.labelMode?Cg="z489":null===Z.editMode&&"measure"==Z.labelMode&&0<A.length&&m.deleteAllMeasureHotspots();m.createLabelFromParameters(null,null,Z.labelMode,"polygon",null,e.x.toString(),e.y.toString(),k,null,null,null,null,null,"0","0",null,null,null,null,null,null,rg,null,zh,null,null,null,null,null,null,p,"0",null,null,null,null,"0",h,null,null,null,null,null,"1");m.updateAnnotationPanelForNewLabel();break;case "z489":Pa(ea,!1,e,!0);break;case "selectLabel":(Zb=
ub(g))&&Ok(Zb.id.substring(3,Zb.id.length));break;case "completeLabelPolygon":f&&Pa(ea,!1,e,!0);case "editLabel":if(Zb=ub(g))e=("shape"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&null!==ea||"shape"==Z.labelMode&&null===ea?ab(e,Z.labelMode):null,"addLabel"==Z.editing&&("shape"==Z.labelMode&&null===e||"freehand"==Z.labelMode)&&m.saveEditsLabel(!0,!1,!1),ji(h,Df,ah),Ok(Zb.id.substring(3,Zb.id.length),!1);break;case "editControlPoint":Xf=ab(e,Z.labelMode)}break;case "move":new Z.Utils.Point(tc.x,
tc.y);k=(e.x-Z.imageX)*p;b=(e.y-Z.imageY)*p;switch(Cg){case "navigateImage":Re?Qe=tc:(e=tc,Z.animation&&m.getZoom()==Z.minZ||(k=e.x-eb.mouseXPrior,h=e.y-eb.mouseYPrior,isNaN(k)||isNaN(h)?(e.x>eb.mouseXPrior?Z.Viewer.viewportNext():e.x<eb.mouseXPrior&&Z.Viewer.viewportPrior(),eb.mouseXPrior=e.x,eb.mouseYPrior=e.y):(k=parseFloat(L.left)+k,h=parseFloat(L.top)+h,b=Fa(k,h,Z.imageZ,Z.imageR,"container"),L.left=b.x+"px",L.top=b.y+"px",eb.mouseXPrior=e.x,eb.mouseYPrior=e.y,k=b.x-Pc,h=b.y-pc,Ga&&Q&&(Z.mobileDevice||
Math.abs(k)>ka/2||Math.abs(h)>ha/2)&&R(Ga,H,uc,"simple",!1,"Updating backfill oversize display"),e=m.calculateCurrentCenterCoordinates(b,Z.imageZ,Z.imageR),Z.Navigator&&Z.Navigator.z658(e),Z.Utils.setBookmarksURL(),Z.Viewer.syncComparisonViewport(),Z.Viewer.syncOverlayViewports(null,a),Z.tracking&&m.syncTrackingToViewport())));break;case "zoomRectangleImage":Hj(ea,Xf,e);break;case "createLabelAndControlPoint":Ce(k,b,e);break;case "z489":"freehand"==Z.labelMode?Z.mouseIsDown&&(h=ki,f=mc,h&&f&&k&&b&&
(na.lineWidth=Bk,na.strokeStyle=zh,na.beginPath(),na.moveTo(h,f),na.lineTo(k,b),na.closePath(),na.stroke(),na.strokeStyle=zh,null===Hi&&(Hi=e),Z.Utils.calculatePointsDistance(Hi.x,Hi.y,k,b)>Al&&(Hi=e,Pa(ea,!1,e,!0))),ki=k,mc=b,Z.mouseIsDown||Eb()):Ce(k,b,e);break;case "editLabel":ji(h,tc,ah);b=h;e=Zb;g=tc;h=e.id.substring(3,e.id.length);h=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h);if(-1!=h){p=m.getZoom();h=A[h];f=h.media;l=h.mediaType;r=k=!1;Z.Utils.stringValidate(f)&&(k=-1!=f.indexOf("/circle.")||
-1!=f.indexOf("/square.")||-1!=f.indexOf("/triangle.")||-1!=f.indexOf("/arrowDownLeft.")||-1!=f.indexOf("/arrowDownRight.")||-1!=f.indexOf("/arrowUpLeft.")||-1!=f.indexOf("/arrowUpRight.")||-1!=f.indexOf("/arrowUp.")||-1!=f.indexOf("/arrowDown.")||-1!=f.indexOf("/arrowLeft.")||-1!=f.indexOf("/arrowRight.")||-1!=f.indexOf("/lineHorizontal.")||-1!=f.indexOf("/lineVertical."),r="fov"==f||"arrow"==f||"line"==f||"square"==f||"rectangle"==f||"circle"==f||"ellipse"==f||"triangle"==f||"polygon"==f||"counter"==
f||"polyLine"==f);k=("counter"==l||"shape"==l)&&(!f||"External Graphics File"!=f)&&(r||k&&Z.labelShapesInternal);f=f&&"polygon"==f;(l="fieldofview"==l)?(b=m.getClickCoordsInImage(b,p,g),"Field Of View ("==h.tooltip.substr(0,15)&&(g=Math.round(h.x).toString(),p=Math.round(h.y).toString(),r=Math.round(h.z).toString()+"%",g="("+g+"x, "+p+"y, "+r+")",h.tooltip=Z.Utils.getResource("CONTENT_TOOLTIPFOV")+g,m.setHotspotTooltipInHTML(e,h.tooltip))):(r=g.x-=e.mouseXOffset-parseFloat(e.style.width)/2,e=g.y-=
e.mouseYOffset-parseFloat(e.style.height)/2,b=m.getClickCoordsInImage(b,p,new Z.Utils.Point(r,e)));if(k||f||l)f&&de(h,b),Tb();h.x=b.x;h.y=b.y}break;case "editControlPoint":De(ea,Xf,e)}break;case "end":Z.mouseIsDown=!1;switch(Cg){case "navigateImage":Pk(h,tc,p,f);break;case "zoomRectangleImage":Pk(h,tc,p,f);break;case "createLabelSimple":"fieldofview"==Z.labelMode&&m.setEditModeLabel("view");break;case "z489":"freehand"==Z.labelMode&&(m.setEditModeLabel("freehand"),Ba(ea,!1),ki=mc=null);break;case "completeLabelPolygon":Ba(ea,
!f);break;case "editLabel":ji(h,tc,ah);break;case "editControlPoint":De(ea,Xf,e)}break;case "gesturestart":e=Z.Utils.event(h);e.preventDefault();Kh=Math.round(100*e.scale)/100;Bg||(Bg=window.setInterval(Qk,li));break;case "gesturechange":Kh=Math.round(100*h.scale)/100;Qk(h);break;case "gestureend":Bg&&(window.clearInterval(Bg),ag=!0,Bg=null);Z.mousePan&&m.updateView();break;case "pinchstart":Dg=Z.Utils.calculatePointsDistance(Xc.clientX,Xc.clientY,Bf.clientX,Bf.clientY);if(h=Z.Utils.event(h))h.preventDefault(),
e=Z.Utils.getFirstTouch(h),h=Z.Utils.getSecondTouch(h),"undefined"!==typeof e&&"undefined"!==typeof h&&(e=Z.Utils.calculatePointsDistance(e.clientX,e.clientY,h.clientX,h.clientY),ch=Math.round(Dg/e*100)/100);Cf||(Cf=window.setInterval(Rk,gj));break;case "pinchchange":e=Z.Utils.calculatePointsDistance(Xc.clientX,Xc.clientY,Bf.clientX,Bf.clientY);ch=Math.round(e/Dg*100)/100;Rk(h);break;case "pinchend":Cf&&(window.clearInterval(Cf),$g=!0,Cf=null),Z.mousePan&&m.updateView()}}}function Hj(h,a,b,e,f){yf&&
(e?(a=A[h].polygonPts,A.splice(h,1),yf=null,ea=Mk,Z.measureVisible||Z.tour||Z.hotspots||Z.annotations||(jc.display=oc.display=$c.display="none",Z.Utils.removeEventListener(Kf,"mousedown",Z.Utils.preventDefault)),f||m.zoomAndPanToZoomRectangle(a)):De(h,a,b))}function ji(h,a,b){"start"==b?(h=m.z480(h.clientX,h.clientY),Zb.mouseXPrior=a.x,Zb.mouseYPrior=a.y,Zb.mouseXOffset=h.x-parseFloat(Zb.style.left),Zb.mouseYOffset=h.y-parseFloat(Zb.style.top),Zb.style.zIndex=A.length+1):"move"==b?(Zb.style.left=
parseFloat(Zb.style.left)+a.x-Zb.mouseXPrior+"px",Zb.style.top=parseFloat(Zb.style.top)+a.y-Zb.mouseYPrior+"px",Zb.mouseXPrior=a.x,Zb.mouseYPrior=a.y):"end"==b&&(Zb.style.zIndex=Zb.zIndex,Zb=null)}function Bl(){na.save();na.beginPath();na.strokeStyle="#FFFFFF";na.lineWidth=1;na.globalAlpha=.5;var h=0,a=0,b=0,e=0,f=window.setInterval(function(){Z.Utils.clearCanvas(tb);na.beginPath();na.rect(h,a,b,e);na.stroke();b<ka&&e<ha?(h-=5,a-=5,b+=10,e+=10):(Z.Utils.clearCanvas(tb),window.clearInterval(f),Yh(null,
null),na.restore())},3)}function Dk(){if(null!==Z.editMode)for(var h=new yb,a=0,b=A.length;a<b;a++){var e=A[a];"fieldofview"==e.mediaType&&Yh(e,h)}}function Yh(h,a){na.save();var b,e,f,g,k;"undefined"===typeof h||null===h?(b=ka-5,e=ha-5,f=-b/2,g=-e/2,k=5):(0==h.w&&(h.w=ka-5),0==h.h&&(h.h=ha-5),f=(h.x-Z.imageX)*Z.imageZ,g=(h.y-Z.imageY)*Z.imageZ,k=a.currentZ/(h.z/100)/(Ia/pd),b=(h.w-5)*k,e=(h.h-5)*k,f-=b/2,g-=e/2,k*=5);na.beginPath();na.strokeStyle=h&&h.highlight?Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTCOLOR"):
Z.Utils.getResource("DEFAULT_LABELFOVBORDERCOLOR");na.lineWidth=h&&h.highlight?3*k:k;na.globalAlpha=h&&h.highlight?1:.5;na.rect(f,g,b,e);na.stroke();na.restore()}function Ok(h,a){if(ea&&h){var b=Z.Utils.arrayIndexOfObjectValue(A,"internalID",h);if(-1!=b){var e=A[b];e.editable?Z.labelMode!=e.mediaType&&null!==Z.editMode&&m.setEditModeLabel(e.mediaType,!0,e.media,!0,a):m.setEditModeLabel("view")}ea!=h&&(q("save","labels"),e&&O(e.poiID,e.internalID),Z.Utils.validateCallback("labelSelectedInViewportGetIDs"))}mb&&
(Z.hotspotListTitle||Z.tourListTitle)&&(mb.selectedIndex=0)}function Pk(h,a,b,e){document.mousemove=null;document.mouseup=null;var f=(new Date).getTime();a=Z.mouseOutDownPoint?Z.mouseOutDownPoint:new Z.Utils.Point(a.x,a.y);clickPt=m.getClickCoordsInImage(h,b,Z.mouseOutDownPoint);b=Z.Utils.calculatePointsDistance(Df.x,Df.y,a.x,a.y);f-=ii;a=Z.mobileDevice?di:Ii;if(b<(Z.mobileDevice?Ji:Cl)&&f<a||!e&&("shape"==Z.labelMode||"freehand"==Z.labelMode)){if(Z.clickZoom||Z.clickPan)var g=m.getClickZoomCoords3D(h,
Df,Sa,Ia,lf&&Z.doubleClickZoom?!0:!1);Z.clickZoom?Z.doubleClickZoom?lf?(clearTimeout(lf),lf=null,m.zoomAndPanToView(g.x,g.y,g.z)):lf=setTimeout(function(h){lf=null;m.zoomAndPanToView(g.x,g.y,g.z)},Z.doubleClickDelay):window.setTimeout(function(){m.zoomAndPanToView(g.x,g.y,g.z)},1):Z.clickPan&&m.zoomAndPanToView(g.x,g.y,Z.imageZ);Hj(ea,Xf,clickPt,!0,!0)}else"view"==Z.labelMode&&(e||Z.altKeyIsDown)&&Z.zoomRectangle?Hj(ea,Xf,clickPt,!0):Z.mousePan&&!Z.smoothPan&&m.updateView()}function Jh(h){null!==
Re&&h&&(window.clearInterval(Re),Re=null);Ef=Eg=Fg=nc=null;zc=ed=Y=cc=0}function zl(){if(Z.animation&&m.getZoom()==Z.minZ){Z.animationCount++;null===Gg&&(Gg=parseFloat(L.left));null===dh&&(dh=parseFloat(L.top));var h=Gg,b=dh;if(Z.mouseIsDown||nc){var e=(nc?Eg:Qe.x)-bh.x,f=(nc?Fg:Qe.y)-bh.y,g=h-Ef.x,p=b-Ef.y;if(!(isNaN(e)||isNaN(f)||isNaN(g)||isNaN(p)||0==e&&0==f&&0==g&&0==p)){var k=nc?Z.smoothPanGlide:1,l=nc?1:100;zc=Math.round((e-g)/(Z.smoothPanEasing*k)*l/l);ed=Math.round((f-p)/(Z.smoothPanEasing*
k)*l/l);Z.mouseIsDown?(Y=zc,cc=ed):(Math.abs(zc)>Math.abs(Y)&&(zc=Y),Math.abs(ed)>Math.abs(cc)&&(ed=cc));b+=ed;Gg=h+zc;dh=b;var r,q,n,u;"motion"==Z.animator?(r="horizontal"==Z.animationAxis?zc:ed,dimensionAxis="horizontal"==Z.animationAxis?ka:ha,q=Math.round(Ki/Z.imageSetLength),n=r/40,u=0):"position"==Z.animator&&(r="horizontal"==Z.animationAxis?g:p,dimensionAxis="horizontal"==Z.animationAxis?ka:ha,q=Math.max(0,Math.round((dimensionAxis/2-Math.abs(r))/hj)),n=0,u="horizontal"==Z.animationAxis?ka/
10:ha/10);0==q&&q++;0==Z.animationCount%q&&(r<-u?Z.Viewer.viewportPrior(n):r>u&&Z.Viewer.viewportNext(n));nc&&0==Math.round(zc*l)/l&&0==Math.round(ed*l)/l&&(nc=!1)}}else if(Z.mouseIsDown||null!==nc||0==zc||0==ed)Jh(!0),dh=Gg=null;else if(0!=Y||0!=cc)Eg=Qe.x+Y,Fg=Qe.y+cc,nc=!0}else if(p=parseFloat(L.left),g=parseFloat(L.top),Z.mouseIsDown||nc)l=(nc?Eg:Qe.x)-bh.x,r=(nc?Fg:Qe.y)-bh.y,q=p-Ef.x,n=g-Ef.y,isNaN(l)||isNaN(r)||isNaN(q)||isNaN(n)||0==l&&0==r&&0==q&&0==n||(u=nc?Z.smoothPanGlide:1,h=nc?1:100,
zc=Math.round((l-q)/(Z.smoothPanEasing*u)*h/h),ed=Math.round((r-n)/(Z.smoothPanEasing*u)*h/h),Z.mouseIsDown?(Y=zc,cc=ed):(Math.abs(zc)>Math.abs(Y)&&(zc=Y),Math.abs(ed)>Math.abs(cc)&&(ed=cc)),p+=zc,g+=ed,l=Fa(p,g,Z.imageZ,Z.imageR,"container"),L.left=l.x+"px",L.top=l.y+"px",zc-=p-l.x,ed-=g-l.y,Ga&&Q&&R(Ga,H,uc,"simple",!1,"Updating backfill oversize display"),nc&&0==Math.round(zc*h)/h&&0==Math.round(ed*h)/h&&(nc=!1),h=m.calculateCurrentCenterCoordinates(l,Z.imageZ,Z.imageR),Z.comparison&&0!=Ja?Z.Navigator2&&
Z.Navigator2.z658(h):Z.Navigator&&Z.Navigator.z658(h),Z.comparison&&Z.Viewer.syncComparisonViewport(),Z.overlays&&Z.Viewer.syncOverlayViewports(null,a),Z.tracking&&m.syncTrackingToViewport(),Z.Utils.validateCallback("viewChanging"),Z.Utils.validateCallback("viewPanningGetCurrentCoordinates"),Z.Utils.validateCallback("viewChangingGetCurrentCoordinatesFull"));else if(Z.mouseIsDown||null!==nc||0==zc||0==ed)Jh(!0),m.updateView();else if(l=Fa(p+Y,g+cc,Z.imageZ,Z.imageR,"container"),Y=l.x-p,cc=l.y-g,0!=
Y||0!=cc)Eg=Qe.x+Y,Fg=Qe.y+cc,nc=!0}function Qk(h){Z.clickZoom&&(h=Aa(Sa,pd*Kh),h=Na(h),h!=Z.imageZ&&m.scaleTierToZoom(h))}function Rk(h){Z.clickZoom&&(h=Aa(Sa,pd*ch),h=Na(h),h!=Z.imageZ&&m.scaleTierToZoom(h))}function ij(h){if(h=Z.Utils.event(h)){var a;if(Z.geoCoordinatesVisible){if(a="",Ij&&Jj&&Kj&&Lj){var b=m.getClickCoordsInImage(h);a=b;b=Li+a.x*Math.abs(Sk/Z.imageW);a=Mj-a.y*Math.abs(Tk/Z.imageH);var e="E",f=1;180<b&&(b-=360);-180>b&&(b+=360);0>b&&(e="W",f=-1);var g=(b-b%1)*f,b=Z.Utils.roundToFixed(b%
1*60*f,5),b=g+", "+b+", "+e,e="N",f=1;0>a&&(e="S",f=-1);g=(a-a%1)*f;a=Z.Utils.roundToFixed(a%1*60*f,5);a=geoCoordsString=g+", "+a+", "+e+"    "+b}}else"IIIFImageServer"==Z.tileSource?(b=m.getClickCoordsInImage(h),"mousemove"==h.type?a=m.getViewCoordinatesIIIFString(null,b,"show"):"mousedown"==h.type&&h.altKey&&(a=m.getViewCoordinatesIIIFString(null,b,"save")+"\n")):(b=Z.Utils.event(h),a=m.getZoom(),e=m.getClickCoordsInImage(b,a),b=Math.round(e.x).toString(),e=Math.round(e.y).toString(),a=(Math.round(1E3*
a)/10).toString(),a='X="'+b+'"   Y="'+e+'"   ZOOM="'+a+'"');"mousemove"==h.type?Z.Utils.showCoordinates(a):"mousedown"==h.type&&h.altKey&&Z.Utils.saveCoordinates(a)}}var Ld,dg,Mc,Fd,Ej=null,Fj=null,jj=0,kj=0,Ja=0;"undefined"!==typeof a&&null!==a&&(Ja=a);var kd;kd="undefined"!==typeof b&&null!==b?b:Z.imagePath;"undefined"===typeof f||null===f?dg=Ld=Z.hotspotPath:(dg=Ld=f,".xml"==dg.toLowerCase().substring(dg.length-4,dg.length)&&(dg=dg.substring(0,dg.lastIndexOf("/"))));"undefined"===typeof e||null===
e?(Mc=Z.annotationPath,Fd=Z.annotationFolder):(Fd=Mc=e,".xml"==Fd.toLowerCase().substring(Fd.length-4,Fd.length)&&(Fd=Fd.substring(0,Fd.lastIndexOf("/"))));"undefined"===typeof g||null===g?(trackingPath=Z.trackingPath,trackingFolder=Z.trackingFolder):(trackingFolder=trackingPath=g,".xml"==trackingFolder.toLowerCase().substring(trackingFolder.length-4,trackingFolder.length)&&(trackingFolder=trackingFolder.substring(0,trackingFolder.lastIndexOf("/"))));"undefined"===typeof k||null===k?(imageListPath=
Z.imageListPath,imageListFolder=Z.imageListFolder):(imageListFolder=imageListPath=k,".xml"==imageListFolder.toLowerCase().substring(imageListFolder.length-4,imageListFolder.length)&&(imageListFolder=imageListFolder.substring(0,imageListFolder.lastIndexOf("/"))));"undefined"!==typeof Ld&&Z.Utils.stringValidate(Ld)?(Z.hotspots=!0,Z.annotationPathProvided=!0,Z.imageSet&&(Z.hotspotPath="multiple")):"undefined"!==typeof Mc&&Z.Utils.stringValidate(Mc)&&(Z.annotationPath=Z.Utils.stringRemoveTrailingSlash(Mc),
Z.annotationFolder=Z.annotationPath,".xml"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-4,Z.annotationPath.length)&&(Z.annotationFolder=Z.annotationFolder.substring(0,Z.annotationFolder.lastIndexOf("/"))),Z.annotations=!0,Z.annotationPathProvided=!0,Z.imageSet&&(Z.annotationPath="multiple"));"undefined"!==typeof Z.narrativePath&&Z.Utils.stringValidate(Z.narrativePath)&&(Z.narrative=!0,Z.narrativePathProvided=!0);"undefined"!==typeof trackingPath&&Z.Utils.stringValidate(trackingPath)&&
(Z.tracking=!0,Z.trackingPathProvided=!0);"undefined"!==typeof imageListPath&&Z.Utils.stringValidate(imageListPath)&&(Z.imageListPath=imageListPath,Z.imageList=!0);var m=this,Lh=[],Ri=-1,Si=0,ua=0,Qc=parseInt(Z.Utils.getResource("z90"),10),tk=8*Qc,uk=4*Qc,Nh=0,Bb=parseInt(Z.Utils.getResource("z221"),10),Hb=parseInt(Z.Utils.getResource("z219"),10),Kd=parseFloat(Z.Utils.getResource("z218")),Dl=Kd/2,te=parseInt(Z.Utils.getResource("z220"),10),Cl=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT"),
10),Ii=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDTIMEVIEWPORT"),10),Ji=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDVIEWPORT"),10),di=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDTIMEVIEWPORT"),10),nf,Ga,Bc,Ib,Kg,ig,Lg,hc,eb,L,Ph,za,Ea,pe,Mg,wa,hb,kb,kh,jd,Xe,of,Rh,Ob,Ye,Kf,Ka,jc,oh,ph,Mf,Of,Sh,Wb,$c,kg,Th,tb,oc,na,mh,oe,Qh,Lf,lh,ne,jg,Kb,$b,Mb,ki,mc,ic,sb,Cc,T,Xb,lb,Jb,ra;W(Ja);var Wa,If=[],aa=[],We=[],jh=[],Jf=[],mf=[],me=[],pi=[],hg=[],ac=[],Oh=[],Nb=1,Sa=0,fc=
0,re,qh,rh,Q=!1,H=0,th=!1,Ia,pd,od,Lc,Vb=[],Nc=[],vb=[],Oc=[],hd=[],vd=[],uc=[],Pb=[],wd=[],le=[],qd=0,Se=0,Vh=0,Gf=0,vh=0,wh=0,pg=0,mi,Rg=0,Qf=0,qg=0,$e=0,rf=0,bf=0,sf=0,Sf=0,Ge=[],va=[],gd=[],Hd=[],He=[],ke=[],Rf=null,Tf=0,si=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYLIMIT"),10),Xh=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYDELAY"),10),xd=[],Cb=[],Ie=[],yd=[],sh=new Z.NetConnector,xh,Ve=[],Ue=[],Te=[],Hf=[],cg=parseInt(Z.Utils.getResource("z81"),10),ri=parseInt(Z.Utils.getResource("z78"),
10),Og=parseInt(Z.Utils.getResource("z80"),10),Ke=parseInt(Z.Utils.getResource("z77"),10),H=Ke,Pg=parseInt(Z.Utils.getResource("z79"),10),Pf=parseInt(Z.Utils.getResource("z76"),10),Ze=parseInt(Z.Utils.getResource("z75"),10),ih=null,hh=null,gg=null,Mi=parseFloat(Z.Utils.getResource("z173UNCONVERTED"),10),Ni=null!==Z.panBuffer?Z.panBuffer:parseFloat(Z.Utils.getResource("z173"),10),Ng="unconverted"!=Z.tileSource?Ni:Mi,Uh=parseFloat(Z.Utils.getResource("z74"),10),qi=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXBROWSER"),
10),nh=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXFIREFOX"),10),mg=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXMOBILE"),10),lg=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXIMAGESET"),10),ka,ha,Ig,Jg,qb,cb,ad,Dc,Pc,pc,Le,se,ng,Qg,zd,Rd,ni=1==Z.toolbarVisible&&Z.toolbarBackgroundVisible?null!==Z.toolbarH?Z.toolbarH:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARHEIGHT"),10):0;ka=Z.viewerW;ha=Z.viewerH-ni;Ig=0;Jg=0==Z.toolbarPosition?ni:0;var lf=null,Df,ii,ah=null,Cg=null,bg="counter"!=
Z.labelMode?1:0,Xc=null,tc=null,Bg=null,Kh=null,ag=!1,li=parseInt(Z.Utils.getResource("z122"),10),Bf=null,hi=null,Cf=null,Dg,ch=null,$g=!1,gj=parseInt(Z.Utils.getResource("DEFAULT_PINCHTESTDURATION"),10),eh=Math.round(parseFloat(Z.Utils.getResource("z176"))*Z.panSpeed),Wc=0,md=0,Gg=null,dh=null,Ki=parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALMOTIONIMAGES"),10),hj=parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALPOSITIONDELTA"),10),Re=null,bh=null,Ef=null,Qe=null,zc=0,ed=0,Y=0,cc=0,nc=
null,Eg=null,Fg=null,Hg=parseFloat(Z.Utils.getResource("z242"))*Z.zoomSpeed;Z.mobileDevice&&(Hg/=2);var nd=0,hf=null,Fi=0,Fh=parseInt(Z.Utils.getResource("z238"),10),Wh=parseFloat(Z.Utils.getResource("z112"))*Z.fadeInSpeed,og=null,fh=parseInt(Z.Utils.getResource("DEFAULT_ROTATIONSTEPDEGREES"),10),Hh=parseInt(Z.Utils.getResource("DEFAULT_ROTATIONSTEPDURATION"),10),$f=0,Gd=null,El=parseFloat(Z.Utils.getResource("z239")),dj=parseFloat(Z.Utils.getResource("z240"));Z.mobileDevice&&(dj/=2);var Zh=null,
gi=0;if(!Z.fullScreenVisible&&!Z.fullPageVisible)var Nj,Oj,Uk,Vk,Pj,Wk,oi,Qj;Z.crosshairsVisible&&Z.Utils.drawCrosshairs(Z.ViewerDisplay,ka,ha);if(Z.measureVisible||null!==Z.editMode||Z.annotations){var hl=parseFloat(Z.Utils.getResource("DEFAULT_CAPTIONBACKALPHA")),jl=Z.Utils.getResource("z431"),kl=Z.Utils.getResource("z431TOTAL"),ll=Z.Utils.getResource("z433"),nl=Z.Utils.getResource("z430"),ml=Z.Utils.getResource("z434");parseInt(Z.Utils.getResource("z154"),10);parseInt(Z.Utils.getResource("z156"),
10)}if(Z.geoCoordinatesVisible)var Kj,Lj,Ij,Jj,Li,Mj,Sk,Tk;if(Z.imageFilters)var lj=null,Mh=null,mj=null,uh=!1,Xa=[],af=[],ej,fj,Rj,Gi,Sj=0,Tj=0,Uj=0,Vj=0,Wj=0,Xj=0,Yj=0,Zj=0,ak=0,bk=0,ck=0,dk=0,ek=0,fk=0,gk=0,hk=0,ik=0,jk=0,kk=0,lk=0,mk=0,nk=0;if(Z.watermarks)var Sg,vk,Xk=[],Yk=[];if(Z.imageList)var Ed,Yf,cj,ok,ef=[];if(0<Z.magnifierVisible)var eg=[],fg=[],Je=[],Ah,Yg,zf,Pe,Aj,Ci,Di,Ee,nj,oj,Xg,Xi;if(Z.annotationFileList)var Vc,Zk=[];if(Z.tour)var Ug,Bi,pk,Cj;null!==Z.imagePath&&(-1!=Z.imagePath.indexOf("zComparisonPath")?
(Z.imageSetPath=Z.imagePath.substring(16,Z.imagePath.length),Z.imageSet=!0,Z.comparison=!0):-1!=Z.imagePath.indexOf("zSlidePath")?(Z.slidePath=Z.imagePath.substring(11,Z.imagePath.length),Z.slideshow=!0):-1!=Z.imagePath.indexOf("zAnimationPath")?(Z.imageSetPath=Z.imagePath.substring(15,Z.imagePath.length),Z.imageSet=!0,Z.animation=!0):-1!=Z.imagePath.indexOf("zSlidestackPath")&&(Z.imageSetPath=Z.imagePath.substring(16,Z.imagePath.length),Z.imageSet=!0,Z.slidestack=!0));if(Z.slideshow){var td=[],pj=
[],Zf,je,fi,qk,rk,Ui,Dj,$k=parseFloat(Z.Utils.getResource("z211"))*Z.slideTransitionSpeed;Z.slideTransitionTimeout=null;Z.slideOpacity=0}if(Z.zoomRectangle||Z.measureVisible||Z.tour||Z.hotspots||Z.annotations||Z.tracking){var yf=null,Mk=null,xi=!1,A=[],rc=[],Ad=[],ui=[],vi=[],ba=null,ea=null,Zb=null,zi=null,ci=null,Ai=null,al=0,ei=null,xg=null,Oi=null,ol=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDHOTSPOT"),10),Ya,bi=!1,he=!0,Xf=null,Al=2,Hi=null,wk=new Z.NetConnector,vj=Z.Utils.getResource("DEFAULT_SHAPELINEWIDTH"),
Ck=Z.Utils.getResource("z177"),pl=parseFloat(Z.Utils.getResource("DEFAULT_POLYGONALPHA")),Tg=parseInt(Z.Utils.getResource("z180"),10),ql=Z.Utils.getResource("z96"),rl=Z.Utils.getResource("z98"),sl=Z.Utils.getResource("z113"),tl=Z.Utils.getResource("z216"),$i=parseInt(Z.Utils.getResource("z97"),10),Bk=Z.Utils.getResource("z177FREEHAND"),rg=Z.captionTextColor?Z.Utils.stringValidateColorValue(Z.captionTextColor):Z.Utils.getResource("z89"),uj=Z.captionBackColor?Z.Utils.stringValidateColorValue(Z.captionBackColor):
Z.Utils.getResource("DEFAULT_CAPTIONBACKCOLOR"),zh=Z.Utils.getResource("DEFAULT_LABELSTROKECOLOR"),Nk=Z.Utils.getResource("DEFAULT_LABELFILLCOLOR"),xk=parseInt(Z.Utils.getResource("z129"),10),Yi=parseInt(Z.Utils.getResource("z160"),10),Zi=parseInt(Z.Utils.getResource("z151"),10),il=parseInt(Z.Utils.getResource("z130"),10),yk=parseInt(Z.Utils.getResource("z161"),10),zk=parseInt(Z.Utils.getResource("z152"),10);Z.mobileDevice&&($i*=2);if(Z.maskVisible){var wg=[],bl=parseFloat(Z.Utils.getResource("DEFAULT_MASKFADESTEP"))*
Z.maskFadeSpeed;Z.setCallback("viewUpdateComplete",function(){Z.maskingSelection&&updateMask()})}if(Z.tour||Z.hotspots)var mb,qj,Vi,rj,$h,ai,Xd=[],ti=parseFloat(Z.Utils.getResource("DEFAULT_SHAPEWIDTH")),yh=parseFloat(Z.Utils.getResource("DEFAULT_SHAPEHEIGHT")),Ta=[],Sb=[];else if(Z.zoomRectangle||Z.measureVisible||Z.annotations||Z.tracking){var Yc,Wi,cl,sa,ob,Oa,ug,Nf,rd,pf,qf,dl,el,fl,gl,wi,db=[],zb=[],yc=[],Ta=[],Sb=[],yi=[];labelLineStyleListDP=[];labelCaptionPositionListDP=[];labelTargetListDP=
[];var yj=[],wj=[],xj=[],aj=[],zj=[],Ak=!1,Ff=null,jf=0,Gh=null,sj=parseFloat(Z.Utils.getResource("z147")),Jk=parseInt(Z.Utils.getResource("z148"),10),ti=parseFloat(Z.Utils.getResource("DEFAULT_SHAPEWIDTH")),yh=parseFloat(Z.Utils.getResource("DEFAULT_SHAPEHEIGHT"));Z.mobileDevice&&(sj/=2);if(Z.tracking)var Ch,Bj,ie=[],Fe=[],Kc=[],Ag=[],Ac}}if(null!==Z.imagePath&&"null"!=Z.imagePath){var Pi=!Z.localUse;Z.localUse&&("ZoomifyZIFFile"!=Z.tileSource||Z.useLocalFile?"ZoomifyPFFFile"!=Z.tileSource||Z.useLocalFile?
Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&7<=Z.browserVersion?Z.Utils.showMessage(Z.Utils.getResource("z288"),!1,Z.messageDurationStandard,"center"):Pi=!0:Z.Utils.showMessage(Z.Utils.getResource("z289"),!1,Z.messageDurationStort,"center"):Z.Utils.showMessage(Z.Utils.getResource("z290"),!1,Z.messageDurationShort,"center"));if(null!==Z.imageW&&null!==Z.imageH&&null!==Z.sourceMagnification)"undefined"!==typeof m.getStatus?
n(Z.imageW,Z.imageH,Bb,Hb,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality):window.setTimeout(function(){n(Z.imageW,Z.imageH,Bb,Hb,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality)},100);else if(null!==Z.imageProperties){var Fl=Z.Utils.xmlConvertTextToDoc(Z.imageProperties),Pi=!1;fa(Fl)}else"unconverted"==Z.tileSource?(Pi=!1,ja(kd)):Pi=-1==Z.imagePath.indexOf("zComparisonPath")&&-1==Z.imagePath.indexOf("zSlidePath")&&-1==Z.imagePath.indexOf("zOverlayPath")&&-1==Z.imagePath.indexOf("zAnimationPath")&&
-1==Z.imagePath.indexOf("zSlidestackPath")?!0:!1;if(Pi){var sk=new Z.NetConnector;ga(kd,sk,Ja)}}Z.imageList&&l();Z.slideshow&&(sk=new Z.NetConnector,E(sk));this.clearAll=function(a,b,e,f){a&&G();b&&K();e&&(Ob&&("undefined"!==typeof Xk&&Z.Utils.arrayClear(Xk),"undefined"!==typeof Yk&&Z.Utils.arrayClear(Yk)),Ka&&("undefined"!==typeof A&&Z.Utils.arrayClear(A),"undefined"!==typeof rc&&Z.Utils.arrayClear(rc),"undefined"!==typeof Ad&&Z.Utils.arrayClear(Ad),null!=mb?(mb.parentNode.removeChild(mb),mb=null,
"undefined"!==typeof Xd&&Z.Utils.arrayClear(Xd)):Z.narrative||(null!=sa&&(sa.parentNode.removeChild(sa),sa=null,"undefined"!==typeof db&&Z.Utils.arrayClear(db)),null!=Oa&&(Oa.parentNode.removeChild(Oa),Oa=null,"undefined"!==typeof Ta&&Z.Utils.arrayClear(Ta),"undefined"!==typeof Sb&&Z.Utils.arrayClear(Sb)),null!=ob&&(ob.parentNode.removeChild(ob),ob=null,"undefined"!==typeof zb&&Z.Utils.arrayClear(zb),"undefined"!==typeof yc&&Z.Utils.arrayClear(yc))),Mc=null,Fd=Z.annotationPath=null,Z.annotationFolder=
null),Z.imageFilters&&(mj=Mh=lj=null,uh=!1,"undefined"!==typeof Xa&&Z.Utils.arrayClear(Xa),"undefined"!==typeof af&&Z.Utils.arrayClear(af),Gi=Rj=fj=ej=null,nk=mk=lk=kk=jk=ik=hk=gk=fk=ek=dk=ck=bk=ak=Zj=Yj=Xj=Wj=Vj=Uj=Tj=Sj=0));f&&(Ga&&Z.Utils.clearDisplay(Ga),za&&Z.Utils.clearDisplay(za),wa&&Z.Utils.clearDisplay(wa),jd&&Z.Utils.clearDisplay(jd),Ob&&Z.Utils.clearDisplay(Ob),sb&&Z.Utils.clearDisplay(sb),Ka&&(Z.Utils.clearDisplay(Ka),Ka=null),Ah&&(m.setStatus("magnifierInitializedViewport",!1),Ah=null),
Mf&&!Z.narrative&&(m.clearAnnotationPanel(Ja),m.setStatus("annotationPanelInitializedViewport",!1),Mf=null),Wb&&Z.Utils.clearDisplay(Wb),tb&&Z.Utils.clearDisplay(tb),oe&&Z.Utils.clearDisplay(oe),ne&&Z.Utils.clearDisplay(ne))};this.setSizeAndPosition=function(a,b,e,f){oa(a,b,e,f)};this.syncViewportResize=function(a,b,e,f){m.resizeViewport(a,b,e,f)};this.resizeViewport=function(a,b,e,f){m.validateXYZDefaults();m.setSizeAndPosition(Z.viewerW,ha,0,0);m.setView(a,b,e,f)};this.loadImageProperties=function(a,
b,e){ga(a,b,e)};this.parseZIFHeader=function(a){K();if(73==a[0]&&73==a[1]&&43==a[2]&&0==a[3]&&8==a[4]&&0==a[5]&&0==a[6]&&0==a[7]&&16==a[8]&&0==a[9]&&0==a[10]&&0==a[11]&&0==a[12]&&0==a[13]&&0==a[14]&&0==a[15]){for(var b=Z.Utils.longValue(a,8),e=Z.Utils.longValue(a,b),f=1,g=null,p=null,k=null,l=null,r=null,q=null,q=2;0!=b;){for(g=0;g<e;g++)switch(p=b+8+20*g,Z.Utils.shortValue(a,p)){case 256:Vb[f-1]=Z.Utils.intValue(a,p+12);break;case 257:Nc[f-1]=Z.Utils.intValue(a,p+12);break;case 322:k=Z.Utils.intValue(a,
p+12);break;case 323:l=Z.Utils.intValue(a,p+12);break;case 324:var u=aa[f-1]=Z.Utils.longValue(a,p+4);If[f-1]=Z.Utils.longValue(a,p+12);r+=u;break;case 325:u=mf[f-1]=Z.Utils.longValue(a,p+4),Jf[f-1]=1==u?Z.Utils.intValue(a,p+12):2==u?Z.Utils.intValue(a,p+12)+","+Z.Utils.intValue(a,p+16):Z.Utils.longValue(a,p+12)}b=Z.Utils.longValue(a,b+20*e+8);e=Z.Utils.longValue(a,b);f++}g=Vb[0];p=Nc[0];Nb=f-1;re=Nb-1;Vb.reverse();Nc.reverse();aa.reverse();If.reverse();mf.reverse();Jf.reverse();!isNaN(g)&&0<g&&!isNaN(p)&&
0<p&&!isNaN(k)&&0<k&&!isNaN(l)&&0<l&&0<r?m.getStatus("initializedViewport")?w(g,p,k,l,r,q,null,null,null,null,null):n(g,p,k,l,r,q,null,null,null,null,null):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}};this.parseZIFOffsetChunk=function(a,b){var e=Z.Utils.arrayIndexOfObjectValue(We,"chunkID",b);-1!=e&&(We[e].chunk=a,bb(b,"offset"))};this.parseZIFByteCountChunk=function(a,b){var e=Z.Utils.arrayIndexOfObjectValue(me,"chunkID",b);-1!=e&&(me[e].chunk=a,bb(b,"byteCount"))};
this.parseZIFImage=function(a,b,e){a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(a);var f;"image-display"==e?f=m.getStatus("imageSaving")?wb:Ua:"image-backfill"==e?f=m.getStatus("imageSaving")?fb:ya:"image-magnifier"==e?f=qc:"navigator"==e?Z.comparison&&0!=Ja?Z.Navigator2&&(f=Z.Navigator2.z556):Z.Navigator&&(f=Z.Navigator.z556):"gallery"==e&&(f=Z.Gallery.initializeGallery);b=Z.Utils.createCallback(null,f,b);Z.Utils.createImageElementFromBytes(a,b)};this.parsePFFImage=function(a,b,e){if(Z.pffJPEGHeadersSeparate){var f=
Z.Utils.intValue(a,a.length-4,!0);a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(hg[f],0)+Z.Utils.encodeBase64(a,0)}else a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(a);var g;"image-display"==e?g=m.getStatus("imageSaving")?wb:Ua:"image-backfill"==e?g=m.getStatus("imageSaving")?fb:ya:"image-magnifier"==e?g=qc:"navigator"==e?g=Z.Navigator.z556:"gallery"==e&&(g=Z.Gallery.initializeGallery);b=Z.Utils.createCallback(null,g,b);Z.Utils.createImageElementFromBytes(a,b)};this.parsePFFHeader=function(a){K();
if("undefined"!==typeof a&&null!==a){var b=null,e=null,f=null,g=null,p=null,k=null;Z.Utils.intValue(a,8,!0);g=Z.Utils.intValue(a,108,!0);k=1060+Z.Utils.intValue(a,116,!0);p=Z.Utils.intValue(a,124,!0);Z.Utils.intValue(a,136,!0);Z.pffJPEGHeadersSeparate=!0;b=Z.Utils.intValue(a,1052,!0);e=Z.Utils.intValue(a,1056,!0);f=g;Z.pffJPEGHeadersSeparate?(Z.imageW=b,Z.imageH=e,Z.imageCtrX=Z.imageW/2,Z.imageCtrY=Z.imageH/2,Z.imageD=Math.round(Math.sqrt(b*b+e*e)),Si=Ri=null,ua=k,Nh=p,Bb=f,Hb=g,(new Z.NetConnector).loadByteRange(kd,
1060,k,"loadingPFFFileBytes","jpegHeaders")):ma(b,e,f,g,p,null,null,k,null,null,null)}};this.parsePFFJPEGHeaders=function(a){if("undefined"!==typeof a&&null!==a){for(var b=Z.Utils.intValue(a,0,!0),e=4,f=0;f<b;f++){var g=Z.Utils.intValue(a,e,!0),e=e+4,p=Z.Utils.dataSlice(a,e,e+g),e=e+g;hg.push(p)}ma()}};this.z602=function(a,b){fa(a,b)};this.validateXYZDefaults=function(a){a&&Z.Utils.resetParametersXYZ(Z.parameters);var b=parseFloat(Z.Utils.getResource("z143")),e=parseFloat(Z.Utils.getResource("z144")),
f=parseFloat(Z.Utils.getResource("z145")),g=parseFloat(Z.Utils.getResource("DEFAULT_INITIALR")),p=parseFloat(Z.Utils.getResource("z163"));a=parseFloat(Z.Utils.getResource("z153"));b=isNaN(b)?null:b;e=isNaN(e)?null:e;f=isNaN(f)?null:f;g=isNaN(g)?null:g;p=isNaN(p)?null:p;a=isNaN(a)?null:a;Z.bookmarksGet?(Z.initialX||(Z.initialX=b),Z.initialY||(Z.initialY=e),Z.initialZ||(Z.initialZ=f),Z.initialR||(Z.initialR=g),Z.minZ||(Z.minZ=p),Z.maxZ||(Z.maxZ=a)):"IIIFImageServer"==Z.tileSource?Z.iiifRegion&&(a=Z.iiifRegion.split(","),
b=Z.iiifSize.split(","),Z.initialX=Math.round(parseFloat(a[0])+parseFloat(a[2])/2),Z.initialY=Math.round(parseFloat(a[1])+parseFloat(a[3])/2),Z.initialZ=Math.round(parseFloat(b[0])/parseFloat(a[2])*100)/100,Z.initialR=parseInt(Z.iiifRotation,10)):Z.parameters?(Z.parameters.zInitialX||(Z.initialX=b),Z.parameters.zInitialY||(Z.initialY=e),Z.parameters.zInitialZoom||(Z.initialZ=f),Z.parameters.zInitialRotation||(Z.initialR=g),Z.parameters.zMinZoom||(Z.minZ=p),Z.parameters.zMaxZoom||(Z.maxZ=a)):(Z.initialX=
b,Z.initialY=e,Z.initialZ=f,Z.initialR=g,Z.minZ=p,Z.maxZ=a);null===Z.initialX&&(Z.initialX=Z.imageW/2);null===Z.initialY&&(Z.initialY=Z.imageH/2);Z.fitZ=m.z468(null,null,0);Z.fillZ=m.calculateZoomToFill(null,null,0);b=m.getStatus("initializedViewport")?m.getRotation():Z.initialR;a=m.z468(null,null,b);b=m.calculateZoomToFill(null,null,b);1<Z.fitZ&&(null!==Z.maxZ?Z.fitZ>Z.maxZ&&(Z.fitZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fitZ=1));1<Z.fillZ&&(null!==Z.maxZ?Z.fillZ>Z.maxZ&&(Z.fillZ=Z.maxZ):"unconverted"==
Z.tileSource&&(Z.fillZ=1));null===Z.minZ||-1==Z.minZ?Z.minZ=Z.fitZ:0==Z.minZ&&(Z.minZ=Z.fillZ);if(null===Z.maxZ||-1==Z.maxZ)Z.maxZ=1;null===Z.initialZ||-1==Z.initialZ?Z.initialZ=a:0==Z.initialZ&&(Z.initialZ=b);Z.initialZ<Z.minZ&&(Z.initialZ=Z.minZ);Z.initialZ>Z.maxZ&&(Z.initialZ=Z.maxZ)};this.getViewW=function(){return ka};this.getViewH=function(){return ha};this.getDisplayW=function(){return qb};this.getDisplayH=function(){return cb};this.getImagePath=function(){return kd};this.setImagePath=function(a){kd=
a};this.getViewportID=function(){return Ja};this.getTierCount=function(){return Nb};this.getTileW=function(){return Bb};this.getTileH=function(){return Hb};this.getTierCurrent=function(){return Sa};this.getTierBackfill=function(){return fc};this.getTierBackfillDynamic=function(){return Q};this.getTierBackfillOversize=function(){return H};this.getTierScale=function(){return Ia};this.getX=function(a){var b=parseFloat(L.left)-Pc;a=m.getZoom(a);return Ej-b/a};this.getY=function(a){var b=parseFloat(L.top)-
pc;a=m.getZoom(a);return Fj-b/a};this.getZoom=function(a){var b=Ia;a&&(b=Ia*parseFloat(hb.width)/qb);return Aa(Sa,b)};this.getRotation=function(a){return Z.imageR};this.getCoordinates=function(){new Z.Utils.Point(m.getX(),m.getY())};this.getCoordinatesBookmark=function(a,b){var e="";return e=b?"?"+m.getViewCoordinatesIIIFString(a,null,"bookmark"):"?"+m.getViewCoordinatesString(a)};this.getViewCoordinatesString=function(a){var b="x="+Math.round(m.getX(a)).toString(),e="&y="+Math.round(m.getY(a)).toString(),
f="&z="+Math.round(100*m.getZoom(a)).toString();a=Math.round(m.getRotation(a));return b+e+f+(0==a?"":"&r="+a.toString())};this.getCoordinatesFull=function(a){return new Z.Utils.Coordinates(m.getX(a),m.getY(a),m.getZoom(a),m.getRotation(a))};this.getCoordinatesDisplayFull=function(){return new Z.Utils.CoordinatesDisplayStyle(L.left,L.top,hb.width,hb.height,hb.left,hb.top,Ea.width,Ea.height,Ea.left,Ea.top,Z.imageR)};this.getTiersScaleUpMax=function(){return Kd};this.getTiersScaleDownMax=function(){return Dl};
this.getTilesCacheMax=function(){return te};this.getTierWs=function(){return Vb.join(",")};this.getTierHs=function(){return Nc.join(", ")};this.getTierTileCounts=function(){return hd.join(", ")};this.getTilesToLoad=function(){return qd};this.getTilesLoadingNames=function(){return""==va.join(", ")?"Current view loading complete":va.join(", ")};this.getTilesToDraw=function(){return bf};this.getConstrainPan=function(a){return Z.constrainPan};this.setConstrainPan=function(a){Z.constrainPan="0"!=a;Z.constrainPanLimit=
parseInt(a,10);Z.constrainPanStrict="3"==a;Z.constrainPan&&m.toggleConstrainPan(!0)};this.getSmoothPan=function(){return Z.smoothPan};this.setSmoothPan=function(a){Z.smoothPan=a};this.getSmoothPanEasing=function(){return Z.smoothPanEasing};this.setSmoothPanEasing=function(a){Z.smoothPanEasing=a};this.getSmoothPanGlide=function(){return Z.smoothPanGlide};this.setSmoothPanGlide=function(a){Z.smoothPanGlide=a};this.getSmoothZoom=function(){return Z.smoothZoom};this.setSmoothZoom=function(a){Z.smoothZoom=
a};this.getSmoothZoomEasing=function(){return Z.smoothZoomEasing};this.setSmoothZoomEasing=function(a){Z.smoothZoomEasing=a};this.getImageMetadataXML=function(){return Z.imageMetadataXML};this.setCoordinatesDisplayVisibility=function(a){a?(Z.Utils.addEventListener(document,"mousemove",ij),Z.Utils.addEventListener(document,"mousedown",ij)):(Z.coordinatesVisible=!1,Z.Utils.removeEventListener(document,"mousemove",ij),Z.Utils.removeEventListener(document,"mousedown",ij))};this.setTourPath=function(a,
b){m.setHotspotPath(a,b)};this.setHotspotPath=function(a,b){"undefined"===typeof a||Z.Utils.stringValidate(a)?(Z.hotspotPath=Z.Utils.stringRemoveTrailingSlash(a),Z.hotspotFolder=Z.hotspotPath,".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/"))),b||(m.deleteAllHotspots(),Od(Ja))):(Z.hotspotPath=null,Z.hotspotFolder=null,m.deleteAllHotspots())};this.getHotspotCurrentID=function(){return ea};
this.getHotspotCurrentIDExternal=function(){var a=m.getHotspotCurrentID();return currIDExt=A[a].id};this.getHotspots=function(){return A};this.setHotspots=function(a){A=a.slice(0)};this.getAnnotationPath=function(){return Mc};this.setAnnotationPath=function(a,b){if("undefined"!==typeof a&&Z.Utils.stringValidate(a)){Mc=Z.annotationPath=Z.Utils.stringRemoveTrailingSlash(a);Z.annotationFolder=Z.annotationPath;var e=Z.annotationPath.toLowerCase();".json"!=e.substring(Z.annotationPath.length-5,Z.annotationPath.length)&&
".xml"!=e.substring(Z.annotationPath.length-4,Z.annotationPath.length)&&(Z.annotationPath=Z.annotationPath+"/"+Z.Utils.getResource("z69"));".xml"==e.substring(Z.annotationPath.length-4,Z.annotationPath.length)&&(Z.annotationFolder=Z.annotationFolder.substring(0,Z.annotationFolder.lastIndexOf("/")));Z.annotations=!0;Z.annotationPathProvided=!0;b||(m.deleteAllAnnotations(),gc(Ja))}else Z.annotationPath=null,Z.annotationFolder=null,m.deleteAllAnnotations(),Z.annotations=!1};this.testSetAnnotationPath=
function(){m.setAnnotationPath("Assets/Annotations/annotations2.xml")};this.getAnnotationsXML=function(){return Yc=U(Yc)};this.setAnnotationsXML=function(a){Yc=a};this.setXMLCallbackFunction=function(a){Z.xmlCallbackFunction=a};this.setLabelClickDrag=function(a){Z.labelClickDrag=a};this.setVisibility=function(a,b){if(b){var e=a?1:0;nf&&Z.Utils.setOpacity(nf,e);hc&&Z.Utils.setOpacity(hc,e)}else e=a?"inline-block":"none",nf&&!Bc&&(Bc=nf.style),Bc&&(Bc.display=e),hc&&!L&&(L=hc.style),L&&(L.display=e)};
this.setOpacity=function(a){Z.Utils.setOpacity(hc,2<=a?a/100:0>a?0:1<a?1:a)};this.showLists=function(a){var b=a?"visible":"hidden";Ed&&(m.setImageListVisibilty(b),Z.comparison&&Z.Viewport1.setImageListVisibilty(b));Z.annotationFileList&&m.setAnnotationFileListVisibilty(b);Z.hotspots&&Z.Viewer.setVisibilityHotspotChoiceList(a,Ja.toString());Z.slideshow&&Z.Viewport.setVisibilitySlidesChoiceList(a);Z.imageSet&&!Z.comparison&&Z.Viewer.setVisibilityImageSetChoiceList(a)};this.getLabelList=function(){if("undefined"!==
typeof Ta){var a=Z.Utils.arrayClone("labels",Ta,a);return a}};this.z619=function(b){u();b||(C(Ze,Pb),ih=!0);(!Z.imageSet||Z.comparison||a==Z.imageSetStart||b)&&Nb>Pg&&(C(Pf,Pb),hh=!0,Nb>Og&&(C(Ke,Pb),gg=!0),m.setStatus("backfillPrecachedViewport",!0));Pb.sort();Pb=Z.Utils.arrayUnique(Pb);vd=Pb.slice(0);m.traceDebugValues("tilesBackfillToPrecache",null,vd.length);xa(Pb,ya,"simple","image-backfill")};this.prez581s=function(a){if(Z.imageSet)Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGESET-LOADINGTILES"),
!1,Z.messageDurationLong,"center"),m.updateView(!0,!0);else{Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGONEIMAGE-LOADINGTILES"),!1,Z.messageDurationLong,"center");Z.Utils.arrayClear(va);a=0;for(var b=Nb;a<b;a++)for(var e=m.z542(a,null,!0,!0),f=e.l,g=e.r;f<=g;f++)for(var p=e.t,k=e.b;p<=k;p++){var l=a+"-"+f+"-"+p;va[va.length]=l}if(0<va.length)for(e=(new Date).getTime(),a=0,b=va.length;a<b;a++)if(l=va[a])l=new La(l,"image-display"),qa(l,e,Ua)}};this.updateView=function(b,e,f){if("undefined"===
typeof a||null===a)a=0;if(a!=Z.viewportCurrentID&&!b){var g=Z["Viewport"+a.toString()];Z.imageX=g.getX(!0);Z.imageY=g.getY(!0);Z.imageZ=g.getZoom(!0);Z.imageR=g.getRotation(!0)}var k=Z.mouseIsDown||Z.buttonIsDown||Z.keyIsDown||Z.mouseWheelIsDown,g=Ia!=pd||m.getZoom()!=Z.imageZ,p=parseFloat(L.left)!=Pc||parseFloat(L.top)!=pc||m.getX()!=Z.imageX||m.getY()!=Z.imageY,l=Z.fullViewPrior,r=Z.animation||Z.slideshowPlaying;if(g||p||l||"undefined"!==typeof b&&b&&(!k||r)||"undefined"!==typeof e&&e||"external"==
Z.imageFilters){f||Fk();if(Z.comparison||Z.overlays||!Z.imageSet||!Z.Viewer.getStatus("readyViewer")||a>Z.viewportCurrentID-1&&a<Z.viewportCurrentID+1||e){var q=!1;if(b||parseFloat(hb.width)!=wa.width){if(Z.useCanvas){hb.width=wa.width+"px";hb.height=wa.height+"px";hb.left="0px";hb.top="0px";kb.restore();kb.save();try{kb.scale(Ia,Ia)}catch(n){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE")),console.log("In function z630 scaling canvas:  "+n)}sb&&(Cc.width=wa.width+
"px",Cc.height=wa.height+"px",Cc.left="0px",Cc.top="0px");Wb&&($c.width=Wb.width+"px",$c.height=Wb.height+"px",$c.left="0px",$c.top="0px");tb&&(oc.width=tb.width+"px",oc.height=tb.height+"px",oc.left="0px",oc.top="0px");za&&(Q?(Ea.width=za.width+"px",Ea.height=za.height+"px",Ea.left=zd+"px",Ea.top=Rd+"px",pe.restore(),pe.save(),pe.scale(od,od)):(Ea.width=Le+"px",Ea.height=se+"px",Ea.left=zd+"px",Ea.top=Rd+"px"))}q=!0}if(b||parseFloat(L.left)!=Pc||parseFloat(L.top)!=pc)q=parseFloat(L.left)-Pc,f=parseFloat(L.top)-
pc,0!=Z.imageR&&(f=Z.Utils.rotatePoint(q,f,Z.imageR),q=f.x,f=f.y),L.left=Pc+"px",L.top=pc+"px",Q||(zd=parseFloat(Ea.left)+q,Rd=parseFloat(Ea.top)+f,Ea.left=zd+"px",Ea.top=Rd+"px"),k=m.getZoom(),Z.imageX=Ej=Z.imageX-q/k,Z.imageY=Fj=Z.imageY-f/k,q=!0;q&&(R(wa,Sa,gd,"centerOut",!1,"1a. Updating view: resetting display positions"),Z.maskingSelection&&sb&&cd(),Q&&R(za,fc,uc,"simple",!1,"1b. Updating view: resetting backfill positions"));q=!1;if("undefined"!==typeof b&&b||Ia!=pd||m.getZoom()!=Z.imageZ||
!m.getStatus("initializedViewport")||e){Ia!=pd&&(Z.imageZ=m.getZoom());Z.imageZ<Z.minZ&&(Z.imageZ=Z.minZ);Z.imageZ>Z.maxZ&&(Z.imageZ=Z.maxZ);k=Kd;for(f=Nb;0<f&&k/2>=Z.imageZ;)f--,k/=2;f=0>f-1?0:f-1;k=la(f,Z.imageZ);if(f!=Sa||k!=Ia)Z.useCanvas&&(kb.restore(),kb.save(),kb.scale(k,k)),Sa!=f&&(th=!0),Sa=f,Ia=k;pd=Ia;"unconverted"!=Z.tileSource&&(u(),Z.imageFilters&&kf("backfill"),R(za,fc,uc,"simple",!1,"2. Updating view: changing tier - backfill"));!b&&0<te&&(q=!0)}else m.traceDebugValues("updateView-noChange");
"unconverted"!=Z.tileSource&&Q?D(!0):Ga&&Z.Utils.clearDisplay(Ga)}a==Z.viewportCurrentID||Z.comparison||Z.overlays||!Z.imageSet||e?("unconverted"!=Z.tileSource?(D(),Z.imageFilters&&kf("frontfill"),R(wa,Sa,null,"centerOut",q,"3. Updating view: prior to loading of any new tiles")):"undefined"!==typeof Wa&&(b=-Z.imageX,q=-Z.imageY,Z.Utils.clearDisplay(wa),kb.drawImage(Wa,b,q),m.setStatus("displayLoadedViewport",!0),m.setStatus("displayDrawnViewport",!0),Z.Utils.validateCallback("viewUpdateComplete"),
Z.Utils.validateCallback("viewUpdateCompleteGetLabelIDs")),Z.maskingSelection&&updateMask(),0<va.length?xa(va,Ua,"centerOut","image-display"):Z.imageFilters&&m.cacheCanvasImage(),m.syncViewportRelated(!0,!0,!0,!0,!0,!0,Z.comparison&&a==Z.viewportCurrentID,Z.overlays&&a==Z.viewportCurrentID,Z.bookmarksSet,Z.tracking)):(m.setStatus("displayLoadedViewport",!0),m.setStatus("displayDrawnViewport",!0));e&&(e=null!==Z.imageSetLength?Z.imageSetLength.toString():"",e=(m.getViewportID()+1).toString()+" of "+
e,Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGESET-UPDATINGVIEW")+"  "+e,!1,Z.messageDurationLong,"center"));p&&Z.Utils.validateCallback("viewPanned");g&&Z.Utils.validateCallback("viewZoomed");(p||g)&&Z.Utils.validateCallback("viewChanged")}};syncTransitionCanvas=function(){jd&&Xe&&of&&(jd.width=wa.width,jd.height=wa.height,Xe.width=hb.width,Xe.height=hb.height,Xe.left=hb.left,Xe.top=hb.top,of.restore(),of.save(),of.translate(ad,Dc),of.scale(Ia,Ia))};this.loadUnconvertedImage=function(a){ja(a)};
this.getUnconvertedImage=function(){return Wa};this.createUnconvertedImageThumbnail=function(a){if(Z.useCanvas){if("undefined"!==typeof Wa){var b=null,b=150/Z.imageW,e=Z.Utils.createContainerElement("canvas","tempCanvas","inline-block","absolute","visible",Z.imageW*b+"px",Z.imageH*b+"px","0px","0px","none","0px","transparent","0px","0px","normal"),f=e.getContext("2d");try{f.scale(b,b),f.drawImage(Wa,0,0)}catch(g){console.log("In function initializeViewportContinue scaling canvas:  "+g)}b=new Image;
b.src=e.toDataURL("image/jpeg",Z.saveImageCompression);if(0<b.width&&0<b.height)return b}window.setTimeout(function(){Z.Navigator.drawNavigatorImage(a)},100)}};this.Tile=function(a,b){return new La(a,b)};this.formatTilePath=function(a,b,e,f){var g;if("ZoomifyZIFFile"==Z.tileSource){var p=m.getViewportID(),k="offsetLoading",l=g="loading",r;if(1==aa[a])g=If[a];else{var q=new Ha(a,b,e),n=q.chunkID+","+a+","+b+","+e+","+f+",offset";r=Z.Utils.arrayIndexOfObjectValue(We,"chunkID",q.chunkID);-1==r?(m.traceDebugValues("z532",
q.chunkID+","+a+","+b+","+e+","+f),-1==Z.Utils.arrayIndexOf(Cb,n)&&(Cb[Cb.length]=n),We[We.length]={chunkID:q.chunkID,chunk:"loading"},r=new Z.NetConnector,r.loadByteRange(kd,q.chunkStart,q.chunkEnd,"loadingZIFFileBytes","offset",null,q.chunkID,p)):"loading"==We[r].chunk?-1==Z.Utils.arrayIndexOf(Cb,n)&&(Cb[Cb.length]=n):"loading"!=We[r].chunk&&(r=We[r].chunk,g=Z.Utils.longValue(r,q.offsetStartInChunk))}1==mf[a]?l=Jf[a]:(r=b+e*vb[a],2==mf[a]?(e=Jf[a],l=0==r?e.substring(0,e.indexOf(",")):e.substring(e.indexOf(",")+
1,e.length)):(q=new F(a,b,e),e=q.chunkID+","+a+","+b+","+e+","+f+",byteCount",r=Z.Utils.arrayIndexOfObjectValue(me,"chunkID",q.chunkID),-1==r?(-1==Z.Utils.arrayIndexOf(Cb,e)&&(Cb[Cb.length]=e),me[me.length]={chunkID:q.chunkID,chunk:"loading"},r=new Z.NetConnector,r.loadByteRange(kd,q.chunkStart,q.chunkEnd,"loadingZIFFileBytes","byteCount",null,q.chunkID,p)):"loading"==me[r].chunk?-1==Z.Utils.arrayIndexOf(Cb,e)&&(Cb[Cb.length]=e):"loading"!=me[r].chunk&&(r=me[r].chunk,l=Z.Utils.intValue(r,q.bcStartInChunk))));
"loading"==g||isNaN(g)||"loading"==l||isNaN(l)||(k=kd+"?"+g.toString()+","+l.toString());g=k}else if("ZoomifyImageFolder"==Z.tileSource){f=e*vb[a]+b;for(k=0;k<a;k++)f+=hd[k];e=kd+"/TileGroup"+Math.floor(f/256)+"/"+a+"-"+b+"-"+e+"."+Z.tileType;if(Z.browser==Z.browsers.IE&&9>Z.browserVersion||0==te)e=Z.Utils.cacheProofPath(e);g=e}else if("ZoomifyPFFFile"==Z.tileSource&&null===Z.tileHandlerPathFull){k=m.getViewportID();g="offsetLoading";p=l="loading";p=0;for(l=Nb-1;l>a;l--)p+=hd[l];p+=e*vb[a]+b;l=Math.floor(p/
Qc);r=ua+Qc*l*8;var q=r+8*Qc,u=p-l*Qc,n=8*u,v=l+","+a+","+b+","+e+","+f+",chunk",p=Z.Utils.arrayIndexOfObjectValue(ac,"chunkID",l);-1==p?(m.traceDebugValues("z531",l+","+a+","+b+","+e+","+f),-1==Z.Utils.arrayIndexOf(Cb,v)&&(Cb[Cb.length]=v),ac[ac.length]={chunkID:l,chunk:"loading"},(new Z.NetConnector).loadByteRange(kd,r,q,"loadingPFFFileBytes","offset",null,l,k)):"loading"==ac[p].chunk?-1==Z.Utils.arrayIndexOf(Cb,v)&&(Cb[Cb.length]=v):(l=Z.Utils.longValue(ac[p].chunk,8*(u-1),!0),p=Z.Utils.longValue(ac[p].chunk,
n,!0)-l-1,"loading"==l||isNaN(l)||"loading"==p||isNaN(p)||(g=kd+"?"+l.toString()+","+p.toString()))}else if("ZoomifyPFFFile"==Z.tileSource){p="offsetLoading";r=k=0;for(g=Nb-1;g>a;g--)k+=hd[g];k+=e*vb[a]+b;g=Math.floor(k/Qc);r=-1==k-1?0:k-1;l=Math.floor(r/Qc);"undefined"===typeof ac[g]||"offsetLoading"==ac[g]||"undefined"===typeof ac[l]||"offsetLoading"==ac[l]?(k=g+","+a+","+b+","+e+","+f+",chunk",-1==Z.Utils.arrayIndexOf(Cb,k)&&(Cb[Cb.length]=k),m.traceDebugValues("z531",g+","+a+","+b+","+e+","+f),
"undefined"===typeof ac[g]&&(ac[g]="offsetLoading",e=ua+Qc*g*8,b=e+8*Qc,V(e,b,g)),"undefined"===typeof ac[l]&&(ac[l]="offsetLoading",e=ua+Qc*l*8,b=e+8*Qc,V(e,b,g))):(f=Math.floor(ac[g][0]),p=Math.floor(ac[l][0]),l=ac[l][1],g=ac[g][1],r=r%Qc*9,l=Math.floor(parseFloat(l.substring(r,r+9))),r=k%Qc*9,g=Math.floor(parseFloat(g.substring(r,r+9))),k=0==k?ua+8*Nh:p+l,f+=g,p=0<f-k?Z.tileHandlerPathFull+"?file="+kd+"&requestType=0&begin="+k.toString()+"&end="+f.toString()+"&vers="+Ri.toString()+"&head="+Si.toString():
"z647:"+a+"-"+b+"-"+e);g=p}else"DZIFolder"==Z.tileSource?g=ca("tile",a,b,e,f):"IIIFImageServer"==Z.tileSource?(l=Bb,p=Hb,r=Vb[a]/Z.imageW,a=Math.round(l/r*b).toString(),f=Math.round(p/r*e).toString(),k=Math.round(l/r).toString(),g=Math.round(p/r).toString(),b=Math.min(Math.round(Z.imageW*r-l*b),Bb).toString(),e=Math.min(Math.round(Z.imageH*r-p*e),Hb).toString(),p=m.getIIIFQuality(),l=m.getIIIFFormat(),g=Z.imagePath+"/"+a+","+f+","+k+","+g+"/"+b+","+e+"/0/"+p+l):"ImageServer"==Z.tileSource&&(e=-1!=
Z.imagePath.toLowerCase().indexOf(".svs")?"svs":-1!=Z.imagePath.toLowerCase().indexOf(".ndpi")?"ndpi":null,b=100*Z.imageZ,40==Z.sourceMagnification?k=b<=2.5+Kd?32:b<=5+Kd?16:b<=10+Kd?8:b<=25+Kd?4:b<=50+Kd?2:1:20==Z.sourceMagnification&&(k=b<=5+Kd?16:b<=10+Kd?8:b<=20+Kd?4:b<=50+Kd?2:1),e=Z.tileHandlerPathFull+"?FIF="+kd+"&focal="+Z.focal+"&QLT="+Z.quality+"&DSTL="+Z.imageX*Z.imageZ+","+Z.imageY*Z.imageZ+","+Bb+","+Hb+","+k+",1&type="+e,Z.Utils.trace(e),g="Assets/Skins/Default/standard/toolbarLogo.png");
return g};this.formatTilePathDZI=function(a,b,e,f){return ca("tile",a,b,e,f)};this.formatFilePathDZI=function(a,b,e,f,g){return ca(a,b,e,f,g)};this.parsePFFOffsetChunk=function(a,b){var e=Z.Utils.arrayIndexOfObjectValue(ac,"chunkID",b);-1!=e&&(ac[e].chunk=a,bb(b,"chunk"))};this.parsePFFOffsetChunkServlet=function(a){var b=parseInt(a.documentElement.getAttribute("BEGIN"),10);a=a.documentElement.getAttribute("REPLYDATA");var e=Oh[b],b=Math.floor((b-ua)/8/Qc);ac[b]=[];ac[b]=a.split(",",2);bb(e,"chunk")};
this.z581=function(a,b,e){qa(a,b,e)};this.getNavigatorImage=function(){var a=0,b=null;0<uc.length&&"0-0-0"!=uc[0].name&&(a=Z.Utils.arrayIndexOfObjectValue(uc,"name","0-0-0"));-1!=a&&(a=uc[a])&&(b=a.image);return b};this.getIIIFURI=function(a){a=m.getIIIFScheme();var b=m.getIIIFServer(),e=m.getIIIFPrefix(),f=m.getIIIFIdentifier(),g=m.getIIIFRegion(),p=m.getIIIFSize(),k=m.getIIIFRotation(),l=m.getIIIFQuality(),r=m.getIIIFFormat();return a&&b&&f?a+"://"+b+"/"+e+"/"+f+"/"+g+"/"+p+"/"+k+"/"+l+r:Z.Utils.getResource("ERROR_SETTINGIIIFIMAGEPATH")};
this.getIIIFScheme=function(){return"undefined"!=typeof Z.iiifScheme&&Z.Utils.stringValidate(Z.iiifScheme)?Z.iiifScheme:"https"};this.getIIIFServer=function(){return"undefined"!=typeof Z.iiifServer&&Z.Utils.stringValidate(Z.iiifServer)?Z.iiifServer:null};this.getIIIFPrefix=function(){return"undefined"!=typeof Z.iiifPrefix&&Z.Utils.stringValidate(Z.iiifPrefix)?Z.iiifPrefix:null};this.getIIIFIdentifier=function(){return"undefined"!=typeof Z.iiifIdentifier&&Z.Utils.stringValidate(Z.iiifIdentifier)?Z.iiifIdentifier:
null};this.getIIIFRegion=function(){var a=m.getZoom(),b=Math.min(Math.max(0,Math.round(m.getX()-ka/a/2)),Z.imageW).toString(),e=Math.min(Math.max(0,Math.round(m.getY()-ha/a/2)),Z.imageH).toString(),f=Math.min(Z.imageW,Math.round(ka/a)).toString(),a=Math.min(Z.imageH,Math.round(ha/a)).toString();return b+","+e+","+f+","+a};this.getIIIFSize=function(){return ka.toString()+","+ha.toString()};this.getIIIFRotation=function(){return Z.imageR.toString()};this.getIIIFQuality=function(){return Z.iiifQuality?
Z.iiifQuality.toString():"default"};this.getIIIFFormat=function(){return null===Z.iiifFormat||".jpg"!=Z.iiifFormat&&".png"!=Z.iiifFormat?".jpg":Z.iiifFormat.toString()};this.getViewCoordinatesIIIFString=function(a,b,e){var f="",g=Math.round(ka/m.getZoom(a)),p=Math.round(ha/m.getZoom(a)),g=1>g?1:g>Z.imageW?Z.imageW:g,p=1>p?1:p>Z.imageH?Z.imageH:p,k=b?Math.round(b.x):Math.round(m.getX(a));a=b?Math.round(b.y):Math.round(m.getY(a));k-=g/2;a-=p/2;k=0>k?0:k>Z.imageW?Z.imageW:k;a=0>a?0:a>Z.imageH?Z.imageH:
a;k=k.toString();a=a.toString();g=k+","+a+","+g.toString()+","+p.toString();p=ka.toString()+","+ha.toString();b=Math.round(m.getRotation()).toString();var l=m.getIIIFQuality(),r=m.getIIIFFormat(),g=g+"/"+p+"/"+b+"/"+l+r;"show"==e?f='RegionX="'+k+'"   RegionY="'+a:"save"==e?f=Z.imagePath+"/"+g:"bookmark"==e&&(f=Z.imagePath+"/"+g);return f};this.getClickCoordsAtZoom=function(a,b){var e=this.getClickCoordsInImage(a,b);return new Z.Utils.Point(e.x*b,e.y*b)};this.getClickCoordsInImage=function(a,b,e){a=
Z.Utils.event(a);var f=null;if(a){var g=a.type;if("undefined"===typeof b||null==b)b=m.getZoom();if("undefined"===typeof e||null===e)"touchstart"==g||"touchend"==g||"touchcancel"==g?(Xc=Z.Utils.getFirstTouch(a),"undefined"!==typeof Xc&&(target=Xc.target,e=new Z.Utils.Point(Xc.pageX,Xc.pageY))):(target=Z.Utils.target(a),relatedTarget=Z.Utils.relatedTarget(a),e=Z.Utils.getMousePosition(a));"undefined"!==typeof e&&null!==e&&(a=m.z479(e.x,e.y),f=m.z485(a.x,a.y,b))}return f};this.getClickZoomCoords3D=function(a,
b,e,f,g){var p=parseFloat(Z.Utils.getResource("z93TIERSKIPTHRESHOLD"));b=m.z479(b.x,b.y);b=m.z485(b.x,b.y,Z.imageZ);var k=Aa(e,f);a=a.altKey;g?a?k=Z.fitZ:(g=la(e,Z.fitZ),f-g<p?k=Z.fitZ:f>1+p?k=Aa(e,1):0<e?k=Aa(e-1,1):"unconverted"==Z.tileSource&&(k=Z.fitZ)):a?k=Z.maxZ:f<1-p?k=Aa(e,1):e<Nb-1?k=Aa(e+1,1):1<Z.maxZ&&(k=Z.maxZ);return new Z.Utils.Point3D(b.x,b.y,k)};this.getTileNameUnderCursor=function(a){a=a?Z.Utils.getMousePosition(a):new Z.Utils.Point(m.getX(),m.getY());a=m.z479(a.x,a.y);var b=m.z485(a.x,
a.y,m.getZoom());a=Math.round(b.x);b=Math.round(b.y);a=Math.min(qh,Math.max(0,Math.floor(a/Bb)));b=Math.min(rh,Math.max(0,Math.floor(b/Hb)));return re+"-"+a+"-"+b};this.calculateCurrentCenterCoordinates=function(a,b,e){if("undefined"===typeof a||null===a)a=new Z.Utils.Point(parseFloat(L.left),parseFloat(L.top));if("undefined"===typeof e||null===e)e=m.getRotation();0>e&&(e+=360);if("undefined"===typeof b||null===b)b=m.getZoom();var f=Math.round(Z.imageX-(a.x-Pc)/b);a=Math.round(Z.imageY-(a.y-pc)/b);
e=Z.Utils.getPositionRotated(f,a,Z.imageX,Z.imageY,-e);return new Z.Utils.Point(e.x,e.y)};this.z542=function(a,b,e,f){if("undefined"===typeof a||null===a)a=Sa;if("undefined"===typeof b||null===b)b=!1;return new P(m.z541(b,e?a:null,f),a)};this.z541=function(a,b,e){var f=parseFloat(L.left)-Pc,g=parseFloat(L.top)-pc;if(Z.useCanvas)var p=parseFloat(L.width)/eb.width,f=f/p,g=g/p;p=m.getZoom();0!=f&&(f/=p);0!=g&&(g/=p);var k=a?ka:qb;a=a?ha:cb;return new ta(Z.imageX-f,Z.imageY-g,-(k/2),k/2,-(a/2),a/2,p,
b,e)};this.HotspotsAllBoundingBoxInPixels=function(){for(var a=new yb,b=Z.imageCtrX,e=Z.imageCtrX,f=Z.imageCtrY,g=Z.imageCtrY,p=0,k=A.length;p<k;p++){var l=A[p],m=new ld(l,a,null,!0),r=l.x-m.w/2,q=l.x+m.w/2,n=l.y-m.h/2,l=l.y+m.h/2;r<b&&(b=r);q>e&&(e=q);n<f&&(f=n);l>g&&(g=l)}a=parseInt(Z.Utils.getResource("DEFAULT_SAVEIMAGELABELMARGIN"),10);b-=a;f-=a;e+=a;g+=a;this.l=b;this.r=e;this.t=f;this.b=g;this.x=b+(e-b)/2;this.y=f+(g-f)/2};this.z480=function(a,b){var e=m.z479(a,b);return new Z.Utils.Point(e.x-
Pc,e.y-pc)};this.convertViewportDisplayCoordsToPageCoords=function(a,b){var e=m.convertViewportCoordsToPageCoords(a+Pc,b+pc);return new Z.Utils.Point(e.x,e.y)};this.z479=function(a,b){var e=Z.Utils.getElementPosition(Mg);return new Z.Utils.Point(a-e.x+Pc,b-e.y+pc)};this.convertViewportCoordsToPageCoords=function(a,b){var e=Z.Utils.getElementPosition(Mg);return new Z.Utils.Point(a+e.x-Pc,b+e.y-pc)};this.convertPageCoordsToImageCoords=function(a,b){var e=m.z479(a,b),e=m.z485(e.x,e.y,Z.imageZ);return new Z.Utils.Point(e.x,
e.y)};this.convertImageCoordsToPageCoords=function(a,b,e,f){a=m.z478(a,b,e,f);a=m.convertViewportCoordsToPageCoords(a.x,a.y,Z.imageZ);return new Z.Utils.Point(a.x,a.y)};this.z485=function(a,b,e,f){if("undefined"===typeof e||null===e)e=Z.imageZ;if("undefined"===typeof f||null===f)f=Z.imageR;0>f&&(f+=360);var g=parseFloat(L.left)+ad,p=parseFloat(L.top)+Dc;a-=g;b-=p;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,f),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(a/e+Z.imageX,
b/e+Z.imageY)};this.z478=function(a,b,e,f){if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;if("undefined"===typeof e||null===e)e=Z.imageZ;if("undefined"===typeof f||null===f)f=Z.imageR;0>f&&(f+=360);a=(a-Z.imageX)*e;b=(b-Z.imageY)*e;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-f),a=viewportClickPt.x,b=viewportClickPt.y);f=parseFloat(L.left)+ad;e=parseFloat(L.top)+Dc;return new Z.Utils.Point(a+f,b+e)};this.convertImageCoordsToViewportEdgeCoords=
function(a,b,e,f){if("undefined"===typeof e||null===e)e=Z.imageZ;if("undefined"===typeof f||null===f)f=Z.imageR;0>f&&(f+=360);a=(Z.imageX-a)*e;b=(Z.imageY-b)*e;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-f),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(Pc+a,pc+b)};this.convertViewportEdgeCoordsToImageCoords=function(a,b,e,f){if("undefined"===typeof e||null===e)e=Z.imageZ;if("undefined"===typeof f||null===f)f=Z.imageR;0>f&&(f+=360);a-=Pc;b-=pc;0!=Z.imageR&&(viewportClickPt=
Z.Utils.rotatePoint(a,b,-f),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(Z.imageX-a/e,Z.imageY-b/e)};this.z468=function(a,b,e){if("undefined"===typeof a||null===a)a=Z.imageW;if("undefined"===typeof b||null===b)b=Z.imageH;var f=a/b>ka/ha?ka/a:ha/b;if(90==e||270==e)f=a/b>ka/ha?ka/b:ha/a;return f};this.calculateZoomToFill=function(a,b,e){if("undefined"===typeof a||null===a)a=Z.imageW;if("undefined"===typeof b||null===b)b=Z.imageH;var f=a/b>ka/ha?ha/b:ka/a;if(90==e||270==e)f=a/b>
ka/ha?ha/a:ka/b;return f};this.calculateZoomForResize=function(a,b,e,f,g){var p=a,k=Z.imageW*a,l=Z.imageH*a;b=f/b;e=g/e;k<f&&l<g?p=a:k==f&&l<g?p=-1:k<f&&l==g?p=-1:k>f&&l<=g?p=a*b:k<=f&&l>g?p=a*e:k>f&&l>g&&(f=1,1<=b&&1<=e?f=b>e?b:e:1>=b&&1>=e&&(f=b<e?b:e),p=a*f);p<Z.minZ&&(p=Z.minZ);p>Z.maxZ&&(p=Z.maxZ);return p};this.z482=function(a,b){return Aa(a,b)};this.syncViewportToNavigator=function(b){var e=Z.imageR;0>e&&(e+=360);var f=Fa(b.x,b.y,Z.imageZ,e,"image"),g=Z.imageX,k=Z.imageY;if(0==e){var p=f.x;
b=f.y}else p=b.x,b=b.y;g=dX=g-p;k=dY=k-b;0!=e&&(270<=e?(g=dY,k=-dX):180<=e?(g=-dX,k=-dY):90<=e&&(g=-dY,k=dX));e=g*Z.imageZ;k*=Z.imageZ;g=k+pc;L.left=e+Pc+"px";L.top=g+"px";Ga&&Q&&(Z.mobileDevice||Math.abs(e)>ka/2||Math.abs(k)>ha/2)&&R(Ga,H,uc,"simple",!1,"Updating backfill oversize display");Z.Viewer.syncComparisonViewport();Z.Viewer.syncOverlayViewports(null,a)};this.getStatus=function(a){a=Z.Utils.arrayIndexOfObjectValue(Lh,"state",a);return-1==a?!1:Lh[a].status};this.setStatus=function(a,b){var e=
!1,f=Z.Utils.arrayIndexOfObjectValue(Lh,"state",a);-1==f?(e=b,Lh[Lh.length]={state:a,status:b}):(!Lh[f].status&&b&&(e=!0),Lh[f].status=b);e&&(Z.Utils.validateCallback(a),Z.Viewer.validateViewerStatus(a))};this.traceDebugValues=function(a,b,e,f){e="undefined"!==typeof e&&null!==e?e:null;b=null!==b?b:"";switch(a){case "tilesToDisplay":Rg=e;rf=$e=qg=Qf=0;bf=e;sf=0;tilesTimeStart=(new Date).getTime();Sf=0;window.clearTimeout(Rf);Rf=null;Rf=window.setTimeout(Yb,Xh);break;case "tilesInCache":Qf=e;break;
case "z581-image-display":qg+=1;break;case "onTileLoad":$e+=1;sf=((new Date).getTime()-e)/1E3;Sf=$e/sf;break;case "z507":e=Z.Utils.arrayIndexOf(Ge,b);-1!=e&&(Ge.splice(e,1),rf+=1,--bf);break;case "tilesBackfillToPrecache":Vh=e;break;case "onTileBackfillPrecache":Gf+=1;break;case "tilesBackfillToDisplay":mi=vh=e;break;case "z599":wh+=1;break;case "z507Backfill":e=Z.Utils.arrayIndexOf(vd,b),-1!=e&&(vd.splice(e,1),pg+=1,--mi)}2!=Z.debug&&3!=Z.debug||Z.Utils.traceTileStatus(Rg,Qf,qg,$e,rf,bf);if(2==Z.debug){var g=
"undefined"!==typeof f&&null!==f&&0<f.length?f.join(", "):"none";e=!0;var p="";switch(a){case "updateView-noChange":p="Updating view: no change of tier.";break;case "tilesToDisplay":p="Tiles to display: "+g;break;case "tilesInCache":p="Tiles in cache: "+g;break;case "tilesToLoad":p="Tiles to load: "+g;break;case "tilesToLoad-backfill":p="Tiles to load-backfill: "+g;break;case "z622-viewportDisplay":a=[];g=0;for(p=f.length;g<p;g++)a[a.length]=f[g].name;p="Tiles from cache-"+b+": "+a.join(", ");break;
case "z622-backfillDisplay":a=[];g=0;for(p=f.length;g<p;g++)a[a.length]=f[g].name;p="Tiles from cache-"+b+": "+a.join(", ");break;case "z577-image-display":p="Tile requests for display: "+b+g;break;case "z577-image-backfill":p="Tile requests for backfill: "+b+g;break;case "imageRequestTimeout":p="Image request for "+b;break;case "z581-image-display":p="Tile request-display: "+b;e=!1;break;case "z581-image-backfill":p="Tile request-backfill: "+b;e=!1;break;case "z581DelayForOffset":p="Tile not yet being loaded - offset chunk loading in progress: "+
b;break;case "onTileLoad":p="Tiles received-display: "+b;e=!1;break;case "z599":p="Tiles received-backfill: "+b;0==Pb.length&&(p+="\n\nTile loading complete for backfill: all requested tiles received.");e=!1;break;case "z532":p="Tile request recorded for after load offset chunk: "+b;break;case "selectTilesRetry":p="Requesting tiles after offset chunk received: "+g;break;case "z531":p="Tile request recorded for after load offset chunk: "+b;e=!1;break;case "selectTilesRetry":p="Requesting tiles after offset chunk received: "+
g;e=!1;break;case "z577Retry":p=b;break;case "z507":p="Tile displaying: "+b;e=!1;break;case "blankLine":p=" "}""!=p&&Z.Utils.trace(p,!1,e)}};this.updateProgress=function(a,b){var e=Z,f;0==a&&0==b?(Z.Utils.validateCallback("loadingTilesComplete"),Z.Utils.validateCallback("loadingTilesCompleteGetLabelIDs"),f=void 0):(f=Math.round(100-b/a*100),f=Math.round(f/10));e.updateViewPercent=f;Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.Toolbar.updateProgress(a,b)};this.saveAnnotationsToImageFile=
function(a,b,e){if(m.getStatus("initializedViewport")&&lb)if(Z.Utils.stringValidate(Z.fileHandlerPath)||e)if(Z.fileHandlerPath&&-1!=Z.fileHandlerPath.indexOf(Z.Utils.getResource("z13"))||Z.demoNoSave)Z.Utils.showMessage(Z.Utils.getResource("z14"),!1,Z.messageDurationStandard,"center");else{var f=a?Z.Utils.getResource("ALERT_IMAGESAVEPREPARING"):Z.Utils.getResource("ALERT_VIEWSAVEPREPARING");Z.Utils.showMessage(f,!1,"none","center");Z.interactive=!1;m.setStatus("imageSaving",!0);Z.Utils.clearDisplay(lb);
Z.setCallback("drawLabelsOnCanvasComplete",function(){Z.Utils.functionCallWithDelay(function(){Z.Viewport.saveCanvasDataToFile(a,b,e)},750)});ib(a);a&&"unconverted"!=Z.tileSource?gb(a):Db(a)}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLFILEHANDLERPATHINVALID"),!0,null,"center")};m.saveCanvasDataToFile=function(a,b,e){Z.saveImageMessage=a?Z.Utils.getResource("ALERT_IMAGESAVEINPROGRESS"):Z.Utils.getResource("ALERT_VIEWSAVEINPROGRESS");switch(Z.saveImageFormat){case "png":canvasData=lb.toDataURL("image/png");
break;default:canvasData=lb.toDataURL("image/jpeg",Z.saveImageCompression)}Z.Utils.verifyCallback("imageSaveExternal")?(Z.Utils.hideMessage(),b=Z.callbacks.slice(0),a=Z.Utils.arrayIndexOfObjectValue(b,"callbackEvent","imageSaveExternal"),-1!=a?b[a].callbackFunction(canvasData):Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGESAVEEXTERNAL"),!0,null,"center")):e?Z.browser==Z.browsers.FIREFOX||Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA?(Z.Utils.hideMessage(),b=document.createElement("a"),
document.body.appendChild(b),a=Z.Utils.stringRemoveFileExtension(Z.saveImageFilename),b.download=a+".jpg",b.href=canvasData,b.click(),document.body.removeChild(b)):Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGESAVELOCALUNSUPPORTEDBROWSER"),!0,null,"center"):(a=Z.Utils.stringRemoveFileExtension(Z.saveImageFilename),a=a+","+canvasData,(new Z.NetConnector).postImage(Z.saveImageHandlerPath,a),b&&(window.location=canvasData));m.setStatus("imageSaving",!1);Z.interactive=!0};m.parseGeoCoordinatesXML=
function(a){if(a=a.getElementsByTagName("SETUP")[0]){Ij=a.getAttribute("GEOTOP");Jj=a.getAttribute("GEOBOTTOM");Kj=a.getAttribute("GEOLEFT");Lj=a.getAttribute("GEORIGHT");var b=Kj,e=Lj,f=Ij;a=Jj;var g=b.substring(0,b.indexOf(",",0)),p=b.substring(b.indexOf(",",0)+1,b.indexOf(",",g.length+1)),k=1;"W"==b.substring(b.indexOf(",",g.length+1+p.length)+1,b.length)&&(k=-1);Li=(parseFloat(g)+parseFloat(p)/60)*k;b=e.substring(0,e.indexOf(",",0));g=e.substring(e.indexOf(",",0)+1,e.indexOf(",",b.length+1));
p=1;"W"==e.substring(e.indexOf(",",b.length+1+g.length)+1,e.length)&&(p=-1);e=(parseFloat(b)+parseFloat(g)/60)*p;b=f.substring(0,f.indexOf(",",0));g=f.substring(f.indexOf(",",0)+1,f.indexOf(",",b.length+1));p=1;"S"==f.substring(f.indexOf(",",b.length+1+g.length)+1,f.length)&&(p=-1);Mj=(parseFloat(b)+parseFloat(g)/60)*p;f=a.substring(0,a.indexOf(",",0));b=a.substring(a.indexOf(",",0)+1,a.indexOf(",",f.length+1));g=1;"S"==a.substring(a.indexOf(",",f.length+1+b.length)+1,a.length)&&(g=-1);a=(parseFloat(f)+
parseFloat(b)/60)*g;Sk=e<Li?180-Li+(180+e):e-Li;Tk=Mj-a}};this.createImageMetadataXML=function(a){a=Z.Utils.xmlConvertTextToDoc("<IMAGEMETADATA></IMAGEMETADATA>");rulerNode=a.createElement("RULER");a.getElementsByTagName("IMAGEMETADATA")[0].appendChild(rulerNode);Z.unitsPerImage&&rulerNode.setAttribute("UNITSPERIMAGE",Z.unitsPerImage.toString());Z.pixelsPerUnit&&rulerNode.setAttribute("PIXELSPERUNIT",Z.pixelsPerUnit.toString());rulerNode.setAttribute("UNITS",Z.units.toString());rulerNode.setAttribute("LISTTYPE",
Z.rulerListType);rulerNode.setAttribute("SOURCEMAGNIFICATION",Z.sourceMagnification.toString());Z.imageMetadataXML=a;X(Z.imageMetadataXML)};this.parseImageMetadataXML=function(a){X(a)};this.parseHotspotsXML=function(b){Z.Utils.arrayClear(Xd);Z.Utils.arrayClear(rc);Z.Utils.arrayClear(Ad);xi=!1;m.setStatus("XMLParsedViewport",!1);pk=Z.Utils.getResource("z226");Cj=Z.Utils.getResource("z225");Vi=Z.Utils.getResource("z131");qj=Z.Utils.getResource("z132");hotspotListTitle=Z.tourPath?Z.Utils.getResource("z444"):
Z.Utils.getResource("z424");rj=Z.Utils.getResource("z134");$h=parseFloat(Z.Utils.getResource("DEFAULT_HOTSPOTSMINSCALE"));ai=parseFloat(Z.Utils.getResource("DEFAULT_HOTSPOTSMAXSCALE"));var e=b.getElementsByTagName("SETUP")[0];"undefined"!==typeof e&&Z.Utils.stringValidate(e)||(e=b.getElementsByTagName("HOTSPOTSETUP")[0],"undefined"!==typeof e&&Z.Utils.stringValidate(e)||(e=Z.Utils.xmlConvertTextToDoc("<HOTSPOTSETUP />").getElementsByTagName("HOTSPOTSETUP")[0]));if(e){var f=e.getAttribute("AUTOSTART");
Z.Utils.stringValidate(f)&&(pk="0"!=f&&"false"!=f);f=e.getAttribute("AUTOLOOP");Z.Utils.stringValidate(f)&&(Cj="0"!=f&&"false"!=f);f=e.getAttribute("CHOICELIST");Z.Utils.stringValidate(f)&&(Vi=f);f=e.getAttribute("LISTSOURCE");Z.Utils.stringValidate(f)&&(qj=f);f=Z.Utils.xmlUnescapeMinimal(unescape(e.getAttribute("LISTTITLE")));Z.Utils.stringValidate(f)&&(hotspotListTitle=f);f=e.getAttribute("INITIALVISIBILITY");Z.Utils.stringValidate(f)&&(rj="1"==f||"true"==f);f=parseFloat(e.getAttribute("MINSCALE"));
isNaN(f)||($h=0!=f?f:1E-5);e=parseFloat(e.getAttribute("MAXSCALE"));isNaN(e)||(ai=0!=e?e:1E4)}jc.visibility=rj?"visible":"hidden";Z.Utils.stringValidate(Z.hotspotListTitle)?hotspotListTitle=Z.hotspotListTitle:Z.Utils.stringValidate(hotspotListTitle)&&(Z.hotspotListTitle=hotspotListTitle);Bd(Vi,hotspotListTitle,Xd,a);b=b.getElementsByTagName("HOTSPOT");e=0;for(f=b.length;e<f;e++){var g=b[e],k="",p=0,l=g.getAttribute("MEDIATYPE"),r=g.getAttribute("MEDIA");if(r)if(-1!=r.indexOf("arrow"))k=r,r="arrow";
else if(-1!=r.indexOf("line"))k=r,r="line";else if(-1!=r.indexOf("/circle.")||-1!=r.indexOf("/square.")||-1!=r.indexOf("/triangle."))r=r.substring(r.lastIndexOf("/")+1,r.indexOf("."));""!=k&&(p=Z.Utils.updateRotationForLegacyMedia(k),g.setAttribute("ROTATION",p));Z.Utils.stringValidate(l)&&("icon"==l&&(l="shape"),g.setAttribute("MEDIATYPE",l),Z.Utils.stringValidate(r)&&g.setAttribute("MEDIA",r));"shape"==l&&(null===g.getAttribute("WIDTH")&&g.setAttribute("WIDTH",Z.Utils.getResource("DEFAULT_SHAPEWIDTH")),
null===g.getAttribute("HEIGHT")&&g.setAttribute("HEIGHT",Z.Utils.getResource("DEFAULT_SHAPEHEIGHT")));m.createHotspotFromXML(g,!0)}2==Z.debug&&xi&&Z.Utils.trace(Z.Utils.getResource("z246"));m.setStatus("XMLParsedViewport",!0);Eb();Z.tour?(m.initializeAudioMuteButtons(),Z.Utils.validateCallback("tourLoaded"),pk&&!Z.tourStop&&Z.Utils.functionCallWithDelay(function(){m.tourStart()},750)):(Z.Utils.validateCallback("hotspotsLoadedViewport"),m.setStatus("hotspotsLoadedViewport",!0))};this.createHotspotFromParameters=
function(a,b,e,f,g,p,k,l,r,q,n,u,v,U,O,D,C,Da,P,Ub,A,qc,w,E,H,I,N,gb,xb,Ca,F,pb,M,R,B,ta,L,fb,Aa,Q,G,T,S,J,K,Qb,ja,Pd,dd,La){e=Z.Utils.arrayToArrayOfStrings([a,b,e,f,g,p,k,l,r,q,n,u,v,U,O,D,C,Da,P,Ub,A,qc,w,E,H,I,N,gb,xb,Ca,F,pb,M,R,B,ta,L,fb,Aa,Q,G,T,S,J,K,Qb,ja,Pd,dd,La]);a=Z.Utils.xmlConvertTextToDoc('<HOTSPOT ID="'+e[0]+'" NAME="'+e[1]+'" MEDIATYPE="'+e[2]+'" MEDIA="'+e[3]+'" AUDIO="'+e[4]+'" X="'+e[5]+'" Y="'+e[6]+'" ZOOM="'+e[7]+'" WIDTH="'+e[8]+'" HEIGHT="'+e[9]+'" XSCALE="'+e[10]+'" YSCALE="'+
e[11]+'" RADIUS="'+e[12]+'" ZMIN="'+e[13]+'" ZMAX="'+e[14]+'" CLICKURL="'+e[15]+'" URLTARGET="'+e[16]+'" ROLLOVER="'+e[17]+'" CAPTION="'+e[18]+'" COMMENT="'+e[19]+'" TOOLTIP="'+e[20]+'" TEXTCOLOR="'+e[21]+'" BACKCOLOR="'+e[22]+'" LINECOLOR="'+e[23]+'" FILLCOLOR="'+e[24]+'" TEXTVISIBLE="'+e[25]+'" BACKVISIBLE="'+e[26]+'" LINEVISIBLE="'+e[27]+'" FILLVISIBLE="'+e[28]+'" LINESTYLE="'+e[29]+'" CAPTIONPOSITION="'+e[30]+'" SAVED="'+e[31]+'" INTERNALID="'+e[32]+'" POIID="'+e[33]+'" CLOSED="'+e[36]+'" SHOWFOR="'+
e[38]+'" TRANSITION="'+e[39]+'" CHANGEFOR="'+e[40]+'" ROTATION="'+e[41]+'" CATEGORY="'+e[42]+'" EDITABLE="'+e[43]+'" POPUP="'+e[44]+'" POPOFFSETX="'+e[45]+'" POPOFFSETY="'+e[46]+'" USER="'+e[47]+'" INITIALS="'+e[48]+'" DATE="'+e[49]+'" ></HOTSPOT>').getElementsByTagName("HOTSPOT")[0];null===a.getAttribute("INTERNALID")&&a.setAttribute("INTERNALID",Gb("hotspot"));b=Z.Utils.xmlConvertTextToDoc("<TEMP></TEMP>");Z.Utils.stringValidate(e[34])&&(B=Z.Utils.xmlConvertTextToDoc(B).getElementsByTagName("CAPTION")[0].innerHTML,
f=b.createElement("CAPTION"),f.innerHTML=B,a.appendChild(f));Z.Utils.stringValidate(e[35])&&(B=Z.Utils.xmlConvertTextToDoc(ta).getElementsByTagName("TOOLTIP")[0].innerHTML,ta=b.createElement("TOOLTIP"),ta.innerHTML=B,a.appendChild(ta));if(Z.Utils.stringValidate(e[37])){ta=b.createElement("POLYGON");ta.setAttribute("CLOSED",e[33]);B=0;for(e=fb.length;B<e;B++)f=b.createElement("POINT"),f.setAttribute("X",fb[B].x),f.setAttribute("Y",fb[B].y),ta.appendChild(f);a.appendChild(ta)}m.createHotspotFromXML(a,
!0)};this.createHotspotFromXML=function(a,b){Z.annotations&&b&&(a=ee(a,"hotspot"));var e=new Sd(a);if(Z.Utils.stringValidate(e.media)||Z.Utils.stringValidate(e.caption)||null!==Z.tourPath||Z.annotations){A[A.length]=e;var f="NAME"==qj?e.name:"CAPTION"==qj?e.caption:e.tooltip;if(mb){var g=e.internalID;if(null!=mb){var p=Z.Utils.arrayIndexOfObjectValue(Xd,"value",g);-1!=p?(mb.options[p+("none"!=Z.hotspotListTitle&&"none"!=Z.tourListTitle?1:0)]=new Option(f,g.toString()),Xd[p]={text:f,value:g}):(mb.options[mb.options.length]=
new Option(f,g.toString()),Xd[Xd.length]={text:f,value:g})}}}Z.Utils.stringValidate(e.popup)&&(f=Z.Utils.arrayIndexOfObjectValue(Ad,"popup",e.popup),-1!=f?Ad[f].element&&(e.popupImage=Ad[f].element.cloneNode(!1)):(Ad[Ad.length]={popup:e.popup,element:null},f=(new Date).getTime(),g=e.popup,wk.loadImage(g,Z.Utils.createCallback(null,$d,g,f),"loadingHotspotPopup")));var f=new yb,g=e.mediaType,p=e.media,k=!1,k=!1;Z.Utils.stringValidate(p)&&(k=-1!=p.indexOf("/circle.")||-1!=p.indexOf("/square.")||-1!=
p.indexOf("/triangle.")||-1!=p.indexOf("/arrowDownLeft.")||-1!=p.indexOf("/arrowDownRight.")||-1!=p.indexOf("/arrowUpLeft.")||-1!=p.indexOf("/arrowUpRight.")||-1!=p.indexOf("/arrowUp.")||-1!=p.indexOf("/arrowDown.")||-1!=p.indexOf("/arrowLeft.")||-1!=p.indexOf("/arrowRight.")||-1!=p.indexOf("/lineHorizontal.")||-1!=p.indexOf("/lineVertical."),k="External Graphics File"!=p&&("fov"==p||"arrow"==p||"line"==p||"square"==p||"rectangle"==p||"circle"==p||"ellipse"==p||"triangle"==p||"polygon"==p||"counter"==
p||"polyLine"==p||k&&Z.labelShapesInternal));!Z.Utils.stringValidate(p)||"fieldofview"==g||"text"==g||"polygon"==p||k?vc(e,f):Zd(e,!0);yf||(ba=e);Z.Viewer.getStatus("readyViewer")&&(Z.Utils.validateCallback("labelCreated"),Z.Utils.validateCallback("labelCreatedGetInternalID"))};this.modifyHotspot=function(a,b,e,f,g){var p=-1,p=g?Z.Utils.arrayIndexOfObjectValue(A,"internalID",a):Z.Utils.arrayIndexOfObjectValue(A,"id",a.toString());if(-1!=p){a=A[p];"polygon"!=a.media||"x"!=b&&"y"!=b||(g=new Z.Utils.Point("x"==
b?e:a.x,"y"==b?e:a.y),de(a,g));if("polygon"!=a.media||"xScale"!=b&&"yScale"!=b)a[b]=e;else{g=e/100;for(var p=a.polygonPts.slice(0),k="xScale"==b?"x":"y",l=a[k]-a[k]*g,m=0,r=p.length;m<r;m++)p[m][k]=p[m][k]*g+l;a.polygonPts=p.slice(0)}"rollover"==b&&0==e&&(a.visibility=!0);"rolloverCaption"==b&&0==e&&(a.visibilityCaption=!0);"media"!=b||"shape"!=a.mediaType||"External Graphics File"!=a.media&&Z.labelShapesInternal||Zd(a,!1);"undefined"!==typeof f&&null!==f&&f||Eb()}};this.deleteHotspot=function(a,
b,e){if(A&&0<A.length){var f=-1;e?f=Z.Utils.arrayIndexOfObjectValue(A,"internalID",a):(f=Z.Utils.arrayIndexOfObjectValue(A,"id",a.toString()),-1!=f&&(a=A[f].internalID));-1!=f&&(A=Z.Utils.arraySplice(A,f,1),Gc(a),!b&&Z.hotspots&&null!=mb&&(a=Z.Utils.arrayIndexOfObjectValue(Xd,"value",a),-1!=a&&(Xd=Z.Utils.arraySplice(Xd,a,1),Z.Utils.updateSelectElement(mb,Xd),b=mb.length,0!=b&&(mb.selectedIndex=a>b-1?b-1:a))))}};this.deleteAllHotspots=function(){A&&0<A.length&&(Z.Utils.arrayClear(A),Ka&&(Ka.innerHTML=
""),mb.options.length=0)};this.deleteAllMeasureHotspots=function(){var a=A.length;if(0<a&&Ka&&0<Ka.childNodes.length){for(var b=0;b<a;b++)"measure"==A[b].mediaType&&(A=Z.Utils.arraySplice(A,b,1));Eb()}};this.z623=function(){Eb()};this.getLabelsVisibility=function(){return m.getHotspotsVisibility()};this.setLabelsVisibility=function(a,b){m.setHotspotsVisibility(a,b)};this.setLabelVisibility=function(a,b){m.setHotspotVisibility(a,b)};this.setLabelsVisibilityByFilter=function(a,b,e){m.setHotspotsVisibilityByFilter(a,
b,e);return e};this.getLabelVisibilityByID=function(a,b){return m.getHotspotVisibilityByID(a,b)};this.setLabelVisibilityByID=function(a,b,e){m.setHotspotVisibilityByID(a,b,e)};this.setLabelFilterByDisplayList=function(a,b){m.setHotspotFilterByDisplayList(a,b)};this.setHotspotFilterByDisplayList=function(a,b){Ka&&Z.Utils.clearDisplay(Ka);Wb&&Z.Utils.clearDisplay(Wb);tb&&Z.Utils.clearDisplay(tb);"undefined"!==typeof a&&null!==a&&0<a.length&&(b?vi=a:ui=a);"inline-block"==jc.display&&we()};this.clearLabelFilterByDisplayList=
function(){m.clearHotspotFilterByDisplayList()};this.clearHotspotFilterByDisplayList=function(){"undefined"!==typeof ui&&Z.Utils.arrayClear(ui);"undefined"!==typeof vi&&Z.Utils.arrayClear(vi);"inline-block"==jc.display&&Eb()};this.getTargetHotspot=function(a){return ub(a)};this.getLabelIDsInCurrentView=function(a,b,e){var f=[];b=new yb(b);for(var g=m.getZoom(),p=b.box.l,k=b.box.r,l=b.box.t,r=b.box.b,q=0,n=A.length;q<n;q++){var u=A[q];e&&(p=new ld(u,b,null,!1),k=p.w/2/g,r=p.h/2/g,p=b.box.l-k,k=b.box.r+
k,l=b.box.t-r,r=b.box.b+r);u.x>p&&u.x<k&&u.y>l&&u.y<r&&(f[f.length]=a?u.internalID:u.id)}return f};this.getHotspotsVisibility=function(){return"inline-block"==jc.display};this.setHotspotsVisibility=function(b,e){if(Ka){var f=!1;if(e){if(A&&0<A.length){for(var f=0,g=A.length;f<g;f++){var k=A[f];k.visibility=b;k=document.getElementById("hot"+k.internalID+(Z.imageSet?"-"+a.toString():""));null!==k&&m.setHotspotVisibility(k,b)}f=!0}}else jc&&(jc.display=b?"inline-block":"none",f=!0);f&&Eb();kj=0}else 10>
kj?(kj++,window.setTimeout(function(){m.setHotspotsVisibility(b,e)},100)):kj=0};this.setHotspotPopupVisibility=function(a,b){var e=Z.Utils.getChildElementByID(a,"popup");e&&e.style&&(e.style.display=b?"inline-block":"none",e.style.visibility=b?"visible":"hidden",al++,a.style.zIndex=al.toString())};this.setHotspotVisibility=function(a,b){if("undefined"!==typeof a){var e=a.firstChild;if(e&&e.style){e.style.visibility="visible";var f=b?"visible":"hidden";e.style.backgroundColor=b?"":"#FFFFFF";Z.Utils.setOpacity(e,
b?1:.01);e=a.firstChild.childNodes.length;0<e&&(e=a.firstChild.childNodes[e-1])&&e.style&&(e.style.visibility=f)}f=a.id.substring(3,a.id.length);f=Z.Utils.arrayIndexOfObjectValue(A,"internalID",f);if(-1!=f){e=A[f];e.visibility=b;var f=e.media,e=e.mediaType,g=!1,p=!1;Z.Utils.stringValidate(f)&&(g=-1!=f.indexOf("/circle.")||-1!=f.indexOf("/square.")||-1!=f.indexOf("/triangle.")||-1!=f.indexOf("/arrowDownLeft.")||-1!=f.indexOf("/arrowDownRight.")||-1!=f.indexOf("/arrowUpLeft.")||-1!=f.indexOf("/arrowUpRight.")||
-1!=f.indexOf("/arrowUp.")||-1!=f.indexOf("/arrowDown.")||-1!=f.indexOf("/arrowLeft.")||-1!=f.indexOf("/arrowRight.")||-1!=f.indexOf("/lineHorizontal.")||-1!=f.indexOf("/lineVertical."),p="fov"==f||"arrow"==f||"line"==f||"square"==f||"rectangle"==f||"circle"==f||"ellipse"==f||"triangle"==f||"polygon"==f||"counter"==f||"polyLine"==f);(!("counter"!=e&&"shape"!=e||null!==f&&"External Graphics File"==f)&&(p||g&&Z.labelShapesInternal)||null!==f&&"polygon"==f||"fieldofview"==e)&&Tb(!0)}}};this.setHotspotsVisibilityByFilter=
function(b,e,f){if(0<A.length)if(Ka&&0<Ka.childNodes.length){for(var g=0,k=A.length;g<k;g++)if(A[g][b]==e){var p=A[g];p.visibility=f;p=document.getElementById("hot"+p.internalID+(Z.imageSet?"-"+a.toString():""));null!==p&&m.setHotspotVisibility(p,f)}jj=0}else 10>jj?(jj++,window.setTimeout(function(){m.setHotspotsVisibilityByFilter(b,e,f)},100)):jj=0;return f};this.getHotspotVisibilityByID=function(a,b){var e=null;if(0<A.length&&Ka&&0<Ka.childNodes.length){var f=Z.Utils.arrayIndexOfObjectValue(A,b?
"internalID":"id",a);-1!=f&&(e=A[f].visibility)}return e};this.setHotspotVisibilityByID=function(b,e,f){var g=f?"internalID":"id";f=!0;var k=null;if(0<A.length){if(0==Ka.childNodes.length||1==Ka.childNodes.length&&"hotspotImmortal"==Ka.childNodes[0].id)f=!1;else if(b=Z.Utils.arrayIndexOfObjectValue(A,g,b),-1!=b){var k=A[b],p=document.getElementById("hot"+k.internalID+(Z.imageSet?"-"+a.toString():""));null==p&&(f=!1)}f?m.setHotspotVisibility(p,e):null!==k&&(k.visibility=e)}};this.setHotspotCaptionVisibility=
function(a,b){var e=Z.Utils.getChildElementByID(a,"captionTextBox");e&&e.style&&(e.style.visibility=b?"visible":"hidden",e=a.id.substring(3,a.id.length),e=Z.Utils.arrayIndexOfObjectValue(A,"internalID",e),-1!=e&&(A[e].visibilityCaption=b))};this.setHotspotCaptionInHTMLByID=function(b,e){var f=Z.Utils.arrayIndexOfObjectValue(A,"internalID",b);if(-1!=f){var f=A[f],g;g=null;if((g=document.getElementById("hot"+b+(Z.imageSet?"-"+a.toString():"")))&&g.firstChild.childNodes){if(2==g.firstChild.childNodes.length){var k=
Z.Utils.getChildElementByID(g,"captionTextBoxDropShadow");k&&(k.firstChild.data=e,Ic(k,f,!0))}if(g=Z.Utils.getChildElementByID(g,"captionTextBox"))g.firstChild.data=e,Ic(g,f)}}};this.setHotspotTooltipInHTML=function(a,b){a&&(a.title=b)};this.z535=function(a){return Gb(a)};this.createAnnotationsXMLFile=function(a,b){var e=Cd();null===Z.editMode||Z.noPost||(Z.Utils.stringValidate(Z.fileHandlerPath)?("undefined"!==typeof a&&Z.Utils.stringValidate(a)||(a=Z.Utils.stringValidateTrailingSlashCharacter(Z.annotationPath),
-1==a.toLowerCase().indexOf(".xml")&&(a+=Z.Utils.getResource("z69"))),(new Z.NetConnector).postXML(Z.fileHandlerPath,e,"postingAnnotationsXML",a),b||m.parseAnnotationsXML(e)):Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLFILEHANDLERPATHINVALID"),!0,null,"center"))};this.parseAnnotationsXML=function(a,b){if("undefined"===typeof b||null===b)b=Ja;Z.imageSet&&Z.Utils.showMessage(Z.Utils.getResource("ALERT_LOADINGANNOTATIONS"),!1,2E3,"center");"undefined"!==typeof db&&Z.Utils.arrayClear(db);"undefined"!==
typeof rc&&Z.Utils.arrayClear(rc);"undefined"!==typeof Ad&&Z.Utils.arrayClear(Ad);"undefined"!==typeof Ta&&Z.Utils.arrayClear(Ta);"undefined"!==typeof Sb&&Z.Utils.arrayClear(Sb);"undefined"!==typeof yi&&Z.Utils.arrayClear(yi);"undefined"!==typeof labelLineStyleListDP&&Z.Utils.arrayClear(labelLineStyleListDP);"undefined"!==typeof labelCaptionPositionListDP&&Z.Utils.arrayClear(labelCaptionPositionListDP);"undefined"!==typeof labelTargetListDP&&Z.Utils.arrayClear(labelTargetListDP);"undefined"!==typeof zb&&
Z.Utils.arrayClear(zb);"undefined"!==typeof yc&&Z.Utils.arrayClear(yc);xi=!1;m.setStatus("XMLParsedViewport",!1);var e=a.documentElement.tagName;"Annotations"==e&&(Z.annotationXMLAperioLoad=!0);if("ANNOTATIONDATA"==e||"ZAS"==e){var f=Cd(),g=nb(f,"root"),k=nb(f,"setup"),l=a.getElementsByTagName("SETUP");0==l.length&&(l=a.getElementsByTagName("LABELSETUP"));if(0<l.length){var r=k,q=l[0];temp=q.getAttribute("PANELPOSITION");Z.Utils.stringValidate(temp)&&r.setAttribute("PANELPOSITION",temp);var n=q.getAttribute("INITIALVISIBILITY");
Z.Utils.stringValidate(n)&&(initVis=Z.Utils.getResource("z134")?"0"!=n&&"hide"!=n?"1":"0":"1"!=n&&"show"!=n?"0":"1",r.setAttribute("INITIALVISIBILITY",initVis));var u=q.getAttribute("POIVISIBILITY");Z.Utils.stringValidate(u)&&(initVis="1"==Z.Utils.getResource("z66")?"0"!=u&&"hide"!=u?"1":"0":"1"!=u&&"show"!=u?"0":"1",r.setAttribute("POIVISIBILITY",initVis));var v=q.getAttribute("LABELVISIBILITY");Z.Utils.stringValidate(v)&&(initVis="1"==Z.Utils.getResource("z52")?"0"!=v&&"hide"!=v?"1":"0":"1"!=v&&
"show"!=v?"0":"1",r.setAttribute("LABELVISIBILITY",initVis));var O=q.getAttribute("NOTEVISIBILITY");Z.Utils.stringValidate(O)&&(initVis="1"==Z.Utils.getResource("z60")?"0"!=O&&"hide"!=O?"1":"0":"1"!=O&&"show"!=O?"0":"1",r.setAttribute("NOTEVISIBILITY",initVis));var D=q.getAttribute("COMMENTVISIBILITY");Z.Utils.stringValidate(O)&&(initVis="1"==Z.Utils.getResource("DEFAULT_ANNOTATIONCOMMENTVISIBILITY")?"0"!=D&&"hide"!=D?"1":"0":"1"!=D&&"show"!=D?"0":"1",r.setAttribute("COMMENTVISIBILITY",initVis));
temp=q.getAttribute("MINSCALE");Z.Utils.stringValidate(temp)&&!isNaN(parseFloat(temp))&&0<=parseFloat(temp)&&r.setAttribute("MINSCALE",temp);temp=q.getAttribute("MAXSCALE");Z.Utils.stringValidate(temp)&&!isNaN(parseFloat(temp))&&0<=parseFloat(temp)&&r.setAttribute("MAXSCALE",temp);temp=q.getAttribute("ZOOMIFYXMLVERSION");Z.Utils.stringValidate(temp)&&(isNaN(parseFloat(temp))||4!=parseFloat(temp)||r.setAttribute("ZOOMIFYXMLVERSION",temp));temp=q.getAttribute("TOOLTIPSOURCE");Z.Utils.stringValidate(temp)&&
r.setAttribute("TOOLTIPSOURCE",temp);k=r}g.appendChild(k);cl=parseFloat(k.getAttribute("ZOOMIFYXMLVERSION"));for(var C=a.getElementsByTagName("POI"),Da=0,P=C.length;Da<P;Da++){var Ub=nb(f,"poi"),A=Ub,qc=C[Da];temp=qc.getAttribute("ID");Z.Utils.stringValidate(temp)&&A.setAttribute("ID",temp);temp=Z.Utils.xmlUnescapeMinimal(unescape(qc.getAttribute("NAME")));Z.Utils.stringValidate(temp)&&A.setAttribute("NAME",temp);temp=qc.getAttribute("X");Z.Utils.stringValidate(temp)&&!isNaN(parseFloat(temp))&&A.setAttribute("X",
"center"==temp?Z.imageCtrX.toString():temp);temp=qc.getAttribute("Y");Z.Utils.stringValidate(temp)&&!isNaN(parseFloat(temp))&&A.setAttribute("Y","center"==temp?Z.imageCtrY.toString():temp);temp=qc.getAttribute("ZOOM");Z.Utils.stringValidate(temp)&&!isNaN(parseFloat(temp))&&A.setAttribute("ZOOM",temp);temp=qc.getAttribute("USER");Z.Utils.stringValidate(temp)&&A.setAttribute("USER",temp);temp=qc.getAttribute("DATE");Z.Utils.stringValidate(temp)&&A.setAttribute("DATE",temp);temp=qc.getAttribute("EDITABLE");
Z.Utils.stringValidate(temp)&&A.setAttribute("EDITABLE",temp);Ub=A;g.appendChild(Ub);var w=C[Da].getElementsByTagName("LABELS")[0];if("undefined"!==typeof w&&null!==w){var E=f.createElement("LABELS");Ub.appendChild(E);for(var H=w.getElementsByTagName("LABEL"),I=0,N=H.length;I<N;I++){var gb=nb(f,"label"),xb=f,Ca=gb,F=H[I],B=void 0,pb=void 0,M="",R=0,ta=0,B=F.getAttribute("ID");Z.Utils.stringValidate(B)&&Ca.setAttribute("ID",B);B=Z.Utils.xmlUnescapeMinimal(unescape(F.getAttribute("NAME")));Z.Utils.stringValidate(B)&&
Ca.setAttribute("NAME",B);B=F.getAttribute("MEDIATYPE");pb=F.getAttribute("MEDIA");if("icon"==B||"url"==B||"symbol"==B&&Z.Utils.stringValidate(pb)&&"polygon"!=pb&&-1!=pb.indexOf("."))B="shape";"symbol"==B&&Z.Utils.stringValidate(pb)&&"caption"==pb&&(B="text");"symbol"==B&&Z.Utils.stringValidate(pb)&&"polygon"==pb&&(B="polygon");"text"==B&&(pb="");-1!=pb.indexOf("arrow")?(M=pb,pb="arrow"):-1!=pb.indexOf("line")&&(M=pb,pb="line");""!=M&&(ta=Z.Utils.updateRotationForLegacyMedia(M));Z.Utils.stringValidate(B)&&
(Ca.setAttribute("MEDIATYPE",B),Z.Utils.stringValidate(pb)&&Ca.setAttribute("MEDIA",pb));B=F.getAttribute("X");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("X","center"==B?Z.imageCtrX.toString():B);B=F.getAttribute("Y");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("Y","center"==B?Z.imageCtrY.toString():B);B=F.getAttribute("WIDTH");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("WIDTH",B);B=F.getAttribute("HEIGHT");Z.Utils.stringValidate(B)&&
!isNaN(parseFloat(B))&&Ca.setAttribute("HEIGHT",B);B=F.getAttribute("ZOOM");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("ZOOM",B);B=F.getAttribute("XSCALE");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("XSCALE",B);B=F.getAttribute("YSCALE");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("YSCALE",B);B=F.getAttribute("RADIUS");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("RADIUS",B);B=F.getAttribute("ZMIN");Z.Utils.stringValidate(B)&&
!isNaN(parseFloat(B))&&Ca.setAttribute("ZMIN",B);B=parseFloat(F.getAttribute("ROTATION"));Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&(R=parseFloat(B));0!=ta&&(R+=ta);0!=R&&Ca.setAttribute("ROTATION",R.toString());B=F.getAttribute("ZMAX");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("ZMAX",B);B=F.getAttribute("CLICKURL");Z.Utils.stringValidate(B)?Ca.setAttribute("CLICKURL",B):(B=F.getAttribute("URL"),Z.Utils.stringValidate(B)&&Ca.setAttribute("CLICKURL",B));B=F.getAttribute("URLTARGET");
Z.Utils.stringValidate(B)&&Ca.setAttribute("URLTARGET",B);B=F.getAttribute("ROLLOVER");Z.Utils.stringValidate(B)&&Ca.setAttribute("ROLLOVER",B);B=Z.Utils.xmlUnescapeMinimal(unescape(F.getAttribute("CAPTION")));Z.Utils.stringValidate(B)&&Ca.setAttribute("CAPTION",B);B=Z.Utils.xmlUnescapeMinimal(unescape(F.getAttribute("ROLLOVERCAPTION")));Z.Utils.stringValidate(B)&&Ca.setAttribute("ROLLOVERCAPTION",B);B=Z.Utils.xmlUnescapeMinimal(unescape(F.getAttribute("COMMENT")));Z.Utils.stringValidate(B)&&Ca.setAttribute("COMMENT",
B);B=Z.Utils.xmlUnescapeMinimal(unescape(F.getAttribute("TOOLTIP")));Z.Utils.stringValidate(B)&&Ca.setAttribute("TOOLTIP",B);B=F.getAttribute("USER");Z.Utils.stringValidate(B)&&Ca.setAttribute("USER",B);B=F.getAttribute("DATE");Z.Utils.stringValidate(B)&&Ca.setAttribute("DATE",B);B=F.getAttribute("TEXTCOLOR");Z.Utils.stringValidate(B)&&Ca.setAttribute("TEXTCOLOR",Z.Utils.stringValidateColorValue(B));B=F.getAttribute("BACKCOLOR");Z.Utils.stringValidate(B)&&Ca.setAttribute("BACKCOLOR",Z.Utils.stringValidateColorValue(B));
B=F.getAttribute("LINECOLOR");Z.Utils.stringValidate(B)&&Ca.setAttribute("LINECOLOR",Z.Utils.stringValidateColorValue(B));B=F.getAttribute("FILLCOLOR");Z.Utils.stringValidate(B)&&Ca.setAttribute("FILLCOLOR",Z.Utils.stringValidateColorValue(B));B=F.getAttribute("TEXTVISIBLE");Z.Utils.stringValidate(B)&&Ca.setAttribute("TEXTVISIBLE",B);B=F.getAttribute("BACKVISIBLE");Z.Utils.stringValidate(B)&&Ca.setAttribute("BACKVISIBLE",B);B=F.getAttribute("LINEVISIBLE");Z.Utils.stringValidate(B)&&Ca.setAttribute("LINEVISIBLE",
B);B=F.getAttribute("FILLVISIBLE");Z.Utils.stringValidate(B)&&Ca.setAttribute("FILLVISIBLE",B);B=F.getAttribute("CAPTIONPOSITION");Z.Utils.stringValidate(B)&&Ca.setAttribute("CAPTIONPOSITION",B);B=F.getAttribute("CATEGORY");Z.Utils.stringValidate(B)&&Ca.setAttribute("CATEGORY",B);L=F.getElementsByTagName("CAPTION")[0];if("undefined"!==typeof L&&null!==L)if(Z.browser==Z.browsers.IE&&11>Z.browserVersion){var fb=Z.Utils.xmlConvertDocToText(L);Ca.setAttribute("CAPTION",fb)}else Ca.appendChild(L);var L=
F.getElementsByTagName("TOOLTIP")[0];if("undefined"!==typeof L&&null!==L)if(Z.browser==Z.browsers.IE&&11>Z.browserVersion){var Aa=Z.Utils.xmlConvertDocToText(L);Ca.setAttribute("TOOLTIP",Aa)}else Ca.appendChild(L);var Q=F.getElementsByTagName("POLYGON")[0];if(Q){for(var G=nb(xb,"polygon"),T=0,S=Q.getElementsByTagName("POINT").length;T<S;T++){var J=Q.getElementsByTagName("POINT")[T],K=nb(xb,"point"),B=J.getAttribute("X");Z.Utils.stringValidate(B)&&K.setAttribute("X",B);B=J.getAttribute("Y");Z.Utils.stringValidate(B)&&
K.setAttribute("Y",B);G.appendChild(K)}B=F.getAttribute("CLOSED");Z.Utils.stringValidate(B)&&Ca.setAttribute("CLOSED",B);Ca.appendChild(G)}B=F.getAttribute("POPUP");Z.Utils.stringValidate(B)&&Ca.setAttribute("POPUP",B);B=F.getAttribute("POPOFFSETX");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("POPOFFSETX",B);B=F.getAttribute("POPOFFSETY");Z.Utils.stringValidate(B)&&!isNaN(parseFloat(B))&&Ca.setAttribute("POPOFFSETY",B);B=F.getAttribute("EDITABLE");Z.Utils.stringValidate(B)&&
Ca.setAttribute("EDITABLE",B);B=F.getAttribute("LINESTYLE");Z.Utils.stringValidate(B)&&Ca.setAttribute("LINESTYLE",B);gb=Ca;if(4==cl&&"polygon"==gb.getAttribute("MEDIA")&&100!=parseFloat(gb.getAttribute("ZOOM"))){var Qb=gb,ja=Qb.getAttribute("X"),Pd=Qb.getAttribute("Y"),dd=100/Qb.getAttribute("ZOOM"),La=ja-ja*dd,wb=Pd-Pd*dd;if(0<Qb.getElementsByTagName("POLYGON").length)for(var Y=Qb.getElementsByTagName("POLYGON")[0],W=Y.getElementsByTagName("POINT"),la=[],aa=0,X=W.length;aa<X;aa++){var V=parseFloat(W[aa].getAttribute("X")),
Rb=isNaN(V)?0:V,Rb=Rb*dd+La,ba=parseFloat(W[aa].getAttribute("Y")),ea=isNaN(ba)?0:ba,ea=ea*dd+wb;la[la.length]={x:Rb,y:ea}}Qb.removeChild(Y);var Jd=Cd();nb(Jd,"label");if(null!=la&&0<la.length){for(var da=Jd.createElement("POLYGON"),ha=0,bd=la.length;ha<bd;ha++){var fa=Jd.createElement("POINT");fa.setAttribute("X",la[ha].x);fa.setAttribute("Y",la[ha].y);da.appendChild(fa)}Qb.appendChild(da)}gb=Qb}E.appendChild(gb)}}var ka=C[Da].getElementsByTagName("NOTES")[0];if("undefined"!==typeof ka&&null!==ka){var Fa=
f.createElement("NOTES");Ub.appendChild(Fa);for(var ca=ka.getElementsByTagName("NOTE"),Id=0,ma=ca.length;Id<ma;Id++){var pa=nb(f,"note"),Jc=pa,Yb=ca[Id];temp=Yb.getAttribute("ID");Z.Utils.stringValidate(temp)&&Jc.setAttribute("ID",temp);temp=Z.Utils.xmlUnescapeMinimal(unescape(Yb.getAttribute("NAME")));Z.Utils.stringValidate(temp)&&Jc.setAttribute("NAME",temp);temp=Z.Utils.xmlUnescapeMinimal(unescape(Yb.getAttribute("TEXT")));Z.Utils.stringValidate(temp)&&Jc.setAttribute("TEXT",temp);temp=Yb.getAttribute("USER");
Z.Utils.stringValidate(temp)&&Jc.setAttribute("USER",temp);temp=Yb.getAttribute("DATE");Z.Utils.stringValidate(temp)&&Jc.setAttribute("DATE",temp);temp=Yb.getAttribute("EDITABLE");Z.Utils.stringValidate(temp)&&Jc.setAttribute("EDITABLE",temp);pa=Jc;Fa.appendChild(pa)}}}0==C.length&&(Ub=nb(f,"poi"),g.appendChild(Ub));Yc=f}else if(Z.annotationXMLAperioLoad){var na=Cd(),sa=nb(na,"root"),ga=nb(na,"setup");ga.setAttribute("PANELPOSITION","2");ga.setAttribute("INITIALVISIBILITY","1");ga.setAttribute("INITIALVISIBILITY",
"1");ga.setAttribute("MINSCALE","1");ga.setAttribute("MAXSCALE","1");ga.setAttribute("POIVISIBILITY","0");ga.setAttribute("LABELVISIBILITY","1");ga.setAttribute("NOTEVISIBILITY","0");ga.setAttribute("COMMENTVISIBILITY","0");sa.appendChild(ga);Z.captionBoxes=!0;var wa=a.getElementsByTagName("Annotations")[0].getAttribute("MicronsPerPixel");Z.unitsPerImage=wa*Z.imageW;Z.units="um";for(var ua=a.getElementsByTagName("Annotation"),va=0,oa=ua.length;va<oa;va++){var ra=nb(na,"poi"),Db=ra,Na=ua[va];temp=
Na.getAttribute("Id");Z.Utils.stringValidate(temp)&&Db.setAttribute("ID",temp);temp=Z.Utils.xmlUnescapeMinimal(unescape(Na.getAttribute("Name")));Z.Utils.stringValidate(temp)&&Db.setAttribute("NAME",temp);temp=Na.getAttribute("Author");Z.Utils.stringValidate(temp)&&Db.setAttribute("USER",temp);temp=Na.getAttribute("ModifiedDate");Z.Utils.stringValidate(temp)&&Db.setAttribute("DATE",temp);temp=Na.getAttribute("LineColor");Z.Utils.stringValidate(temp)&&Db.setAttribute("APERIOLINECOLOR",temp);temp=Na.getAttribute("ReadOnly");
Z.Utils.stringValidate(temp)&&Db.setAttribute("APERIOREADONLY",temp);ra=Db;sa.appendChild(ra);var Qa=ua[va].getElementsByTagName("Regions")[0];if("undefined"!==typeof Qa&&null!==Qa){var qa=na.createElement("LABELS");ra.appendChild(qa);for(var Ea=Qa.getElementsByTagName("Region"),xa=0,Ka=Ea.length;xa<Ka;xa++){var Ga=nb(na,"label"),Ia=na,ia=Ga,za=Ea[xa],ya=ra.getAttribute("APERIOLINECOLOR"),ge=ra.getAttribute("APERIOREADONLY"),$a=void 0,$a=za.getAttribute("ID");Z.Utils.stringValidate($a)&&ia.setAttribute("ID",
$a);var Oa=null,ud=null,Ha=null,Sa=null,Xa=Z.Utils.getResource("UI_ANNOTATIONAPERIONONAME"),Ya=Z.Utils.getResource("UI_ANNOTATIONAPERIONONAMENORMEDIA"),Wa=za.getElementsByTagName("Attributes")[0];if(Wa){var gf=Wa.getElementsByTagName("Attribute")[0];gf&&(Oa=gf.getAttribute("Value"))}ud=za.getAttribute("Name");Ha=za.getAttribute("Text");Sa=Xa+Z.Utils.stringUpperCaseFirstLetter(ia.getAttribute("MEDIA"));$a=Z.Utils.stringValidate(Oa)?Oa:Z.Utils.stringValidate(ud)?ud:Z.Utils.stringValidate(Ha)?Ha:Z.Utils.stringValidate(Sa)?
Sa:Ya;!Z.Utils.stringValidate(Ha)||$a!=Oa&&$a!=ud||($a=$a+" - "+Ha);$a=Z.Utils.xmlUnescapeMinimal(unescape($a));Z.Utils.stringValidate($a)&&ia.setAttribute("NAME",$a);var Ba=za.getAttribute("Type");if(Z.Utils.stringValidate(Ba))switch(Ba){case "0":ia.setAttribute("MEDIA","polygon");ia.setAttribute("MEDIATYPE","polygon");break;case "1":ia.setAttribute("MEDIA","polygon");ia.setAttribute("MEDIATYPE","polygon");break;case "2":ia.setAttribute("MEDIA","ellipse");ia.setAttribute("MEDIATYPE","shape");break;
case "3":ia.setAttribute("MEDIA","arrow");ia.setAttribute("MEDIATYPE","shape");ia.setAttribute("ROTATION","180");break;case "4":ia.setAttribute("MEDIA","polygon"),ia.setAttribute("MEDIATYPE","measure")}$a=za.getAttribute("Zoom");if(Z.Utils.stringValidate($a)&&!isNaN(parseFloat($a))){var Ua=(100*parseFloat($a)).toString();ia.setAttribute("ZOOM",Ua)}"4"!=Ba&&($a=za.getAttribute("Text"),Z.Utils.stringValidate($a)&&ia.setAttribute("CAPTION",$a));var hb=parseInt((ya&16711680)>>16|(ya&65280)>>8<<8|(ya&
255)<<16).toString(16),jb="000000".substr(0,6-hb.length)+hb,bb=Z.Utils.stringValidateColorValue(jb);ia.setAttribute("LINECOLOR",bb);"measure"==ia.getAttribute("MEDIATYPE")&&ia.setAttribute("LINECOLOR","#FFFFFF");"4"!=Ba?ia.setAttribute("TEXTCOLOR",bb):ia.setAttribute("TEXTCOLOR","#FFFFFF");ia.setAttribute("BACKCOLOR","#000000");ia.setAttribute("TEXTVISIBLE","1");ia.setAttribute("BACKVISIBLE","1");ia.setAttribute("LINEVISIBLE","1");ia.setAttribute("FILLVISIBLE","0");"4"!=Ba?ia.setAttribute("CAPTIONPOSITION",
"9"):ia.setAttribute("CAPTIONPOSITION","5");var Pa=za.getElementsByTagName("Vertices")[0];if(Pa){for(var Ra=nb(Ia,"polygon"),kc=void 0,Af=void 0,Va=[],kb=0,Zc=Pa.getElementsByTagName("Vertex").length;kb<Zc;kb++){var Za=Pa.getElementsByTagName("Vertex")[kb],lb=nb(Ia,"point"),kc=Za.getAttribute("X");Z.Utils.stringValidate(kc)&&lb.setAttribute("X",kc);Af=Za.getAttribute("Y");Z.Utils.stringValidate(Af)&&lb.setAttribute("Y",Af);Ra.appendChild(lb);Va[Va.length]={x:kc,y:Af}}var mb="1"==Ba?"1":"0";Ra.setAttribute("CLOSED",
mb);var qb=Z.Utils.polygonCenter(Va,mb);"3"!=Ba?(ia.setAttribute("X",qb.x),ia.setAttribute("Y",qb.y)):(ia.setAttribute("X",Va[0].x),ia.setAttribute("Y",Va[0].y));"2"==Ba&&2==Va.length&&(ia.setAttribute("WIDTH",Math.abs(Va[1].x-Va[0].x)),ia.setAttribute("HEIGHT",Math.abs(Va[1].y-Va[0].y)));ia.appendChild(Ra)}ia.setAttribute("EDITABLE","1"==ge?"0":"1");Ga=ia;qa.appendChild(Ga)}}}0==ua.length&&(ra=nb(na,"poi"),sa.appendChild(ra));Yc=na}else{Z.Utils.showMessage(Z.Utils.getResource("z296"),!0);return}var cb=
Yc.getElementsByTagName("SETUP")[0];Wi=cb.getAttribute("PANELPOSITION");var Md=Z.Utils.getResource("z134"),ob=cb.getAttribute("INITIALVISIBILITY");rj=Md?"0"!=ob&&"hide"!=ob:"1"!=ob&&"show"!=ob;var Bb=parseFloat(cb.getAttribute("MINSCALE"));isNaN(Bb)||($h=0!=Bb?Bb:1E-5);var sb=parseFloat(cb.getAttribute("MAXSCALE"));isNaN(sb)||(ai=0!=sb?sb:1E4);Nf=dl="markup"!=Z.editMode&&"0"!=cb.getAttribute("POIVISIBILITY");rd=el="0"!=cb.getAttribute("LABELVISIBILITY");pf=fl="markup"!=Z.editMode&&"0"!=cb.getAttribute("NOTEVISIBILITY");
qf=gl="edit"!=Z.editMode&&"0"!=cb.getAttribute("COMMENTVISIBILITY");wi="COMMENT"==cb.getAttribute("TOOLTIPSOURCE")?"COMMENT":"TOOLTIP";for(var ue=Yc.getElementsByTagName("POI"),ab=0,ub=ue.length;ab<ub;ab++){var Dd=Gb("poi");ue[ab].setAttribute("INTERNALID",Dd);ze(ue[ab]);var Dh=ue[ab].getElementsByTagName("LABELS")[0];if(Dh)for(var eb=Dh.getElementsByTagName("LABEL"),ib=0,yb=eb.length;ib<yb;ib++){var Wd=Gb("label");eb[ib].setAttribute("INTERNALID",Wd);0<ib&&"0"==eb[ib].getAttribute("ID")&&"0"==eb[ib-
1].getAttribute("ID")&&eb[ib].setAttribute("ID",Wd);eb[ib].setAttribute("POIID",Dd);Z.browser==Z.browsers.IE&&11>Z.browserVersion?eb[ib].parentNode.replaceChild(eb[ib],Td(eb[ib])):eb[ib]=Td(eb[ib]);m.z495(eb[ib])}var Cb=ue[ab].getElementsByTagName("NOTES")[0];if(Cb)for(var vb=Cb.getElementsByTagName("NOTE"),tb=0,Ab=vb.length;tb<Ab;tb++){var Hb=Gb("note");vb[tb].setAttribute("INTERNALID",Hb);vb[tb].setAttribute("POIID",Dd);Ae(vb[tb])}}2==Z.debug&&xi&&Z.Utils.trace(Z.Utils.getResource("z246"));Yc=U(Yc);
m.setStatus("XMLParsedViewport",!0);"markup"==Z.editMode&&(Nf=rd=pf=!1);m.getStatus("annotationPanelInitializedViewport")?wc():m.createAnnotationPanel(b);Z.Utils.validateCallback("annotationsLoaded");m.setStatus("annotationsLoadedViewport",!0)};this.createLabelFromParameters=function(a,b,e,f,g,k,l,r,q,n,u,v,U,O,B,D,C,Da,P,Ub,Ca,qc,F,w,E,H,gb,I,N,xb,pb,M,R,ta,L,fb,Aa,Q,G,T,S,Qb,J,K,ja,Pd,dd,La,la,wb){if("fieldofview"==e){for(var Y=!1,W=0,aa=A.length;W<aa;W++){var X=A[W],ia="undefined"===typeof rotation||
null===rotation?0:rotation;if("fieldofview"==X.mediaType&&X.x==k&&X.y==l&&X.z==100*z&&X.rotation==ia){Y=!0;break}}Y?Z.Utils.showMessage(Z.Utils.getResource("ALERT_FOVLABELEXISTS"),!1,Z.messageDurationStandard,"center",!1,"5"):(Y=Gb("fov"),id=caption=Z.Utils.getResource("CONTENT_CAPTIONFOVTEXT")+Y,Bl(),Z.Utils.showMessage(Z.Utils.getResource("CONTENT_CAPTIONFOVNOTETEXT"),!1,Z.messageDurationStandard,"center",!0,"5"))}null==ta&&(ta="undefined"!==typeof sa&&0<sa.options.length?ta=sa.options[sa.selectedIndex].value:
0);a=Z.Utils.arrayToArrayOfStrings([a,b,e,f,g,k,l,r,q,n,u,v,U,O,B,D,C,Da,P,Ub,Ca,qc,F,w,E,H,gb,I,N,xb,pb,M,R,ta,L,fb,Aa,Q,G,T,S,Qb,J,K,ja,Pd,dd,La,la,wb]);a=Z.Utils.xmlConvertTextToDoc('<LABEL ID="'+a[0]+'" NAME="'+a[1]+'" MEDIATYPE="'+a[2]+'" MEDIA="'+a[3]+'" AUDIO="'+a[4]+'" X="'+a[5]+'" Y="'+a[6]+'" ZOOM="'+a[7]+'" WIDTH="'+a[8]+'" HEIGHT="'+a[9]+'" XSCALE="'+a[10]+'" YSCALE="'+a[11]+'" RADIUS="'+a[12]+'" ZMIN="'+a[13]+'" ZMAX="'+a[14]+'" CLICKURL="'+a[15]+'" URLTARGET="'+a[16]+'" ROLLOVER="'+
a[17]+'" CAPTION="'+a[18]+'" COMMENT="'+a[19]+'" TOOLTIP="'+a[20]+'" TEXTCOLOR="'+a[21]+'" BACKCOLOR="'+a[22]+'" LINECOLOR="'+a[23]+'" FILLCOLOR="'+a[24]+'" TEXTVISIBLE="'+a[25]+'" BACKVISIBLE="'+a[26]+'" LINEVISIBLE="'+a[27]+'" FILLVISIBLE="'+a[28]+'" LINESTYLE="'+a[29]+'" CAPTIONPOSITION="'+a[30]+'" SAVED="'+a[31]+'" INTERNALID="'+a[32]+'" POIID="'+a[33]+'" CLOSED="'+a[36]+'" SHOWFOR="'+a[38]+'" TRANSITION="'+a[39]+'" CHANGEFOR="'+a[40]+'" ROTATION="'+a[41]+'" CATEGORY="'+a[42]+'" EDITABLE="'+a[43]+
'" POPUP="'+a[44]+'" POPOFFSETX="'+a[45]+'" POPOFFSETY="'+a[46]+'" USER="'+a[47]+'" INITIALS="'+a[48]+'" DATE="'+a[49]+'" ></LABEL>');b=a.getElementsByTagName("LABEL")[0];Z.Utils.stringValidate(b.getAttribute("INTERNALID"))||b.setAttribute("INTERNALID",Gb("label"));Z.Utils.stringValidate(L)&&(L=Z.Utils.xmlConvertTextToDoc(L).getElementsByTagName("CAPTION")[0].innerHTML,e=a.createElement("CAPTION"),e.innerHTML=L,b.appendChild(e));L=fb;Z.Utils.stringValidate(L)&&(L=Z.Utils.xmlConvertTextToDoc(L).getElementsByTagName("TOOLTIP")[0].innerHTML,
fb=a.createElement("TOOLTIP"),fb.innerHTML=L,b.appendChild(fb));if(null!=Q){fb=a.createElement("POLYGON");L=0;for(e=Q.length;L<e;L++)f=a.createElement("POINT"),f.setAttribute("X",Q[L].x),f.setAttribute("Y",Q[L].y),fb.appendChild(f);b.appendChild(fb)}m.z495(b,!0)};this.z495=function(a,b){b&&(a=ee(a,"label"));"polygon"==a.getAttribute("MEDIA")&&(a.setAttribute("X",Math.round(parseFloat(a.getAttribute("X"))).toString()),a.setAttribute("Y",Math.round(parseFloat(a.getAttribute("Y"))).toString()));var e=
a.getAttribute("INTERNALID"),f=a.getAttribute("EDITABLE"),f="0"!=f&&"false"!=f,g=Z.Utils.arrayIndexOfObjectValue(Ta,"value",e);-1==g&&(g=Ta.length);Ta[g]={text:a.getAttribute("NAME"),value:e,poiID:a.getAttribute("POIID"),editable:f};m.createHotspotFromXML(a)};this.createLabelFromJSON=function(a,b){var e=Z.Utils.jsonConvertObjectToXMLText(a),e=Z.Utils.xmlUnescapeMinimal(e),e=Z.Utils.xmlEscapingConvertURIToHTML(e),e=decodeURIComponent(e),e=Z.Utils.xmlConvertTextToDoc(e).getElementsByTagName("LABEL")[0];
m.z495(e,!0)};this.modifyLabel=function(a,b,e,f,g){m.modifyHotspot(a.toString(),b,e,f,g)};this.createAnnotationPanel=function(a){var b=a.toString();if(Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){var e=Z.Toolbar.getSkinArray(),f=Z.Toolbar.getSkinSizes();Z["AnnotationPanelDisplay"+b]=Z.Utils.createContainerElement("div","AnnotationPanelDisplay"+b,"inline-block","absolute","visible","1px","1px","1px","1px","solid","1px","transparent","0px","0px","normal","default");Mf=Ya=Z["AnnotationPanelDisplay"+
b];Of=Mf.style;Z.ViewerDisplay.appendChild(Ya);Of.zIndex=(Z.baseZIndex+16).toString();var g=Z.Utils.createContainerElement("div","annotationPanelBackground"+b,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal");Ya.appendChild(g);var k=parseInt(Z.Utils.getResource("z63"),10),l=[{text:Z.Utils.getResource("z20"),value:"0"}];if("undefined"===typeof sa||null===sa){var r=Z.Utils.createContainerElement("div","labelPOITextBox"+b,"inline-block","absolute",
"hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),q=document.createTextNode(Z.Utils.getResource("z410"));r.appendChild(q);sa=new Z.Utils.createSelectElement("poiList"+b,"",l,1,1,0,k,"hidden",Jd,"change");Ya.appendChild(r);Ya.appendChild(sa);"markup"!=Z.editMode&&(r=new Z.Utils.Button("buttonPOIGo"+b,null,Z.skinPath,e[30],e[31],e[32],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_POIGO"),Ya.appendChild(r.elmt))}else Z.Utils.arrayClear(db);if("undefined"===
typeof Oa||null===Oa){if("markup"!=Z.editMode||Z.narrative)r=Z.Utils.createContainerElement("div","labelLabelTextBox"+b,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),q=document.createTextNode(Z.Utils.getResource("z408")),r.appendChild(q),Ya.appendChild(r),Z.narrative&&(r.style.display="none");Oa=new Z.Utils.createSelectElement("labelList"+b,"",l,1,1,0,k,"hidden",Jc,"change");Ya.appendChild(Oa);e=new Z.Utils.Button("buttonLabelGo"+
b,null,Z.skinPath,e[30],e[31],e[32],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_LABELGO");Ya.appendChild(e.elmt);qf&&(e="markup"!=Z.editMode,r=Z.Utils.getResource("CONTENT_ANNOTATIONPLACEHOLDERCOMMENTTEXT"),e=Z.Utils.createTextElement("commentTextElement"+b,r,"1px","1px","1px","1px","0px","solid","1px",e,"verdana","1px","none",null,1,"auto","auto",null),Z.Utils.addEventListener(e.firstChild,"focus",Be),Z.Utils.addEventListener(e.firstChild,"blur",fe),Ya.appendChild(e))}else Z.Utils.arrayClear(Ta),
Z.Utils.arrayClear(Sb);if(pf)if("undefined"===typeof ob||null===ob){if(e=Z.Utils.createContainerElement("div","labelNoteTextBox"+b,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),r=document.createTextNode(Z.Utils.getResource("z409")),e.appendChild(r),ob=new Z.Utils.createSelectElement("noteList"+b,"",l,1,1,0,k,"hidden",Wg,"change"),k=Z.Utils.getResource("z21"),k=Z.Utils.createTextElement("noteTextElement"+b,k,"1px","1px","1px","1px",
"0px","solid","1px",!0,"verdana","1px","none",null,1,"auto","auto",null),Z.Utils.addEventListener(k.firstChild,"focus",Be),Z.Utils.addEventListener(k.firstChild,"blur",fe),Ya.appendChild(e),Ya.appendChild(ob),Ya.appendChild(k),b=document.getElementById("textBoxFor-noteTextElement"+b))b.style.visibility="hidden"}else Z.Utils.arrayClear(zb),Z.Utils.arrayClear(yc);null===Z.editMode?(Uc(f,a),m.getStatus("XMLParsedViewport")&&wc()):Vd(a);Z.Utils.addEventListener(g,"mousedown",Z.Utils.preventDefault)}else window.setTimeout(function(){m.createAnnotationPanel(a)},
100)};this.z514=function(){var b=Z.Toolbar.getSkinSizes();Uc(b,a)};this.calculateAnnotationPanelDimensions=function(a,b,e,f){var g=parseInt(Z.Utils.getResource("z65"),10),k=parseInt(Z.Utils.getResource("z61"),10);"markup"==Z.editMode?(k+=134,a||(k-=24),b||(k-=33),e||(k-=115),f||(k-=80),Z.clickURLEntryVisible&&(k+=23)):null!==Z.editMode?(k+=244,a||(k-=50),b||(k-=215),e||(k-=140),f||(k-=80)):(a||(k-=24),b||Z.narrative||(k-=21),e||(k-=115),f||(k-=80),a||e||f||(k-=9));this.w=g;this.h=k};this.calculateAnnotationPanelCoords=
function(a,b,e,f,g){if(0==Z.annotationPanelVisible)e=a=-1E3;else switch(a){case "0":e=a=-1E3;break;case "1":e=a=15;break;case "2":a=f-b-15;e=15;2==Z.trackingPanelPosition&&(e+=20);2==Z.imageSetListPosition&&(e+=20);break;case "3":a=f-b-15;e=0<Z.toolbarVisible&&8!=Z.toolbarVisible?g-e-15:g-15;break;case "4":a=15;e=0<Z.toolbarVisible&&8!=Z.toolbarVisible?g-e-15:g-15;break;default:a=f-b-15,e=15}Z.narrative&&(a+=Z.narrativeW);return new Z.Utils.Point(a,e)};this.sizeAndPositionAnnotationPanel=function(a,
b,e,f,g){"undefined"!==typeof b&&null!==b&&(a.width=b+"px");"undefined"!==typeof e&&null!==e&&(a.height=e+"px");"undefined"!==typeof f&&null!==f&&(a.left=f+"px");"undefined"!==typeof g&&null!==g&&(a.top=g+"px")};this.clearAnnotationPanel=function(a){Mf&&(ob=Oa=sa=null,Z.Utils.deleteDiv("AnnotationPanelDisplay"+a))};this.setMaskByCoordinates=function(a,b){if(sb&&"undefined"!==typeof a&&null!==a&&0<a.length)if(Z.maskingSelection){var e=function(){setMask(null,null,a,b);Z.Viewport.maskFadeTimeoutHandler("in");
Z.clearCallback("maskClear",e)};Z.setCallback("maskClear",e);Z.Viewport.clearMask()}else setMask(null,null,a,b),Z.Viewport.maskFadeTimeoutHandler("in")};this.setLabelMaskByID=function(a,b){m.setHotspotMaskByID(a,b)};this.setHotspotMaskByID=function(a,b){var e=[];e[0]=a;m.setHotspotMaskByIDList(e,b)};this.setLabelMaskByIDList=function(a,b){m.setHotspotMaskByIDList(a,b)};this.setLabelMaskByDisplayList=function(a,b){m.setHotspotMaskByIDList(a,b)};this.setHotspotMaskByIDList=function(a,b){if(sb&&"undefined"!==
typeof a&&null!==a&&0<a.length)if(Z.maskingSelection){var e=function(){setMask(a,b);Z.Viewport.maskFadeTimeoutHandler("in");Z.clearCallback("maskClear",e)};Z.setCallback("maskClear",e);Z.Viewport.clearMask()}else setMask(a,b),Z.Viewport.maskFadeTimeoutHandler("in")};setMask=function(a,b,e,f){sc();cd();if("undefined"!==typeof e&&null!==e&&0<e.length){var g=f;if(Z.useCanvas)if(0<e.length){b=Z.Utils.polygonCenter(e,null,null,!0);a=b.x;b=b.y;T.save();T.globalCompositeOperation="xor";T.translate((a-Z.imageX)*
Z.imageZ,(b-Z.imageY)*Z.imageZ);T.lineWidth=1E-6;T.strokeStyle="#000000";T.globalAlpha=1;var k=Ia/pd,l=m.getZoom();f=k*l;k*=l;1!=f&&1!=k&&T.scale(f,k);T.beginPath();if(2<e.length){var g=e[0][0]-a,r=e[0][1]-b;T.moveTo(g,r);for(var l=1,q=e.length;l<q;l++)T.lineTo(e[l][0]-a,e[l][1]-b);T.lineTo(g,r);T.closePath()}else"undefined"===typeof g&&(g=200),T.arc(0,0,g,0,2*Math.PI);T.fill();T.restore();if(Z.maskBorder){T.save();T.translate((a-Z.imageX)*Z.imageZ,(b-Z.imageY)*Z.imageZ);T.scale(f,k);if(2<e.length){T.beginPath();
T.moveTo(e[0][0]-a,r);l=1;for(q=e.length;l<q;l++)T.lineTo(e[l][0]-a,e[l][1]-b),T.lineWidth=3/f,T.strokeStyle="#000000",T.stroke(),T.lineWidth=2/f,T.strokeStyle="#ffffff",T.stroke();T.lineTo(e[0][0]-a,e[0][1]-b);T.lineWidth=3/f;T.strokeStyle="#000000";T.stroke();T.lineWidth=2/f;T.strokeStyle="#ffffff";T.stroke();T.closePath()}else T.lineWidth=3/f,T.strokeStyle="#000000",T.stroke(),T.lineWidth=2/f,T.strokeStyle="#ffffff",T.stroke();T.restore()}}else Z.Utils.showMessage(Z.Utils.getResource("ALERT_POLYGONDATAINVALID"));
else bi||(Z.Utils.showMessage(Z.Utils.getResource("z9")),bi=!0)}else xc(a,b)};updateMask=function(){sc();cd();xc()};this.clearMask=function(){sb&&Z.Viewport.maskFadeTimeoutHandler("out")};this.maskFadeTimeoutHandler=function(a){if(sb){Z.maskingSelection||null===a||(Z.maskingSelection=!0,Cc.display="inline-block");if("in"==a)Z.maskOpacity+=bl,1<Z.maskOpacity&&(Z.maskOpacity=1,a=null,Z.Utils.validateCallback("maskSet"));else if("out"==a||"outIn"==a)Z.maskOpacity-=bl,0>=Z.maskOpacity&&(Z.maskOpacity=
0,"outIn"==a?a="In":(Z.maskingSelection=!1,Z.Utils.clearDisplay(sb),Cc.display="none",a=null,Z.Utils.validateCallback("maskClear")));Z.Utils.setOpacity(sb,Z.maskOpacity);null!==a&&0<Z.maskOpacity&&1>Z.maskOpacity?Z.maskFadeTimeout=window.setTimeout(function(){Z.Viewport.maskFadeTimeoutHandler(a)},50):(window.clearTimeout(Z.maskFadeTimeout),Z.maskFadeTimeout=null)}else a=null,Z.maskingSelection=!1};this.setLabelHighlightByDisplayID=function(a,b,e){var f=[];f[0]=a;m.setHotspotHighlightByDisplayList(f,
b,e)};this.setLabelHighlightByDisplayList=function(a,b,e){m.setHotspotHighlightByDisplayList(a,b,e)};this.setHotspotHighlightByDisplayList=function(a,b,e){if("undefined"!==typeof a&&null!==a&&0<a.length){if("undefined"===typeof b||null===b)b=!1;var f=null;b=b?"internalID":"id";for(var g=0,k=A.length;g<k;g++){var l=A[g];l.highlight=-1!=a.indexOf(l[b]);if(l.highlight){if("fieldofview"==l.mediaType||"text"==l.mediaType)f=l;l.rollover&&(l.rolloverPrior=!0,l.rollover=!1,l.visibility=!0);l.rolloverCaption&&
(l.rolloverCaptionPrior=!0,l.rolloverCaption=!1,l.visibilityCaption=!0)}}f?m.setLabelHighlightInHTMLByDisplayID(f.internalID,!0,!0):e?Eb():Tb()}};this.setLabelHighlightInHTMLByDisplayID=function(b,e,f){b=Z.Utils.arrayIndexOfObjectValue(A,f?"internalID":"id",b);if(-1!=b&&(hotspot=A[b],f=document.getElementById("hot"+hotspot.internalID+(Z.imageSet?"-"+a.toString():"")),null!==f)){if(0<f.firstChild.childNodes.length){b=e?Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTBORDERWIDTH"):"text"==hotspot.mediaType||
"fieldofview"==hotspot.mediaType?"0px":"1px";e=e?Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTCOLOR"):"#000000";var g=Z.Utils.getChildElementByID(f,"captionTextBox");g&&g.style&&(g.style.borderWidth=b,g.style.borderColor=e);(f=Z.Utils.getChildElementByID(f,"captionTextBoxDropShadow"))&&f.style&&(f.style.borderWidth=b,f.style.borderColor=e)}"fieldofview"==hotspot.mediaType&&(e=new yb,Yh(hotspot,e),hotspot.highlight||Tb())}};this.drawHighlight=function(a,b,e,f,g,k,l,r,q,n,u,v,U,O){a.save();a.lineWidth*=
3;var B="#FFFFFF"==v.lineColor?"#FFFF00":Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTCOLOR");if("undefined"===typeof n||null===n)n=B;if("undefined"===typeof r||null===r)r=B;if("undefined"===typeof q||null===q)q=v.lineStyle?v.lineStyle:"solid";var D="arrow"==b||"line"==b||"square"==b||"rectangle"==b||"circle"==b||"ellipse"==b||"triangle"==b;U?(a.fillStyle=a.strokeStyle=B,zg(a,v,U,g,k,O)):D&&m.drawShape(a,b,e,f,g,k,l,r,q,n,u);a.restore()};this.clearLabelHighlightByID=function(a,b){Z.Viewport.clearMask();
var e=Z.Utils.arrayIndexOfObjectValue(A,"internalID",b);-1!=e&&(hotspot=A[e],hotspot.highlight=!1,hotspot.rolloverPrior&&(hotspot.rollover=!0,hotspot.rolloverPrior=!1,hotspot.visibility=!1),hotspot.rolloverCaptionPrior&&(hotspot.rolloverCaption=!0,hotspot.rolloverCaptionPrior=!1,hotspot.visibilityCaption=!1),a?Eb():"fieldofview"==hotspot.mediaType||"text"==hotspot.mediaType?m.setLabelHighlightInHTMLByDisplayID(b,!1,!0):Tb())};this.clearLabelHighlightsAll=function(a){Z.Viewport.clearMask();for(var b=
0,e=A.length;b<e;b++){var f=A[b];f.highlight=!1;f.rolloverPrior&&(f.rollover=!0,f.rolloverPrior=!1,f.visibility=!1);f.rolloverCaptionPrior&&(f.rolloverCaption=!0,f.rolloverCaptionPrior=!1,f.visibilityCaption=!1);"fieldofview"!=f.mediaType&&"text"!=f.mediaType||m.setLabelHighlightInHTMLByDisplayID(f.internalID,!1,!0)}a?Eb():Tb()};this.goToPOICurrent=function(){var a=m.getCurrentPOIID();a&&!isNaN(parseInt(a),10)&&m.goToPOIByID(a)};this.goToPOIByID=function(a){var b=Z.Utils.arrayIndexOfObjectValue(db,
"value",a);if(-1!=b){var e;e=db[b].x;a="center"==e?Z.imageCtrX:parseFloat(e);e=db[b].y;var f="center"==e?Z.imageCtrY:parseFloat(e);e=db[b].z;b="-1"==e?Z.fitZ:parseFloat(e);m.getStatus("annotationPanelInitializedViewport")?m.zoomAndPanToView(a,f,b/100):m.setView(a,f,b/100)}};this.getCurrentPOIID=function(){var a=null;sa&&0<sa.length&&(a=sa[sa.selectedIndex].value);return a};this.getPOIEditable=function(a){var b=Z.editAdmin;b||(a=Z.Utils.arrayIndexOfObjectValue(db,"value",a),-1!=a&&(b=db[a].editable));
return b};this.goToLabelCurrent=function(){m.goToLabelByID(null,ba)};this.goToLabelByIDAndImage=function(a,b,e,f,g){if(a!=Z.imagePath){Z.setCallback("annotationsLoaded",function(){g&&m.setLabelMaskByID(b,!0);m.goToLabelByID(b,e,f)});var k="Assets/Annotations/Narratives/"+a.substring(a.lastIndexOf("/")+1,a.lastIndexOf(".zif"))+"-annotations.xml",k="undefined"!==typeof k&&Z.Utils.stringValidate(k)?"zAnnotationPath="+k:null;Z.Viewer.setImage(a,k)}else g&&m.setLabelMaskByID(b,!0),m.goToLabelByID(b,e,
f)};this.goToLabelByID=function(a,b,e,f){if("undefined"===typeof f||null===f)f=Z.Utils.getCallbackFunction("goToLabelByID");"undefined"!==typeof b&&null!==b?ba=b:"undefined"!==typeof a&&null!==a&&(a="undefined"!==typeof e&&null!==e&&e?Z.Utils.arrayIndexOfObjectValue(A,"internalID",a):Z.Utils.arrayIndexOfObjectValue(A,"id",a),ba=-1!=a?A[a]:null);ba&&(e=ba.x,a="center"==e?Z.imageCtrX:parseFloat(e),e=ba.y,b="center"==e?Z.imageCtrY:parseFloat(e),e=ba.z,e="-1"==e?Z.fitZ:parseFloat(e),m.zoomAndPanToView(a,
b,e/100,null,null,null,f,null))};this.getCurrentLabel=function(){return ba};this.getCurrentLabelID=function(){var a=null;ba&&(a=ba.internalID);return a};this.getLabelEditable=function(a){var b=Z.editAdmin;b||(a=Z.Utils.arrayIndexOfObjectValue(Ta,"value",a),-1!=a&&(b=Ta[a].editable,b=!("undefined"!==typeof b&&0==b)));return b};this.setCurrentLabel=function(a,b){var e=b?Z.Utils.arrayIndexOfObjectValue(A,"internalID",a):Z.Utils.arrayIndexOfObjectValue(A,"id",a);-1!=e&&(q("save","labels"),ba=A[e],ea=
ba.internalID,O(hotspot.poiID,hotspot.internalID),Z.Utils.validateCallback("labelSelectedInViewportGetIDs"),Eb())};this.getLabelXMLText=function(a){var b=null,b=null;a=Z.Utils.arrayIndexOfObjectValue(A,"internalID",a);-1!=a&&(b=m.convertLabelToXML(A[a]),b=Z.Utils.xmlConvertDocToText(b));return b};this.getLabelJSONObject=function(a,b){var e=null,f=b?Z.Utils.arrayIndexOfObjectValue(A,"internalID",a):Z.Utils.arrayIndexOfObjectValue(A,"id",a);-1!=f&&(e=m.convertLabelToJSON(A[f]));return e};this.getCurrentNoteID=
function(){var a=null;ob&&0<ob.length&&(a=ob[ob.selectedIndex].value);return a};this.getNoteEditable=function(a){var b=Z.editAdmin;b||(a=Z.Utils.arrayIndexOfObjectValue(zb,"value",a),-1!=a&&(b=zb[a].editable));return b};this.drawShape=function(a,b,e,f,g,k,l,r,m,q,n){a.save();"undefined"!==typeof l&&null!==l&&0!=l&&a.rotate(l*Math.PI/180);a.strokeStyle=r?r:"#FFFFFF";a.fillStyle=q?q:"#FFFFFF";lineStyleArr="dashed"==m?[10,5]:"dotted"==m?[4,4]:[];a.setLineDash(lineStyleArr);"arrow"!=b&&a.beginPath();
switch(b){case "arrow":var u=g-50-e;l=0;var v=-10;m=0;a.beginPath();a.moveTo(u,l);a.lineTo(v,m);a.save();m=Z.annotationXMLAperioLoad?10:f/100*5;r==Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTCOLOR")&&(m*=2);a.lineWidth=m;a.stroke();a.restore();e=e/2*(Z.annotationXMLAperioLoad?.5:1);l=Math.atan2(l-k,0);m=Z.annotationXMLAperioLoad?Math.PI/8:Math.PI-(.24159+(f-100)/400);var U=l+m;f=g+Math.cos(U)*e;r=k+Math.sin(U)*e;l-=m;m=g+Math.cos(l)*e;e=k+Math.sin(l)*e;l=(f+g+m)/3;v=(r+k+e)/3;Z.annotationXMLAperioLoad&&
a.rotate(180*Math.PI/180);a.save();a.beginPath();a.moveTo(m,e);a.lineTo(g,k);a.lineTo(f,r);a.stroke();a.beginPath();a.lineTo(g,k);a.lineTo(m,e);a.quadraticCurveTo(l,v,f,r);a.fill();a.restore();break;case "line":u=g-e/2;l=0;v=g+e/2;m=0;a.beginPath();a.moveTo(u,l);a.lineTo(v,m);a.stroke();e=u-g;r=l-k;g=v-g;k=m-k;l=Math.atan2(k-r,g-e);var O=Math.PI/2,U=l+O;m=e+Math.cos(U)*f/2;v=r+Math.sin(U)*f/2;u=g+Math.cos(U)*f/2;U=k+Math.sin(U)*f/2;l-=O;var O=e+Math.cos(l)*f/2,B=r+Math.sin(l)*f/2,D=g+Math.cos(l)*
f/2;f=k+Math.sin(l)*f/2;a.save();a.beginPath();a.moveTo(O,B);a.lineTo(e,r);a.lineTo(m,v);a.stroke();a.beginPath();a.moveTo(D,f);a.lineTo(g,k);a.lineTo(u,U);a.stroke();a.restore();break;case "square":f=Math.min(e,f)/2;a.moveTo(g-f,k-f);a.lineTo(g+f,k-f);a.lineTo(g+f,k+f);a.lineTo(g-f,k+f);break;case "rectangle":a.moveTo(g-e/2,k-f/2);a.lineTo(g+e/2,k-f/2);a.lineTo(g+e/2,k+f/2);a.lineTo(g-e/2,k+f/2);break;case "counter":f=Math.abs(Math.min(e,f)/2);a.arc(g,k,f,0,2*Math.PI);break;case "circle":f=Math.abs(Math.min(e,
f)/2);a.arc(g,k,f,0,2*Math.PI);break;case "ellipse":Z.ellipseDrawingSupported?(e=Math.abs(e/2),f=Math.abs(f/2),a.ellipse(g,k,e,f,0,0,2*Math.PI,!1)):(a.beginPath(),r=g-e/2,l=g+e/2,m=k-f/2,v=k+f/2,e=.551784*e/2,f=.551784*f/2,a.moveTo(g,m),a.bezierCurveTo(g+e,m,l,k-f,l,k),a.bezierCurveTo(l,k+f,g+e,v,g,v),a.bezierCurveTo(g-e,v,r,k+f,r,k),a.bezierCurveTo(r,k-f,g-e,m,g,m),a.stroke());break;case "triangle":a.moveTo(g,k-f/2),a.lineTo(g+e/2,k+f/2),a.lineTo(g-e/2,k+f/2)}"arrow"!=b&&(q&&n&&(a.fillStyle=q,a.globalAlpha=
Z.tracking?parseFloat(Z.Utils.getResource("DEFAULT_TRACKINGALPHA")):parseFloat(Z.Utils.getResource("DEFAULT_POLYGONALPHA")),a.fill()),"line"!=b&&a.closePath(),a.globalAlpha=1,a.stroke());a.restore()};this.drawShapeEditor=function(a,b,e,f,g,k,l,r,m){b.save();b.scale(m,m);e/=m;f/=m;b.lineWidth/=m;"undefined"!==typeof r&&null!==r&&0!=r&&b.rotate(r*Math.PI/180);b.strokeStyle="#FFFFFF";b.setLineDash([10,5]);b.beginPath();b.moveTo(g-e/2,k-f/2);b.lineTo(g+e/2,k-f/2);b.lineTo(g+e/2,k+f/2);b.lineTo(g-e/2,
k+f/2);b.closePath();b.globalAlpha=1;b.stroke();r=debugColor1=debugColor2=debugColor3=null;Oe(g-e/2,k-f/2,!1,1,r);Oe(g+e/2,k-f/2,!1,1,debugColor1);Oe(g+e/2,k+f/2,!1,1,debugColor2);Oe(g-e/2,k+f/2,!1,1,debugColor3);r=Math.abs(g+e/2-g);var q=Math.abs((k-f/2+(k+f/2))/2-k);l=Math.abs(Math.max(50,Math.min(Math.min(e/3,f),50/l*(a.z/100))));var n=r+l,u=q,v=r+l/2,U=q;b.moveTo(r,q);b.beginPath();b.arc(v,U,l/2,1*Math.PI,0*Math.PI,!1);b.stroke();Oe(n,u,!1,1);e*=m/(a.z/100);f*=m/(a.z/100);r=Math.abs(g+e/2-g);
q=Math.abs((k-f/2+(k+f/2))/2-k);l*=m/(a.z/100);a.polygonPts=[];a.polygonPts[0]={x:g-e/2+a.x,y:k-f/2+a.y};a.polygonPts[1]={x:g+e/2+a.x,y:k-f/2+a.y};a.polygonPts[2]={x:g+e/2+a.x,y:k+f/2+a.y};a.polygonPts[3]={x:g-e/2+a.x,y:k+f/2+a.y};a.polygonPts[4]={x:r+l+a.x,y:q+a.y};b.restore()};this.redisplayShapesAndPolygons=function(a){Tb(a)};this.toggleEditMode=function(){var a=!1;null!==Z.editMode?(Nf=dl,rd=el,qf=gl,pf=fl,Z.editMode=null,"view"==Z.labelMode,Z.measureVisible=!1,m.saveAnnotations(!0,!0,null),a=
!0,m.setEditModeLabel("view")):"undefined"!==typeof Z.parameters&&null!==Z.parameters&&("undefined"===Z.parameters.zEditMode||"1"!=Z.parameters.zEditMode&&"2"!=Z.parameters.zEditMode?"undefined"===typeof Z.parameters.zMarkupMode||"1"!=Z.parameters.zMarkupMode&&"2"!=Z.parameters.zMarkupMode?Z.narrativeMode&&null===Z.editMode&&(Nf=rd=pf=!1,Z.editMode="markup",a=!0):(Nf=rd=pf=!1,Z.editMode="markup",a=!0):(Z.editMode="edit",a=!0),Z.measureVisible="undefined"!==typeof Z.parameters.zEditMode&&"0"==Z.parameters.zMeasureVisible||
Z.narrativeMode);Z.Toolbar&&a&&Z.Toolbar.toggleAnnotationPanelMode(Z.editMode)};this.setEditModeLabel=function(a,b,e,f,g,k){f=Ja.toString();Ff=Z.labelMode?Z.labelMode:null;Z.labelMode=a;k&&(bg=0);"view"==a&&null===Z.editMode||Z.mouseIsDown||Z.Utils.showMessage(Z.Utils.getResource("ALERT_HOWTOEDITMODE"+a.toUpperCase()),!1,Z.messageDurationLong,"center",!0,"5");Z.overlayMessage&&(Z.overlayMessage.parentNode.style.display="none");k=document.getElementById("labelShapeList"+f);"undefined"!==typeof e&&
null!==e||null===ba||(e=ba.media);e=b?e:null;b=Ja.toString();if(Z.Toolbar&&0!=Z.annotationPanelVisible){if(null!==Z.editMode)f="view"==a?"buttonViewMode"+b:"buttonEditMode"+Z.Utils.stringUpperCaseFirstLetter(a)+b,Z.Toolbar.positionButtonBorder(f);else if(Z.measureVisible){f=document.getElementById("buttonMeasure");var l=document.getElementById("buttonMeasureExit");f&&l&&(f.style.display="measure"==Z.labelMode?"none":"inline-block",l.style.display="measure"==Z.labelMode?"inline-block":"none")}"shape"==
a&&e&&(b=document.getElementById("labelShapeList"+b))&&(e=Z.Utils.arrayIndexOfObjectValueSubstring(b,"value",e,null,!0),-1!=e&&(b.selectedIndex=e))}if("edit"==Z.editMode&&"editLabel"==Z.editing)if(e=k&&"shape"==a?k[k.selectedIndex].value:null,k=ea,m.modifyLabel(k,"mediaType",a,!0,!0),"fieldofview"==a)m.modifyLabel(k,"media","fieldofview",!1,!0);else if("text"==a)m.modifyLabel(k,"image",null,!0,!0),m.modifyLabel(k,"captionPosition","5",!0,!0),m.modifyLabel(k,"media",null,!1,!0);else if("shape"==a&&
e)m.modifyLabel(k,"media",Z.labelShapesInternal?e:Fd+"/"+e,!1,!0);else if("shape"==a){if(ba&&ba.polygonPts&&4==ba.polygonPts.length&&("polygon"==Ff||"measure"==Ff)?(a=Za(ba.polygonPts,0),m.modifyLabel(k,"polygonPts",a,!0,!0),a=Za(ba.polygonPts,1),m.modifyLabel(k,"polygonPts",a,!0,!0),a=Za(ba.polygonPts,2),m.modifyLabel(k,"polygonPts",a,!0,!0),a=Za(ba.polygonPts,3),m.modifyLabel(k,"polygonPts",a,!0,!0)):m.modifyLabel(k,"polygonPts",null,!0,!0),m.modifyLabel(k,"image",null,!0,!0),m.modifyLabel(k,"media",
"polygon",!1,!0),a=ba&&ba.polygonPts&&0<ba.polygonPts.length)a=new Z.Utils.Point(ba.polygonPts[0].x,ba.polygonPts[0].y),Fb(k,a)}else"freehand"==a?("freehand"!=Ff&&m.modifyLabel(k,"polygonPts",null,!0,!0),m.modifyLabel(k,"image",null,!0,!0),m.modifyLabel(k,"closed","false",!0,!0),m.modifyLabel(k,"media","polygon",!1,!0)):"polygon"==a?("view"!=Ff&&"rectangle"!=Ff&&"polygon"!=Ff&&"measure"!=Ff&&m.modifyLabel(k,"polygonPts",null,!0,!0),m.modifyLabel(k,"image",null,!0,!0),m.modifyLabel(k,"media","polygon",
!1,!0)):"measure"==a&&((a=ba&&ba.polygonPts&&0<ba.polygonPts.length)&&"rectangle"!=Ff&&"polygon"!=Ff&&"measure"!=Ff&&m.modifyLabel(k,"polygonPts",null,!0,!0),m.modifyLabel(k,"image",null,!0,!0),m.modifyLabel(k,"media","polygon",!1,!0),a&&(a=new Z.Utils.Point(ba.polygonPts[0].x,ba.polygonPts[0].y),Fb(k,a)));if("undefined"===typeof g||null===g||1==g)Xf=null,he=!0,Z.Utils.removeEventListener(document,"mousemove",fd),Z.Utils.removeEventListener(document,"touchmove",fd);Zb?Tb():Eb()};this.getEditability=
function(a,b){var e=!0,f=!m.getPOIEditable(m.getCurrentPOIID()),g=!m.getLabelEditable(m.getCurrentLabelID()),k=!m.getNoteEditable(m.getCurrentNoteID());f?"poi"!=a||"edit"!=b&&"delete"!=b?"label"==a?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NONEDITABLELABELPOI"),!1,Z.messageDurationShort,"center"),e=!1):"note"==a&&(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NONEDITABLENOTEPOI"),!1,Z.messageDurationShort,"center"),e=!1):(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NONEDITABLEPOI"),!1,Z.messageDurationShort,
"center"),e=!1):!g||"label"!=a||"edit"!=b&&"delete"!=b?!k||"note"!=a||"edit"!=b&&"delete"!=b||(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NONEDITABLENOTE"),!1,Z.messageDurationShort,"center"),e=!1):(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NONEDITABLELABEL"),!1,Z.messageDurationShort,"center"),e=!1);return e};this.toggleLabelColorPicker=function(a){var b=document.getElementById("buttonContainerLabelColors"+(Z.annotationFileShared?"0":Ja.toString()));if(b){var e="inline-block"==b.style.display;
b.style.display=("undefined"!==typeof a&&null!==a?a:!e)?"inline-block":"none"}};this.setDrawingColor=function(a,b,e){var f=Z.annotationFileShared?"0":Ja.toString();m.toggleLabelColorPicker(!1);var g;if("undefined"!==a&&null===a&&"undefined"!==b&&null===b&&"undefined"!==e&&null!==e)g=Z.Utils.stringValidateColorValue(e);else switch(a){case "buttonColor0"+f:g="#FFFFFF";break;case "buttonColor1"+f:g="#FFFF00";break;case "buttonColor2"+f:g="#00FFFF";break;case "buttonColor3"+f:g="#800080";break;case "buttonColor4"+
f:g="#008000";break;case "buttonColor5"+f:g="#FF0000";break;case "buttonColor6"+f:g="#0000FF";break;case "buttonColor7"+f:g="#000000"}zh=Nk=g;if(Z.markupMode||Z.editMode)rg=g;a="#FFFFFF"==g?"#000000":"#FFFFFF";"view"==Z.labelMode||b||null===ea||null===Z.editMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing||(m.modifyLabel(ea,"textColor",g,!0,!0),m.modifyLabel(ea,"backColor",a,!0,!0),m.modifyLabel(ea,"lineColor",g,!1,!0),m.modifyLabel(ea,"fillColor",g,!1,!0))};this.getLabelShapePickerVisibility=
function(){var a=null,b=document.getElementById("buttonContainerLabelShapes"+Ja.toString());b&&(a="inline-block"==b.style.display);return a};this.toggleLabelShapePicker=function(a){var b=document.getElementById("buttonContainerLabelShapes"+Ja.toString());if(b){var e="inline-block"==b.style.display;b.style.display=("undefined"!==typeof a&&null!==a?a:!e)?"inline-block":"none"}};this.toggleLabelLineStylePicker=function(a){var b=document.getElementById("buttonContainerLabelLineStyles"+Ja.toString());
if(b){var e="inline-block"==b.style.display;b.style.display=("undefined"!==typeof a&&null!==a?a:!e)?"inline-block":"none"}};this.addNewPOI=function(){m.getEditability("poi","add")&&(ei=0<sa.options.length?sa.options[sa.selectedIndex].value:0,q("save","pois"),Ud(),O(db[db.length-1].value),lc("poi","addPOI"))};this.editCurrentPOI=function(){m.getEditability("poi","edit")&&(ei=sa.options[sa.selectedIndex].value,q("save","pois"),lc("poi","editPOI"))};this.deleteCurrentPOI=function(){if(m.getEditability("poi",
"delete")){lc("poi",null);if("undefined"!==typeof sa&&null!==sa&&0<sa.options.length){var a=-1!=sa.selectedIndex?sa.selectedIndex:0,b=sa[sa.selectedIndex].value,b=Z.Utils.arrayIndexOfObjectValue(db,"value",b);-1!=b&&(db=Z.Utils.arraySplice(db,b,1));0<db.length?(b=db.length-1,b=db[a<=b?a:b].value):b=null;O(b);ei=0<sa.options.length?sa.options[sa.selectedIndex].value:0;q("save","pois")}m.saveAnnotations(!0,!1,"poi")}};this.cancelEditsPOI=function(){lc("poi",null);Z.Utils.showMessage(Z.Utils.getResource("z2"),
!1,Z.messageDurationVeryShort,"center");q("rollback","pois");O(ei)};this.saveEditsPOI=function(a){var b=m.getStatus("XMLParsedViewport")&&null!==Z.editing&&Z.Viewport.verifyEditsUnsaved();a||lc("poi",null);b&&(ei=sa.options[sa.selectedIndex].value,m.saveAnnotations(!0,!0,"poi"),q("save","pois"),Z.Utils.validateCallback("poiSaved"))};this.addNewLabel=function(){m.getEditability("label","add")&&(xg=0<Oa.options.length?Oa.options[Oa.selectedIndex].value:0,q("save","labels"),ea=null,lc("labelPartial",
"addLabel"))};this.editCurrentLabel=function(){if(m.getEditability("label","edit")&&(xg=ea,q("save","labels"),lc("label","editLabel"),null!==ba)){var a=ba.media,b=ba.mediaType;"view"==Z.labelMode||null===Z.editing||Z.narrative&&!Z.narrativeMode||m.setEditModeLabel(b,!0,a,!0);var e=!1,f=!1;Z.Utils.stringValidate(a)&&(e=-1!=a.indexOf("/circle.")||-1!=a.indexOf("/square.")||-1!=a.indexOf("/triangle.")||-1!=a.indexOf("/arrowDownLeft.")||-1!=a.indexOf("/arrowDownRight.")||-1!=a.indexOf("/arrowUpLeft.")||
-1!=a.indexOf("/arrowUpRight.")||-1!=a.indexOf("/arrowUp.")||-1!=a.indexOf("/arrowDown.")||-1!=a.indexOf("/arrowLeft.")||-1!=a.indexOf("/arrowRight.")||-1!=a.indexOf("/lineHorizontal.")||-1!=a.indexOf("/lineVertical."),f="fov"==a||"arrow"==a||"line"==a||"square"==a||"rectangle"==a||"circle"==a||"ellipse"==a||"triangle"==a||"polygon"==a||"counter"==a||"polyLine"==a);(!("counter"!=b&&"shape"!=b||a&&"External Graphics File"==a)&&(f||e&&Z.labelShapesInternal)||a&&"polygon"==a)&&Tb()}};this.deleteCurrentLabel=
function(){m.getEditability("label","delete")&&(Z.Utils.removeEventListener(document,"mousemove",fd),Z.Utils.removeEventListener(document,"touchmove",fd),m.toggleLabelShapePicker(!1),m.toggleLabelColorPicker(!1),m.toggleLabelLineStylePicker(!1),"markup"!=Z.editMode&&lc("label",null),"undefined"!==typeof Oa&&null!==Oa&&0<Oa.options.length&&m.deleteLabel(Oa[Oa.selectedIndex].value))};this.deleteLabel=function(a,b){if(m.getEditability("label","delete")){if("undefined"!==typeof b&&null!==b&&!b)for(var e=
0,f=A.length;e<f;e++)if(A[e].id==a){a=A[e].internalID;break}"undefined"!==typeof a&&null!==a&&"undefined"!==typeof Ta&&null!==Ta&&(e=a.toString(),f=Z.Utils.arrayIndexOfObjectValue(Ta,"value",e),-1!=f&&(Ta=Z.Utils.arraySplice(Ta,f,1),f=Z.Utils.arrayIndexOfObjectValue(Sb,"value",e),-1!=f&&(Sb=Z.Utils.arraySplice(Sb,f,1)),m.deleteHotspot(e,null,!0),0<Sb.length&&"undefined"!==typeof Oa&&null!==Oa&&0<Oa.options.length?(e=-1!=Oa.selectedIndex?Oa.selectedIndex:0,f=Sb.length-1,a=Sb[e<=f?e:f].value):a=null,
yf||Z.tracking?Tb():(Da(sa.options[sa.selectedIndex].value,a),xg=0<Oa.options.length?Oa.options[Oa.selectedIndex].value:"0",q("save","labels"),m.saveAnnotations(!0,!1,"label"))))}};this.deleteAllLabels=function(){Ka&&("undefined"!==typeof A&&Z.Utils.arrayClear(A),"undefined"!==typeof rc&&Z.Utils.arrayClear(rc),"undefined"!==typeof Ad&&Z.Utils.arrayClear(Ad),null!=mb?"undefined"!==typeof Xd&&Z.Utils.arrayClear(Xd):("undefined"!==typeof db&&Z.Utils.arrayClear(db),"undefined"!==typeof Ta&&Z.Utils.arrayClear(Ta),
"undefined"!==typeof Sb&&Z.Utils.arrayClear(Sb),"undefined"!==typeof zb&&Z.Utils.arrayClear(zb),"undefined"!==typeof yc&&Z.Utils.arrayClear(yc)));Eb()};this.deleteAllLabelsExcept=function(a,b){if("undefined"!==typeof A&&"undefined"!==typeof Ka){for(var e=A.length-1;0<=e;e--){var f="undefined"!==typeof b&&null!==b&&b?A[e].internalID.toString():A[e].id.toString();if(-1==a.indexOf(f.toString())&&"undefined"!==typeof f&&null!==f&&"undefined"!==typeof Ta&&null!==Ta){var g=A[e].internalID.toString(),k=
Z.Utils.arrayIndexOfObjectValue(Ta,"value",g);-1!=k&&(Ta=Z.Utils.arraySplice(Ta,k,1),f=Z.Utils.arrayIndexOfObjectValue(Sb,"value",g),-1!=f&&(Sb=Z.Utils.arraySplice(Sb,f,1)),m.deleteHotspot(g,null,!0),0<Sb.length&&"undefined"!==typeof Oa&&null!==Oa&&0<Oa.options.length?(g=-1!=Oa.selectedIndex?Oa.selectedIndex:0,f=Sb.length-1,g=g<=f?g:f,f=Sb[g].value):f=null)}}yf||Z.tracking?Tb():(Da(sa.options[sa.selectedIndex].value,f),xg=0<Oa.options.length?Oa.options[Oa.selectedIndex].value:"0",q("save","labels"),
m.saveAnnotations(!0,!1,"label"))}};this.cancelEditsLabel=function(){Z.Utils.removeEventListener(document,"mousemove",fd);Z.Utils.removeEventListener(document,"touchmove",fd);m.toggleLabelShapePicker(!1);m.toggleLabelColorPicker(!1);m.toggleLabelLineStylePicker(!1);lc("label",null);Z.Utils.showMessage(Z.Utils.getResource("z2"),!1,Z.messageDurationVeryShort,"center");q("rollback","labels");he=!0;Da(sa.options[sa.selectedIndex].value,xg);Eb()};this.saveEditsLabel=function(a,b,e){m.toggleLabelShapePicker(!1);
m.toggleLabelColorPicker(!1);m.toggleLabelLineStylePicker(!1);if(Z.browser==Z.browsers.IE&&!Z.fullView){var f=Ja.toString(),g=ba.internalID,k=document.getElementById("labelNameTextElement"+f);if(k){var l=Oa.selectedIndex;Sb[l].text=k.value;var r=m.getCurrentPOIID(),l=Oa[l].value,r=Z.Utils.arrayIndexOfObjectTwoValues(Ta,"poiID",r,null,"value",l);-1!=r&&(Ta[r].text=k.value);Ta.sort(ec);Sb.sort(ec);Z.Utils.updateSelectElement(Oa,Sb,l);l=Z.Utils.arrayIndexOfObjectValue(A,"internalID",g);-1!=l&&(A[l].name=
k.value)}if(k=document.getElementById("captionTextElement"+f))property=(k=k.value)&&-1!=k.indexOf("<CAPTION>")?"captionHTML":"caption",Z.viewportCurrent.modifyLabel(g,property,k,!1,!0);if(f=document.getElementById("commentTextElement"+f))l=Z.Utils.arrayIndexOfObjectValue(A,"internalID",g),-1!=l&&(A[l].comment=f.value)}g=Z.saveImageHandlerProvided||m.getStatus("XMLParsedViewport")&&null!==Z.editing&&Z.Viewport.verifyEditsUnsaved();a||"markup"==Z.editMode||(Z.Utils.removeEventListener(document,"mousemove",
fd),Z.Utils.removeEventListener(document,"touchmove",fd),lc("label",null));b&&m.setEditModeLabel("view",!1);g&&(xg=0<Oa.options.length?Oa.options[Oa.selectedIndex].value:0,m.saveAnnotations(b,e,"label"),q("save","labels"),he=!0,Da(sa.options[sa.selectedIndex].value,xg,!0),Z.Utils.validateCallback("labelSaved"),Z.Utils.validateCallback("labelSavedGetJSONObject"));Eb()};this.addNewNote=function(){if(m.getEditability("note","add")){Oi=0<ob.options.length?ob.options[ob.selectedIndex].value:0;q("save",
"notes");var a=Z.Utils.arrayToArrayOfStrings([void 0,void 0,void 0,void 0,void 0,void 0]),a=Z.Utils.xmlConvertTextToDoc('<NOTE ID="'+a[0]+'" NAME="'+a[1]+'" TEXT="'+a[2]+'" INTERNALID="'+a[3]+'" POIID="'+a[4]+'" EDITABLE="'+a[5]+'" ></NOTE>').getElementsByTagName("NOTE")[0];Ae(a,!0);a=zb[zb.length-1];Rb(a.poiID,a.value);lc("note","addNote")}};this.editCurrentNote=function(){m.getEditability("note","edit")&&(Oi=ob.options[ob.selectedIndex].value,q("save","notes"),lc("note","editNote"))};this.deleteCurrentNote=
function(){if(m.getEditability("note","delete")){lc("note",null);if("undefined"!==typeof ob&&null!==ob&&0<ob.options.length){var a=-1!=ob.selectedIndex?ob.selectedIndex:0,b=ob[ob.selectedIndex].value,b=Z.Utils.arrayIndexOfObjectValue(zb,"value",b);-1!=b&&(zb=Z.Utils.arraySplice(zb,b,1));0<zb.length?(b=zb.length-1,b=zb[a<=b?a:b].value):b=null;"markup"!=Z.editMode&&Rb(sa.options[sa.selectedIndex].value,b);Oi=0<ob.options.length?ob.options[ob.selectedIndex].value:0;q("save","notes")}m.saveAnnotations(!0,
!1,"note")}};this.cancelEditsNote=function(){lc("note",null);Z.Utils.showMessage(Z.Utils.getResource("z2"),!1,Z.messageDurationVeryShort,"center");q("rollback","notes");Rb(sa.options[sa.selectedIndex].value,Oi)};this.saveEditsNote=function(a){var b=m.getStatus("XMLParsedViewport")&&null!==Z.editing&&Z.Viewport.verifyEditsUnsaved();a||lc("note",null);b&&(Oi=ob.options[ob.selectedIndex].value,m.saveAnnotations(!0,!1,"note"),q("save","notes"),Z.Utils.validateCallback("noteSaved"))};this.deleteAllAnnotations=
function(){if("undefined"!==typeof Yc){var a=Z.Utils.xmlConvertTextToDoc("<ANNOTATIONDATA></ANNOTATIONDATA>"),b=a.getElementsByTagName("ANNOTATIONDATA")[0],e=nb(a,"setup");b.appendChild(e);var b=Yc.getElementsByTagName("SETUP")[0],f=b.getAttribute("PANELPOSITION");Z.Utils.stringValidate(f)&&e.setAttribute("PANELPOSITION",f);var g,f=b.getAttribute("INITIALVISIBILITY");Z.Utils.stringValidate(f)&&(g=Z.Utils.getResource("z134")?"0"!=f&&"hide"!=f?"1":"0":"1"!=f&&"show"!=f?"0":"1",e.setAttribute("INITIALVISIBILITY",
g));f=b.getAttribute("POIVISIBILITY");Z.Utils.stringValidate(f)&&(g="1"==Z.Utils.getResource("z66")?"0"!=f&&"hide"!=f?"1":"0":"1"!=f&&"show"!=f?"0":"1",e.setAttribute("POIVISIBILITY",g));f=b.getAttribute("LABELVISIBILITY");Z.Utils.stringValidate(f)&&(f="1"==Z.Utils.getResource("z52"),e.setAttribute("LABELVISIBILITY",f?"0"!=f&&"hide"!=f?"1":"0":"1"!=f&&"show"!=f?"0":"1"));f="1"==b.getAttribute("NOTEVISIBILITY");Z.Utils.stringValidate(f)&&(g=Z.Utils.getResource("z60")?"0"!=f&&"hide"!=f?"1":"0":"1"!=
f&&"show"!=f?"0":"1",e.setAttribute("NOTEVISIBILITY",g));g=b.getAttribute("COMMENTVISIBILITY");Z.Utils.stringValidate(f)&&(g="1"==Z.Utils.getResource("DEFAULT_ANNOTATIONCOMMENTVISIBILITY")?"0"!=g&&"hide"!=g?"1":"0":"1"!=g&&"show"!=g?"0":"1",e.setAttribute("COMMENTVISIBILITY",g));f=b.getAttribute("MINSCALE");Z.Utils.stringValidate(f)&&!isNaN(parseFloat(f))&&0<=parseFloat(f)&&e.setAttribute("MINSCALE",f);f=b.getAttribute("MAXSCALE");Z.Utils.stringValidate(f)&&!isNaN(parseFloat(f))&&0<=parseFloat(f)&&
e.setAttribute("MAXSCALE",f);Ka&&("undefined"!==typeof A&&Z.Utils.arrayClear(A),"undefined"!==typeof rc&&Z.Utils.arrayClear(rc),"undefined"!==typeof Ad&&Z.Utils.arrayClear(Ad),null!=mb?"undefined"!==typeof Xd&&Z.Utils.arrayClear(Xd):("undefined"!==typeof db&&Z.Utils.arrayClear(db),"undefined"!==typeof Ta&&Z.Utils.arrayClear(Ta),"undefined"!==typeof Sb&&Z.Utils.arrayClear(Sb),"undefined"!==typeof zb&&Z.Utils.arrayClear(zb),"undefined"!==typeof yc&&Z.Utils.arrayClear(yc)));Z.Viewport.parseAnnotationsXML(a);
Eb()}};this.saveLabel=function(a,b){if("undefined"!==typeof b&&null!==b&&!b)for(var e=0,f=A.length;e<f;e++)if(A[e].id==a){a=A[e].internalID;break}"undefined"!==typeof a&&null!==a&&(e=Z.Utils.arrayIndexOfObjectValue(A,"internalID",a),e=-1!=e?A[e]:null)&&(f=Yc,Yc=m.convertLabelToXML(e),m.saveAnnotations(!0,!0,"label"),Yc=f)};this.convertLabelToXML=function(a){var b,e=Cd(),f=nb(e,"label");f.setAttribute("ID",a.id);f.setAttribute("NAME",Z.Utils.xmlEscapeMinimal(a.name));f.setAttribute("MEDIATYPE",a.mediaType);
f.setAttribute("MEDIA",a.media);f.setAttribute("X",a.x);f.setAttribute("Y",a.y);if("fieldofview"==a.mediaType||"shape"==a.mediaType)f.setAttribute("WIDTH",a.w),f.setAttribute("HEIGHT",a.h);f.setAttribute("ZOOM",a.z);f.setAttribute("XSCALE",a.xScale);f.setAttribute("YSCALE",a.yScale);f.setAttribute("RADIUS",a.radius);f.setAttribute("ZMIN",a.zMin);f.setAttribute("ZMAX",a.zMax);f.setAttribute("CLICKURL",a.clickURL);f.setAttribute("URLTARGET",a.urlTarget);b=1==a.rollover?"1":"0";f.setAttribute("ROLLOVER",
b);f.setAttribute("CAPTION",Z.Utils.xmlEscapeMinimal(a.caption));b=1==a.rolloverCaption?"1":"0";f.setAttribute("ROLLOVERCAPTION",b);qf&&f.setAttribute("COMMENT",Z.Utils.xmlEscapeMinimal(a.comment));f.setAttribute("TOOLTIP",Z.Utils.xmlEscapeMinimal(a.tooltip));f.setAttribute("USER",a.user);f.setAttribute("DATE",a.date);f.setAttribute("TEXTCOLOR",a.textColor);f.setAttribute("BACKCOLOR",a.backColor);f.setAttribute("LINECOLOR",a.lineColor);f.setAttribute("FILLCOLOR",a.fillColor);b=0!=a.textVisible?"1":
"0";f.setAttribute("TEXTVISIBLE",b);b=0!=a.backVisible?"1":"0";f.setAttribute("BACKVISIBLE",b);b=0!=a.lineVisible?"1":"0";f.setAttribute("LINEVISIBLE",b);b=1!=a.fillVisible?"0":"1";f.setAttribute("FILLVISIBLE",b);f.setAttribute("CAPTIONPOSITION",a.captionPosition);f.setAttribute("INTERNALID",a.internalID.toString());f.setAttribute("POIID",a.poiID.toString());f.setAttribute("POPUP",a.popup);f.setAttribute("POPOFFSETX",a.popupOffsetX);f.setAttribute("POPOFFSETY",a.popupOffsetY);f.setAttribute("ROTATION",
a.rotation);f.setAttribute("CATEGORY",a.category);f.setAttribute("EDITABLE",a.editable);f.setAttribute("LINESTYLE",a.lineStyle);b=a.captionHTML;if(Z.Utils.stringValidate(b)&&(b=Z.Utils.xmlConvertTextToDoc(b).getElementsByTagName("CAPTION")[0])){b=b.innerHTML;var g=e.createElement("CAPTION");g.innerHTML=b;f.appendChild(g)}b=a.tooltipHTML;Z.Utils.stringValidate(b)&&(b=Z.Utils.xmlConvertTextToDoc(b).getElementsByTagName("TOOLTIP")[0])&&(b=b.innerHTML,g=e.createElement("TOOLTIP"),g.innerHTML=b,f.appendChild(g));
if((b=a.polygonPts)&&"shape"!=a.mediaType){a=e.createElement("POLYGON");for(var g=0,k=b.length;g<k;g++){var l=e.createElement("POINT");l.setAttribute("X",b[g].x);l.setAttribute("Y",b[g].y);a.appendChild(l)}f.appendChild(a)}return f};this.convertLabelToJSON=function(a){var b=null;a=m.convertLabelToXML(a);a=Z.Utils.jsonConvertXMLTextToJSONText(a);try{b=JSON.parse(a)}catch(e){Z.Utils.showMessage(e.name+Z.Utils.getResource("z277")+e.message)}return b};this.saveAnnotations=function(a,b,e){if((Z.annotationsAutoSave||
a)&&null!==Z.editMode&&!Z.noPost){if(Z.localUse)Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALSAVING"),!1,Z.messageDurationStandard,"center",!0);else if(Z.Utils.stringValidate(Z.fileHandlerPath))if(-1!=Z.fileHandlerPath.indexOf(Z.Utils.getResource("z13"))||Z.demoNoSave)Z.Utils.showMessage(Z.Utils.getResource("z14"),!1,Z.messageDurationStandard,"center",!0);else{Z.Utils.showMessage(Z.Utils.getResource("z15"),!1,Z.messageDurationStandard,"center",!1,"5");Yc=U(Yc);if(Z.noPostDefaults){a=
Z.Utils.xmlConvertDocToText(Yc);a=Z.Utils.xmlConvertTextToDoc(a);e=a.getElementsByTagName("SETUP")[0];"2"==e.getAttribute("PANELPOSITION")&&e.removeAttribute("PANELPOSITION");"1"==e.getAttribute("INITIALVISIBILITY")&&e.removeAttribute("INITIALVISIBILITY");e.getAttribute("POIVISIBILITY")==Z.Utils.getResource("z66")&&e.removeAttribute("POIVISIBILITY");e.getAttribute("LABELVISIBILITY")==Z.Utils.getResource("z52")&&e.removeAttribute("LABELVISIBILITY");e.getAttribute("NOTEVISIBILITY")==Z.Utils.getResource("z60")&&
e.removeAttribute("NOTEVISIBILITY");e.getAttribute("COMMENTVISIBILITY")==Z.Utils.getResource("DEFAULT_ANNOTATIONCOMMENTVISIBILITY")&&e.removeAttribute("COMMENTVISIBILITY");.2==parseFloat(e.getAttribute("MINSCALE"))&&e.removeAttribute("MINSCALE");2==parseFloat(e.getAttribute("MAXSCALE"))&&e.removeAttribute("MAXSCALE");e=a.getElementsByTagName("POI");for(var f=0,g=e.length;f<g;f++){var k=e[f];k.getAttribute("NAME")==Z.Utils.getResource("z43")&&k.removeAttribute("NAME");"center"==k.getAttribute("X")&&
k.removeAttribute("X");"center"==k.getAttribute("Y")&&k.removeAttribute("Y");"-1"==k.getAttribute("ZOOM")&&k.removeAttribute("ZOOM");k.hasAttribute("INTERNALID")&&k.removeAttribute("INTERNALID");if(k=e[f].getElementsByTagName("LABELS")[0])for(var k=k.getElementsByTagName("LABEL"),l=0,r=k.length;l<r;l++){var q=k[l];q.getAttribute("NAME")==Z.Utils.getResource("z37")&&q.removeAttribute("NAME");"center"==q.getAttribute("X")&&q.removeAttribute("X");"center"==q.getAttribute("Y")&&q.removeAttribute("Y");
"100"==q.getAttribute("ZOOM")&&q.removeAttribute("ZOOM");"100"==q.getAttribute("XSCALE")&&q.removeAttribute("XSCALE");"100"==q.getAttribute("YSCALE")&&q.removeAttribute("YSCALE");""!=q.getAttribute("RADIUS")&&"null"!=q.getAttribute("RADIUS")||q.removeAttribute("RADIUS");"0"==q.getAttribute("ZMIN")&&q.removeAttribute("ZMIN");"0"==q.getAttribute("ZMAX")&&q.removeAttribute("ZMAX");""==q.getAttribute("CLICKURL")&&q.removeAttribute("CLICKURL");""!=q.getAttribute("URLTARGET")&&"_blank"!=q.getAttribute("URLTARGET")||
q.removeAttribute("URLTARGET");"0"==q.getAttribute("ROLLOVER")&&q.removeAttribute("ROLLOVER");""==q.getAttribute("CAPTION")&&q.removeAttribute("CAPTION");"0"==q.getAttribute("ROLLOVERCAPTION")&&q.removeAttribute("ROLLOVERCAPTION");""==q.getAttribute("COMMENT")&&q.removeAttribute("COMMENT");""==q.getAttribute("TOOLTIP")&&q.removeAttribute("TOOLTIP");q.getAttribute("TEXTCOLOR")==Z.Utils.getResource("z25")&&q.removeAttribute("TEXTCOLOR");q.getAttribute("BACKCOLOR")==Z.Utils.getResource("z22")&&q.removeAttribute("BACKCOLOR");
q.getAttribute("LINECOLOR")==Z.Utils.getResource("CONTENT_LABELLINECOLOR")&&q.removeAttribute("LINECOLOR");q.getAttribute("FILLCOLOR")==Z.Utils.getResource("CONTENT_LABELFILLCOLOR")&&q.removeAttribute("FILLCOLOR");q.getAttribute("TEXTVISIBLE")==Z.Utils.getResource("z26")&&q.removeAttribute("TEXTVISIBLE");q.getAttribute("BACKVISIBLE")==Z.Utils.getResource("z23")&&q.removeAttribute("BACKVISIBLE");q.getAttribute("LINEVISIBLE")==Z.Utils.getResource("CONTENT_LABELLINEVISIBLE")&&q.removeAttribute("LINEVISIBLE");
q.getAttribute("FILLVISIBLE")==Z.Utils.getResource("CONTENT_LABELFILLVISIBLE")&&q.removeAttribute("FILLVISIBLE");q.getAttribute("CAPTIONPOSITION")==Z.Utils.getResource("z24")&&q.removeAttribute("CAPTIONPOSITION");"0"==q.getAttribute("ROTATION")&&q.removeAttribute("ROTATION");""==q.getAttribute("CATEGORY")&&q.removeAttribute("CATEGORY");""==q.getAttribute("POPUP")&&q.removeAttribute("POPUP");""!=q.getAttribute("POPOFFSETX")&&"0"!=q.getAttribute("POPOFFSETX")||q.removeAttribute("POPOFFSETX");""!=q.getAttribute("POPOFFSETY")&&
"0"!=q.getAttribute("POPOFFSETY")||q.removeAttribute("POPOFFSETY");q.getAttribute("EDITABLE")==Z.Utils.getResource("CONTENT_EDITABLE")&&q.removeAttribute("EDITABLE");q.getAttribute("LINESTYLE")==Z.Utils.getResource("CONTENT_LINESTYLE")&&q.removeAttribute("LINESTYLE");q.hasAttribute("INTERNALID")&&q.removeAttribute("INTERNALID")}if(k=e[f].getElementsByTagName("NOTES")[0])for(k=k.getElementsByTagName("NOTE"),l=0,r=k.length;l<r;l++)q=k[l],q.getAttribute("NAME")==Z.Utils.getResource("z40")&&q.removeAttribute("NAME"),
q.getAttribute("TEXT")==Z.Utils.getResource("z41")&&q.removeAttribute("TEXT"),q.hasAttribute("INTERNALID")&&q.removeAttribute("INTERNALID")}}else a=Yc;annotationsXMLOut=a;if(Z.annotationXMLAperioPost){f=annotationsXMLOut;a=Z.Utils.xmlConvertTextToDoc("<Annotations></Annotations>");e=a.getElementsByTagName("ANNOTATIONDATA")[0];isNaN(Z.unitsPerImage)||e.setAttribute("MicronsPerPixel",Z.unitsPerImage/Z.imageW);f=f.getElementsByTagName("POI");g=0;for(k=f.length;g<k;g++){r=f[g];l=a.createElement("Annotation");
l.setAttribute("NAME",r.getAttribute("NAME"));l.setAttribute("ID",r.getAttribute("ID"));if(r=f[g].getElementsByTagName("LABELS")[0]){for(var n=!1,u=q=!1,v=xmlDocNew.createElement("Regions"),O=r.getElementsByTagName("LABEL"),B=0,D=O.length;B<D;B++){var C=O[B],Da=a.createElement("Region");Da.setAttribute("NAME",C.getAttribute("NAME"));var P=C.getAttribute("ZOOM"),P=(P/100).toString();Da.setAttribute("ZOOM",P);if(!n){var n=C.getAttribute("LINECOLOR"),n="#"==n.charAt(0)?n.substring(1,7):n,P=parseInt(n.substring(0,
2),16),Ub=parseInt(n.substring(2,4),16),n=parseInt(n.substring(4,6),16)|Ub|P;l.setAttribute("LineColor",n);n=!0}q||(l.setAttribute("Author",C.getAttribute("USER")),q=!0);u||(l.setAttribute("ModifiedDate",C.getAttribute("DATE")),u=!0);P="1";Ub=C.getAttribute("MEDIA");if(Z.Utils.stringValidate(Ub))switch(Ub){case "polygon":P="1"==C.getAttribute("CLOSED");P="measure"==C.getAttribute("MEDIATYPE")?"4":P?"1":"0";break;case "ellipse":P="2";break;case "arrow":P="3"}Da.setAttribute("Type",P);C="4"!=P?C.getAttribute("CAPTION"):
"";Da.setAttribute("Text",C);if(P=r.getElementsByTagName("POLYGON")){for(var C=xmlDocNew.createElement("Vertices"),P=P.getElementsByTagName("POINT"),Ub=0,A=P.length;Ub<A;Ub++){var Ca=P[Ub],qc=a.createElement("Vertex");qc.setAttribute("X",Ca.getAttribute("X"));qc.setAttribute("Y",Ca.getAttribute("Y"));C.appendChild(qc)}Da.appendChild(C)}v.appendChild(Da)}l.appendChild(v)}e.appendChild(l)}annotationsXMLOut=a}a=Z.annotationPath;-1==a.toLowerCase().indexOf(".xml")&&(a=a+"/"+Z.Utils.getResource("z69"));
(new Z.NetConnector).postXML(Z.fileHandlerPath,annotationsXMLOut,"postingAnnotationsXML",a)}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLFILEHANDLERPATHINVALID"),!0,null,"center",!0);Z.saveImageHandlerProvided&&b&&Z.annotationsAutoSaveImage&&m.saveAnnotationsToImageFile(Z.saveImageFull?!0:null)}};this.setAllHotspotsSaved=function(){for(var a=0,b=A.length;a<b;a++)A[a].saved=!0};this.verifyEditsUnsaved=function(a){a=!0;"undefined"!==typeof Yc&&(a=U(Yc),a=Z.Utils.xmlConvertDocToText(Yc)!=Z.Utils.xmlConvertDocToText(a));
return a};this.setVisibilityMagnifier=function(b,e){if("undefined"===typeof e||null===e)e=a.toString();if(Ee=Z["MagnifierContainer"+e]){var f=Ee.style;f&&(f.display=b?"inline-block":"none")}};this.syncMagnifierToViewport=function(){if(0!=Z.imageR&&(!Pe&&magnifierDisplay&&(Pe=magnifierDisplay.style),Pe)){var a=magViewport.getRotation();Z.Utils.rotateElement(Pe,a,!0)}};this.sizeAndPositionMagnifier=function(a,b,e,f){if(Ee){if("undefined"===typeof a||null===a)a=Z.magnifierW;if("undefined"===typeof b||
null===b)b=Z.magnifierH;if("undefined"===typeof e||null===e)e=Z.viewerW-Z.magnifierW;if("undefined"===typeof f||null===f)f=Z.magnifierT;if(Z.annotations||Z.imageSet)Z.magnifierW==parseInt(Z.Utils.getResource("DEFAULT_MAGNIFIERWIDTH"),10)&&(a=parseInt(Z.Utils.getResource("z65"),10)),Z.magnifierH==parseInt(Z.Utils.getResource("DEFAULT_MAGNIFIERHEIGHT"),10)&&(b+=25),Z.magnifierL==parseInt(Z.Utils.getResource("DEFAULT_MAGNIFIERLEFT"),10)&&(e=Z.viewerW-a-15),Z.magnifierT==parseInt(Z.Utils.getResource("DEFAULT_MAGNIFIERTOP"),
10)&&(f=Z.viewerH-b-(null!==Z.toolbarH?Z.toolbarH:30)-15);nj=a/2;oj=b/2;Ah||(Ah=Ee);Yg||(Yg=Ah.style);Ci||(Ci=magnifierBackground);Di||(Di=Ci.style);zf||(zf=magnifierDisplay);Pe||(Pe=zf.style);Yg.width=a+"px";Yg.height=b+"px";Yg.left=e+"px";Yg.top=f+"px";Di.width=a+"px";Di.height=b+"px";Pe.width=a+"px";Pe.height=b+"px";f=1;if(Z.rotationVisible||0!=Z.imageR)f=Math.sqrt(a*a+b*b)/((a+b)/2);e=a*f;f*=b;a=Math.round((e-a)/2);b=Math.round((f-b)/2);zf.width=e;zf.height=f;Pe.width=e+"px";Pe.height=f+"px";
Pe.left=a+"px";Pe.top=b+"px";magnifierW=e;magnifierH=f}};this.toggleMagnifierMinimize=function(b,e){if("undefined"===typeof e||null===e)e=a.toString();if(Ee=Z["MagnifierContainer"+e]){var f=Ee.style,g=hCaption=Z.Utils.getChildElementByID(Ee,"buttonMagnifierMinimize"),k=hCaption=Z.Utils.getChildElementByID(Ee,"buttonMagnifierMaximize");f&&g&&k&&(g=g.style,k=k.style,!b&&parseInt(f.width,10)>Xg+2?(f.width=Xg+2+"px",f.height=Xg+2+"px",g.display="none",k.display="inline-block",Z.narrative||Z.imageSet?
(f.left=Z.viewerW-Xg-15+"px",f.top=Z.viewerH-Z.toolbarH-Xg-15+"px"):(f.left=parseInt(f.left)+(magnifierW-Xg-3)+"px",f.top="0px"),Xi=!0):(f.width=magnifierW+"px",f.height=magnifierH+"px",g.display="inline-block",k.display="none",g.left=magnifierW-Xg-2+"px",m.sizeAndPositionMagnifier(null,null,null,null),Xi=!1))}};this.updateViewMagnifier=function(a,b,e){if(zf&&!Z.mouseIsDown&&!Xi){var f;a?(a=Z.Utils.getMousePosition(a),a=m.z479(a.x,a.y),magPtPrior=f=m.z485(a.x,a.y,m.getZoom())):b&&e?magPtPrior=f=new Z.Utils.Point(b,
e):f=magPtPrior;if(f){a=Math.round(f.x);f=Math.round(f.y);var g=Math.max(0,Math.floor((a-nj)/Bb)),k=Math.min(qh,Math.floor((a+nj)/Bb)),l=Math.max(0,Math.floor((f-oj)/Hb)),r=Math.min(rh,Math.floor((f+oj)/Hb));Z.Utils.clearCanvas(zf);for(var q=(new Date).getTime();g<=k;g++)for(var n=l;n<=r;n++)if(b=re+"-"+g+"-"+n,e=Z.Utils.arrayIndexOfObjectValue(fg,"name",b),-1!=e&&Aj){var u=fg[e];b=u.x-a+nj;e=u.y-f+oj;try{Aj.drawImage(u.image,b,e)}catch(v){console.log("In function initializeViewportContinue scaling canvas:  "+
v)}}else-1==Z.Utils.arrayIndexOf(eg,b)&&(eg[eg.length]=b,b=new m.Tile(b,"image-magnifier"),m.z581(b,q,qc))}}};this.parseTrackingXML=function(a,b){if("undefined"===typeof b||null===b)b=Ja;Z.imageSet&&Z.Utils.showMessage(Z.Utils.getResource("ALERT_LOADINTRACKINGDATA"),!1,2E3,"center");"undefined"!==typeof ie&&Z.Utils.arrayClear(ie);"undefined"!==typeof Fe&&Z.Utils.arrayClear(Fe);"undefined"!==typeof Kc&&Z.Utils.arrayClear(Kc);m.setStatus("XMLParsedViewport",!1);var e=a.getElementsByTagName("SETUP")[0],
f=e.getAttribute("PANELPOSITION");Z.trackingPanelPosition=Z.Utils.stringValidate(f)?f:Z.Utils.getResource("DEFAULT_TRACKINGPANELPOSITION");if(e=e.getElementsByTagName("TYPES")[0])for(var e=e.getElementsByTagName("TYPE"),f=0,g=e.length;f<g;f++){var k=e[f];ie[ie.length]={text:k.getAttribute("NAME"),value:k.getAttribute("ID"),mediaType:k.getAttribute("MEDIATYPE"),media:k.getAttribute("MEDIA"),radius:k.getAttribute("RADIUS"),caption:k.getAttribute("CAPTION"),captionPosition:k.getAttribute("CAPTIONPOSITION"),
fillColor:k.getAttribute("FILLCOLOR")}}if(e=a.getElementsByTagName("CELLS")[0])for(e=e.getElementsByTagName("CELL"),f=0,g=e.length;f<g;f++)k=e[f],Fe[Fe.length]={id:k.getAttribute("ID"),complete:"0"!=k.getAttribute("COMPLETE"),user:k.getAttribute("USER"),date:k.getAttribute("DATE")};if(e=a.getElementsByTagName("INSTANCES")[0]){e=e.getElementsByTagName("LABEL");f=0;for(g=e.length;f<g;f++){var l=Gb("label"),k=e[f];k.setAttribute("INTERNALID",l);0<f&&"0"==k.getAttribute("ID")&&"0"==e[f-1].getAttribute("ID")&&
k.setAttribute("ID",l);k.setAttribute("POIID","TZ");null===k.getAttribute("TEXTCOLOR")&&k.setAttribute("TEXTCOLOR","#FFFFFF");k.setAttribute("TEXTVISIBLE","1");k.setAttribute("FILLVISIBLE","1");k.setAttribute("CATEGORY",k.getAttribute("TYPEID"));l=k.getAttribute("NAME");k.setAttribute("TOOLTIP",l+" : "+k.getAttribute("USER"));var r=k.getAttribute("CATEGORY"),q=k.getAttribute("ID"),n=k.getAttribute("CELL"),u=k.getAttribute("X"),v=k.getAttribute("Y"),U=k.getAttribute("ZOOM"),O=k.getAttribute("USER"),
B=Z.Utils.stringPadFront(n,6,"0")+Z.Utils.stringPadFront(q,6,"0");Kc[Kc.length]={text:n+"   "+u+", "+v+", "+U+": "+O,value:q,sortKey:B,cell:n,typeID:r,x:u,y:v,zoom:U,user:O,name:l,mediaType:k.getAttribute("MEDIATYPE"),media:k.getAttribute("MEDIA"),radius:k.getAttribute("RADIUS"),caption:k.getAttribute("CAPTION"),captionPosition:k.getAttribute("CAPTIONPOSITION"),fillColor:k.getAttribute("FILLCOLOR"),initials:k.getAttribute("INITIALS"),date:k.getAttribute("DATE")};m.z495(k)}m.syncTrackingToViewport()}m.setStatus("XMLParsedViewport",
!0);m.createTrackingPanel(b);Z.initialTrackingOverlayVisible&&(Z.Viewer.getStatus("readyViewer")?m.toggleTrackingNavigatorOverlay(!0):Z.setCallback("readyViewer",function(){m.toggleTrackingNavigatorOverlay(!0)}));m.setStatus("trackingLoadedViewport",!0);Z.Utils.validateCallback("trackingLoaded")};this.createLabelCounter=function(a){if("addLabel"==Z.editing){var b=Z.Utils.getResource("CONTENT_TRACKINGTEXTCOLOR"),e=Z.Utils.getResource("CONTENT_TRACKINGLINECOLOR"),f=Z.Utils.getResource("CONTENT_TRACKINGFILLCOLOR");
null===Z.userName&&(Z.userName=Z.Utils.getResource("CONTENT_SKIPUSERNAME"),Z.userInitials=Z.Utils.stringGetInitials(Z.userName));var g=Z.userName,k=Z.userInitials,l=Gb("label"),r=Math.round(a.x).toString();a=Math.round(a.y).toString();var q=m.getTrackingCellIDFromCoordinates(r,a,"100"),n=null,u=null,v=null,U=Z.Utils.arrayIndexOfObjectValue(ie,"value",Z.trackingTypeCurrent);-1!=U&&(f=ie[U],n=f.text,v=f.text+" : "+Z.userName,u=f.value,f=f.fillColor);var U=q+"   "+r+", "+a+", 100: "+g,O=Z.Utils.stringPadFront(q,
6,"0")+Z.Utils.stringPadFront(l,6,"0"),B=Z.Utils.getResource("CONTENT_COUNTERCAPTIONPOSITION"),D=Z.Utils.getCurrentUTCDateAsString();m.createLabelFromParameters(l,n,"counter","circle",null,r,a,"100",null,null,null,null,40,"0","0",null,null,null,k,null,v,b,null,e,f,"1","0","1","1","solid",B,"0",null,"TZ",null,null,null,null,null,null,null,0,u,!0,null,null,null,g,Z.userInitials,D);Kc[Kc.length]={text:U,value:l,sortKey:O,cell:q,typeID:u,x:r,y:a,zoom:"100",user:g,name:n,mediaType:"counter",media:"circle",
radius:(40).toString(),caption:k,captionPosition:B,fillColor:f,initials:Z.userInitials,date:D};m.syncTrackingToViewport()}};this.createTrackingPanel=function(a){if(!Z.ToolbarDisplay||!Z.Toolbar.getInitialized())window.setTimeout(function(){m.createTrackingPanel(a)},100);else if("undefined"===typeof Z["TrackingPanelDisplay"+a.toString()]){var b=Z.Toolbar.getSkinArray(),e=a.toString();Z["TrackingPanelDisplay"+e]=Z.Utils.createContainerElement("div","TrackingPanelDisplay"+e,"inline-block","absolute",
"hidden","1px","1px","1px","1px","solid","1px","transparent","0px","0px","normal","default");$b=Ac=Z["TrackingPanelDisplay"+e];Mb=$b.style;Z.ViewerDisplay.appendChild(Ac);Mb.zIndex=(Z.baseZIndex+30).toString();var f=Z.Utils.createContainerElement("div","trackingPanelBackground"+e,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal");Ac.appendChild(f);var g=parseInt(Z.Utils.getResource("DEFAULT_TRACKINGPANELLISTFONTSIZE"),10);Z.Utils.getResource("CONTENT_TRACKINGPLACEHOLDERLISTTEXT");
if("undefined"===typeof counterCountainer||null===counterCountainer){var k=Z.Utils.createContainerElement("div","containerCounterLabels"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);Ac.appendChild(k);var l=Z.Utils.createContainerElement("div","labelAddTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELADD"));
l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelShowTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELSHOW"));l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelNameTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELNAME"));
l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelCountPerCellTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELCOUNT"));l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelCountPerImageTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",
null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELCOUNTALL"));l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelListTextBox"+e,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELLIST"));l.appendChild(r);k.appendChild(l);k=Z.Utils.createContainerElement("div","containerCounterListLabels"+e,"none","absolute","visible",
"1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);Ac.appendChild(k);l=Z.Utils.createContainerElement("div","labelCellTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELCELL"));l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelXTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px",
"none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELX"));l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelYTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELY"));l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelZoomTextBox"+
e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELZOOM"));l.appendChild(r);k.appendChild(l);l=Z.Utils.createContainerElement("div","labelUserNameTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);r=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELUSERNAME"));l.appendChild(r);
k.appendChild(l);var q="#FFFFFF",l=k=20,r=1,n=120,u=20,v=6,U=parseInt(Z.Utils.getResource("DEFAULT_TRACKINGPANELLABELFONTSIZE"),10),O=8,B=0;Ch=Z.Utils.createContainerElement("div","containerTracking"+e,"inline-block","absolute","scroll","1px","1px","0px","0px","solid","1px","#FFFFFF","0px","0px","nowrap",null,!0);Ch.style.overflowX="hidden";Ac.appendChild(Ch);for(var D=0,C=ie.length;D<C;D++){q=0==D%2?"#F8F8F8":"#FFFFFF";q=Z.Utils.createContainerElement("div","rowContainer","inline-block","absolute",
"hidden","100%","24px","0px",B+"px","none","0px",q,"0px","0px","nowrap",null,!0);Ch.appendChild(q);parseFloat(Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDALPHA"));Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDCOLOR");var P=Z.Utils.stringValidateColorValue(ie[D].fillColor),Da="buttonCounterType"+D.toString();q[Da]=Z.Utils.createContainerElement("div",Da,"inline-block","absolute","visible","22px","14px",O+"px","4px","solid","1px",P,"0px","0px","normal");q[Da].title=Z.Utils.getResource("TIP_COUNTERTYPE");
"edit"!=Z.trackingEditMode?Z.Utils.setOpacity(q[Da],.7,""):0<D?Z.Utils.setOpacity(q[Da],.4,""):Bj=q[Da];q.appendChild(q[Da]);"edit"==Z.trackingEditMode&&(Z.Utils.addEventListener(q[Da],"mouseover",Bh),Z.Utils.addEventListener(q[Da],"mousedown",Bh),Z.Utils.addEventListener(q[Da],"mouseout",Bh));O+=34;P="checkboxCountersShow"+D.toString();q[P]=new Z.Utils.Checkbox(P,"show",k+"px",l+"px",O+"px",r+"px","click",Z.Toolbar.z457,"TIP_COUNTERTYPESHOW");q.appendChild(q[P]);document.getElementById(P).checked=
!0;O+=34;P="rowNameTextBox"+D.toString();Da="rowNameTextNode"+D.toString();q[P]=Z.Utils.createContainerElement("div",P,"inline-block","absolute","hidden",n+"px",u+"px",O+"px",v+"px","none","0px","transparent","0px","0px","nowrap",null,!0);q[Da]=document.createTextNode(ie[D].text);q[P].appendChild(q[Da]);q.appendChild(q[P]);Z.Utils.setTextNodeStyle(q[P],"black","verdana",U+"px","none","normal","normal","normal","normal","1em","left","none");O+=n+12;P="rowCountPerCellTextBox"+D.toString();Da="rowCountPerCellTextNode"+
D.toString();q[P]=Z.Utils.createContainerElement("div",P,"inline-block","absolute","hidden",n+"px",u+"px",O+"px",v+"px","none","0px","transparent","0px","0px","nowrap",null,!0);q[Da]=document.createTextNode("...");q[P].appendChild(q[Da]);q.appendChild(q[P]);Z.Utils.setTextNodeStyle(q[P],"black","verdana",U+"px","none","normal","normal","normal","normal","1em","left","none");O+=30;P="rowCountPerImageTextBox"+D.toString();Da="rowCountPerImageTextNode"+D.toString();q[P]=Z.Utils.createContainerElement("div",
P,"inline-block","absolute","hidden",n+"px",u+"px",O+"px",v+"px","none","0px","transparent","0px","0px","nowrap",null,!0);q[Da]=document.createTextNode("...");q[P].appendChild(q[Da]);q.appendChild(q[P]);Z.Utils.setTextNodeStyle(q[P],"black","verdana",U+"px","none","normal","normal","normal","normal","1em","left","none");O+=26;P="buttonCounterListShow"+D.toString();q[P]=new Z.Utils.Button(P,null,Z.skinPath,b[30],b[31],b[32],"15px","15px",O+"px","4px","mousedown",Z.Toolbar.z457,"TIP_COUNTERLIST");q.appendChild(q[P].elmt);
O="rowCounterFilteredList"+e;Ac[O]=new Z.Utils.createSelectElement(O,"",Ag,1,0,0,g,"hidden",Af,"click");Ac[O].style.fontSize="12px";Ac[O].size=15;Ac.appendChild(Ac[O]);O=8;B+=24}}g=Z.Utils.createContainerElement("div","labelCurrentCellTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);B=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELCURRENTCELL"));g.appendChild(B);Ac.appendChild(g);g=Z.Utils.createContainerElement("div",
"currentCellTextBox"+e,"inline-block","absolute","hidden",n+"px",u+"px",O+"px",v+"px","none","0px","transparent","0px","0px","nowrap",null,!0);n=document.createTextNode("...");g.appendChild(n);Ac.appendChild(g);Z.Utils.setTextNodeStyle(n,"black","verdana",U+"px","none","normal","normal","normal","normal","1em","left","none");"edit"==Z.trackingEditMode&&(g=new Z.Utils.Graphic("countingDivider"+e,Z.skinPath,b[20],"1px","1px","1px","1px"),Ac.appendChild(g.elmt));g=Z.Utils.createContainerElement("div",
"labelCountingCompleteTextBox"+e,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);U=document.createTextNode(Z.Utils.getResource("UI_TRACKINGPANELLABELCOUNTINGCOMPLETE"));g.appendChild(U);Ac.appendChild(g);g=new Z.Utils.Checkbox("checkboxCountingComplete"+e,!0,k+"px",l+"px",O+"px",r+"px","click",Z.Toolbar.z457,"TIP_COUNTINGCOMPLETE");Ac.appendChild(g);g=new Z.Utils.Button("buttonToggleTrackingNav"+e,null,Z.skinPath,b[186],b[187],b[188],
"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_TRACKINGNAVTOGGLE");Ac.appendChild(g.elmt);"edit"==Z.trackingEditMode&&(g=new Z.Utils.Button("buttonTrackingClearLast"+e,null,Z.skinPath,b[189],b[190],b[191],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_COUNTERCLEARLAST"),Ac.appendChild(g.elmt),g=new Z.Utils.Button("buttonTrackingClearType"+e,null,Z.skinPath,b[192],b[193],b[194],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_COUNTERCLEARTYPE"),Ac.appendChild(g.elmt),g=new Z.Utils.Button("buttonTrackingClearAll"+
e,null,Z.skinPath,b[195],b[196],b[197],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_COUNTERSCLEARALL"),Ac.appendChild(g.elmt),g=new Z.Utils.Graphic("trackingDivider"+e,Z.skinPath,b[20],"1px","1px","1px","1px"),Ac.appendChild(g.elmt),g=new Z.Utils.Button("buttonTrackingSave"+e,null,Z.skinPath,b[198],b[199],b[200],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_COUNTERSSAVE"),Ac.appendChild(g.elmt));b=new Z.Utils.Button("buttonCounterListHide"+e,null,Z.skinPath,b[30],b[31],b[32],
"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_COUNTINGLISTHIDE");Ac.appendChild(b.elmt);bj(a);m.syncTrackingToViewport();Z.Utils.addEventListener(f,"mousedown",Z.Utils.preventDefault)}};this.calculateTrackingPanelCoords=function(a,b,e,f,g){if(0==Z.trackingPanelVisible)e=a=-1E3;else switch(a){case "0":e=a=-1E3;break;case "1":e=a=5;break;case "2":a=f-b-5-2;e=5;2==Z.imageSetListPosition&&(e+=20);break;case "3":a=f-b-5;e=0<Z.toolbarVisible&&8!=Z.toolbarVisible?g-e-5:g-5;break;case "4":a=5;e=
0<Z.toolbarVisible&&8!=Z.toolbarVisible?g-e-5:g-5;break;default:a=f-b-5,e=5}return new Z.Utils.Point(a,e)};this.sizeAndPositionTrackingPanel=function(a,b,e,f,g){"undefined"!==typeof b&&null!==b&&(a.width=b+"px");"undefined"!==typeof e&&null!==e&&(a.height=e+"px");"undefined"!==typeof f&&null!==f&&(a.left=f+"px");"undefined"!==typeof g&&null!==g&&(a.top=g+"px")};this.goToNextCell=function(a){a=m.calculateNextCellCoordinates(a);m.zoomAndPanToView(a.x,a.y)};this.calculateNextCellCoordinates=function(a){var b=
Math.round(m.getX()),e=Math.round(m.getY()),f=m.getZoom(),g=Math.max(0,Math.floor(b*f/Z.viewerW)),k=Math.max(0,Math.floor(e*f/Z.viewerH));switch(a){case "left":--g;break;case "right":g+=1;break;case "up":--k;break;case "down":k+=1}f=Math.round(100*f);f=(1.5>f?1.25:2>f?1.5:2.5>f?2:4>f?2.5:5>f?4:10>f?5:16>f?10:20>f?16:25>f?20:32>f?25:40>f?32:50>f?40:60>f?50:100>f?60:150>f?100:250>f?150:250)/100;a=Math.ceil(Z.viewerW/f);var f=Math.ceil(Z.viewerH/f),l=Math.ceil(Z.imageW/a)-1;0>g&&(g=0);g>l&&(g=l);l=Math.ceil(Z.imageH/
f)-1;0>k&&(k=0);k>l&&(k=l);b=new Z.Utils.Point(b,e);b=Math.round(g*a+a/2);e=Math.round(k*f+f/2);0>b-a/2&&(b=a/2);0>e-f/2&&(e=f/2);return b=new Z.Utils.Point(b,e)};this.syncTrackingToViewport=function(){if(Z.tracking){Z.trackingCellCurrent=m.getCurrentTrackingCellID();var a=document.getElementById("currentCellTextBox"+Ja.toString());a&&(a.textContent=Z.trackingCellCurrent);var a=Z.Utils.arrayIndexOfObjectValue(Fe,"id",Z.trackingCellCurrent),b=document.getElementById("checkboxCountingComplete"+Ja.toString());
b&&(b.checked=-1!=a&&Fe[a].complete?!0:!1);if(Z.trackingCounts){m.calculateCounterCounts();for(var b=0,e=ie.length;b<e;b++){var f=0<Z.trackingCounts.length?Z.trackingCounts[b].countCell.toString():"0",a=0<Z.trackingCounts.length?Z.trackingCounts[b].countImage.toString():"0",g=document.getElementById("rowCountPerCellTextBox"+b.toString());g&&(g.firstChild.textContent=f);if(f=document.getElementById("rowCountPerImageTextBox"+b.toString()))f.firstChild.textContent=a}if(Z.userLogging)for(b=0,e=Z.userList.length;b<
e;b++)if(a=null!==Z.userList[b].countImage?Z.userList[b].countImage.toString():"0",f=document.getElementById("rowCountPerUserTextBox"+b.toString()))f.firstChild.textContent=a}Z.Navigator&&Z.Navigator.getInitialized()&&Z.Navigator.drawNavigatorTrackingOverlay(Fe)}};this.getCurrentTrackingCellID=function(){var a=m.getX(),b=m.getY(),e=m.getZoom();return m.getTrackingCellIDFromCoordinates(a,b,e)};this.getTrackingCellIDFromCoordinates=function(a,b,e){if("undefined"===typeof a||null===a)a=m.getX();if("undefined"===
typeof b||null===b)b=m.getY();if("undefined"===typeof e||null===e)e=m.getZoom();b=Math.max(0,Math.floor(b*e/Z.viewerH));a=Math.max(0,Math.floor(a*e/Z.viewerW));e=Math.round(100*e).toString();return b.toString()+":"+a.toString()+":"+e};this.getCoordinatesFromTrackingCellID=function(a){var b=null,e=null,f=null;"undefined"!==typeof a&&null!==a&&(a=a.split(":"),b=parseInt(a[1],10),e=parseInt(a[0],10),f=parseInt(a[2],10));return new Z.Utils.Point3D(b,e,f)};this.calculateCounterCounts=function(){if(Z.tracking&&
Kc){var a,b,e="undefined"!==typeof ie&&0<ie.length,f=Z.trackingCellCurrent;Z.Utils.arrayClear(Z.trackingCounts);var g=Z.userLogging&&"undefined"!==typeof Z.userList&&0<Z.userList.length;g&&(Z.Utils.arrayClearObjectValue(Z.userList,"countCell"),Z.Utils.arrayClearObjectValue(Z.userList,"countImage"));for(var k=0,l=Kc.length;k<l;k++){b=Kc[k];if(e){a=0;for(var r=ie.length;a<r;a++)"undefined"===typeof Z.trackingCounts[a]&&(Z.trackingCounts[a]={typeID:a.toString,countCell:0,countImage:0}),b.typeID==a.toString()&&
(b.cell==f&&(Z.trackingCounts[a].countCell+=1),Z.trackingCounts[a].countImage+=1)}if(g)for(var r=0,q=Z.userList.length;r<q;r++)a=Z.userList[r],a.name==b.user&&(a.countImage+=1,b.cell==f&&(a.countCell+=1))}}};this.setCellCountComplete=function(a){var b=Z.Utils.arrayIndexOfObjectValue(Fe,"id",Z.trackingCellCurrent);-1==b&&(b=Fe.length);Fe[b]={id:Z.trackingCellCurrent,complete:a,user:Z.userName,date:Z.Utils.getCurrentUTCDateAsString()};Z.Navigator.drawNavigatorTrackingOverlay(Fe)};this.getTrackingCells=
function(){return Fe};this.toggleTrackingNavigatorOverlay=function(a){Z.trackingOverlayVisible="undefined"!==typeof a&&null!==a?a:!Z.trackingOverlayVisible;if(a=document.getElementById("navigatorTrackingOverlay"))a.style.display=Z.trackingOverlayVisible?"inline-block":"none",Ei(a)};this.setSizeAndPositionNavigatorTrackingOverlay=function(a,b,e,f,g){if("undefined"===typeof g||null===g)g=document.getElementById("navigatorTrackingOverlay");g&&(g=g.style,g.width=a+"px",g.height=b+"px",g.left=e+"px",g.top=
f+"px")};this.deleteCounterLast=function(){var a=Kc.length-1;-1!=a&&(m.deleteLabel(Kc[a].value),Kc=Z.Utils.arraySplice(Kc,a,1),m.syncTrackingToViewport())};this.deleteCountersOfType=function(a){for(var b=0,e=ie.length;b<e;b++)for(var f=0,g=Kc.length;f<g;f++)Kc[f].typeID==a&&(m.deleteLabel(Kc[f].value),Kc=Z.Utils.arraySplice(Kc,f,1),g--);m.syncTrackingToViewport()};this.deleteCountersAll=function(){m.deleteAllLabels();Z.Utils.arrayClear(Kc);m.syncTrackingToViewport()};this.saveTracking=function(a,
b,e){Z.localUse?Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALSAVING"),!1,Z.messageDurationStandard,"center",!0):Z.Utils.stringValidate(Z.fileHandlerPath)?-1!=Z.fileHandlerPath.indexOf(Z.Utils.getResource("z13"))||Z.demoNoSave?Z.Utils.showMessage(Z.Utils.getResource("z14"),!1,Z.messageDurationStandard,"center"):(Z.Utils.showMessage(Z.Utils.getResource("z15"),!1,2E3,"center",!1,"5"),a=updateTrackingXML(a,b,e),b=Z.trackingPath,-1==b.toLowerCase().indexOf(".xml")&&(b=b+"/"+Z.Utils.getResource("DEFAULT_TRACKINGXMLFILE")),
(new Z.NetConnector).postXML(Z.fileHandlerPath,a,"postingTrackingXML",b)):Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLFILEHANDLERPATHINVALID"),!0,null,"center")};updateTrackingXML=function(a,b,e){var f;f=Z.Utils.xmlConvertTextToDoc("<TRACKINGDATA></TRACKINGDATA>");var g=Zg(f,"root"),k=Zg(f,"setup"),l;l=Z.trackingPanelPosition;Z.Utils.stringValidate(l)&&k.setAttribute("PANELPOSITION",l);g.appendChild(k);if(0<a.length){var r=f.createElement("TYPES"),k=0;for(l=a.length;k<l;k++){var q=Zg(f,"type"),
m=a[k],n=void 0,n=m.value;Z.Utils.stringValidate(n)&&q.setAttribute("ID",n);n=m.text;Z.Utils.stringValidate(n)&&q.setAttribute("NAME",n);n=m.mediaType;Z.Utils.stringValidate(n)&&q.setAttribute("MEDIATYPE",n);n=m.media;Z.Utils.stringValidate(n)&&q.setAttribute("MEDIA",n);n=m.radius;Z.Utils.stringValidate(n)&&q.setAttribute("RADIUS",n);n=m.caption;Z.Utils.stringValidate(n)&&q.setAttribute("CAPTION",n);n=m.captionPosition;Z.Utils.stringValidate(n)&&q.setAttribute("CAPTIONPOSITION",n);n=m.fillColor;Z.Utils.stringValidate(n)&&
q.setAttribute("FILLCOLOR",n);r.appendChild(q)}}g.appendChild(r);if(0<b.length){var u=f.createElement("CELLS"),k=0;for(l=b.length;k<l;k++)a=Zg(f,"cell"),r=b[k],q=void 0,q=r.value,Z.Utils.stringValidate(q)&&a.setAttribute("ID",q),q=r.complete?"1":"0",Z.Utils.stringValidate(q)&&a.setAttribute("COMPLETE",q),q=r.user,Z.Utils.stringValidate(q)&&a.setAttribute("USER",q),q=r.date,Z.Utils.stringValidate(q)&&a.setAttribute("DATE",q),u.appendChild(a)}g.appendChild(u);if(0<e.length){var v=f.createElement("INSTANCES"),
k=0;for(l=e.length;k<l;k++)b=Zg(f,"label"),u=e[k],a=void 0,a=u.value,Z.Utils.stringValidate(a)&&b.setAttribute("ID",a),a=u.typeID,Z.Utils.stringValidate(a)&&b.setAttribute("CATEGORY",a),a=u.name,Z.Utils.stringValidate(a)&&b.setAttribute("NAME",a),a=u.mediaType,Z.Utils.stringValidate(a)&&b.setAttribute("MEDIATYPE",a),a=u.media,Z.Utils.stringValidate(a)&&b.setAttribute("MEDIA",a),a=u.radius,Z.Utils.stringValidate(a)&&b.setAttribute("RADIUS",a),a=u.caption,Z.Utils.stringValidate(a)&&b.setAttribute("CAPTION",
a),a=u.captionPosition,Z.Utils.stringValidate(a)&&b.setAttribute("CAPTIONPOSITION",a),a=u.fillColor,Z.Utils.stringValidate(a)&&b.setAttribute("FILLCOLOR",a),a=u.cell,Z.Utils.stringValidate(a)&&b.setAttribute("CELL",a),a=u.x,Z.Utils.stringValidate(a)&&b.setAttribute("X",a),a=u.y,Z.Utils.stringValidate(a)&&b.setAttribute("Y",a),a=u.zoom,Z.Utils.stringValidate(a)&&b.setAttribute("ZOOM",a),a=u.user,Z.Utils.stringValidate(a)&&b.setAttribute("USER",a),a=u.initials,Z.Utils.stringValidate(a)&&b.setAttribute("INITIALS",
a),a=u.date,Z.Utils.stringValidate(a)&&b.setAttribute("DATE",a),v.appendChild(b)}g.appendChild(v);return f};this.trackingEventsManager=function(b,e){if(b){var f=Z.Utils.target(b);if(f){var g=Ja.toString(),k=f.parentNode.id,k=k.substring(k.length-1,k.length);switch(e){case "containerFor-checkboxCountersShow"+k:Z.Viewport.setHotspotsVisibilityByFilter("category",k,f.checked);break;case "containerFor-checkboxCountingComplete"+g:Z.Viewport.setCellCountComplete(f.checked);break;case "buttonCounterListShow":Z.Utils.arrayClear(Ag);
for(var f=0,l=Kc.length;f<l;f++){var r=Kc[f];r.typeID==k&&(Ag[Ag.length]={text:r.text,value:r.value,sortKey:r.sortKey,x:r.x,y:r.y,zoom:r.zoom})}Z.Utils.arraySortByObjectValue(Ag,"sortKey");k=document.getElementById("rowCounterFilteredList"+g);Z.Utils.updateSelectElement(k,Ag,0);k.style.visibility="visible";if(k=document.getElementById("buttonCounterListHide"+g))k.style.display="inline-block";if(k=document.getElementById("containerCounterLabels"+g))k.style.display="none";if(k=document.getElementById("containerCounterListLabels"+
g))k.style.display="inline-block";break;case "buttonCounterListHide"+g:f=0;for(l=Ch.children.length;f<l;f++)k=document.getElementById("rowCounterFilteredList"+a.toString()),k.style.visibility="hidden";window.setTimeout(function(){var a=document.getElementById("buttonCounterListHide"+g);a&&(a.style.display="none")},10);if(k=document.getElementById("containerCounterLabels"+g))k.style.display="inline-block";if(k=document.getElementById("containerCounterListLabels"+g))k.style.display="none";break;case "buttonToggleTrackingNav"+
g:m.toggleTrackingNavigatorOverlay();break;case "buttonTrackingClearLast"+g:m.deleteCounterLast();break;case "buttonTrackingClearType"+g:m.deleteCountersOfType(Z.trackingTypeCurrent);break;case "buttonTrackingClearAll"+g:m.deleteCountersAll();break;case "buttonTrackingSave"+g:m.saveTracking(ie,Fe,Kc);break;case "containerFor-checkboxUserCountersShow"+k:Z.Viewport.setHotspotsVisibilityByFilter("user",Z.userList[k].name,f.checked)}}}};this.tourStart=function(){m.tourStop();if(!Z.tourStop){Z.tourPlaying=
!0;var a=document.getElementById("buttonTourStop"),b=document.getElementById("buttonTourStart");a&&b&&(a.style.display="inline-block",b.style.display="none");Z.screensaver?Z.constrainPanStrict||(Z.constrainPanStrict=!0):Z.Utils.playAudio(Bi,A[Ug].audio);var e=Z.screensaver?0:Eh(Ug,"next",A.length-1);null!==e&&Z.Utils.functionCallWithDelay(function(){m.goToDestination(e)},1500)}};this.tourStop=function(){Z.Utils.stopAudio();Z.tourPlaying=!1;var a=document.getElementById("buttonTourStop"),b=document.getElementById("buttonTourStart");
a&&b&&(a.style.display="none",b.style.display="inline-block")};this.priorDestination=function(a){Z.tourPlaying&&a&&m.tourStop();Z.screensaver?m.zoomAndPanToView(Z.priorX,Z.priorY,Z.priorZ,Z.priorR):destinationChange("prior")};this.nextDestination=function(a){Z.tourPlaying&&a&&m.tourStop();destinationChange("next")};destinationChange=function(a){var b;if(Z.screensaver)Z.Utils.functionCallWithDelay(function(){m.goToDestination(0)},0<Z.screensaverSpeed?8E3/Z.screensaverSpeed:3E3);else if("undefined"!==
typeof mb&&null!==mb&&0<mb.length){Z.Utils.playAudio(Bi,A[Ug].audio);var e=Z.tourPlaying?A[Ug].showFor:0;Z.Utils.stringValidate(A[Ug].audio)&&(e+=500);b=Eh(Ug,a,A.length-1);null!==b?(Z.screensaver||Z.Utils.loadAudio(A[b].audio),Z.Utils.functionCallWithDelay(function(){m.goToDestination(b)},e)):m.tourStop()}};this.goToDestination=function(a){if(Z.tourStop)m.tourStop(),Z.tourStop=!1;else{var b,e,f,g=Z.tourPlaying?m.nextDestination:null;if(Z.screensaver){a=Z.Utils.getRandomInt(1,Z.imageW);b=Z.Utils.getRandomInt(1,
Z.imageH);e=Z.Utils.getRandomInt(100*Z.minZ,100*Z.maxZ)/100;500>Z.imageX-a&&(a+=500,a>Z.imageW&&(a-=1E3));500>Z.imageY-b&&(b+=500,b>Z.imageH&&(b-=1E3));.3>Z.imageZ-e&&(e+=.3,e>Z.maxZ&&(e-=.6));f=0;var k=0<Z.screensaverSpeed?8E3/Z.screensaverSpeed:null;null!==k?m.zoomAndPanToView(a,b,e,f,k,null,g):m.setView(a,b,e,f,g)}else{Ug=a;var l=A[a];a=l.x;b=l.y;e=l.z/100;f=l.rotation;k=l.changeFor;switch(A.transition){case "ZoomAndPanToView":m.zoomAndPanToView(a,b,e,f,k,null,g);break;case "SetView":m.setView(a,
b,e,f,g);break;default:m.zoomAndPanToView(a,b,e,f,k,null,g)}g=Z.Utils.arrayIndexOfObjectValue(mb.options,"value",l.internalID.toString());-1!=g&&(mb.selectedIndex=g)}}};this.parseImageListXML=function(a,b){Z.Utils.arrayClear(ef);Yf=Z.Utils.getResource("DEFAULT_IMAGELISTPOSITION");ok=Z.Utils.getResource("DEFAULT_IMAGELISTSOURCE");var e=a.getElementsByTagName("SETUP")[0];if(e){var f=e.getAttribute("LISTPOSITION");Z.Utils.stringValidate(f)&&(Yf=f);f=e.getAttribute("LISTSOURCE");Z.Utils.stringValidate(f)&&
(ok=f);e=e.getAttribute("LISTTITLE");Z.Utils.stringValidate(e)&&(Z.imageListTitle=e)}for(var e=a.getElementsByTagName("IMAGE"),f=0,g=e.length;f<g;f++){for(var k=e[f],l=k.getAttribute("NAME"),r=k.getAttribute("MEDIA"),l="NAME"==ok?l:r.substring(r.lastIndexOf("/")+1,r.length),q=Gb("image"),m="",n=0,u=k.attributes.length;n<u;n++){var v=k.attributes[n];if("MEDIA"!=v.name&&"NAME"!=v.name&&Z.Utils.stringValidate(v.value)){var U="";switch(v.name){case "INITIALX":U="zInitialX";break;case "INITIALY":U="zInitialY";
break;case "INITIALZOOM":U="zInitialZoom";break;case "MINZOOM":U="zMinZoom";break;case "MAXZOOM":U="zMaxZoom";break;case "INITIALROTATION":U="zInitialRotation";break;case "RULERLISTTYPE":U="zRulerListType";break;case "UNITS":U="zUnits";break;case "UNITSPERIMAGE":U="zUnitsPerImage";break;case "PIXELSPERUNIT":U="zPixelsPerUnit";break;case "SOURCEMAGNIFICATION":U="zSourceMagnification";break;case "IMAGEPROPERTIES":U="zImageProperties";break;case "TILESPNG":U="zTilesPNG";break;case "TILEW":U="zTileW";
break;case "TILEH":U="zTileH";break;case "IMAGEW":U="zImageW";break;case "IMAGEH":U="zImageH";break;case "MAGNIFICATION":U="zMagnification";break;case "FOCAL":U="zFocal";break;case "QUALITY":U="zQuality";break;case "HOTSPOTS":U="zHotspotPath";break;case "ANNOTATIONS":U="zAnnotationPath";break;case "TRACKING":U="zTrackingPath"}m+=U+"="+v.value;n<u-1&&(m+="&")}}null===k.getAttribute("TILEW")&&(m+="&zTileW=256");null===k.getAttribute("TILEH")&&(m+="&zTileH=256");ef[ef.length]={text:l,value:q,media:r,
optionalParams:m}}gf(Z.imageListTitle,ef,b)};this.createImageChoiceList=function(a,b,e){gf(a,b,e)};this.setSizeAndPositionImageList=function(b,e,f){if("undefined"===typeof b||null===b)cj=b=Z.tracking&&Z.navigatorVisible&&null!==Z.navigatorW?Z.navigatorW+2:parseInt(Z.Utils.getResource("DEFAULT_IMAGELISTWIDTH"),10);var g=m.calculateImageListCoords(ka,ha,a);if("undefined"===typeof e||null===e)e=g.x;if("undefined"===typeof f||null===f)f=g.y;Ed.style.width=b+"px";Ed.style.left=e+"px";Ed.style.top=f+"px"};
this.calculateImageListCoords=function(a,b,e){var f=cj;if("undefined"===typeof Yf||null===Yf)Yf="1";var g=Yf,k;switch(g){case "0":b=k=0;break;case "1":var l=b=k=0,r=0,q=b=0,m=0,n=0,u=m=r=0,v=0,U=0,v=r=0;"0"!=Z.userPanelVisible&&Z.UserPanel&&(k=parseFloat(Z.UserPanel.style.left),b=parseFloat(Z.UserPanel.style.top),l=parseFloat(Z.UserPanel.style.width),r=parseFloat(Z.UserPanel.style.height),b+=r);0<Z.navigatorVisible&&Z.NavigatorDisplay&&(q=parseFloat(Z.NavigatorDisplay.style.left),m=parseFloat(Z.NavigatorDisplay.style.top),
n=parseFloat(Z.NavigatorDisplay.style.width),r=parseFloat(Z.NavigatorDisplay.style.height),m+=r);"0"!=Z.rulerVisible&&Z.RulerDisplay&&(u=parseFloat(Z.RulerDisplay.style.left),v=parseFloat(Z.RulerDisplay.style.top),U=parseFloat(Z.RulerDisplay.style.width),r=parseFloat(Z.RulerDisplay.style.height),v+=r);Z.narrative&&Z.NarrativeDisplay&&parseFloat(Z.NarrativeDisplay.style.width);l=Math.max(l,n,U);0!=l&&(f=l);k=Math.max(k,q,u);k=0!=k?k:25;b=Math.max(b,m,v);b=0!=b?b+4:25;break;case "2":k=a-f-25;b=20;break;
case "3":k=a-f-25;b=0<Z.toolbarVisible&&8!=Z.toolbarVisible?b-62.5:b-37.5;break;case "4":k=25;b=0<Z.toolbarVisible&&8!=Z.toolbarVisible?b-62.5:b-37.5;break;default:k=a-f,b=25}Z.comparison&&"undefined"!==typeof e&&null!==e&&(0!=e||"2"!=g&&"3"!=g?1!=e||"1"!=g&&"4"!=g||(k=2*a-(25+f)):k=a-25);return new Z.Utils.Point(k,b)};this.setImageListVisibilty=function(a){Ed.style.visibility=a};this.updateImageList=function(b){ef=b;Ed&&Z.Utils.updateSelectElement(Ed,ef,a,kd)};this.createAnnotationFileChoiceList=
function(a,b){var e=Z.Viewport.getViewportID().toString();Zk=b;if((e=document.getElementById("AnnotationPanelDisplay"+e))&&!Vc){var f=e.style,e=parseInt(f.width)+2,g=parseInt(f.height),k=parseInt(f.left),f=parseInt(f.top)+g+4;Vc=new Z.Utils.createSelectElement("annotationFileList",a,b,e,k,f,null,"visible",ul,"change");Z.ViewerDisplay.appendChild(Vc);Vc.style.zIndex=(Z.baseZIndex+18).toString();e=m.getAnnotationPath();e=Z.Utils.arrayIndexOfObjectValue(b,"value",e);-1==e&&(e=0);k=Z.Utils.stringValidate(a)&&
"none"!=a?1:0;Vc.selectedIndex=e+k;m.setStatus("initializedAnnotationFileList",!0)}else Z.Utils.arrayClear(b)};this.setSizeAndPositionAnnotationFileList=function(a,b,e){a=Z.Viewport.getViewportID().toString();if((a=document.getElementById("AnnotationPanelDisplay"+a))&&Vc){e=a.style;a=parseInt(e.width)+2;var f=parseInt(e.height);b=parseInt(e.left);e=parseInt(e.top)+f+4;f=Vc.style;f.width=a+"px";f.left=b+"px";f.top=e+"px"}};this.setAnnotationFileListVisibilty=function(a){Vc&&(Vc.style.visibility=a)};
this.updateAnnotationFileList=function(b){annotationFileListDB=b;Vc&&Z.Utils.updateSelectElement(Vc,Zk,a)};this.updateImageComponents=function(){if(Ed){var b=Z.Utils.arrayIndexOfObjectValue(Ed.options,"value",m.getImagePath());-1!=b&&(Ed.selectedIndex=b)}0<Z.rulerVisible&&Z.narrative&&Nd(a);if(Z.narrative&&Z.annotations){var b=Z.imagePath.substring(Z.imagePath.lastIndexOf("/")+1,Z.imagePath.indexOf("."))+"-annotations",e=null;if(Vc){var f=Z.Utils.arrayIndexOfObjectValue(Vc.options,"text",b);-1!=f&&
(e=Vc.options[f].value,Vc.selectedIndex=f)}e||(e=Z.narrativeAnnotationFolderPath+b+".xml");Z.annotationPath!=e&&Z.Viewer.setAnnotationPath(e)}};this.parseSlidesXML=function(a){Z.Utils.arrayClear(td);Z.Utils.arrayClear(pj);Ui=Z.Utils.getResource("DEFAULT_SLIDESHOWAUTOSTART");Dj=Z.Utils.getResource("DEFAULT_SLIDESHOWAUTOLOOP");fi=Z.Utils.getResource("z202");qk=parseInt(Z.Utils.getResource("z204"),10);rk=Z.Utils.getResource("z203");null===Z.slideListTitle&&(Z.slideListTitle=Z.Utils.getResource("z443"));
var b=a.getElementsByTagName("SETUP")[0];if(b){var e=b.getAttribute("AUTOSTART");Z.Utils.stringValidate(e)&&(Ui="0"!=e&&"false"!=e);e=b.getAttribute("AUTOLOOP");Z.Utils.stringValidate(e)&&(Dj="0"!=e&&"false"!=e);e=b.getAttribute("CHOICELIST");Z.Utils.stringValidate(e)&&(fi=e);e=b.getAttribute("LISTSOURCE");Z.Utils.stringValidate(e)&&(rk=e);b=b.getAttribute("LISTTITLE");Z.Utils.stringValidate(b)&&(Z.slideListTitle=b)}a=a.getElementsByTagName("SLIDE");b=0;for(e=a.length;b<e;b++){var f=new I(a[b]);td[td.length]=
f;var g="NAME"==rk?f.name:f.media.substring(f.media.lastIndexOf("/")+1,f.media.length);pj[pj.length]={text:g,value:f.internalID}}a=Z.slideListTitle;b=pj;e="0"==fi?"hidden":"visible";f=m.calculateSlideListCoords(ka,ha);"undefined"===typeof je||null===je?(je=new Z.Utils.createSelectElement("SlideList",a,b,qk,f.x,f.y,null,e,vl,"change"),Z.ViewerDisplay.appendChild(je),Z.slideList=!0,Zf=0,a=Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0,je.selectedIndex=a):Z.Utils.arrayClear(b);
m.initializeAudioMuteButtons();null===Z.imagePath||"null"==Z.imagePath||-1!=Z.imagePath.indexOf("zSlidePath")?m.goToSlide(0,!0):Ui&&m.slideshowStart()};this.calculateSlideListCoords=function(a,b){var e=qk,f;switch(fi){case "0":f=e=0;break;case "1":f=e=25;break;case "2":e=a-e-25;f=20;break;case "3":e=a-e-25;f=0<Z.toolbarVisible&&8!=Z.toolbarVisible?b-50:b-37.5;break;case "4":e=25;f=0<Z.toolbarVisible&&8!=Z.toolbarVisible?b-50:b-37.5;break;default:e=a-e,f=25}return new Z.Utils.Point(e,f)};this.setVisibilitySlidesChoiceList=
function(a){var b=document.getElementById("SlideList");b&&(b.style.visibility=a&&"0"!=fi?"visible":"hidden")};this.slideshowStart=function(a){m.slideshowStop();Z.slideshowPlaying=!0;var b=document.getElementById("buttonSlideshowStop"),e=document.getElementById("buttonSlideshowStart");b&&e&&(b.style.display="inline-block",e.style.display="none");Z.Utils.playAudio(Bi,td[Zf].audio);var b=Z.slideshowPlaying?td[Zf].showFor:0,f=a?0:Eh(Zf,"next",td.length-1);null!==f&&(Z.Utils.loadAudio(td[f].audio),Z.Utils.functionCallWithDelay(function(){m.goToSlide(f,
null,null,!0)},b))};this.slideshowStop=function(){Z.Utils.stopAudio();Z.slideshowPlaying=!1;var a=document.getElementById("buttonSlideshowStop"),b=document.getElementById("buttonSlideshowStart");a&&b&&(a.style.display="none",b.style.display="inline-block")};this.priorSlide=function(a){Z.slideshowPlaying&&a&&m.slideshowStop();Ek("prior")};this.nextSlide=function(a){Z.slideshowPlaying&&a&&m.slideshowStop();Ek("next")};this.goToSlide=function(a,b,e,f){if(!Z.slideshowStopping&&(Z.slideshowPlaying||b||
e||f)){Zf=a;a=td[a];e=Z.Utils.parametersToDelimitedString(Z.parameters,"&");var g=a.initialX,k=Z.Utils.stringValidate(g)?"center"==g?"zInitialX="+(Z.imageW/2).toString():isNaN(parseFloat(g))?"":"zInitialX="+g:"",g=a.initialY;f=Z.Utils.stringValidate(g)?"center"==g?"zInitialY="+(Z.imageH/2).toString():isNaN(parseFloat(g))?"":"zInitialY="+g:"";var g=a.initialZoom,l=Z.Utils.stringValidate(g)?isNaN(parseFloat(g))?"":"zInitialZoom="+g:"",g=a.minZoom,r=Z.Utils.stringValidate(g)?isNaN(parseFloat(g))?"":
"zMinZoom="+g:"",g=a.maxZoom,q=Z.Utils.stringValidate(g)?isNaN(parseFloat(g))?"":"zMaxZoom="+g:"",g=a.hotspotPath,m=Z.Utils.stringValidate(g)?"zHotspotPath="+g:"",g=a.annotationPath,g=Z.Utils.stringValidate(g)?"zAnnotationPath="+g:"",k=""!=k?k:"";""!=f&&(k+=(""!=k?"&":"")+f);""!=l&&(k+=(""!=k?"&":"")+l);""!=r&&(k+=(""!=k?"&":"")+r);""!=q&&(k+=(""!=k?"&":"")+q);""!=m&&(k+=(""!=k?"&":"")+m);""!=g&&(k+=(""!=k?"&":"")+g);f=k;f=null!==f?f:"";l=Z.Utils.stringValidate(f)?"&":"";e=e+l+f;switch(a.transition){case "Fade":Z.Viewer.setImageWithFade(a.media,
e,b,a.changeFor);break;case "None":Z.Viewer.setImage(a.media,e,b);b=Z.Utils.arrayIndexOfObjectValue(je.options,"value",a.internalID.toString());-1!=b&&(je.selectedIndex=b);Z.Gallery&&Z.Gallery.getInitialized()&&Z.Gallery.syncGalleryToViewport(b-1);break;default:Z.Viewer.setImageWithFade(a.media,e,b)}}};this.getSlides=function(){return td};this.slideTransitionTimeoutHandler=function(a,b,e,f,g){if(Z.slideshowStopping)Z.slideOpacity=1,a=null;else{if("undefined"===typeof g||null===g)g=50;f&&(Z.Viewer.setImage(b,
e,f),a="in");window.clearTimeout(Z.slideTransitionTimeout);Z.slideTransitionTimeout=null;"out"==a?0<=Z.slideOpacity?(Z.slideOpacity-=$k,a="out",.5>Z.slideOpacity&&!Z.audioStopped&&(Z.audioStopped=!0,Z.Utils.stopAudio())):(Z.slideOpacity=0,a="in",Z.setCallback("viewUpdateComplete",function(){Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(a,b,e)},g)}),Z.Viewer.setImage(b,e,null)):(0==Z.slideOpacity&&Z.clearCallback("viewUpdateComplete",function(){Z.slideTransitionTimeout=
window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(a,b,e)},g)}),1>=Z.slideOpacity?(Z.slideOpacity+=$k,a="in",.1<Z.slideOpacity&&Z.audioStopped&&(Z.audioStopped=!1,Z.Utils.playAudio(Bi,td[Zf].audio),f=Z.Utils.arrayIndexOfObjectValue(je.options,"value",td[Zf].internalID.toString()),-1!=f&&(je.selectedIndex=f),Z.Gallery&&Z.Gallery.getInitialized()&&Z.Gallery.syncGalleryToViewport(f-1))):(Z.slideOpacity=1,a=null))}eb&&Z.Utils.setOpacity(eb,Z.slideOpacity);Z.NavigatorDisplay&&Z.Utils.setOpacity(Z.NavigatorDisplay,
Z.slideOpacity);Z.GalleryDisplay&&Z.Utils.setOpacity(Z.GalleryDisplay,Z.slideOpacity);null!==a&&0!=Z.slideOpacity&&(Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(a,b,e)},g))};this.initializeAudioMuteButtons=function(){if(Z.audioContent){var a=document.getElementById("buttonAudioOn");a&&(a.style.display="inline-block")}};this.audioMute=function(a){if(Z.audioMuted=a)Z.audioStopped=!0,Z.Utils.stopAudio();var b=document.getElementById("buttonAudioMuted"),
e=document.getElementById("buttonAudioOn");b&&e&&(a?(b.style.display="inline-block",e.style.display="none"):(b.style.display="none",e.style.display="inline-block"))};this.setViewNoUpdate=function(a,b,e,f,g,k,l,r,q,m,n){L.left=a;L.top=b;hb.width=e;hb.height=f;hb.left=g;hb.top=k;Ea.width=l;Ea.height=r;Ea.left=q;Ea.top=m;0!=n&&Z.Utils.rotateElement(L,n,!0)};this.setView=function(a,b,e,f,g,k){Ti(a,b,e,f,g,k)};this.zoom=function(a){if("stop"!=a||"stop"!=Z.zooming){switch(a){case "out":0<=nd&&(nd-=Hg);
break;case "in":0>=nd&&(nd+=Hg);break;case "stop":nd=0}Z.zooming=0==nd?"stop":0<nd?"in":"out";if(0!=nd){if(!hf){if(0>nd&&Z.imageZ>Z.minZ||0<nd&&Z.imageZ<Z.maxZ)m.toggleWatermarks(!1),A&&39<A.length&&m.setHotspotsVisibility(!1);Z.useCanvas||Z.Utils.clearDisplay(Ob);hf=window.setTimeout(M,Fh)}}else Hk(),m.updateView(),m.toggleWatermarks(!0),A&&39<A.length&&m.setHotspotsVisibility(!0)}};this.pan=function(a){if("horizontalStop"!=a||"stop"!=Z.panningX)if("verticalStop"!=a||"stop"!=Z.panningY){if(!Z.tracking)switch(a){case "left":0>=
Wc&&(Wc+=eh);break;case "up":0>=md&&(md+=eh);break;case "down":0<=md&&(md-=eh);break;case "right":0<=Wc&&(Wc-=eh);break;case "horizontalStop":Wc=0;break;case "verticalStop":md=0;break;case "stop":md=Wc=0}Z.panningX=0==Wc?"stop":0<Wc?"left":"right";Z.panningY=0==md?"stop":0<md?"up":"down";Aa(Sa,1);Aa(Sa,1);0!=Wc||0!=md?hf||(m.toggleWatermarks(!1),Z.useCanvas||Z.Utils.clearDisplay(Ob),A&&39<A.length&&m.setHotspotsVisibility(!1),hf=window.setTimeout(M,Fh)):(Hk(),m.updateView(),m.toggleWatermarks(!0),
A&&39<A.length&&m.setHotspotsVisibility(!0))}};this.zoomAndPanToView=function(a,b,e,f,g,k,l,r){m.zoomAndPanAllStop();if(!Z.clickZoomAndPanBlock||"undefined"!==typeof r&&null!==r&&r){if("undefined"===typeof a||null===a)a=Z.imageX;if("undefined"===typeof b||null===b)b=Z.imageY;if("undefined"===typeof e||null===e)e=Z.imageZ;if("undefined"===typeof f||null===f)f=Z.imageR;if("undefined"===typeof g||null===g)g=El;if("undefined"===typeof k||null===k)k=dj;if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;
if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;if(-1==e||isNaN(parseFloat(e)))e=Z.fitZ;m.toggleWatermarks(!1);Z.useCanvas||Z.Utils.clearDisplay(Ob);A&&39<A.length&&m.setHotspotsVisibility(!1);"undefined"===typeof e||null===e?e=Z.initialZ:100<e?e/=100:e>Z.maxZ?e=Z.maxZ:e<Z.maxZ&&e>Z.maxZ-.01&&(e=Z.maxZ);b=Fa(a,b,e,f,"image");a=b.x;b=b.y;e=Na(e);if(Math.round(a)!=Math.round(Z.imageX)||Math.round(b)!=Math.round(Z.imageY)||Math.round(1E5*e)!=Math.round(1E5*Z.imageZ)||Math.round(f)!=Math.round(Z.imageR))Z.interactive=
!1,gi=0,Z.zoomAndPanInProgressID=a.toString()+"-"+b.toString()+"-"+e.toString()+"-"+f.toString(),Gk(a,b,e,f,g,k,l)}else Z.clickZoomAndPanBlock=!1};this.zoomAndPanAllStop=function(a,b){Z.interactive&&((null!==Z.zoomAndPanInProgressID||Zh)&&dd(),Z.tourPlaying&&b&&(m.tourStop(),a=!1),Z.slideshowPlaying&&b&&(m.slideshowStop(),a=!1),Z.smoothPan&&null!==Re&&(Z.mouseIsDown||Jh(!0),a=!0),a||m.updateView(null,null,!0))};this.syncViewportRelated=function(b,e,f,g,k,l,r,q,n,u,v){Z.expressParamsEnabled&&(Z.sliderZoomVisible&&
("undefined"===typeof f||null===f||f)&&(Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(f=m.getZoom(),Z.Toolbar.syncSliderToViewportZoom(f)),Z.Utils.validateCallback("viewZoomingGetCurrentZoom")),Z.Navigator&&("undefined"===typeof g||null===g||g)&&xb());Z.proParamsEnabled&&(Z.watermarks&&("undefined"===typeof b||null===b||b)&&Ob&&(Z.Utils.clearDisplay(Ob),kc()),A&&("undefined"===typeof e||null===e||e)&&Eb(),Z.Ruler&&("undefined"===typeof k||null===k||k)&&Z.Ruler&&Z.Ruler.getInitialized()&&
Z.Ruler.syncToViewport(),Z.sliderImageSetVisible&&"undefined"!==typeof l&&l&&Z.Viewer.syncToolbarImageSetSliderToViewport(Z.viewportCurrentID),Z.comparison&&("undefined"===typeof r||null===r||r)&&Z.Viewer.syncComparisonViewport(r),Z.overlays&&("undefined"===typeof q||null===q||q)&&Z.Viewer.syncOverlayViewports(q,a),Z.bookmarksSet&&"undefined"!==typeof n&&null!==n&&n&&Z.Utils.setBookmarksURL());Z.enterpriseParamsEnabled&&(Z.Magnifier&&("undefined"===typeof v||null===v||v)&&syncMagnifierToViewport(),
Z.tracking&&("undefined"===typeof u||null===u||u)&&m.syncTrackingToViewport());Z.Utils.validateCallback("viewChanging");Z.Utils.validateCallback("viewPanningGetCurrentCoordinates");Z.Utils.validateCallback("viewChangingGetCurrentCoordinatesFull")};this.scaleTierToZoom=function(a,b){Gj(a,b)&&m.syncViewportRelated()};this.reset=function(a){Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();a?(Z.Utils.setButtonDefaults(buttonReset),m.zoomAndPanToView(Z.priorX,Z.priorY,Z.priorZ,Z.priorR)):m.zoomAndPanToView(Z.initialX,
Z.initialY,Z.initialZ,Z.initialR);Fk(!0)};this.labelScale=function(a){switch(a){case "down":0<=jf&&(jf-=sj);break;case "up":0>=jf&&(jf+=sj);break;case "stop":jf=0}0!=jf?Gh||(Gh=window.setTimeout(Ik,Jk)):(Gh&&(window.clearTimeout(Gh),Gh=null),jf=0)};this.toggleWatermarks=function(a){if(Ye){var b="inline-block"==Ye.display;Ye.display=("undefined"!==typeof a&&null!==a?a:!b)?"inline-block":"none"}};this.toggleConstrainPan=function(a){Z.constrainPan="undefined"!==typeof a&&null!==a?a:!Z.constrainPan;if(Z.constrainPan){a=
parseFloat(hb.left);var b=parseFloat(hb.top);a=Fa(a,b,Z.imageZ,Z.imageR,"container");L.left=a.x+"px";L.top=a.y+"px";m.updateView()}};this.toggleSmoothPan=function(){Jh();Z.smoothPan=!Z.smoothPan};this.toggleSmoothZoom=function(){dd();Z.smoothZoom=!Z.smoothZoom};this.buttonToggleBackfillHandler=function(){m.toggleBackfill()};this.toggleBackfill=function(a){var b=document.getElementById("viewportBackfillDisplay"+Ja.toString());if(b){var b=b.style,e="inline-block"==b.display;b.display=("undefined"!==
typeof a&&null!==a?a:!e)?"inline-block":"none"}};this.buttonToggleDisplayHandler=function(){m.toggleDisplay()};this.toggleDisplay=function(a){var b=document.getElementById("viewportDisplay"+Ja.toString());b&&(hb=b.style,b="inline-block"==hb.display,hb.display=("undefined"!==typeof a&&null!==a?a:!b)?"inline-block":"none")};this.toggleDisplaysOther=function(a){a=a?"inline-block":"none";Bc&&(Bc.display=a);Ea&&(Ea.display=a);Xe&&(Xe.display=a);jg&&(jg.display=a);Ye&&(Ye.display=a);$c&&($c.display=a);
oc&&(oc.display=a);jc&&(jc.display=a);Jb&&(Jb.display=a)};this.zoomAndPanToZoomRectangle=function(a){var b=Math.min(a[0].x,a[1].x,a[2].x,a[3].x),e=Math.max(a[0].x,a[1].x,a[2].x,a[3].x),f=Math.min(a[0].y,a[1].y,a[2].y,a[3].y);a=Math.max(a[0].y,a[1].y,a[2].y,a[3].y);e-=b;a-=f;var b=b+e/2,f=f+a/2,g=m.getRotation(),e=m.z468(e,a,g);m.zoomAndPanToView(b,f,e)};this.toggleFullViewModeExternal=function(){Qj=!0;m.toggleFullViewMode()};this.toggleFullViewMode=function(a,b){Z.maskingSelection&&Z.maskClearOnUserAction&&
m.clearMask();Z.ToolbarDisplay&&Z.Toolbar&&Z.Toolbar.show(!1);var e=null,f=null;Z.fullViewPrior=Z.fullView;Z.fullView="undefined"!==typeof a&&null!==a?a:!Z.fullView;var g=document.body.style,k=document.documentElement.style,l=Z.ViewerDisplay.style,e=Z.Utils.getElementStyle(Z.pageContainer);Z.fullView?(f=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay),Nj=f.x,Oj=f.y,Uk=g.overflow,Vk=k.overflow,Pj=Z.Utils.stringValidate(e.backgroundColor)&&"transparent"!=e.backgroundColor?e.backgroundColor:
Z.Utils.stringValidate(g.backgroundColor)&&"transparent"!=g.backgroundColor?g.backgroundColor:Z.Utils.getResource("z120"),Wk=l.zIndex,Z.fullScreenSupported&&!Z.fullPageVisible?(f=Z.Utils.getScreenSize(),Z.fullScreenEntering=!0,Z.Utils.fullScreenView(Z.ViewerDisplay,!0),Z.Utils.validateCallback("fullscreenEntered")):(f=Z.Utils.getWindowSize(),Z.mobileDevice?(g.width=f.x,g.height=f.y):(g.width="100%",g.height="100%"),Z.Utils.validateCallback("fullpageEntered")),e=f.x,f=f.y,g.overflow="hidden",k.overflow=
"hidden",l.backgroundColor=Pj,l.position="fixed",l.zIndex="99999999",Z.autoResize&&Z.Utils.removeEventListener(window,"resize",Z.Viewer.viewerEventsHandler)):(g.overflow=Uk,k.overflow=Vk,l.backgroundColor=Pj,l.position="relative",l.zIndex=Wk,Z.fullScreenSupported&&!Z.fullPageVisible?(Z.Utils.fullScreenView(Z.ViewerDisplay,!1,b),Z.Utils.validateCallback("fullscreenExited")):Z.Utils.validateCallback("fullpageExited"),g.width=Nj,g.height=Oj,e=Nj,f=Oj,isNaN(e)&&(e=Z.ViewerDisplay.clientWidth),isNaN(f)&&
(f=Z.ViewerDisplay.clientHeight),Qj=!1,Z.autoResize&&Z.Utils.addEventListener(window,"resize",Z.Viewer.viewerEventsHandler));Z.initialFullPage&&m.setSizeAndPosition(e,f);g=Z.viewportCurrent.calculateZoomForResize(Z.viewportCurrent.getZoom(),Z.viewerW,Z.viewerH,e,f);Z.Viewer.resizeViewer(e,f,g);g=null;if(Z.slideshow)Z.Toolbar.gallerySizeAndPositionReset();else if(Z.comparison)(g=0==m.getViewportID()?Z.Viewport1:Z.Viewport0)&&g.syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else if(Z.overlays)for(k=
0,l=Z.imageSetLength-1;k<l;k++)Z["Viewport"+k.toString()].syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else Z.narrative&&(Z.Narrative.drawLayoutNarrativePanel(),Z.narrativeMode&&Z.Narrative.drawLayoutFileManagerPanel());Z.imageList&&m.getStatus("initializedImageList")&&(m.setSizeAndPositionImageList(),g&&g.getStatus("initializedImageList")&&g.setSizeAndPositionImageList());Z.annotationFileList&&m.getStatus("initializedAnnotationFileList")&&m.setSizeAndPositionAnnotationFileList();g=Z.fullView;
k=document.getElementById("buttonFullView");l=document.getElementById("buttonFullViewExit");k&&l&&(k.style.display=g?"none":"inline-block",l.style.display=g?"inline-block":"none");Qj?(oi||(g=Z.Utils.getResource("z420"),k=parseFloat(Z.viewerW)-54,l=parseFloat(Z.viewerH)-54,e=Z.Utils.getResource("DEFAULT_FULLVIEWEXITEXTERNALBUTTONCOLOR"),oi=new Z.Utils.Button("buttonFullViewExitExternal",g,null,null,null,null,"34px","34px",k+"px",l+"px","mousedown",wl,"z391EXITEXTERNAL","solid","1px",e,"0px","0px"),
Z.ViewerDisplay.appendChild(oi.elmt)),oi.elmt.style.display="inline-block"):oi&&(oi.elmt.style.display="none");Z.fullViewPrior=!1};this.rotate=function(a,b){if(!Z.rotationFree||b)0!=Z.imageR%90&&(Z.imageR=90*Math.round(Z.imageR/90)),m.rotateStep("clockwise"==a?90:-90,!0);else if("stop"!=a||"stop"!=Z.rotating)$f="stop"==a?0:"clockwise"==a?fh:-fh,Z.rotating=0==$f?"stop":0<$f?"clockwise":"counterwise",0!=$f?Gd||(Gd=window.setTimeout(Kk,Hh)):($f=0,Gd&&(window.clearTimeout(Gd),Gd=null),m.updateView())};
this.rotateStep=function(a,b,e){m.rotateSet(Z.imageR+a,b,e)};this.rotateSet=function(a,b,e){if(Z.interactive)if(Z.rotationSupported)if(Z.rotationFree)e?(Z.Utils.rotateElement(L,Z.imageR,!0),Z.interactive=!0):(Z.Utils.rotateElement(L,a),Z.imageR=a,xb());else{Z.interactive=!1;var f=Qa(a);b?m.zoomAndPanToView(Z.imageX,Z.imageY,Z.imageZ,a,600,12,function(){Z.imageR=f}):e?(Z.Utils.rotateElement(L,Z.imageR,!0),Z.interactive=!0):(Z.Utils.rotateElement(L,a),Ga&&0!=Z.imageR&&Ib.rotate((a-Z.imageR)*Math.PI/
180),Z.imageR=f,m.zoomAndPanToView(Z.imageX,Z.imageY,Z.imageZ))}else Z.Utils.showMessage(Z.Utils.getResource("z12"))};this.toggleEditModeMeasure=function(a){m.zoomAndPanAllStop();Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();"undefined"!==typeof a&&!a||"measure"==Z.labelMode?(null===Z.editMode&&"measure"==Z.labelMode&&0<A.length&&(m.deleteAllMeasureHotspots(),ea=null),m.setEditModeLabel("view")):m.setEditModeLabel("measure",null,null,null,null,!0)};this.getImageFilterValuePrior=function(a){var b=
0;switch(a){case "brightness":b=Sj;break;case "contrast":b=Tj;break;case "sharpness":b=Uj;break;case "blurriness":b=Vj;break;case "colorRed":b=Wj;break;case "colorGreen":b=Xj;break;case "colorBlue":b=Yj;break;case "colorRedRange":b=Zj;break;case "colorGreenRange":b=ak;break;case "colorBlueRange":b=bk;break;case "colorRedRange2":b=ck;break;case "colorGreenRange2":b=dk;break;case "colorBlueRange2":b=ek;break;case "gamma":b=fk;break;case "gammaRed":b=gk;break;case "gammaGreen":b=hk;break;case "gammaBlue":b=
ik;break;case "hue":b=jk;break;case "saturation":b=kk;break;case "lightness":b=lk;break;case "whiteBalance":b=mk;break;case "noise":b=nk}return b};this.setImageFilterValuePrior=function(a,b){switch(a){case "brightness":Sj=b;break;case "contrast":Tj=b;break;case "sharpness":Uj=b;break;case "blurriness":Vj=b;break;case "colorRed":Wj=b;break;case "colorGreen":Xj=b;break;case "colorBlue":Yj=b;break;case "colorRedRange":Zj=b;break;case "colorGreenRange":ak=b;break;case "colorBlueRange":bk=b;break;case "colorRedRange2":ck=
b;break;case "colorGreenRange2":dk=b;break;case "colorBlueRange2":ek=b;break;case "gamma":fk=b;break;case "gammaRed":gk=b;break;case "gammaGreen":hk=b;break;case "gammaBlue":ik=b;break;case "hue":jk=b;break;case "saturation":kk=b;break;case "lightness":lk=b;break;case "whiteBalance":mk=b;break;case "noise":nk=b}};this.setImageFilter=function(a,b,e){if("undefined"!==typeof a&&null!==a&&"null"!=a&&"undefined"!==typeof b&&(null!==b||"grayscale"==a||"threshold"==a||"inversion"==a||"normalize"==a||"equalize"==
a||"edges"==a||"sepia"==a)){m.clearTileCache();var f=!0,g;-1==a.indexOf("Range")?(f=m.getImageFilterDefault(a),f=b==f):"undefined"!==typeof e&&null!==e&&(f=a.indexOf("2"),f=a.substring(0,-1==f?a.length:f),g=f+"2",f=m.getImageFilterDefault(f),g=m.getImageFilterDefault(g),f=b==f&&e==g);if(f)Lk(a);else{var k="undefined"!==typeof b&&null!==b,f="grayscale"==a||"threshold"==a||"inversion"==a||"normalize"==a||"equalize"==a||"edges"==a||"sepia"==a;g=Z.Utils.arrayIndexOfObjectValue(Xa,"filter",a);var l=-1==
g,r=0<Xa.length&&Xa[Xa.length-1].filter==a;if(k||f){k=!1;if(-1!=g)Z.Toolbar.addFilterToImageFilterList(a,b,null,!0),Xa[g].value=b,Xa[g].value2=e,1<Xa.length&&(a=null),k=!0;else if(r&&!f)Z.Toolbar.addFilterToImageFilterList(a,b),Xa[Xa.length-1].value=b,Xa[Xa.length-1].value2=e,k=!0;else if(l||!f)Z.Toolbar.addFilterToImageFilterList(a,b,e),Xa[Xa.length]={filter:a,value:b,value2:e},k=!0;k&&(1<Xa.length&&(a=null),validateImageFiltersConvolve(),m.applyImageFilter(a,b,null,e))}}}};this.clearImageFilterLast=
function(){0<Xa.length&&Lk(Xa[Xa.length-1].filter,!0)};this.clearImageFiltersAll=function(){if(0<Xa.length){for(var a=0,b=Xa.length;a<b;a++)Z.Toolbar&&"external"!=Z.imageFilters&&Z.Toolbar.clearImageFilterInPanel(Xa[a].filter);Z.Utils.arrayClear(Xa);validateImageFiltersConvolve();m.updateView(!0)}Z.Toolbar&&"undefined"!==typeof imageFilterCurrent&&"external"!=Z.imageFilters&&Z.Toolbar.setFilterSliderReferences(imageFilterCurrent)};this.imageFilterButtonsHandler=function(a,b){var e="plus"==b?1:-1;
if(Z.Utils.stringValidate(a)){var e=.05*e,f=m.getImageFilterRangeMaxAbsolute(a),e=m.getImageFilterValuePrior(a)+f*e,e=constrainImageFilter(a,e);Z.Toolbar.syncImageFilterPanel(a,e);m.setImageFilterValuePrior(a,e);m.setImageFilter(a,e)}};this.getImageFilterDefault=function(a){var b=0;switch(a){case "brightness":b=0;break;case "contrast":b=0;break;case "sharpness":b=0;break;case "blurriness":b=0;break;case "colorRed":b=0;break;case "colorGreen":b=0;break;case "colorBlue":b=0;break;case "colorRedRange":b=
0;break;case "colorGreenRange":b=0;break;case "colorBlueRange":b=0;break;case "colorRedRange2":b=255;break;case "colorGreenRange2":b=255;break;case "colorBlueRange2":b=255;break;case "gamma":b=1;break;case "gammaRed":b=1;break;case "gammaGreen":b=1;break;case "gammaBlue":b=1;break;case "hue":b=0;break;case "saturation":b=0;break;case "lightness":b=0;break;case "whiteBalance":b=6500;break;case "noise":b=0}return b};this.getImageFilterRange=function(a){var b=0,e=100;switch(a){case "brightness":b=-150;
e=150;break;case "contrast":b=-50;e=100;break;case "sharpness":e=40;break;case "blurriness":e=30;break;case "colorRed":b=-100;e=100;break;case "colorGreen":b=-100;e=100;break;case "colorBlue":b=-100;e=100;break;case "colorRedRange":b=0;e=m.getImageFilterRangeMaxAbsolute(a);break;case "colorGreenRange":b=0;e=m.getImageFilterRangeMaxAbsolute(a);break;case "colorBlueRange":b=0;e=m.getImageFilterRangeMaxAbsolute(a);break;case "colorRedRange2":b=0;e=m.getImageFilterRangeMaxAbsolute(a);break;case "colorGreenRange2":b=
0;e=m.getImageFilterRangeMaxAbsolute(a);break;case "colorBlueRange2":b=0;e=m.getImageFilterRangeMaxAbsolute(a);break;case "gamma":b=0;e=4;break;case "gammaRed":b=0;e=4;break;case "gammaGreen":b=0;e=4;break;case "gammaBlue":b=0;e=4;break;case "hue":b=0;e=351;break;case "saturation":b=-100;e=100;break;case "lightness":b=-100;e=100;break;case "whiteBalance":b=0;e=4E4;break;case "noise":b=0,e=100}return new Z.Utils.RangeScale(b,e)};this.getImageFilterRangeMaxAbsolute=function(a){var b=100;switch(a){case "brightness":b=
300;break;case "contrast":b=150;break;case "sharpness":b=40;break;case "blurriness":b=30;break;case "colorRed":b=200;break;case "colorGreen":b=200;break;case "colorBlue":b=200;break;case "colorRedRange":b=255;break;case "colorGreenRange":b=255;break;case "colorBlueRange":b=255;break;case "colorRedRange2":b=255;break;case "colorGreenRange2":b=255;break;case "colorBlueRange2":b=255;break;case "gamma":b=4;break;case "gammaRed":b=4;break;case "gammaGreen":b=4;break;case "gammaBlue":b=4;break;case "hue":b=
359;break;case "saturation":b=200;break;case "lightness":b=200;break;case "whiteBalance":b=4E4;break;case "noise":b=100}return b};constrainImageFilter=function(a,b){if("undefined"!==typeof b&&Z.Utils.stringValidate(b)){var e=m.getImageFilterRange(a);b=b<e.min?e.min:b;b=b>e.max?e.max:b}return b};validateImageFiltersConvolve=function(){var a=-1!=Z.Utils.arrayIndexOfObjectValue(Xa,"filter","sharpness"),b=-1!=Z.Utils.arrayIndexOfObjectValue(Xa,"filter","blurriness"),e=-1!=Z.Utils.arrayIndexOfObjectValue(Xa,
"filter","edges");uh=a||b||e};this.applyImageFilter=function(a,b,e,f){"undefined"!==typeof mj&&"undefined"!==typeof Mh&&(null!==lj||null!==Mh?(window.clearTimeout(mj),mj=null,window.clearTimeout(Mh),Mh=null):lj=window.setTimeout(function(){lj=null;var g="sharpness"==a||"blurriness"==a||"edges"==a;Z.buttonIsDown&&!g?xl(a,b,f):("undefined"!==typeof af&&Z.Utils.arrayClear(af),Ih(wa,a,b,e,f),g&&Z.Utils.showMessage(Z.Utils.getResource("z11-CONVOLUTION"),!1,null,"center",!1,"2"),Mh=window.setTimeout(function(){Mh=
null;Ga&&Q?Ih(Ga,a,b,e,f):Ih(za,a,b,e,f);Z.Utils.hideMessage()},100))},100))};this.isCachedCanvasFilteringDefined=function(){return"undefined"!==typeof Gi};this.cacheCanvasImage=function(a,b,e){a?(b&&(kb.putImageData(Rj,0,0),a=kb.getImageData(0,0,wa.width,wa.height),e=ue(e,a,e),kb.putImageData(e,0,0)),Gi=kb.getImageData(0,0,wa.width,wa.height)):(ej=kb.getImageData(0,0,wa.width,wa.height),fj=Ga&&Q?Ib.getImageData(0,0,Ga.width,Ga.height):pe.getImageData(0,0,za.width,za.height),Rj=kb.getImageData(0,
0,wa.width,wa.height))};this.cacheTileImage=function(a,b){af[af.length]={filter:a,image:b}};this.clearTileCache=function(){Z.Utils.arrayClear(af)};this.updateAnnotationPanelForNewLabel=function(){var a=Ta[Ta.length-1];Da(a.poiID,a.value);Z.annotationsAddMultiple||(Z.editing="editLabel");lc("label","addLabel")};this.getSmoothPanGliding=function(){return nc};this.setSmoothPanGliding=function(a){nc=a};this.fullScreenEscapeHandler=function(a){Z.fullScreenEntering?Z.fullScreenEntering=!1:m.toggleFullViewMode(!1,
!0)};this.mouseWheelHandler=function(a,b){Z.mouseWheelIsDown=!0;Z.mouseWheelCompleteTimer&&window.clearTimeout(Z.mouseWheelCompleteTimer);Z.mouseWheelCompleteTimer=window.setTimeout(Z.Viewer.z586,Z.mouseWheelCompleteDuration);if(!("zoom"!=Z.sliderFocus||Z.imageSet&&b)){var e=m.z482(Sa,Ia*(1+(0<a?Hg:-Hg)));constrainedZ=Na(e);constrainedZ!=Z.imageZ&&(Z.zooming=0<a?"in":0>a?"out":"stop",m.scaleTierToZoom(constrainedZ))}else if("imageSet"==Z.sliderFocus||b)0<a?Z.Viewer.viewportNext():0>a&&Z.Viewer.viewportPrior()}};
Z.ZoomifyToolbar=function(a){function b(){parseFloat(Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDALPHA"));var a=Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDCOLOR"),b=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONUPCOLOR"),e=Z.viewerW/2-50,f=Z.viewerH-25-10,k=Math.round(25),l=Math.round(25/1.5),r=(100-3*k)/4,n=(25-l)/2;Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","visible","100px","25px",e+"px",f+"px","none","0px","transparent none","0px",
"0px","normal");jb=Z.ToolbarDisplay.style;e=Z.Utils.createContainerElement("div","buttonZoomOutInternal","inline-block","absolute","visible",k+"px",l+"px",r+1+"px",n+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(e,.6,a);e.setAttribute("title",Z.Utils.getResource("z400"));f=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONZOOMOUTTEXT"));e.appendChild(f);Z.ToolbarDisplay.appendChild(e);qa=e.style;qa.borderRadius="3px";Z.Utils.setTextNodeStyle(f,"black","verdana",
"15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(f);f=Z.Utils.createContainerElement("div","buttonResetInternal","inline-block","absolute","visible",k+"px",l+"px",2*r+k+1+"px",n+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(f,.6,a);f.setAttribute("title",Z.Utils.getResource("z378"));var u=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONRESETTEXT"));f.appendChild(u);Z.ToolbarDisplay.appendChild(f);Ab=f.style;
Ab.borderRadius="3px";Z.Utils.setTextNodeStyle(u,"blue","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(u);b=Z.Utils.createContainerElement("div","buttonZoomInInternal","inline-block","absolute","visible",k+"px",l+"px",3*r+2*k+1+"px",n+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(b,.6,a);b.setAttribute("title",Z.Utils.getResource("z399"));a=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONZOOMINTEXT"));
b.appendChild(a);Z.ToolbarDisplay.appendChild(b);bb=b.style;bb.borderRadius="3px";Z.Utils.setTextNodeStyle(a,"black","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(a);Z.Utils.addEventListener(e,"mouseover",R);Z.Utils.addEventListener(e,"mousedown",R);Z.Utils.addEventListener(e,"mouseup",R);Z.Utils.addEventListener(e,"mouseout",R);Z.Utils.addEventListener(e,"touchstart",R);Z.Utils.addEventListener(e,"touchend",R);Z.Utils.addEventListener(e,
"touchcancel",R);Z.Utils.addEventListener(f,"mouseover",R);Z.Utils.addEventListener(f,"mousedown",R);Z.Utils.addEventListener(f,"mouseup",R);Z.Utils.addEventListener(f,"mouseout",R);Z.Utils.addEventListener(f,"touchstart",R);Z.Utils.addEventListener(f,"touchend",R);Z.Utils.addEventListener(f,"touchcancel",R);Z.Utils.addEventListener(b,"mouseover",R);Z.Utils.addEventListener(b,"mousedown",R);Z.Utils.addEventListener(b,"mouseup",R);Z.Utils.addEventListener(b,"mouseout",R);Z.Utils.addEventListener(b,
"touchstart",R);Z.Utils.addEventListener(b,"touchend",R);Z.Utils.addEventListener(b,"touchcancel",R);jb.zIndex=(Z.baseZIndex+2).toString();Z.ViewerDisplay.appendChild(Z.ToolbarDisplay);Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation);g(!0)}function e(){Z.Gallery&&Z.Gallery.getInitialized()?Z.Gallery.setSizeAndPosition():window.setTimeout(e,100)}function f(){window.clearInterval(Qa);Qa=null;var a=document.getElementById("progressTextBoxCenteredDiv");a&&(a=a.firstChild)&&
(a.nodeValue="")}function g(a){!ca&&a&&(ca=!0,Z.Utils.validateCallback("toolbarInitialized"),Z.Viewer.validateViewerReady("toolbarInitialized"))}function k(a){4>Z.toolbarVisible&&!Z.mobileDevice||8==Z.toolbarVisible||Z.toolbarInternal?l(a):E(!a)}function l(a){jb&&(jb.display=a?"inline-block":"none")}function E(a){Z.ToolbarMinimized=a;if(jb){var b=document.getElementById("buttonContainer"),e=document.getElementById("toolbarBackground"),f=document.getElementById("buttonMinimize"),g=document.getElementById("buttonExpand"),
k=document.getElementById("logoDivider"),l=0;g&&!Yb&&(l=parseFloat(g.style.left)+parseFloat(g.style.width)+4);if(Z.imageFilters)var r=document.getElementById("imageFilterPanelBackground"),n=document.getElementById("buttonContainerImageFilter");var u=Z.toolbarCurrentW;a?(b&&(b.style.display="none"),f&&g&&!Yb&&(k&&(k.style.display="none"),f.style.display="none",g.style.display="inline-block"),jb.width=l+"px",e&&(e.style.width=l+"px"),r&&n&&(r.style.width="0px",n.style.display="none")):(b&&(b.style.display=
"inline-block"),f&&g&&!Yb&&(k&&(k.style.display="inline-block"),f.style.display="inline-block",g.style.display="none"),jb.width=u+"px",e&&(e.style.width=u+"px"),r&&n&&Qd&&(r.style.width=ld+"px",n.style.display="inline-block"))}}function n(a){if("undefined"!==typeof trszS&&"undefined"!==typeof btszS){a=(a-Z.minZ)/(Z.maxZ-Z.minZ);var b=parseFloat(trszS.left),e=parseFloat(trszS.left)+parseFloat(trszS.width)-parseFloat(btszS.width)-b;btszS.left=a*e+b+"px"}}function w(a){"undefined"!==typeof btsZ&&(la=
!0,a=Z.Utils.getMousePosition(a),btsZ.mouseXPrior=a.x,btsZ.mouseYPrior=a.y)}function G(){if("undefined"!==typeof trszS&&"undefined"!==typeof btsZ&&"undefined"!==typeof btszS){var b=parseFloat(trszS.left),e=parseFloat(trszS.left)+parseFloat(trszS.width)-parseFloat(btszS.width),f=parseFloat(btszS.left)+(Na.x-btsZ.mouseXPrior);f<b?f=b:f>e?f=e:btsZ.mouseXPrior=Na.x;btszS.left=f+"px";b=Z.minZ+(f-b)/(e-b)*(Z.maxZ-Z.minZ);e=b-a.getZoom();Z.zooming=0<e?"in":0>e?"out":"stop";a.scaleTierToZoom(b)}}function K(b,
e,f){if("undefined"===typeof f||null===f)f=e;if("sliderStart"!=f||!Nd)if(b=Z.Utils.event(b))switch(f){case "sliderSnap":J(e);if("undefined"!==typeof Za&&"undefined"!==typeof Pa){e=parseFloat(Pa.left);var g=parseFloat(Pa.left)+parseFloat(Pa.width)-parseFloat(Ba.width);f=Z.Utils.getElementPosition(Za);b=Z.Utils.getMousePosition(b).x-f.x-parseFloat(Ba.width)/2;f=oa(b,e,g);if(f!=a.getImageFilterValuePrior(X)){var k,l;(g=null!==Ba&&null!==Fb)?(k=parseFloat(Ba.left)-e,e=parseFloat(Fb.left)-e,k=Math.abs(k-
b),e=Math.abs(e-b),k<e?(e=f,k=a.getImageFilterValuePrior(X+"2"),b=Ba,l=X):(e=a.getImageFilterValuePrior(X),k=f,b=Fb,"2"!=X.substring(X.length-1)&&(l=X+"2"))):(e=f,b=Ba,l=X);F.syncImageFilterPanel(l,f,b);a.setImageFilterValuePrior(l,f);a.setImageFilter(l,e,k)}}break;case "sliderStart":Nd=!0;J(e);"hue"!=X&&"saturation"!=X&&"sharpness"!=X&&"blurriness"!=X||Z.Utils.showMessage("\n"+Z.Utils.stringUpperCaseFirstLetter(X)+Z.Utils.getResource("z11-CONVOLUTION-ONMOUSEUP"),!1,null,"center",!0,"2");"undefined"!==
typeof ab&&(Db=!0,k=Z.Utils.getMousePosition(b),ab.mouseXPrior=k.x,ab.mouseYPrior=k.y,a.isCachedCanvasFilteringDefined()?Zd&&a.cacheCanvasImage(!0,!0,X):a.cacheCanvasImage(!0,!1));break;case "sliderSlide":"undefined"!==typeof Pa&&"undefined"!==typeof ab&&"undefined"!==typeof Ba&&(e=parseFloat(Pa.left),g=parseFloat(Pa.left)+parseFloat(Pa.width)-parseFloat(Ba.width),l=parseFloat(Ba.left)+(ia.x-ab.mouseXPrior),l<e?l=e:l>g?l=g:ab.mouseXPrior=ia.x,b=oa(l-e,e,g),Ba.left=l+"px",(g=null!==Ba&&null!==Fb)?
((g="2"!=X.substring(X.length-1))?(e=b,k=a.getImageFilterValuePrior(X+"2")):(e=a.getImageFilterValuePrior(X.substring(0,X.length-1)),k=b),g?parseFloat(Fb.left)<=l&&(Fb.left=l+"px",l=X+"2",F.setImageFilterText(l,e),a.setImageFilterValuePrior(l,e)):parseFloat(Fb.left)>=l&&(Fb.left=l+"px",l=X.substring(0,X.length-1),F.setImageFilterText(l,k),a.setImageFilterValuePrior(l,k))):e=b,b!=a.getImageFilterValuePrior(X)&&(F.setImageFilterText(X,b),"hue"!=X&&"saturation"!=X&&"sharpness"!=X&&"blurriness"!=X&&a.applyImageFilter(X,
e,null,k),a.setImageFilterValuePrior(X,b)));break;case "sliderEnd":Nd=!1;"undefined"!==typeof Pa&&"undefined"!==typeof ab&&"undefined"!==typeof Ba&&(e=parseFloat(Pa.left),g=parseFloat(Pa.left)+parseFloat(Pa.width)-parseFloat(Ba.width),l=parseFloat(Ba.left)+(ia.x-ab.mouseXPrior),l<e?l=e:l>g?l=g:ab.mouseXPrior=ia.x,b=oa(l-e,e,g),Ba.left=l+"px",-1==X.indexOf("Range")?e=b:((g="2"!=X.substring(X.length-1))?(e=b,k=a.getImageFilterValuePrior(X+"2")):(e=a.getImageFilterValuePrior(X.substring(0,X.length-1)),
k=b),g?parseFloat(Fb.left)<=l&&(Fb.left=l+"px",l=X+"2",F.setImageFilterText(l,e),a.setImageFilterValuePrior(l,e)):parseFloat(Fb.left)>=l&&(Fb.left=l+"px",l=X.substring(0,X.length-1),F.setImageFilterText(l,k),a.setImageFilterValuePrior(l,k))),b!=a.getImageFilterValuePrior(X)||"sliderEnd"==f)&&(F.setImageFilterText(X,b),a.setImageFilter(X,e,k),validateImageFiltersConvolve(),a.applyImageFilter(X,e,null,k),a.setImageFilterValuePrior(X,b));Db=!1;break;case "imageFilterText":k=b.type;l=Z.Utils.target(b);
e=l.value;f=3;-1!=e.indexOf(".")&&(f+=1);-1!=e.indexOf("-")&&(f+=1);e.length>f&&(e=e.substring(0,f),l.value=e);e=Z.Utils.stringValidateNumberValue(e);e=constrainImageFilter(X,e);filterValueNum=parseFloat(e);if(isNaN(filterValueNum))break;l.value=e;if(null!==filterValueNum||"blur"==k)switch(k){case "focus":X=l.id.substring(0,l.id.indexOf("TextElement"));J(null,X);break;case "input":filterValueNum!=a.getImageFilterValuePrior(X)&&(F.setImageFilterSlider(X,filterValueNum),a.setImageFilter(X,filterValueNum),
a.setImageFilterValuePrior(X,filterValueNum));break;case "change":filterValueNum!=a.getImageFilterValuePrior(X)&&(F.setImageFilterSlider(X,filterValueNum),a.setImageFilter(X,filterValueNum),a.setImageFilterValuePrior(X,filterValueNum));break;case "blur":""==l.value&&(l.value=0)}break;case "checkbox":l=Z.Utils.target(b);pa();k=l.checked;l=e.substring(e.indexOf("Filter")+6,e.length).toLowerCase();e=null;k||(e=0);a.setImageFilter(l,e);break;case "buttonImageFilterPlus":J(null,X);a.imageFilterButtonsHandler(X,
"plus");break;case "buttonImageFilterMinus":J(null,X),a.imageFilterButtonsHandler(X,"minus")}}function W(a){K(a,null,"imageFilterText")}function J(a,b,e){var f=!1;"undefined"===typeof a||null===a?"undefined"!==typeof b&&Z.Utils.stringValidate(b)?(X=b,f=!0):"undefined"!==typeof X&&Z.Utils.stringValidate(X)||(X="brightness",f=!0):(b=17,-1!=a.indexOf("buttonSliderFilter")&&(b=18),a=a.substring(b,a.length),X=Z.Utils.stringLowerCaseFirstLetter(a),f=!0);f&&(Z.Toolbar.setFilterSliderReferences(X),e||(Zd=
X!=Od,Od=X))}function oa(b,e,f){var g=a.getImageFilterValuePrior(X);if(b!=lc){lc=b;b/=f-e;0>b&&(b=0);1<b&&(b=1);switch(X){case "brightness":b-=.5;break;case "contrast":b-=.3333;break;case "colorRed":b-=.5;break;case "colorGreen":b-=.5;break;case "colorBlue":b-=.5;break;case "saturation":b-=.5;break;case "lightness":b-=.5}g=a.getImageFilterRangeMaxAbsolute(X)*b;g=-1==X.indexOf("gamma")?Math.round(g):Math.round(10*g)/10}return g}function ga(a,b){ia=new Z.Utils.Point(a.clientX,a.clientY)}function ma(a,
b){var e=Z.Utils.getFirstTouch(a);e&&(ia=new Z.Utils.Point(e.pageX,e.pageY))}function fa(a){if("undefined"!==typeof trsisS&&"undefined"!==typeof btsisS){a=Z.viewportCurrentID/(Z.imageSetLength-1);var b=parseFloat(trsisS.left),e=parseFloat(trsisS.left)+parseFloat(trsisS.width)-parseFloat(btsisS.width)-b;btsisS.left=a*e+b+"px"}}function v(a){btsiS&&(ib=!0,a=Z.Utils.getMousePosition(a),btsiS.mouseXPrior=a.x,btsiS.mouseYPrior=a.y)}function C(){if(trsiS&&btsiS&&btsiS){var a=parseFloat(trsisS.left),b=parseFloat(trsisS.left)+
parseFloat(trsisS.width)-parseFloat(btsisS.width),e=parseFloat(btsisS.left)+(B.x-btsiS.mouseXPrior);e<a?e=a:e>b?e=b:btsiS.mouseXPrior=B.x;btsisS.left=e+"px";a=Math.round((e-a)/(b-a)*(Z.imageSetLength-1));a!=Z.viewportCurrentID&&Z.Viewer.viewportSelect(a,!0)}}function u(a){B=new Z.Utils.Point(a.clientX,a.clientY)}function D(a){(a=Z.Utils.getFirstTouch(a))&&(B=new Z.Utils.Point(a.pageX,a.pageY))}function R(b){if(b=Z.Utils.event(b)){var e=b.type,f=Z.Utils.target(b);if(f){qa.background=Ra;Ab.background=
Ra;bb.background=Ra;var g=f.id;b=b.altKey;if("mousedown"==e||"touchstart"==e)e="start";if("mouseup"==e||"touchend"==e||"touchcancel"==e)e="end";switch(e){case "mouseover":f.style.background=Ua;break;case "start":f.style.background=ya;"buttonZoomInInternal"==g?b||a.zoom("in"):"buttonZoomOutInternal"==g&&(b||a.zoom("out"));break;case "end":f.style.background=Ua,a.zoom("stop"),"buttonResetInternal"==g&&a.reset(b)}}}}function N(b){if(b=Z.Utils.event(b)){var e=b.type,f=Z.Utils.target(b);if(f){var g=f.parentNode;
if(g){var k=g;tbID=g.id}}f=Z.Utils.relatedTarget(b)}"mousedown"==e&&a&&"buttonMinimize"!=tbID&&"buttonExpand"!=tbID&&"buttonAudioOn"!=tbID&&"buttonAudioMuted"!=tbID&&(a.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask());if((Z.interactive||"mousedown"!=e&&"mouseup"!=e||"buttonRotateClockwise"==tbID||"buttonRotateCounterwise"==tbID)&&(!f||"[object HTMLSelectElement]"!=f&&"[object HTMLOptionElement]"!=f)&&!Z.Utils.isRightMouseButton(b)){Z.touchSupport&&b.preventDefault();
if(tbID&&-1!=tbID.indexOf("viewportContainer")||la||Db||ib)la?g=document.getElementById("buttonSliderZoom"):ib&&(g=document.getElementById("buttonSliderImageSet")),g&&(tbID=g.id);La(g,e);if(tbID&&"buttonBackground"!=tbID&&e)switch(e){case "click":e=-1!=tbID.toLowerCase().indexOf("checkbox");a&&e&&ja(b,tbID);break;case "mouseover":if("trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID)if(Z.Utils.removeEventListener(g.childNodes[0],"mouseover",N),Z.Utils.addEventListener(g.childNodes[1],"mousedown",
N),Z.Utils.addEventListener(g.childNodes[1],"mouseout",N),la&&k&&Z.Utils.addEventListener(k.childNodes[0],"mouseup",N),ib&&k&&Z.Utils.addEventListener(k.childNodes[0],"mouseup",N),"buttonZoomIn"==tbID||"buttonSliderZoom"==tbID||"buttonZoomOut"==tbID)Z.sliderFocus="zoom";else{if("buttonImageSetPrior"==tbID||"buttonSliderImageSet"==tbID||"buttonImageSetNext"==tbID)Z.sliderFocus="imageSet"}else Z.Utils.addEventListener(g.childNodes[0],"mouseout",N),Z.sliderFocus="trackSliderImageSet"==tbID?"imageSet":
"zoom";break;case "mousedown":Z.buttonIsDown=!0;!Z.fullView&&document.activeElement&&document.activeElement.blur();"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID&&-1==tbID.indexOf("trackSliderFilter")?(Z.Utils.removeEventListener(g.childNodes[1],"mousedown",N),Z.Utils.removeEventListener(g.childNodes[1],"mouseout",N),Z.Utils.addEventListener(g.childNodes[2],"mouseup",N),Z.Utils.addEventListener(g.childNodes[2],"mouseout",N),"buttonSliderZoom"==tbID?(w(b),S(b),Z.Utils.addEventListener(document,
"mousemove",S),Fa||(Fa=window.setInterval(G,Aa)),Z.Utils.addEventListener(document,"mouseup",N)):-1!=tbID.indexOf("buttonSliderFilter")?(K(b,tbID,"sliderStart"),ga(b,tbID),Z.Utils.addEventListener(document,"mousemove",ga),$a||($a=window.setInterval(function(){K(b,tbID,"sliderSlide")},wb)),Z.Utils.addEventListener(document,"mouseup",N)):"buttonSliderImageSet"==tbID&&(v(b),u(b),Z.Utils.addEventListener(document,"mousemove",u),gb||(gb=window.setInterval(C,bc)),Z.Utils.addEventListener(document,"mouseup",
N))):Z.Utils.addEventListener(document,"mouseup",N);a&&ja(b,tbID);break;case "mouseup":Z.buttonIsDown=!1;"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID&&-1==tbID.indexOf("trackSliderFilter")?(Z.Utils.removeEventListener(g.childNodes[2],"mouseup",N),Z.Utils.removeEventListener(g.childNodes[2],"mouseout",N),Z.Utils.addEventListener(g.childNodes[1],"mousedown",N),Z.Utils.addEventListener(g.childNodes[1],"mouseout",N),k&&(la||Db||ib)&&Z.Utils.removeEventListener(k.childNodes[0],"mouseup",N)):Z.Utils.addEventListener(document,
"mouseup",N);a&&ja(b,tbID);break;case "mouseout":if("trackSliderZoom"!=tbID&&-1==tbID.indexOf("trackSliderFilter")&&"trackSliderImageSet"!=tbID){if(Z.Utils.removeEventListener(g.childNodes[1],"mousedown",N),Z.Utils.removeEventListener(g.childNodes[1],"mouseout",N),Z.Utils.addEventListener(g.childNodes[0],"mouseover",N),a&&ja(b,tbID),"buttonImageSetPrior"==tbID||"buttonSliderImageSet"==tbID||"trackSliderImageSet"==tbID||"buttonImageSetNext"==tbID||"buttonZoomIn"==tbID||"buttonSliderZoom"==tbID||"buttonZoomOut"==
tbID)Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom"}else Z.Utils.removeEventListener(g.childNodes[0],"mouseout",N),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom";break;case "touchstart":"buttonSliderZoom"==tbID?(w(b),xa(b),Z.Utils.addEventListener(document,"touchmove",xa),Fa||(Fa=window.setInterval(G,Aa))):-1!=tbID.indexOf("buttonSliderFilter")?(K(b,tbID,"sliderStart"),ma(b,tbID),Z.Utils.addEventListener(document,"touchmove",ma),$a||($a=window.setInterval(function(){K(b,tbID,"sliderSlide")},wb))):
"buttonSliderImageSet"==tbID&&(v(b),D(b),Z.Utils.addEventListener(document,"touchmove",D),gb||(gb=window.setInterval(C,bc)));Z.Utils.addEventListener(g,"touchend",N);Z.Utils.addEventListener(g,"touchcancel",N);a&&ja(b,tbID);break;case "touchend":Z.Utils.addEventListener(g,"touchstart",N);a&&ja(b,tbID);break;case "touchcancel":Z.Utils.addEventListener(g,"touchstart",N);a&&ja(b,tbID);break;case "MSPointerDown":"buttonSliderZoom"==tbID?(w(b),xa(b),Z.Utils.addEventListener(document,"MSPointerMove",xa),
Fa||(Fa=window.setInterval(G,Aa))):-1!=tbID.indexOf("SliderFilter")?(K(b,tbID,"sliderStart"),ma(b,tbID),Z.Utils.addEventListener(document,"MSPointerMove",ma),$a||($a=window.setInterval(function(){K(b,tbID,"sliderSlide")},wb))):"buttonSliderImageSet"==tbID&&(v(b),D(b),Z.Utils.addEventListener(document,"MSPointerMove",D),gb||(gb=window.setInterval(C,bc)));Z.Utils.addEventListener(g,"MSPointerUp",N);a&&ja(b,tbID);break;case "MSPointerUp":Z.Utils.addEventListener(g,"MSPointerDown",N),a&&ja(b,tbID)}}}
function ja(b,e){var f=b.type,g=Z.annotationFileShared?"0":V,k=b.altKey;if("click"==f)Z.comparison&&-1!=e.indexOf("Sync")?(f=Z.Utils.target(b),Z.syncComparison=f.checked,Z.Viewer.syncComparisonViewport(!0)):Z.tracking&&-1!=e.indexOf("Count")?a.trackingEventsManager(b,e):Z.userLogging&&-1!=e.indexOf("User")?a.trackingEventsManager(b,e):Z.imageFilters&&-1!=e.indexOf("Filter")&&K(b,e,"checkbox");else if("mousedown"==f||"touchstart"==f)switch(pa(),F.positionButtonBorder(e),Z.tracking&&-1!=e.indexOf("buttonCounterListShow")&&
(e="buttonCounterListShow"),e){case "buttonMinimize":k?a.setHotspotsVisibility(!a.getHotspotsVisibility()):(F.minimize(!0),Z.Navigator&&(Z.Navigator.setVisibility(!1),Z.comparison&&Z.Navigator2.setVisibility(!1)),Z.Ruler&&Z.Ruler.setVisibility(!1),Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!1),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!1),
2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!1),Z.Gallery&&Z.Gallery.setVisibility(!1),Z.viewportCurrent&&0<Z.magnifierVisible&&Z.viewportCurrent.setVisibilityMagnifier(!1));break;case "buttonExpand":k?a.setHotspotsVisibility(!a.getHotspotsVisibility()):(F.minimize(!1),Z.Navigator&&(Z.Navigator.setVisibility(!0),Z.comparison&&Z.Navigator2.setVisibility(!0)),Z.Ruler&&Z.Ruler.setVisibility(!0),!Z.viewportCurrent||Z.narrative&&!Z.narrativeMode||Z.viewportCurrent.showLists(!0),
!Z.annotations||2!=Z.annotationPanelVisible&&3!=Z.annotationPanelVisible||Z.Toolbar.setVisibilityAnnotationPanel(!0),!Z.tracking||2!=Z.trackingPanelVisible&&3!=Z.trackingPanelVisible||Z.Toolbar.setVisibilityTrackingPanel(!0),2!=Z.userPanelVisible&&3!=Z.userPanelVisible||Z.Toolbar.setVisibilityUserPanel(!0),Z.Gallery&&Z.Gallery.setVisibility(!0),Z.viewportCurrent&&1<Z.magnifierVisible&&Z.viewportCurrent.setVisibilityMagnifier(!0));break;case "buttonZoomOut":k||a.zoom("out");break;case "buttonZoomIn":k||
a.zoom("in");break;case "buttonPanLeft":a.pan("left");break;case "buttonPanUp":a.pan("up");break;case "buttonPanDown":a.pan("down");break;case "buttonPanRight":a.pan("right");break;case "buttonReset":a.reset(k);break;case "buttonFullView":break;case "buttonFullViewExit":break;case "buttonMeasure":a.toggleEditModeMeasure(!0);break;case "buttonMeasureExit":a.toggleEditModeMeasure(!1);break;case "buttonHelp":Z.annotations&&null===Z.editMode?Z.Utils.showHelp(Z.Utils.getResource("z32")+Z.Utils.getResource("z30")+
Z.Utils.getResource("z29")):Z.Utils.showHelp(Z.Utils.getResource("z32"));break;case "buttonHelpMarkup"+g:Z.Utils.showHelp(Z.Utils.getResource("z31"));break;case "buttonHelpAnnotation"+g:Z.Utils.showHelp(Z.Utils.getResource("z28"));break;case "buttonRotateClockwise":a.rotate("clockwise",k);break;case "buttonRotateCounterwise":a.rotate("counterwise",k);break;case "buttonTourPrior":a.priorDestination(!0);break;case "buttonTourNext":a.nextDestination(!0);break;case "buttonTourStart":a.tourStart();break;
case "buttonTourStop":a.tourStop();break;case "buttonSlideshowPrior":a.priorSlide(!0);break;case "buttonSlideshowNext":a.nextSlide(!0);break;case "buttonSlideshowStart":a.slideshowStart();break;case "buttonSlideshowStop":a.slideshowStop();break;case "buttonAudioOn":a.audioMute(!0);break;case "buttonAudioMuted":a.audioMute(!1);break;case "buttonImageSetPrior":Z.animation&&Z.Viewer.viewportChange("backward");break;case "buttonImageSetNext":Z.animation&&Z.Viewer.viewportChange("forward");break;case "buttonPreload":Z.imageSet?
Z.Viewer.prez581s():Z.Viewport.prez581s();break;case "buttonPOIGo"+g:a.goToPOICurrent();break;case "buttonPOIAdd"+g:a.addNewPOI();break;case "buttonPOIEdit"+g:a.editCurrentPOI();break;case "buttonPOIDelete"+g:a.deleteCurrentPOI();break;case "buttonPOICancel"+g:a.cancelEditsPOI();break;case "buttonPOISave"+g:a.saveEditsPOI();break;case "buttonLabelGo"+g:a.goToLabelCurrent();break;case "buttonLabelAdd"+g:a.addNewLabel();break;case "buttonLabelEdit"+g:a.editCurrentLabel();break;case "buttonLabelDelete"+
g:a.deleteCurrentLabel();break;case "buttonLabelCancel"+g:a.cancelEditsLabel();break;case "buttonLabelSave"+g:a.saveEditsLabel(!1,!0,!0);break;case "buttonNoteAdd"+g:a.addNewNote();break;case "buttonNoteEdit"+g:a.editCurrentNote();break;case "buttonNoteDelete"+g:a.deleteCurrentNote();break;case "buttonNoteCancel"+g:a.cancelEditsNote();break;case "buttonNoteSave"+g:a.saveEditsNote();break;case "buttonClearAll"+g:a.deleteAllAnnotations();break;case "buttonViewMode"+g:a.setEditModeLabel("view");break;
case "buttonEditModeFieldOfView"+g:a.setEditModeLabel("fieldofview",null,null,null,null,!0);break;case "buttonEditModeText"+g:a.setEditModeLabel("text",null,null,null,null,!0);break;case "buttonEditModeShape"+g:(f=a.getLabelShapePickerVisibility())||a.setEditModeLabel("shape",!0,null,null,null,!0);a.toggleLabelShapePicker(!f);a.toggleLabelLineStylePicker(!1);a.toggleLabelColorPicker(!1);break;case "buttonEditModeFreehand"+g:a.setEditModeLabel("freehand",null,null,null,null,!0);break;case "buttonEditModePolygon"+
g:a.setEditModeLabel("polygon",null,null,null,null,!0);break;case "buttonEditModeMeasure"+g:a.setEditModeLabel("measure",null,null,null,null,!0);break;case "buttonEditLineStyle"+g:a.toggleLabelShapePicker(!1);a.toggleLabelLineStylePicker();a.toggleLabelColorPicker(!1);break;case "buttonEditColorPicker"+g:a.toggleLabelShapePicker(!1);a.toggleLabelLineStylePicker(!1);a.toggleLabelColorPicker();break;case "buttonNarrativeBold":Z.Narrative.setSelectedTextFormat("bold");break;case "buttonNarrativeItalic":Z.Narrative.setSelectedTextFormat("italic");
break;case "buttonNarrativeUnderline":Z.Narrative.setSelectedTextFormat("underline");break;case "buttonNarrativeScaleDown":Z.Narrative.setSelectedTextFontSize("down");break;case "buttonNarrativeScaleUp":Z.Narrative.setSelectedTextFontSize("up");break;case "buttonNarrativeAlignLeft":Z.Narrative.setCurrentParagraphAlignment("left");break;case "buttonNarrativeAlignCenter":Z.Narrative.setCurrentParagraphAlignment("center");break;case "buttonNarrativeAlignRight":Z.Narrative.setCurrentParagraphAlignment("right");
break;case "buttonNarrativeAlignJustify":Z.Narrative.setCurrentParagraphAlignment("justify");break;case "buttonNarrativeSetInitialImage":Z.Narrative.setNarrativeDefaultImage();break;case "buttonNarrativeSetInitialLabels":Z.Narrative.setNarrativeDefaultAnnotations();break;case "buttonNarrativeLinkClear":Z.Utils.htmlClearLinkFromSelection();break;case "buttonNarrativeCancel":Z.Narrative.cancelNarrative();break;case "buttonNarrativeSave":Z.Narrative.saveNarrative();break;case "buttonHelpNarrative":null===
Z.narrativeMode?Z.Utils.getResource("CONTENT_HELPNARRATIVEVIEW"):Z.Utils.getResource("CONTENT_HELPNARRATIVEEDIT");Z.Utils.showHelp(Z.narrativeHelpContent);break;case "buttonFileManagerUpload":Z.Narrative.selectUploadFiles();break;case "buttonFileManagerDownload":Z.Narrative.showDownloadPanel(!0);break;case "buttonFileManagerNew":Z.Narrative.createFile();break;case "buttonFileManagerDelete":Z.Narrative.deleteFilePrep();break;case "buttonDownloadPanelClose":Z.Narrative.showDownloadPanel(!1);break;case "buttonCounterListShow":a.trackingEventsManager(b,
e);break;case "buttonCounterListHide"+g:a.trackingEventsManager(b,e);break;case "buttonToggleTrackingNav"+g:a.trackingEventsManager(b,e);break;case "buttonTrackingClearLast"+g:a.trackingEventsManager(b,e);break;case "buttonTrackingClearType"+g:a.trackingEventsManager(b,e);break;case "buttonTrackingClearAll"+g:a.trackingEventsManager(b,e);break;case "buttonTrackingSave"+g:a.trackingEventsManager(b,e);break;default:"buttonColor"==e.substr(0,11)&&a.setDrawingColor(e)}else"mouseup"==f||"touchend"==f||
"touchcancel"==f?"buttonSliderZoom"==e||la?(Fa&&(window.clearInterval(Fa),Fa=null),da(),la=!1,Z.zooming="stop",a.updateView()):"trackSliderZoom"==e?"undefined"!==typeof trsZ&&"undefined"!==typeof trszS&&(f=Z.Utils.getElementPosition(trsZ),f=Z.Utils.getMousePosition(b).x-f.x,g=parseFloat(trszS.width),f=Z.minZ+(f-0)/(g-0)*(Z.maxZ-Z.minZ),f<Z.minZ+.1&&(f=Z.minZ),f>Z.maxZ-.1&&(f=Z.maxZ),g=f-a.getZoom(),Z.zooming=0<g?"in":0>g?"out":"stop",a.scaleTierToZoom(f),Z.zooming="stop",a.updateView()):-1!=e.indexOf("buttonSliderFilter")||
Db?($a&&(window.clearInterval($a),$a=null),da(),K(b,e,"sliderEnd")):-1!=e.indexOf("trackSliderFilter")?K(b,e,"sliderSnap"):"buttonImageFilterPlus"==e||"buttonImageFilterMinus"==e?K(b,e):"buttonSliderImageSet"==e||ib?(gb&&(window.clearInterval(gb),gb=null),da(),ib=!1,Z.Viewer.viewportSelect(Z.viewportCurrentID,!0)):"buttonZoomOut"==e||"buttonZoomIn"==e?(a.zoom("stop"),"buttonZoomOut"==e&&k&&a.toggleSmoothZoom(),"buttonZoomIn"==e&&k&&a.toggleEditMode()):"buttonPanLeft"==e||"buttonPanRight"==e?(Z.tracking?
"buttonPanLeft"==e?Z.viewportCurrent.goToNextCell("left"):Z.viewportCurrent.goToNextCell("right"):a.pan("horizontalStop"),"buttonPanLeft"==e&&k&&a.toggleSmoothPan()):"buttonPanUp"==e||"buttonPanDown"==e?Z.tracking?"buttonPanUp"==e?Z.viewportCurrent.goToNextCell("up"):Z.viewportCurrent.goToNextCell("down"):a.pan("verticalStop"):"buttonHelp"==e?0==Z.debug&&k&&Z.Utils.showGlobals():"buttonRotateClockwise"==e||"buttonRotateCounterwise"==e?Z.rotationFree&&a.rotate("stop"):"buttonFullView"==e?a.toggleFullViewMode(!0):
"buttonFullViewExit"==e?a.toggleFullViewMode(!1):"buttonRulerSettingsShow"==e?Z.Ruler.showRulerSettings(!0):"buttonRulerSettingsCancel"==e?Z.Ruler.showRulerSettings(!1):"buttonRulerSettingsSave"==e?Z.Ruler.showRulerSettings(!1,!0):"buttonNarrativePreview"==e?Z.Narrative.toggleNarrativeMode(!1):"buttonNarrativeEdit"==e?Z.Narrative.toggleNarrativeMode(!0):"buttonNarrativeToolsShow"==e?Z.Narrative.showFileManagerPanel(!1):"buttonFileManagerShow"==e?Z.Narrative.showFileManagerPanel(!0):"trackSliderImageSet"==
e?Z.slidestack&&trsiS&&trsisS&&(f=Z.Utils.getElementPosition(trsiS),f=Z.Utils.getMousePosition(b).x-f.x,g=parseFloat(trsisS.width),f=Math.round((f-0)/(g-0)*(Z.imageSetLength-1)),0>f&&(f=0),f>Z.imageSetLength-1&&(f=Z.imageSetLength-1),f!=Z.viewportCurrentID&&Z.Viewer.viewportSelect(f,!0),fa(f)):"buttonImageSetPrior"==e||"buttonImageSetNext"==e?Z.animation?Z.Viewer.viewportChange("stop"):Z.slidestack&&("buttonImageSetPrior"==e?Z.Viewer.viewportChange("backward"):"buttonImageSetNext"==e&&Z.Viewer.viewportChange("forward")):
"buttonImageFilterClear"==e?a.clearImageFilterLast():"buttonImageFiltersClearAll"==e?a.clearImageFiltersAll():"buttonImageFilterPanelShow"==e?F.showImageFilterPanel(!0):"buttonImageFilterPanelHide"==e?F.showImageFilterPanel(!1):"buttonImageFilterPanelHideOnPanel"==e&&F.showImageFilterPanel(!1):"mouseout"==f&&("buttonZoomOut"==e||"buttonZoomIn"==e?a.zoom("stop"):"buttonPanLeft"==e||"buttonPanRight"==e?a.pan("horizontalStop"):"buttonPanUp"==e||"buttonPanDown"==e?a.pan("verticalStop"):"buttonRotateClockwise"==
e||"buttonRotateCounterwise"==e?Z.rotationFree&&a.rotate("stop"):"buttonImageSetPrior"!=e&&"buttonImageSetNext"!=e||Z.Viewer.viewportChange("stop"))}function da(){la?(Z.Utils.removeEventListener(document,"mousemove",S),Z.Utils.removeEventListener(document,"mouseup",N),Z.Utils.removeEventListener(document,"touchmove",xa)):Db?(Z.Utils.removeEventListener(document,"mousemove",ga),Z.Utils.removeEventListener(document,"mouseup",N),Z.Utils.removeEventListener(document,"touchmove",ma)):ib&&(Z.Utils.removeEventListener(document,
"mousemove",u),Z.Utils.removeEventListener(document,"mouseup",N),Z.Utils.removeEventListener(document,"touchmove",D));for(var a=Z.ToolbarDisplay.childNodes,b=0,e=a.length;b<e;b++){var f=a[b],g=f.id;if(g&&-1!=g.indexOf("button"))if("buttonContainer"!=g&&"buttonContainerImageFilter"!=g)Z.Utils.setButtonDefaults(f);else for(var f=f.childNodes,g=0,k=f.length;g<k;g++){var l=f[g],r=l.id;r&&-1!=r.indexOf("button")&&Z.Utils.setButtonDefaults(l)}}}function S(a){Na=new Z.Utils.Point(a.clientX,a.clientY)}function xa(a){(a=
Z.Utils.getFirstTouch(a))&&(Na=new Z.Utils.Point(a.pageX,a.pageY))}function La(a,b){if(-1!=a.id.indexOf("button")&&-1==a.id.indexOf("buttonContainer")){var e=a.firstChild,f=a.childNodes[1],g=a.childNodes[2];if(e&&f&&g)if(e=e.style,f=f.style,g=g.style,e.visibility=f.visibility=g.visibility="hidden","mouseover"==b&&"buttonSliderZoom"==a.id&&la)g.visibility="visible";else if("mouseover"==b&&-1!=a.id.indexOf("buttonSliderFilter")&&Db)g.visibility="visible";else if("mouseover"==b&&"buttonSliderImageSet"==
a.id&&ib)g.visibility="visible";else if("mouseover"==b||"mouseup"==b)f.visibility="visible";else if("mousedown"==b||"mousemove"==b||"touchstart"==b||"MSPointerDown"==b)g.visibility="visible";else if("mouseout"==b||"touchend"==b||"touchcancel"==b||"MSPointerUp"==b)e.visibility="visible"}}function pa(){var a=document.activeElement.id;!Z.Utils.stringValidate(a)||a!="poiNameTextElement"+V&&a!="labelNameTextElement"+V&&"captionTextElement"!=a&&"commentTextElement"!=a&&"tooltipTextElement"!=a&&"clickURLTextElement"!=
a&&a!="noteNameTextElement"+V&&a!="noteTextElement"+V||document.getElementById(a).blur()}function Ha(a){if(a=Z.Utils.event(a))Z.Utils.target(a).selectedIndex=0}var F=this,ca=!1,V=a?a.getViewportID().toString():"0";if(Z.toolbarInternal){var bb,Ab,qa,Ua=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONOVERCOLOR"),ya=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONDOWNCOLOR"),Ra=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONUPCOLOR");b()}else{Z.skinPath=Z.Utils.stringRemoveTrailingSlash(Z.skinPath);(new Z.NetConnector).loadXML(Z.skinPath+
"/"+Z.Utils.getResource("z200"),null,"loadingSkinXML");var Va,jb,Lb=[],P=[],ta=[],Aa=parseInt(Z.Utils.getResource("z205ZOOM"),10),la=!1,Fa=null,Na=null,Qa=null,xb=null,Qb,bd,Yb,Zc,kc;if(Z.imageSet)var bc=parseInt(Z.Utils.getResource("z205IMAGESET"),10),ib=!1,gb=null,B=null,fb;if(Z.imageFilters)var wb=parseInt(Z.Utils.getResource("z205FILTER"),10),Db=!1,$a=null,ia=null,ld,sd=[],Qd=Z.initialImageFilters,Nd=!1,X=null,Od=null,Zd=!1,Sd,$d,ve,Eb,we,vc,ae,yb,ub,de,Ec,Sc,Rc,Fc,Tc,Bd,Gc,Ic,qe,Gb,gc,Td,Cd,
nb,Ud,ze,Ae,ee,ec,Vd,Uc,wc,sc,cd,xc,tf,ce,uf,vf,sg,dc,Hc,ye,tg,wf,Uf,Vf,xe,be,df,Ne,xf,r,O,Da,pb,Rb,ud,Jd,Jc,Id,Wd,Dd,ge,Md,Vg,Wg,Be,vg,fe,yg,Wf,Me,cf,zg,Oe,Ce,Tb,ff,De,Za,Pa,ab,Ba,Fb,lc=0}this.gallerySizeAndPositionReset=function(){e()};this.getInitialized=function(){return ca};this.getSkinArray=function(){return Lb};this.getSkinSizes=function(){return ta};this.show=function(a){k(a)};this.setVisibility=function(a){l(a)};this.minimize=function(a){E(a)};this.setVisibilityAnnotationPanel=function(b,
e){var f=e;if("undefined"===typeof f||null===f)f=Z.annotationFileShared?"0":a.getViewportID().toString();if(f=document.getElementById("AnnotationPanelDisplay"+f))!b||Z.measureVisible&&null===Z.editMode&&1!=Z.annotationPanelVisible&&2!=Z.annotationPanelVisible&&!Z.narrative?(f.style.display="none",Z.annotationPanelVisibleState=!1):(f.style.display="inline-block",Z.annotationPanelVisibleState=!0)};this.toggleAnnotationPanelMode=function(b){a.clearAnnotationPanel(V);a.setStatus("annotationPanelInitializedViewport",
!1);a.createAnnotationPanel(V)};this.setVisibilityTrackingPanel=function(b,e){var f=e;if("undefined"===typeof f||null===f)f=Z.trackingFileShared?"0":a.getViewportID().toString();if(f=document.getElementById("TrackingPanelDisplay"+f))b?(f.style.display="inline-block",Z.trackingPanelVisibleState=!0):(f.style.display="none",Z.trackingPanelVisibleState=!1)};this.setVisibilityUserPanel=function(a){var b=document.getElementById("userPanelDisplay");b&&(a?(b.style.display="inline-block",Z.userPanelVisibleState=
!0):(b.style.display="none",Z.userPanelVisibleState=!1))};this.showProgress=function(){var a=document.getElementById("progressTextBox");a&&(a=a.style)&&(a.display="inline-block")};this.hideProgress=function(){var a=document.getElementById("progressTextBox");a&&(a=a.style)&&(a.display="none")};this.updateProgress=function(a,b){if(Z.progressVisible){Qa&&window.clearInterval(Qa);var e,g=document.getElementById("progressTextBoxCenteredDiv");g&&(g=g.firstChild)&&(0==a||0==b?(g.nodeValue="llllllllll",Qa=
window.setInterval(f,parseInt(Z.Utils.getResource("z182")),10)):(e=Math.round(100-b/a*100),e=Math.round(e/10),g.nodeValue=Z.Utils.stringMultiply("l",e)))}};this.setViewport=function(b){a=b;V=a.getViewportID().toString()};this.parseSkinXML=function(b){Z.skinMode=Z.narrative?Z.skinMode="2":b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("SKINMODE").nodeValue;var f,l;1==Z.skinMode||0==Z.skinMode&&!Z.mobileDevice?(f=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERSTANDARD").nodeValue,
l="SIZESSTANDARD"):(f=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERLARGE").nodeValue,l="SIZESLARGE");var r=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("PROGRESSCOLOR");"undefined"!==typeof r&&null!==r&&(xb=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("PROGRESSCOLOR").nodeValue);var u=[];u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("TOOLBARW").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("TOOLBARH").nodeValue);
u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("LOGOW").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("LOGOH").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("DIVIDERW").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("DIVIDERH").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("BUTTONW").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("BUTTONH").nodeValue);
u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("BUTTONSPAN").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("SLIDERBUTTONW").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("SLIDERBUTTONH").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("SLIDERTRACKW").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("SLIDERTRACKH").nodeValue);
u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("SLIDERSPAN").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("PROGRESSW").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("PROGRESSH").nodeValue);u[u.length]=parseFloat(b.getElementsByTagName(l)[0].attributes.getNamedItem("PROGRESSFONTSIZE").nodeValue);var v,O,B,D,C;v=Z.imageFilters?216:"edit"==Z.trackingEditMode?200:Z.tracking?188:Z.narrativeMode?
182:"edit"==Z.editMode?141:"markup"==Z.editMode?132:Z.screensaver||Z.preloadVisible||Z.tourPath||Z.slidePath||Z.imageSetPath?77:Z.rotationVisible?58:Z.measureVisible?51:0<Z.helpVisible?45:Z.fullScreenVisible||Z.fullPageVisible?45:Z.resetVisible?35:Z.panButtonsVisible?32:Z.sliderZoomVisible?19:Z.minimizeVisible?14:Z.logoVisible?8:6;O=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN0");null!==O&&(B=O.nodeValue);D=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+v.toString());
null!==D&&(C=D.nodeValue);if("undefined"!==typeof B&&Z.Utils.stringValidate(B)&&"undefined"!==typeof C&&Z.Utils.stringValidate(C)){for(var Da=!1,w=0,E=v+1;w<E;w++){var gb=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+w).nodeValue;Z.Utils.stringValidate(gb)?P[w]=f+"/"+gb:(P[w]="null",Da=!0)}Da&&Z.Utils.showMessage(Z.Utils.getResource("z279"));var I=P;Lb=I;Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","visible","1px","1px","0px",
"1px","none","0px","transparent","0px","0px","normal");jb=Z.ToolbarDisplay.style;jb.textAlign="left";jb.zIndex=(Z.baseZIndex+3).toString();var pb=new Z.Utils.Graphic("toolbarBackground",Z.skinPath,I[0],"1px","1px","0px","0px");parseFloat(Z.Utils.getResource("z82"));var R=Z.Utils.getResource("z83NOALPHA");Z.ToolbarDisplay.appendChild(pb.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(pb.elmt,0,R);ta=u;if(Z.logoVisible){var fb;if(Z.Utils.stringValidate(Z.logoCustomPath)){var Aa=Z.Utils.cacheProofPath(Z.logoCustomPath);
fb=new Z.Utils.Graphic("toolbarLogo",Aa,null,"1px","1px","1px","1px")}else fb=new Z.Utils.Graphic("toolbarLogo",Z.skinPath,I[7],"1px","1px","1px","1px");var G=Z.Utils.getResource("z427ZOOMIFY"),M=Z.Utils.getResource("z360ZOOMIFY");Z.expressParamsEnabled&&null!==Z.logoLinkURL&&("none"==Z.logoLinkURL?M=G=null:(G=Z.logoLinkURL,-1==Z.logoLinkURL.toLowerCase().indexOf("zoomify")&&(M=Z.Utils.getResource("z360GENERIC"))));if(null!==G&&null!==M){var S=document.createElement("a");S.setAttribute("title",M);
S.setAttribute("href",G);S.setAttribute("target",Z.Utils.getResource("z427TARGET"));S.setAttribute("outline","none");S.appendChild(fb.elmt);Z.ToolbarDisplay.appendChild(S)}else Z.ToolbarDisplay.appendChild(fb.elmt);if(0==Z.toolbarVisible||1==Z.toolbarVisible){var Qb=new Z.Utils.Graphic("logoDivider",Z.skinPath,I[8],"1px","1px","1px","1px");Z.ToolbarDisplay.appendChild(Qb.elmt)}}var J=Z.Utils.createContainerElement("div","buttonContainer","inline-block","absolute","visible","1px","1px","0px","0px",
"none","0px","transparent","0px","0px","normal","default");Z.ToolbarDisplay.appendChild(J);Z.Utils.addEventListener(J,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(J,"mouseover",F.backgroundEventsHandler);Z.Utils.addEventListener(J,"touchstart",Z.Utils.preventDefault);var K=new Z.Utils.Graphic("buttonBackground",Z.skinPath,I[0],"1px","1px","0px","0px");J.appendChild(K.elmt);Z.Utils.setOpacity(K.elmt,"0","#FBFAFA");if((0!=Z.toolbarVisible&&1!=Z.toolbarVisible||Z.mobileDevice)&&Z.minimizeVisible){var ja=
new Z.Utils.Button("buttonMinimize",null,Z.skinPath,I[9],I[10],I[11],"1px","1px","1px","1px","mouseover",N,"z363");Z.ToolbarDisplay.appendChild(ja.elmt);var La=new Z.Utils.Button("buttonExpand",null,Z.skinPath,I[12],I[13],I[14],"1px","1px","1px","1px","mouseover",N,"z341");Z.ToolbarDisplay.appendChild(La.elmt)}if(Z.zoomButtonsVisible){var la=new Z.Utils.Button("buttonZoomOut",null,Z.skinPath,I[1],I[2],I[3],"1px","1px","1px","1px","mouseover",N,"z400");J.appendChild(la.elmt)}if(Z.sliderZoomVisible){var wb=
new Z.Utils.Graphic("trackSliderZoom",Z.skinPath,I[15],"1px","1px","0px","0px","z385ZOOM");J.appendChild(wb.elmt);Z.Utils.addEventListener(wb.elmt,"mousedown",N);Z.Utils.addEventListener(wb.elmt,"touchstart",N);Z.Utils.addEventListener(wb.elmt,"mouseover",N);var X=new Z.Utils.Button("buttonSliderZoom",null,Z.skinPath,I[17],I[18],I[19],"1px","1px","1px","1px","mouseover",N,"z385ZOOM");J.appendChild(X.elmt)}if(Z.zoomButtonsVisible){var ia=new Z.Utils.Button("buttonZoomIn",null,Z.skinPath,I[4],I[5],
I[6],"1px","1px","1px","1px","mouseover",N,"z399");J.appendChild(ia.elmt)}if(Z.panButtonsVisible){if(Z.zoomButtonsVisible||Z.sliderZoomVisible){var Rb=new Z.Utils.Graphic("panDivider",Z.skinPath,I[20],"1px","1px","1px","1px");J.appendChild(Rb.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(Rb.elmt,0,R)}var Jd=new Z.Utils.Button("buttonPanLeft",null,Z.skinPath,I[21],I[22],I[23],"1px","1px","1px","1px","mouseover",N,"z370");J.appendChild(Jd.elmt);var da=new Z.Utils.Button("buttonPanUp",null,Z.skinPath,
I[24],I[25],I[26],"1px","1px","1px","1px","mouseover",N,"z372");J.appendChild(da.elmt);var bd=new Z.Utils.Button("buttonPanDown",null,Z.skinPath,I[27],I[28],I[29],"1px","1px","1px","1px","mouseover",N,"z369");J.appendChild(bd.elmt);var fa=new Z.Utils.Button("buttonPanRight",null,Z.skinPath,I[30],I[31],I[32],"1px","1px","1px","1px","mouseover",N,"z371");J.appendChild(fa.elmt)}if(Z.resetVisible){var ga=new Z.Utils.Button("buttonReset",null,Z.skinPath,I[33],I[34],I[35],"1px","1px","1px","1px","mouseover",
N,"z378");J.appendChild(ga.elmt)}if(Z.fullScreenVisible||Z.fullPageVisible){var Fa=new Z.Utils.Graphic("fullViewDivider",Z.skinPath,I[36],"1px","1px","1px","1px");J.appendChild(Fa.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(Fa.elmt,0,R);var Jc=new Z.Utils.Button("buttonFullViewExit",null,Z.skinPath,I[40],I[41],I[42],"1px","1px","1px","1px","mouseover",N,"z391EXIT");J.appendChild(Jc.elmt);var Yb=new Z.Utils.Button("buttonFullView",null,Z.skinPath,I[37],I[38],I[39],"1px","1px","1px","1px",
"mouseover",N,"z391");J.appendChild(Yb.elmt)}if(Z.measureVisible&&null===Z.editMode){if(!Z.fullScreenVisible&&!Z.fullPageVisible){var Id=new Z.Utils.Graphic("measureDivider",Z.skinPath,I[36],"1px","1px","1px","1px");J.appendChild(Id.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(Id.elmt,0,R)}if(null===Z.editMode){var ca=new Z.Utils.Button("buttonMeasureExit",null,Z.skinPath,I[49],I[50],I[51],"1px","1px","1px","1px","mouseover",N,"z392EXIT");J.appendChild(ca.elmt)}var $a=new Z.Utils.Button("buttonMeasure",
null,Z.skinPath,I[46],I[47],I[48],"1px","1px","1px","1px","mouseover",N,"z392");J.appendChild($a.elmt)}if(Z.rotationVisible){var pa=new Z.Utils.Graphic("rotateDivider",Z.skinPath,I[52],"1px","1px","1px","1px");J.appendChild(pa.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(pa.elmt,0,R);var ma=new Z.Utils.Button("buttonRotateCounterwise",null,Z.skinPath,I[53],I[54],I[55],"1px","1px","1px","1px","mouseover",N,"z381");J.appendChild(ma.elmt);var Db=new Z.Utils.Button("buttonRotateClockwise",null,
Z.skinPath,I[56],I[57],I[58],"1px","1px","1px","1px","mouseover",N,"z380");J.appendChild(Db.elmt)}if(Z.tour){var Na=new Z.Utils.Graphic("tourDivider",Z.skinPath,I[59],"1px","1px","1px","1px");J.appendChild(Na.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(Na.elmt,0,R);var oa=new Z.Utils.Button("buttonTourPrior",null,Z.skinPath,I[60],I[61],I[62],"1px","1px","1px","1px","mouseover",N,"z394");J.appendChild(oa.elmt);var Qa=new Z.Utils.Button("buttonTourNext",null,Z.skinPath,I[63],I[64],I[65],"1px",
"1px","1px","1px","mouseover",N,"z393");J.appendChild(Qa.elmt);var qa=new Z.Utils.Button("buttonTourStart",null,Z.skinPath,I[66],I[67],I[68],"1px","1px","1px","1px","mouseover",N,"z395");J.appendChild(qa.elmt);var xa=new Z.Utils.Button("buttonTourStop",null,Z.skinPath,I[69],I[70],I[71],"1px","1px","1px","1px","mouseover",N,"z396");J.appendChild(xa.elmt)}if(Z.slideshow&&Z.slideButtonsVisible){var ya=new Z.Utils.Graphic("slideshowDivider",Z.skinPath,I[59],"1px","1px","1px","1px");J.appendChild(ya.elmt);
Z.toolbarBackgroundVisible||Z.Utils.setOpacity(ya.elmt,0,R);var ud=new Z.Utils.Button("buttonSlideshowPrior",null,Z.skinPath,I[60],I[61],I[62],"1px","1px","1px","1px","mouseover",N,"z384");J.appendChild(ud.elmt);var ge=new Z.Utils.Button("buttonSlideshowNext",null,Z.skinPath,I[63],I[64],I[65],"1px","1px","1px","1px","mouseover",N,"z383");J.appendChild(ge.elmt);var Ba=new Z.Utils.Button("buttonSlideshowStart",null,Z.skinPath,I[66],I[67],I[68],"1px","1px","1px","1px","mouseover",N,"z386");J.appendChild(Ba.elmt);
var Ja=new Z.Utils.Button("buttonSlideshowStop",null,Z.skinPath,I[69],I[70],I[71],"1px","1px","1px","1px","mouseover",N,"z387");J.appendChild(Ja.elmt)}if(Z.tour||Z.slideshow){var ib=new Z.Utils.Button("buttonAudioOn",null,Z.skinPath,I[72],I[73],I[74],"1px","1px","1px","1px","mouseover",N,"z321");J.appendChild(ib.elmt);var m=new Z.Utils.Button("buttonAudioMuted",null,Z.skinPath,I[75],I[76],I[77],"1px","1px","1px","1px","mouseover",N,"z322");J.appendChild(m.elmt)}if(Z.imageFilters){var kc=new Z.Utils.Graphic("imageFilterDivider",
Z.skinPath,I[207],"1px","1px","1px","1px");J.appendChild(kc.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(kc.elmt,0,R);var Pa=new Z.Utils.Button("buttonImageFilterPanelHide",null,Z.skinPath,I[204],I[205],I[206],"1px","1px","1px","1px","mouseover",N,"z350");J.appendChild(Pa.elmt);var bb=new Z.Utils.Button("buttonImageFilterPanelShow",null,Z.skinPath,I[201],I[202],I[203],"1px","1px","1px","1px","mouseover",N,"z351");J.appendChild(bb.elmt);var ua=Z.Utils.createContainerElement("div","buttonContainerImageFilter",
"none","absolute","visible","1px","1px","0px","0px","solid","1px","transparent","0px","0px","normal","default");Z.ToolbarDisplay.appendChild(ua);Z.Utils.addEventListener(ua,"mouseover",F.backgroundEventsHandler);var Ua=parseFloat(Z.Utils.getResource("z82")),Ra=Z.Utils.getResource("z83"),ab=Z.Utils.getResource("z83NOALPHA"),Za=Z.Utils.createContainerElement("div","imageFilterPanelBackground","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",Ra,"0px","0px","normal",null,!0);Z.Utils.setOpacity(Za,
Ua,ab);ua.appendChild(Za);for(var Zc=Z.Utils.getResource("z425").split(","),nb=Z.Utils.getResource("z426").split(","),Dd=0,Md=Zc.length;Dd<Md;Dd++)sd[sd.length]={text:Zc[Dd],value:nb[Dd]};var ub=new Z.Utils.createSelectElement("imageFilterList","",sd,1,1,1,null,!0,Ha,"change");ua.appendChild(ub);Z.brightnessVisible&&new Z.Utils.Slider("brightness",ua,I,N,W);Z.contrastVisible&&new Z.Utils.Slider("contrast",ua,I,N,W);Z.sharpnessVisible&&new Z.Utils.Slider("sharpness",ua,I,N,W);Z.blurrinessVisible&&
new Z.Utils.Slider("blurriness",ua,I,N,W);Z.colorRedVisible&&new Z.Utils.Slider("colorRed",ua,I,N,W);Z.colorGreenVisible&&new Z.Utils.Slider("colorGreen",ua,I,N,W);Z.colorBlueVisible&&new Z.Utils.Slider("colorBlue",ua,I,N,W);Z.colorRedRangeVisible&&new Z.Utils.Slider("colorRedRange",ua,I,N,W,!0);Z.colorGreenRangeVisible&&new Z.Utils.Slider("colorGreenRange",ua,I,N,W,!0);Z.colorBlueRangeVisible&&new Z.Utils.Slider("colorBlueRange",ua,I,N,W,!0);Z.gammaVisible&&new Z.Utils.Slider("gamma",ua,I,N,W);Z.gammaRedVisible&&
new Z.Utils.Slider("gammaRed",ua,I,N,W);Z.gammaGreenVisible&&new Z.Utils.Slider("gammaGreen",ua,I,N,W);Z.gammaBlueVisible&&new Z.Utils.Slider("gammaBlue",ua,I,N,W);Z.hueVisible&&new Z.Utils.Slider("hue",ua,I,N,W);Z.saturationVisible&&new Z.Utils.Slider("saturation",ua,I,N,W);Z.lightnessVisible&&new Z.Utils.Slider("lightness",ua,I,N,W);Z.whiteBalanceVisible&&new Z.Utils.Slider("whiteBalance",ua,I,N,W);Z.noiseVisible&&new Z.Utils.Slider("noise",ua,I,N,W);if(Z.blurrinessVisible||Z.brightnessVisible||
Z.colorBlueRangeVisible||Z.colorBlueVisible||Z.colorGreenRangeVisible||Z.colorGreenVisible||Z.colorRedRangeVisible||Z.colorRedVisible||Z.contrastVisible||Z.gammaBlueVisible||Z.gammaGreenVisible||Z.gammaRedVisible||Z.gammaVisible||Z.hueVisible||Z.lightnessVisible||Z.noiseVisible||Z.saturationVisible||Z.sharpnessVisible||Z.whiteBalanceVisible){var Wd=new Z.Utils.Button("buttonImageFilterMinus",null,Z.skinPath,I[208],I[209],I[210],"1px","1px","1px","1px","mouseover",N,"z349");ua.appendChild(Wd.elmt);
var yb=new Z.Utils.Button("buttonImageFilterPlus",null,Z.skinPath,I[211],I[212],I[213],"1px","1px","1px","1px","mouseover",N,"z352");ua.appendChild(yb.elmt);var Ab=new Z.Utils.Graphic("imageFilterStateDivider",Z.skinPath,I[207],"1px","1px","1px","1px");ua.appendChild(Ab.elmt)}if(Z.grayscaleVisible){var Eb=Z.Utils.createContainerElement("div","labelGrayscaleTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),Gb=document.createTextNode(Z.Utils.getResource("UI_IMAGEFILTERPANELLABELGRAYSCALE"));
Eb.appendChild(Gb);var Ga=new Z.Utils.Checkbox("checkboxFilterGrayscale","test","1px","1px","1px","1px","click",N,"TIP_GRAYSCALE");ua.appendChild(Eb);ua.appendChild(Ga)}if(Z.thresholdVisible){var bc=Z.Utils.createContainerElement("div","labelThresholdTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),Ib=document.createTextNode(Z.Utils.getResource("UI_IMAGEFILTERPANELLABELTHRESHOLD"));bc.appendChild(Ib);var Tb=new Z.Utils.Checkbox("checkboxFilterThreshold",
"test","1px","1px","1px","1px","click",N,"TIP_THRESHOLD");ua.appendChild(bc);ua.appendChild(Tb)}if(Z.inversionVisible){var Fb=Z.Utils.createContainerElement("div","labelInversionTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),ld=document.createTextNode(Z.Utils.getResource("UI_IMAGEFILTERPANELLABELINVERSION"));Fb.appendChild(ld);var hc=new Z.Utils.Checkbox("checkboxFilterInversion","test","1px","1px","1px","1px","click",N,
"TIP_INVERSION");ua.appendChild(Fb);ua.appendChild(hc)}if(Z.normalizeVisible){var eb=Z.Utils.createContainerElement("div","labelNormalizeTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),L=document.createTextNode(Z.Utils.getResource("UI_IMAGEFILTERPANELLABELEQUALIZE"));eb.appendChild(L);var dc=new Z.Utils.Checkbox("checkboxFilterNormalize","test","1px","1px","1px","1px","click",N,"TIP_EQUALIZE");ua.appendChild(eb);ua.appendChild(dc)}if(Z.equalizeVisible){var za=
Z.Utils.createContainerElement("div","labelEqualizeTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),Ea=document.createTextNode(Z.Utils.getResource("UI_IMAGEFILTERPANELLABELEQUALIZE"));za.appendChild(Ea);var gc=new Z.Utils.Checkbox("checkboxFilterEqualize","test","1px","1px","1px","1px","click",N,"TIP_EQUALIZE");ua.appendChild(za);ua.appendChild(gc)}if(Z.edgesVisible){var ec=Z.Utils.createContainerElement("div","labelEdgesTextBox",
"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),wa=document.createTextNode(Z.Utils.getResource("UI_IMAGEFILTERPANELLABELEDGES"));ec.appendChild(wa);var hb=new Z.Utils.Checkbox("checkboxFilterEdges","test","1px","1px","1px","1px","click",N,"TIP_EDGES");ua.appendChild(ec);ua.appendChild(hb)}if(Z.sepiaVisible){var kb=Z.Utils.createContainerElement("div","labelSepiaTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none",
"0px","transparent","0px","0px","nowrap",null,!0),sc=document.createTextNode(Z.Utils.getResource("UI_IMAGEFILTERPANELLABELSEPIA"));kb.appendChild(sc);var vc=new Z.Utils.Checkbox("checkboxFilterSepia","test","1px","1px","1px","1px","click",N,"TIP_SEPIA");ua.appendChild(kb);ua.appendChild(vc)}var xc=new Z.Utils.Graphic("imageFilterPanelDivider",Z.skinPath,I[207],"1px","1px","1px","1px");ua.appendChild(xc.elmt);var Ec=new Z.Utils.Button("buttonImageFilterClear",null,Z.skinPath,I[183],I[184],I[185],"1px",
"1px","1px","1px","mouseover",N,"z347");ua.appendChild(Ec.elmt);var Fc=new Z.Utils.Button("buttonImageFiltersClearAll",null,Z.skinPath,I[180],I[181],I[182],"1px","1px","1px","1px","mouseover",N,"z347ALL");ua.appendChild(Fc.elmt);var Ob=new Z.Utils.Graphic("imageFilterStateDivider3",Z.skinPath,I[207],"1px","1px","1px","1px");ua.appendChild(Ob.elmt);var Gc=new Z.Utils.Button("buttonImageFilterPanelHideOnPanel",null,Z.skinPath,I[202],I[203],I[204],"1px","1px","1px","1px","mouseover",N,"z350");ua.appendChild(Gc.elmt)}if(Z.imageSet&&
!Z.overlays){if(1<J.childNodes.length){var wc=new Z.Utils.Graphic("imageSetDivider",Z.skinPath,I[59],"1px","1px","1px","1px");J.appendChild(wc.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(wc.elmt,0,R)}var Ka=new Z.Utils.Button("buttonImageSetPrior",null,Z.skinPath,I[60],I[61],I[62],"1px","1px","1px","1px","mouseover",N,"TIP_IMAGESETPRIOR");J.appendChild(Ka.elmt);if(Z.sliderImageSetVisible){var jc=new Z.Utils.Graphic("trackSliderImageSet",Z.skinPath,I[15],"1px","1px","0px","0px","z385IMAGESET");
J.appendChild(jc.elmt);Z.Utils.addEventListener(jc.elmt,"mousedown",N);Z.Utils.addEventListener(jc.elmt,"touchstart",N);Z.Utils.addEventListener(jc.elmt,"mouseover",N);var lc=new Z.Utils.Button("buttonSliderImageSet",null,Z.skinPath,I[17],I[18],I[19],"1px","1px","1px","1px","mouseover",N,"z385IMAGESET");J.appendChild(lc.elmt)}var Rc=new Z.Utils.Button("buttonImageSetNext",null,Z.skinPath,I[63],I[64],I[65],"1px","1px","1px","1px","mouseover",N,"TIP_IMAGESETNEXT");J.appendChild(Rc.elmt)}if(Z.preloadVisible){var Hc=
new Z.Utils.Graphic("preloadDivider",Z.skinPath,I[59],"1px","1px","1px","1px");J.appendChild(Hc.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(Hc.elmt,0,R);var Tc=new Z.Utils.Button("buttonPreload",null,Z.skinPath,I[69],I[70],I[71],"1px","1px","1px","1px","mouseover",N,"TIP_PRELOAD");J.appendChild(Tc.elmt)}if(Z.comparison){var Ic=Z.Utils.createContainerElement("div","labelSyncTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",
null,!0),Wb=document.createTextNode(Z.Utils.getResource("UI_TOOLBARLABELSYNC"));Ic.appendChild(Wb);var $c=new Z.Utils.Checkbox("checkboxSyncComparison","test","1px","1px","1px","1px","click",N,"TIP_SYNC");J.appendChild(Ic);J.appendChild($c)}if(1==Z.helpVisible||3==Z.helpVisible){var Uc=new Z.Utils.Button("buttonHelp",null,Z.skinPath,I[43],I[44],I[45],"1px","1px","1px","1px","mouseover",N,"z342");J.appendChild(Uc.elmt)}if(Z.progressVisible){var Sc=Z.Utils.createContainerElement("div","progressTextBox",
"inline-block","absolute","hidden","1px","1px","1px","1px","none","0px","transparent","0px","0px","normal",null,!0),tb=ta[16];J.appendChild(Sc);var oc=document.createTextNode(Z.Utils.getResource("z183"));Sc.appendChild(Z.Utils.createCenteredElement(oc,"progressTextBoxCenteredDiv"));null===xb&&(xb=Z.Utils.getResource("z183COLOR"));Z.Utils.setTextNodeStyle(oc,xb,"verdana",tb+"px","none","normal","normal","normal","normal","1em","left","none");Z.Utils.disableTextInteraction(oc)}Z.ViewerDisplay.appendChild(Z.ToolbarDisplay);
Z.toolbarW=ta[0];Z.toolbarCurrentW=-1==Z.toolbarW?Z.viewerW:Z.toolbarW;Z.toolbarH=Va=ta[1];var na=Z.toolbarBackgroundVisible?0:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST"),10);F.setSizeAndPosition(Z.toolbarCurrentW,Z.toolbarH,0,1==Z.toolbarPosition?Z.viewerH-Z.toolbarH-na:0+na);if(a&&a.getStatus("initializedViewport")){1==Z.toolbarVisible&&Z.toolbarBackgroundVisible&&(a.setSizeAndPosition(Z.viewerW,Z.viewerH-Z.toolbarH,0,0==Z.toolbarPosition?Z.toolbarH:0),a.validateXYZDefaults(!0),
a.updateView());var cd=a.getZoom();n(cd);Z.annotations&&a.setDrawingColor("buttonColor0"+V,!0)}k(1==Z.toolbarVisible||2==Z.toolbarVisible||4==Z.toolbarVisible||7==Z.toolbarVisible);Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation);g(!0);e()}else Z.Utils.showMessage(Z.Utils.getResource("z278"))};this.setSizeAndPosition=function(b,e,f,g){"undefined"===typeof b||null===b?b=0<Z.toolbarVisible?Z.toolbarCurrentW:0:Z.toolbarCurrentW=b;if("undefined"===typeof e||null===e)e=0<
Z.toolbarVisible&&8!=Z.toolbarVisible?Va:0;if("undefined"===typeof f||null===f)f=0;if("undefined"===typeof g||null===g)g=1==Z.toolbarPosition?Z.viewerH-Va:0;Z.narrative&&(b-=Z.narrativeW,f+=Z.narrativeW);jb=Z.ToolbarDisplay.style;jb.width=b+"px";jb.height=e+"px";jb.left=f+"px";jb.top=g+"px";var k=b,l=e,n=ta[2],u=ta[3],v=ta[4],B=ta[5],D=ta[6],P=ta[7],C=ta[8],w=ta[9],E=ta[10],gb=ta[11],N=ta[12],xb=ta[13],R=ta[14],Aa=ta[15],M=Z.narrative?10:0,G=(l-u)/2,S=(l-B)/2,K=(l-P)/2,ja=Z.narrative?K:1.3*K,La=Z.narrative?
3:0,wb=K+6-La,la=K+5-La,X=1==Z.logoVisible?0:C/2,W=1==Z.logoVisible?0:C/2,ia=C-(D-v),V=0,da=0;Z.zoomButtonsVisible&&(V+=2);Z.panButtonsVisible&&(V+=4,da+=1);Z.resetVisible&&(V+=1);if(Z.fullScreenVisible||Z.fullPageVisible)V+=1,da+=1;Z.helpVisible&&(V+=1,Z.fullScreenVisible||Z.fullPageVisible||(da+=1));Z.measureVisible&&(Z.fullScreenVisible||Z.fullPageVisible||(da+=1),V+=1);Z.rotationVisible&&(V+=2,da+=1);if(Z.tour||Z.slideshow&&Z.slideButtonsVisible)V+=3,da+=1,Z.audioContent&&(V+=1);Z.imageFilters&&
(V+=1,da+=1);Z.preloadVisible&&(V+=1,da+=1);Z.comparison&&Z.syncVisible&&(V+=1,da+=1);if(Z.imageSet&&Z.sliderImageSetVisible){var fa=xb,Fa=gb,ga=N;fb=!1;V+=2}Z.progressVisible||(R=0);var ca=V*C+da*ia;Z.sliderZoomVisible&&(ca+=xb);Z.imageSet&&Z.sliderImageSetVisible&&(ca+=fa);Qb=bd=Yb=Zc=overrideZoom=!1;var pa=(1==Z.logoVisible?n+2:0)+(0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&0!=Z.minimizeVisible?C:0),$a=1==Z.panButtonsVisible?4*C+ia:0,ma=1==Z.zoomButtonsVisible?2*C:0,Db=1==Z.resetVisible?C:0,Na=
pa+20+ca+20+R;Na>k&&(Qb=!0,Na-xb>k&&(bd=!0,Na-xb-R>k&&(Yb=!0,Na-xb-R-pa>k&&(kc=!0,Na-xb-R-pa-Db>k&&(Zc=!0,ca-=$a,Na-xb-R-pa-Db-$a>k&&(overrideZoom=!0,ca-=ma)),ca-=Db),pa=0),R=0),ca-=xb);var oa=(k-ca)/2-20+3,Qa=document.getElementById("toolbarBackground");Qa&&(Qa.style.width=k+"px",Qa.style.height=l+"px",Qa.firstChild.style.width=k+"px",Qa.firstChild.style.height=l+"px");var qa=document.getElementById("buttonContainer");qa&&(qa.style.width=ca+40+"px",qa.style.height=l+"px",qa.style.left=oa+"px");var xa=
document.getElementById("buttonBackground");xa&&(xa.style.width=k+"px",Z.Utils.graphicSize(xa,parseFloat(qa.style.width),parseFloat(qa.style.height)),xa.style.left="0px");var ya=document.getElementById("toolbarLogo");if(ya){var Ba=ya.style;if(Ba)if(Yb)Ba.display="none";else{Ba.display="inline-block";Z.Utils.graphicSize(ya,n,u);Ba.left=M+"px";Ba.top=G+"px";var M=M+(n+5),Ha=document.getElementById("logoDivider");if(Ha){Z.Utils.graphicSize(Ha,v,B);var ib=Ha.style;ib.left=M+"px";ib.top=S+"px"}}}if(0!=
Z.toolbarVisible&&1!=Z.toolbarVisible){var Pa=document.getElementById("buttonMinimize"),bb=document.getElementById("buttonExpand");if(Pa&&bb){var Ua=Pa.style,Ra=bb.style;Ua&&Ra&&(Yb?(Ua.display="none",Ra.display="none"):(Ua.display="inline-block",Ra.display="inline-block",Z.Utils.buttonSize(Pa,D,P),Z.Utils.buttonSize(bb,D,P),Ua.left=M+X+"px",Ua.top=ja+"px",Ra.left=M+W+"px",Ra.top=ja+"px"))}}M=20;if(!overrideZoom){var Za=document.getElementById("buttonZoomOut");if(Za){Z.Utils.buttonSize(Za,D,P);var Ja=
Za.style;Ja.left=M+"px";Ja.top=K+"px";M+=C}trsZ=document.getElementById("trackSliderZoom");btsZ=document.getElementById("buttonSliderZoom");trsZ&&btsZ&&(trszS=trsZ.style,btszS=btsZ.style,trszS&&btszS&&(Qb?(trszS.display="none",btszS.display="none"):(trszS.display="inline-block",btszS.display="inline-block",Z.Utils.graphicSize(trsZ,gb,N),trszS.left=M-2+"px",trszS.top=wb+"px",Z.Utils.buttonSize(btsZ,w,E),btszS.left=parseFloat(trszS.left)+"px",btszS.top=la+"px",M+=xb)));var ab=document.getElementById("buttonZoomIn");
if(ab){Z.Utils.buttonSize(ab,D,P);var m=ab.style;m.left=M+"px";m.top=K+"px";M+=C+1}}if(!Zc){var Ab=document.getElementById("panDivider");if(Ab){Z.Utils.graphicSize(Ab,v,B);var bc=Ab.style;bc.left=M+"px";bc.top=S-5+"px";M+=ia}var Fb=document.getElementById("buttonPanLeft");if(Fb){Z.Utils.buttonSize(Fb,D,P);var ua=Fb.style;ua.left=M+"px";ua.top=K+"px";M+=C}var Lb=document.getElementById("buttonPanUp");if(Lb){Z.Utils.buttonSize(Lb,D,P);var lc=Lb.style;lc.left=M+"px";lc.top=K+"px";M+=C}var sd=document.getElementById("buttonPanDown");
if(sd){Z.Utils.buttonSize(sd,D,P);var Nd=sd.style;Nd.left=M+"px";Nd.top=K+"px";M+=C}var Bb=document.getElementById("buttonPanRight");if(Bb){Z.Utils.buttonSize(Bb,D,P);var Hb=Bb.style;Hb.left=M+"px";Hb.top=K+"px";M+=C}}if(!kc){var Kd=document.getElementById("buttonReset");if(Kd){Z.Utils.buttonSize(Kd,D,P);var Od=Kd.style;Od.left=M+"px";Od.top=K+"px";M+=C+1}}var te=document.getElementById("fullViewDivider");if(te){Z.Utils.graphicSize(te,v,B);var Zd=te.style;Zd.left=M+"px";Zd.top=S+"px";M+=ia}var Ii=
document.getElementById("buttonFullViewExit");if(Ii){Z.Utils.buttonSize(Ii,D,P);var Ji=Ii.style;Ji.left=M+"px";Ji.top=K+"px";Ji.display=Z.fullView?"inline-block":"none"}var di=document.getElementById("buttonFullView");if(di){Z.Utils.buttonSize(di,D,P);var nf=di.style;nf.left=M+"px";nf.top=K+"px";M+=C+1;nf.display=Z.fullView?"none":"inline-block"}var Ga=document.getElementById("measureDivider");if(Ga){Z.Utils.graphicSize(Ga,v,B);var Bc=Ga.style;Bc.left=M+"px";Bc.top=S+"px";M+=ia}if(null===Z.editMode){var Ib=
document.getElementById("buttonMeasureExit");if(Ib){Z.Utils.buttonSize(Ib,D,P);var Kg=Ib.style;Kg.left=M+"px";Kg.top=K+"px";Kg.display="measure"==Z.labelMode?"inline-block":"none"}}if(Pa=document.getElementById("buttonMeasure"))Z.Utils.buttonSize(Pa,D,P),Ua=Pa.style,Ua.left=M+"px",Ua.top=K+"px",M+=C+1,Ua.display="measure"==Z.labelMode?"none":"inline-block";var ig=document.getElementById("rotateDivider");if(ig){Z.Utils.graphicSize(ig,v,B);var Lg=ig.style;Lg.left=M+"px";Lg.top=S+"px";var M=M+ia,hc=
document.getElementById("buttonRotateCounterwise");if(hc){Z.Utils.buttonSize(hc,D,P);var eb=hc.style;eb.left=M+"px";eb.top=K+"px";M+=C}var L=document.getElementById("buttonRotateClockwise");if(L){Z.Utils.buttonSize(L,D,P);var Ph=L.style;Ph.left=M+"px";Ph.top=K+"px";M+=C+1}}if(Z.tour){var za=document.getElementById("tourDivider");if(za){Z.Utils.graphicSize(za,v,B);var Ea=za.style;Ea.left=M+"px";Ea.top=S+"px";var M=M+ia,pe=document.getElementById("buttonTourPrior");if(pe){Z.Utils.buttonSize(pe,D,P);
var Mg=pe.style;Mg.left=M+"px";Mg.top=K+"px";M+=C+1}var wa=document.getElementById("buttonTourNext");if(wa){Z.Utils.buttonSize(wa,D,P);var hb=wa.style;hb.left=M+"px";hb.top=K+"px";M+=C+1}var kb=document.getElementById("buttonTourStop");if(kb){Z.Utils.buttonSize(kb,D,P);var kh=kb.style;kh.left=M+"px";kh.top=K+"px";kh.display=Z.tourPlaying?"inline-block":"none"}var jd=document.getElementById("buttonTourStart");if(jd){Z.Utils.buttonSize(jd,D,P);var Xe=jd.style;Xe.left=M+"px";Xe.top=K+"px";M+=C+1;Xe.display=
Z.tourPlaying?"none":"inline-block"}}}else if(Z.slideshow&&Z.slideButtonsVisible){var of=document.getElementById("slideshowDivider");if(of){Z.Utils.graphicSize(of,v,B);var Rh=of.style;Rh.left=M+"px";Rh.top=S+"px";var M=M+ia,Ob=document.getElementById("buttonSlideshowPrior");if(Ob){Z.Utils.buttonSize(Ob,D,P);var Ye=Ob.style;Ye.left=M+"px";Ye.top=K+"px";M+=C+1}var Kf=document.getElementById("buttonSlideshowNext");if(Kf){Z.Utils.buttonSize(Kf,D,P);var Ka=Kf.style;Ka.left=M+"px";Ka.top=K+"px";M+=C+1}var jc=
document.getElementById("buttonSlideshowStop");if(jc){Z.Utils.buttonSize(jc,D,P);var oh=jc.style;oh.left=M+"px";oh.top=K+"px";oh.display=Z.slideshowPlaying?"inline-block":"none"}var ph=document.getElementById("buttonSlideshowStart");if(ph){Z.Utils.buttonSize(ph,D,P);var Mf=ph.style;Mf.left=M+"px";Mf.top=K+"px";M+=C+1;Mf.display=Z.slideshowPlaying?"none":"inline-block"}}}else if(null!==Z.imageSetPath&&!Z.comparison){var Of=document.getElementById("imageSetDivider");if(Of){Z.Utils.graphicSize(Of,v,
B);var Sh=Of.style;Sh.left=M+"px";Sh.top=S+"px";M+=ia}var Wb=document.getElementById("buttonImageSetPrior");if(Wb){Z.Utils.buttonSize(Wb,D,P);var $c=Wb.style;$c.left=M+"px";$c.top=K+"px";M+=C+1}trsiS=document.getElementById("trackSliderImageSet");btsiS=document.getElementById("buttonSliderImageSet");trsiS&&btsiS&&(trsisS=trsiS.style,btsisS=btsiS.style,trsisS&&btsisS&&(fb?(trsisS.display="none",btsisS.display="none"):(trsisS.display="inline-block",btsisS.display="inline-block",Z.Utils.graphicSize(trsiS,
Fa,ga),trsisS.left=M-2+"px",trsisS.top=wb+"px",Z.Utils.buttonSize(btsiS,w,E),btsisS.left=parseFloat(trsisS.left)+"px",btsisS.top=la+"px",M+=fa)));var kg=document.getElementById("buttonImageSetNext");if(kg){Z.Utils.buttonSize(kg,D,P);var Th=kg.style;Th.left=M+"px";Th.top=K+"px";M+=C+1}}if(Z.tour||Z.slideshow){var tb=document.getElementById("buttonAudioMuted");if(tb){Z.Utils.buttonSize(tb,D,P);var oc=tb.style;oc.left=M+"px";oc.top=K+"px";oc.display="none"}var na=document.getElementById("buttonAudioOn");
if(na){Z.Utils.buttonSize(na,D,P);var mh=na.style;mh.left=M+"px";mh.top=K+"px";M+=C+1;mh.display="none"}a.initializeAudioMuteButtons()}if(Z.imageFilters){var oe=document.getElementById("imageFilterDivider");if(oe){Z.Utils.graphicSize(oe,v,B);var Qh=oe.style;Qh.left=M+"px";Qh.top=S+"px";var M=M+ia,Lf=document.getElementById("buttonImageFilterPanelHide");if(Lf){Z.Utils.buttonSize(Lf,D,P);var lh=Lf.style;lh.left=M+"px";lh.top=K+"px";lh.display=Qd?"inline-block":"none"}var ne=document.getElementById("buttonImageFilterPanelShow");
if(ne){Z.Utils.buttonSize(ne,D,P);var jg=ne.style;jg.left=M+"px";jg.top=K+"px";M+=C+1;jg.display=Qd?"none":"inline-block"}var Kb=parseInt(Z.Utils.getResource("DEFAULT_IMAGEFILTERPANELLABELFONTSIZE"),10),$b=parseInt(Z.Utils.getResource("DEFAULT_IMAGEFILTERPANELTEXTFONTSIZE"),10),Mb=parseInt(Z.Utils.getResource("DEFAULT_IMAGEFILTERTEXTPADDINGSMALL"),10),ki=parseInt(Z.Utils.getResource("DEFAULT_IMAGEFILTERSLIDERWIDTHMULTIPLIER"),10),mc=ta[6],ic=ta[7],sb=ta[8],Cc=ta[4],T=ta[5],Xb=ta[11]*ki,lb=ta[12],
Jb=ta[9],ra=ta[10],Wa=ta[13]*ki,If=sb-(mc-Cc),aa=90,We=parseInt(Z.Utils.getResource("z137"),10),jh=Z.grayscaleVisible+Z.thresholdVisible+Z.inversionVisible+Z.normalizeVisible+Z.equalizeVisible+Z.edgesVisible+Z.sepiaVisible,Jf=Math.max(ic+6+18*(Z.brightnessVisible+Z.contrastVisible+Z.sharpnessVisible+Z.blurrinessVisible+Z.colorRedVisible+Z.colorGreenVisible+Z.colorBlueVisible+Z.colorRedRangeVisible+Z.colorGreenRangeVisible+Z.colorBlueRangeVisible+Z.gammaVisible+Z.gammaRedVisible+Z.gammaGreenVisible+
Z.gammaBlueVisible+Z.hueVisible+Z.saturationVisible+Z.lightnessVisible+Z.whiteBalanceVisible+Z.noiseVisible)+10,(ic+6)*jh),mf=0<jh?2:.96,me=Z.blurrinessVisible||Z.brightnessVisible||Z.colorBlueRangeVisible||Z.colorBlueVisible||Z.colorGreenRangeVisible||Z.colorGreenVisible||Z.colorRedRangeVisible||Z.colorRedVisible||Z.contrastVisible||Z.gammaBlueVisible||Z.gammaGreenVisible||Z.gammaRedVisible||Z.gammaVisible||Z.hueVisible||Z.lightnessVisible||Z.noiseVisible||Z.saturationVisible||Z.sharpnessVisible||
Z.whiteBalanceVisible,pi=Z.colorRedRangeVisible||Z.colorGreenRangeVisible||Z.colorBlueRangeVisible?50:0,hg=Z.colorRedVisible||Z.colorGreenVisible||Z.colorBlueVisible||Z.whiteBalanceVisible||Z.gammaRedVisible||Z.gammaGreenVisible||Z.gammaBlueVisible?0:30,Xb=me?Xb+pi+hg:30,Wa=me?Wa+pi+hg:30,ac=Z.colorRedRangeVisible||Z.colorGreenRangeVisible||Z.colorBlueRangeVisible?42:0,aa=aa-hg,Oh=me&&0<jh?hg+ac:0,Nb=ld=Math.round(aa*mf+Xb+2*sb+sb*mf+If*mf+15*mf-4+ac),Sa=20+T+Jf+15,fc=Sa-T-38,re=Nb-15-mc,qh=Sa-10-
1.9*ic,rh=Sa-10-ic-1,Q=15,H=20,th=document.getElementById("buttonImageFilterPanelShow"),Ia=document.getElementById("buttonContainerImageFilter"),pd=document.getElementById("imageFilterList");if(Ia&&th&&pd){var od=parseFloat(th.style.left),Lc=parseFloat(th.parentNode.style.left),Vb=Ia.style;Vb.width=Nb+"px";Vb.height=Sa+"px";var Nc=od+Lc+sb-Nb+Oh;75>Nc&&(Nc=75);Vb.left=Nc+"px";Vb.top=-(Sa+5)+"px";var vb=document.getElementById("imageFilterPanelBackground");if(vb){var Oc=vb.style;Oc.width=Nb+"px";Oc.height=
Sa+"px"}var hd=pd.style;hd.width=We+"px";hd.left="20px";hd.top=rh+"px";var vd=document.getElementById("labelBrightnessTextBox");$d=document.getElementById("trackSliderFilterBrightness");Eb=document.getElementById("buttonSliderFilterBrightness");var uc=document.getElementById("textBoxFor-brightnessTextElement");if(vd&&$d&&Eb&&uc){Sd=vd.style;ve=$d.style;we=Eb.style;var Pb=uc.style;Sd&&ve&&we&&Pb&&(Sd.width=aa+"px",Sd.height="20px",Sd.left=Q+"px",Sd.top=H-3+"px",Sd.visibility="visible",Z.Utils.setTextNodeStyle(vd,
"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),ve.display="inline-block",we.display="inline-block",Z.Utils.graphicSize($d,Xb,lb),ve.left=Q+aa+3+"px",ve.top=H-4+"px",Z.Utils.buttonSize(Eb,Jb,ra),we.left=parseFloat(ve.left)+"px",we.top=H-4+"px",Pb.width="37px",Pb.height="14px",Pb.left=Q+aa+3+Wa+"px",Pb.top=H-6+"px",Z.Utils.setTextAreaStyle(uc,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var wd=document.getElementById("labelContrastTextBox");
ae=document.getElementById("trackSliderFilterContrast");ub=document.getElementById("buttonSliderFilterContrast");var le=document.getElementById("textBoxFor-contrastTextElement");if(wd&&ae&&ub&&le){vc=wd.style;yb=ae.style;de=ub.style;var qd=le.style;vc&&yb&&de&&qd&&(vc.width=aa+"px",vc.height="20px",vc.left=Q+"px",vc.top=H-3+"px",vc.visibility="visible",Z.Utils.setTextNodeStyle(wd,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),yb.display="inline-block",de.display=
"inline-block",Z.Utils.graphicSize(ae,Xb,lb),yb.left=Q+aa+3+"px",yb.top=H-4+"px",Z.Utils.buttonSize(ub,Jb,ra),de.left=parseFloat(yb.left)+"px",de.top=H-4+"px",qd.width="37px",qd.height="14px",qd.left=Q+aa+3+Wa+"px",qd.top=H-6+"px",Z.Utils.setTextAreaStyle(le,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var Se=document.getElementById("labelSharpnessTextBox");Sc=document.getElementById("trackSliderFilterSharpness");Fc=document.getElementById("buttonSliderFilterSharpness");
var Vh=document.getElementById("textBoxFor-sharpnessTextElement");if(Se&&Sc&&Fc&&Vh){Ec=Se.style;Rc=Sc.style;Tc=Fc.style;var Gf=Vh.style;Ec&&Rc&&Tc&&Gf&&(Ec.width=aa+"px",Ec.height="20px",Ec.left=Q+"px",Ec.top=H-3+"px",Ec.visibility="visible",Z.Utils.setTextNodeStyle(Se,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Rc.display="inline-block",Tc.display="inline-block",Z.Utils.graphicSize(Sc,Xb,lb),Rc.left=Q+aa+3+"px",Rc.top=H-4+"px",Z.Utils.buttonSize(Fc,
Jb,ra),Tc.left=parseFloat(Rc.left)+"px",Tc.top=H-4+"px",Gf.width="37px",Gf.height="14px",Gf.left=Q+aa+3+Wa+"px",Gf.top=H-6+"px",Z.Utils.setTextAreaStyle(Vh,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var vh=document.getElementById("labelBlurrinessTextBox");Gc=document.getElementById("trackSliderFilterBlurriness");qe=document.getElementById("buttonSliderFilterBlurriness");var wh=document.getElementById("textBoxFor-blurrinessTextElement");
if(vh&&Gc&&qe&&wh){Bd=vh.style;Ic=Gc.style;Gb=qe.style;var pg=wh.style;Bd&&Ic&&Gb&&pg&&(Bd.width=aa+"px",Bd.height="20px",Bd.left=Q+"px",Bd.top=H-3+"px",Bd.visibility="visible",Z.Utils.setTextNodeStyle(vh,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Ic.display="inline-block",Gb.display="inline-block",Z.Utils.graphicSize(Gc,Xb,lb),Ic.left=Q+aa+3+"px",Ic.top=H-4+"px",Z.Utils.buttonSize(qe,Jb,ra),Gb.left=parseFloat(Ic.left)+"px",Gb.top=H-4+"px",pg.width="37px",
pg.height="14px",pg.left=Q+aa+3+Wa+"px",pg.top=H-6+"px",Z.Utils.setTextAreaStyle(wh,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var mi=document.getElementById("labelColorRedTextBox");gc=document.getElementById("trackSliderFilterColorRed");Cd=document.getElementById("buttonSliderFilterColorRed");var Rg=document.getElementById("textBoxFor-colorRedTextElement");if(mi&&gc&&Cd&&Rg){lfbtcrS=mi.style;Td=gc.style;nb=Cd.style;var Qf=Rg.style;lfbtcrS&&
Td&&nb&&Qf&&(lfbtcrS.width=aa+"px",lfbtcrS.height="20px",lfbtcrS.left=Q+"px",lfbtcrS.top=H-3+"px",lfbtcrS.visibility="visible",Z.Utils.setTextNodeStyle(mi,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Td.display="inline-block",nb.display="inline-block",Z.Utils.graphicSize(gc,Xb,lb),Td.left=Q+aa+3+"px",Td.top=H-4+"px",Z.Utils.buttonSize(Cd,Jb,ra),nb.left=parseFloat(Td.left)+"px",nb.top=H-4+"px",Qf.width="37px",Qf.height="14px",Qf.left=Q+aa+3+Wa+"px",Qf.top=
H-6+"px",Z.Utils.setTextAreaStyle(Rg,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var qg=document.getElementById("labelColorGreenTextBox");Ud=document.getElementById("trackSliderFilterColorGreen");Ae=document.getElementById("buttonSliderFilterColorGreen");var $e=document.getElementById("textBoxFor-colorGreenTextElement");if(qg&&Ud&&Ae&&$e){lfbtcgS=qg.style;ze=Ud.style;ee=Ae.style;var rf=$e.style;lfbtcgS&&ze&&ee&&rf&&(lfbtcgS.width=aa+"px",
lfbtcgS.height="20px",lfbtcgS.left=Q+"px",lfbtcgS.top=H-3+"px",lfbtcgS.visibility="visible",Z.Utils.setTextNodeStyle(qg,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),ze.display="inline-block",ee.display="inline-block",Z.Utils.graphicSize(Ud,Xb,lb),ze.left=Q+aa+3+"px",ze.top=H-4+"px",Z.Utils.buttonSize(Ae,Jb,ra),ee.left=parseFloat(ze.left)+"px",ee.top=H-4+"px",rf.width="37px",rf.height="14px",rf.left=Q+aa+3+Wa+"px",rf.top=H-6+"px",Z.Utils.setTextAreaStyle($e,
"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var bf=document.getElementById("labelColorBlueTextBox");ec=document.getElementById("trackSliderFilterColorBlue");Uc=document.getElementById("buttonSliderFilterColorBlue");var sf=document.getElementById("textBoxFor-colorBlueTextElement");if(bf&&ec&&Uc&&sf){lfbtcbS=bf.style;Vd=ec.style;wc=Uc.style;var Sf=sf.style;lfbtcbS&&Vd&&wc&&Sf&&(lfbtcbS.width=aa+"px",lfbtcbS.height="20px",lfbtcbS.left=Q+"px",
lfbtcbS.top=H-3+"px",lfbtcbS.visibility="visible",Z.Utils.setTextNodeStyle(bf,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Vd.display="inline-block",wc.display="inline-block",Z.Utils.graphicSize(ec,Xb,lb),Vd.left=Q+aa+3+"px",Vd.top=H-4+"px",Z.Utils.buttonSize(Uc,Jb,ra),wc.left=parseFloat(Vd.left)+"px",wc.top=H-4+"px",Sf.width="37px",Sf.height="14px",Sf.left=Q+aa+3+Wa+"px",Sf.top=H-6+"px",Z.Utils.setTextAreaStyle(sf,"black","verdana",$b+"px","none","normal",
"normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var Ge=document.getElementById("labelColorRedRangeTextBox");sc=document.getElementById("trackSliderFilterColorRedRange");xc=document.getElementById("buttonSliderFilterColorRedRange");btfCRR2=document.getElementById("buttonSliderFilterColorRedRange2");var va=document.getElementById("textBoxFor-colorRedRangeTextElement"),gd=document.getElementById("textBoxFor-colorRedRangeTextElement2");if(Ge&&sc&&xc&&btfCRR2&&va&&gd){lfbtcrrS=Ge.style;
cd=sc.style;tf=xc.style;btfcrr2S=btfCRR2.style;tbfcrrteS=va.style;var Hd=gd.style;lfbtcrrS&&cd&&tf&&btfcrr2S&&tbfcrrteS&&Hd&&(lfbtcrrS.width=aa+"px",lfbtcrrS.height="20px",lfbtcrrS.left=Q+"px",lfbtcrrS.top=H-3+"px",lfbtcrrS.visibility="visible",Z.Utils.setTextNodeStyle(Ge,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),cd.display="inline-block",tf.display="inline-block",Z.Utils.graphicSize(sc,Xb,lb),cd.left=Q+aa+3+"px",cd.top=H-4+"px",Z.Utils.buttonSize(xc,
Jb,ra),tf.left=parseFloat(cd.left)+"px",tf.top=H-4+"px",Z.Utils.buttonSize(btfCRR2,Jb,ra),btfcrr2S.left=parseFloat(cd.left)+50+"px",btfcrr2S.top=H-4+"px",tbfcrrteS.width="37px",tbfcrrteS.height="14px",tbfcrrteS.left=Q+aa+3+Wa+"px",tbfcrrteS.top=H-6+"px",Z.Utils.setTextAreaStyle(va,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),Hd.width="37px",Hd.height="14px",Hd.left=Q+aa+3+Wa+37+5+"px",Hd.top=H-6+"px",Z.Utils.setTextAreaStyle(gd,"black","verdana",
$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var He=document.getElementById("labelColorGreenRangeTextBox");ce=document.getElementById("trackSliderFilterColorGreenRange");vf=document.getElementById("buttonSliderFilterColorGreenRange");btfCGR2=document.getElementById("buttonSliderFilterColorGreenRange2");var ke=document.getElementById("textBoxFor-colorGreenRangeTextElement"),Rf=document.getElementById("textBoxFor-colorGreenRangeTextElement2");if(He&&ce&&vf&&
btfCGR2&&ke&&Rf){lfbtcgrS=He.style;uf=ce.style;sg=vf.style;btfcgr2S=btfCGR2.style;tbfcgrteS=ke.style;var Tf=Rf.style;lfbtcgrS&&uf&&sg&&btfcgr2S&&tbfcgrteS&&Tf&&(lfbtcgrS.width=aa+"px",lfbtcgrS.height="20px",lfbtcgrS.left=Q+"px",lfbtcgrS.top=H-3+"px",lfbtcgrS.visibility="visible",Z.Utils.setTextNodeStyle(He,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),uf.display="inline-block",sg.display="inline-block",Z.Utils.graphicSize(ce,Xb,lb),uf.left=Q+aa+3+"px",uf.top=
H-4+"px",Z.Utils.buttonSize(vf,Jb,ra),sg.left=parseFloat(uf.left)+"px",sg.top=H-4+"px",Z.Utils.buttonSize(btfCGR2,Jb,ra),btfcgr2S.left=parseFloat(cd.left)+50+"px",btfcgr2S.top=H-4+"px",tbfcgrteS.width="37px",tbfcgrteS.height="14px",tbfcgrteS.left=Q+aa+3+Wa+"px",tbfcgrteS.top=H-6+"px",Z.Utils.setTextAreaStyle(ke,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),Tf.width="37px",Tf.height="14px",Tf.left=Q+aa+3+Wa+37+5+"px",Tf.top=H-6+"px",Z.Utils.setTextAreaStyle(Rf,
"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var si=document.getElementById("labelColorBlueRangeTextBox");dc=document.getElementById("trackSliderFilterColorBlueRange");ye=document.getElementById("buttonSliderFilterColorBlueRange");btfCBR2=document.getElementById("buttonSliderFilterColorBlueRange2");var Xh=document.getElementById("textBoxFor-colorBlueRangeTextElement"),xd=document.getElementById("textBoxFor-colorBlueRangeTextElement2");if(si&&
dc&&ye&&btfCBR2&&Xh&&xd){lfbtcbrS=si.style;Hc=dc.style;tg=ye.style;btfcbr2S=btfCBR2.style;tbfcbrteS=Xh.style;var Cb=xd.style;lfbtcbrS&&Hc&&tg&&btfcbr2S&&tbfcbrteS&&Cb&&(lfbtcbrS.width=aa+"px",lfbtcbrS.height="20px",lfbtcbrS.left=Q+"px",lfbtcbrS.top=H-3+"px",lfbtcbrS.visibility="visible",Z.Utils.setTextNodeStyle(si,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Hc.display="inline-block",tg.display="inline-block",Z.Utils.graphicSize(dc,Xb,lb),Hc.left=Q+aa+
3+"px",Hc.top=H-4+"px",Z.Utils.buttonSize(ye,Jb,ra),tg.left=parseFloat(Hc.left)+"px",tg.top=H-4+"px",Z.Utils.buttonSize(btfCBR2,Jb,ra),btfcbr2S.left=parseFloat(cd.left)+50+"px",btfcbr2S.top=H-4+"px",tbfcbrteS.width="37px",tbfcbrteS.height="14px",tbfcbrteS.left=Q+aa+3+Wa+"px",tbfcbrteS.top=H-6+"px",Z.Utils.setTextAreaStyle(Xh,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),Cb.width="37px",Cb.height="14px",Cb.left=Q+aa+3+Wa+37+5+"px",Cb.top=H-6+"px",
Z.Utils.setTextAreaStyle(xd,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var Ie=document.getElementById("labelGammaTextBox");wf=document.getElementById("trackSliderFilterGamma");Vf=document.getElementById("buttonSliderFilterGamma");var yd=document.getElementById("textBoxFor-gammaTextElement");if(Ie&&wf&&Vf&&yd){lfbtgS=Ie.style;Uf=wf.style;xe=Vf.style;var sh=yd.style;lfbtgS&&Uf&&xe&&sh&&(lfbtgS.width=aa+"px",lfbtgS.height="20px",lfbtgS.left=
Q+"px",lfbtgS.top=H-3+"px",lfbtgS.visibility="visible",Z.Utils.setTextNodeStyle(Ie,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Uf.display="inline-block",xe.display="inline-block",Z.Utils.graphicSize(wf,Xb,lb),Uf.left=Q+aa+3+"px",Uf.top=H-4+"px",Z.Utils.buttonSize(Vf,Jb,ra),xe.left=parseFloat(Uf.left)+"px",xe.top=H-4+"px",sh.width="37px",sh.height="14px",sh.left=Q+aa+3+Wa+"px",sh.top=H-6+"px",Z.Utils.setTextAreaStyle(yd,"black","verdana",$b+"px","none",
"normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var xh=document.getElementById("labelGammaRedTextBox");be=document.getElementById("trackSliderFilterGammaRed");Ne=document.getElementById("buttonSliderFilterGammaRed");var Ve=document.getElementById("textBoxFor-gammaRedTextElement");if(xh&&be&&Ne&&Ve){lfbtgrS=xh.style;df=be.style;xf=Ne.style;var Ue=Ve.style;lfbtgrS&&df&&xf&&Ue&&(lfbtgrS.width=aa+"px",lfbtgrS.height="20px",lfbtgrS.left=Q+"px",lfbtgrS.top=H-3+"px",lfbtgrS.visibility=
"visible",Z.Utils.setTextNodeStyle(xh,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),df.display="inline-block",xf.display="inline-block",Z.Utils.graphicSize(be,Xb,lb),df.left=Q+aa+3+"px",df.top=H-4+"px",Z.Utils.buttonSize(Ne,Jb,ra),xf.left=parseFloat(df.left)+"px",xf.top=H-4+"px",Ue.width="37px",Ue.height="14px",Ue.left=Q+aa+3+Wa+"px",Ue.top=H-6+"px",Z.Utils.setTextAreaStyle(Ve,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center",
"none",Mb+"px"),H+=T)}var Te=document.getElementById("labelGammaGreenTextBox");r=document.getElementById("trackSliderFilterGammaGreen");Da=document.getElementById("buttonSliderFilterGammaGreen");var Hf=document.getElementById("textBoxFor-gammaGreenTextElement");if(Te&&r&&Da&&Hf){lfbtggS=Te.style;O=r.style;pb=Da.style;var cg=Hf.style;lfbtggS&&O&&pb&&cg&&(lfbtggS.width=aa+"px",lfbtggS.height="20px",lfbtggS.left=Q+"px",lfbtggS.top=H-3+"px",lfbtggS.visibility="visible",Z.Utils.setTextNodeStyle(Te,"black",
"verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),O.display="inline-block",pb.display="inline-block",Z.Utils.graphicSize(r,Xb,lb),O.left=Q+aa+3+"px",O.top=H-4+"px",Z.Utils.buttonSize(Da,Jb,ra),pb.left=parseFloat(O.left)+"px",pb.top=H-4+"px",cg.width="37px",cg.height="14px",cg.left=Q+aa+3+Wa+"px",cg.top=H-6+"px",Z.Utils.setTextAreaStyle(Hf,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var ri=document.getElementById("labelGammaBlueTextBox");
Rb=document.getElementById("trackSliderFilterGammaBlue");Jd=document.getElementById("buttonSliderFilterGammaBlue");var Og=document.getElementById("textBoxFor-gammaBlueTextElement");if(ri&&Rb&&Jd&&Og){lfbtgbS=ri.style;ud=Rb.style;Jc=Jd.style;var Ke=Og.style;lfbtgbS&&ud&&Jc&&Ke&&(lfbtgbS.width=aa+"px",lfbtgbS.height="20px",lfbtgbS.left=Q+"px",lfbtgbS.top=H-3+"px",lfbtgbS.visibility="visible",Z.Utils.setTextNodeStyle(ri,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left",
"none"),ud.display="inline-block",Jc.display="inline-block",Z.Utils.graphicSize(Rb,Xb,lb),ud.left=Q+aa+3+"px",ud.top=H-4+"px",Z.Utils.buttonSize(Jd,Jb,ra),Jc.left=parseFloat(ud.left)+"px",Jc.top=H-4+"px",Ke.width="37px",Ke.height="14px",Ke.left=Q+aa+3+Wa+"px",Ke.top=H-6+"px",Z.Utils.setTextAreaStyle(Og,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var Pg=document.getElementById("labelHueTextBox");Id=document.getElementById("trackSliderFilterHue");
Dd=document.getElementById("buttonSliderFilterHue");var Pf=document.getElementById("textBoxFor-hueTextElement");if(Pg&&Id&&Dd&&Pf){lfbthS=Pg.style;Wd=Id.style;ge=Dd.style;var Ze=Pf.style;lfbthS&&Wd&&ge&&Ze&&(lfbthS.width=aa+"px",lfbthS.height="20px",lfbthS.left=Q+"px",lfbthS.top=H-3+"px",lfbthS.visibility="visible",Z.Utils.setTextNodeStyle(Pg,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Wd.display="inline-block",ge.display="inline-block",Z.Utils.graphicSize(Id,
Xb,lb),Wd.left=Q+aa+3+"px",Wd.top=H-4+"px",Z.Utils.buttonSize(Dd,Jb,ra),ge.left=parseFloat(Wd.left)+"px",ge.top=H-4+"px",Ze.width="37px",Ze.height="14px",Ze.left=Q+aa+3+Wa+"px",Ze.top=H-6+"px",Z.Utils.setTextAreaStyle(Pf,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var ih=document.getElementById("labelSaturationTextBox");Md=document.getElementById("trackSliderFilterSaturation");Wg=document.getElementById("buttonSliderFilterSaturation");
var hh=document.getElementById("textBoxFor-saturationTextElement");if(ih&&Md&&Wg&&hh){lfbtsaS=ih.style;Vg=Md.style;Be=Wg.style;var gg=hh.style;lfbtsaS&&Vg&&Be&&gg&&(lfbtsaS.width=aa+"px",lfbtsaS.height="20px",lfbtsaS.left=Q+"px",lfbtsaS.top=H-3+"px",lfbtsaS.visibility="visible",Z.Utils.setTextNodeStyle(ih,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Vg.display="inline-block",Be.display="inline-block",Z.Utils.graphicSize(Md,Xb,lb),Vg.left=Q+aa+3+"px",Vg.top=
H-4+"px",Z.Utils.buttonSize(Wg,Jb,ra),Be.left=parseFloat(Vg.left)+"px",Be.top=H-4+"px",gg.width="37px",gg.height="14px",gg.left=Q+aa+3+Wa+"px",gg.top=H-6+"px",Z.Utils.setTextAreaStyle(hh,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var Mi=document.getElementById("labelLightnessTextBox");vg=document.getElementById("trackSliderFilterLightness");yg=document.getElementById("buttonSliderFilterLightness");var Ni=document.getElementById("textBoxFor-lightnessTextElement");
if(Mi&&vg&&yg&&Ni){lfbtlS=Mi.style;fe=vg.style;Wf=yg.style;var Ng=Ni.style;lfbtlS&&fe&&Wf&&Ng&&(lfbtlS.width=aa+"px",lfbtlS.height="20px",lfbtlS.left=Q+"px",lfbtlS.top=H-3+"px",lfbtlS.visibility="visible",Z.Utils.setTextNodeStyle(Mi,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),fe.display="inline-block",Wf.display="inline-block",Z.Utils.graphicSize(vg,Xb,lb),fe.left=Q+aa+3+"px",fe.top=H-4+"px",Z.Utils.buttonSize(yg,Jb,ra),Wf.left=parseFloat(fe.left)+"px",
Wf.top=H-4+"px",Ng.width="37px",Ng.height="14px",Ng.left=Q+aa+3+Wa+"px",Ng.top=H-6+"px",Z.Utils.setTextAreaStyle(Ni,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var Uh=document.getElementById("labelWhiteBalanceTextBox");Me=document.getElementById("trackSliderFilterWhiteBalance");zg=document.getElementById("buttonSliderFilterWhiteBalance");var qi=document.getElementById("textBoxFor-whiteBalanceTextElement");if(Uh&&Me&&zg&&qi){lfbtwbS=Uh.style;
cf=Me.style;Oe=zg.style;var nh=qi.style;lfbtwbS&&cf&&Oe&&nh&&(lfbtwbS.width=aa+"px",lfbtwbS.height="20px",lfbtwbS.left=Q+"px",lfbtwbS.top=H-3+"px",lfbtwbS.visibility="visible",Z.Utils.setTextNodeStyle(Uh,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),cf.display="inline-block",Oe.display="inline-block",Z.Utils.graphicSize(Me,Xb,lb),cf.left=Q+aa+3+"px",cf.top=H-4+"px",Z.Utils.buttonSize(zg,Jb,ra),Oe.left=parseFloat(cf.left)+"px",Oe.top=H-4+"px",nh.width="37px",
nh.height="14px",nh.left=Q+aa+3+Wa+"px",nh.top=H-6+"px",Z.Utils.setTextAreaStyle(qi,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var mg=document.getElementById("labelNormalizeTextBox");Ce=document.getElementById("trackSliderFilterNormalize");ff=document.getElementById("buttonSliderFilterNormalize");var lg=document.getElementById("textBoxFor-normalizeTextElement");if(mg&&Ce&&ff&&lg){lfbtnS=mg.style;Tb=Ce.style;De=ff.style;var ka=lg.style;
lfbtnS&&Tb&&De&&ka&&(lfbtnS.width=aa+"px",lfbtnS.height="20px",lfbtnS.left=Q+"px",lfbtnS.top=H-3+"px",lfbtnS.visibility="visible",Z.Utils.setTextNodeStyle(mg,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Tb.display="inline-block",De.display="inline-block",Z.Utils.graphicSize(Ce,Xb,lb),Tb.left=Q+aa+3+"px",Tb.top=H-4+"px",Z.Utils.buttonSize(ff,Jb,ra),De.left=parseFloat(Tb.left)+"px",De.top=H-4+"px",ka.width="37px",ka.height="14px",ka.left=Q+aa+3+Wa+"px",ka.top=
H-6+"px",Z.Utils.setTextAreaStyle(lg,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T)}var ha=document.getElementById("labelEqualizeTextBox");trsFE=document.getElementById("trackSliderFilterEqualize");btfE=document.getElementById("buttonSliderFilterEqualize");var Ig=document.getElementById("textBoxFor-equalizeTextElement");ha&&trsFE&&btfE&&Ig&&(lfbteS=ha.style,trsfeS=trsFE.style,btfeS=btfE.style,tbfeteS=Ig.style,lfbteS&&trsfeS&&btfeS&&tbfeteS&&
(lfbteS.width=aa+"px",lfbteS.height="20px",lfbteS.left=Q+"px",lfbteS.top=H-3+"px",lfbteS.visibility="visible",Z.Utils.setTextNodeStyle(ha,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),trsfeS.display="inline-block",btfeS.display="inline-block",Z.Utils.graphicSize(trsFE,Xb,lb),trsfeS.left=Q+aa+3+"px",trsfeS.top=H-4+"px",Z.Utils.buttonSize(btfE,Jb,ra),btfeS.left=parseFloat(trsfeS.left)+"px",btfeS.top=H-4+"px",tbfeteS.width="37px",tbfeteS.height="14px",tbfeteS.left=
Q+aa+3+Wa+"px",tbfeteS.top=H-6+"px",Z.Utils.setTextAreaStyle(Ig,"black","verdana",$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T));mg=document.getElementById("labelNoiseTextBox");Ce=document.getElementById("trackSliderFilterNoise");ff=document.getElementById("buttonSliderFilterNoise");lg=document.getElementById("textBoxFor-noiseTextElement");mg&&Ce&&ff&&lg&&(lfbtnS=mg.style,Tb=Ce.style,De=ff.style,ka=lg.style,lfbtnS&&Tb&&De&&ka&&(lfbtnS.width=aa+"px",lfbtnS.height=
"20px",lfbtnS.left=Q+"px",lfbtnS.top=H-3+"px",lfbtnS.visibility="visible",Z.Utils.setTextNodeStyle(mg,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none"),Tb.display="inline-block",De.display="inline-block",Z.Utils.graphicSize(Ce,Xb,lb),Tb.left=Q+aa+3+"px",Tb.top=H-4+"px",Z.Utils.buttonSize(ff,Jb,ra),De.left=parseFloat(Tb.left)+"px",De.top=H-4+"px",ka.width="37px",ka.height="14px",ka.left=Q+aa+3+Wa+"px",ka.top=H-6+"px",Z.Utils.setTextAreaStyle(lg,"black","verdana",
$b+"px","none","normal","normal","normal","normal","1em","center","none",Mb+"px"),H+=T));var Q=15+aa+Xb+15+ac/2,H=H-5,Jg=document.getElementById("buttonImageFilterMinus");if(Jg){Z.Utils.buttonSize(Jg,.9*mc,.9*ic);var qb=Jg.style;qb.left=Q+"px";qb.top=H+"px";Q+=mc+3}var cb=document.getElementById("buttonImageFilterPlus");if(cb){Z.Utils.buttonSize(cb,.9*mc,.9*ic);var ad=cb.style;ad.left=Q+"px";ad.top=H+"px";Q+=sb}var Q=Nb-22.5-mc-aa,H=14,Dc=document.getElementById("imageFilterStateDivider");if(Dc){Z.Utils.graphicSize(Dc,
Cc,fc);var Pc=Dc.style;Pc.left=0<jh?Q-15+"px":"-1000px";Pc.top="10px"}var pc=document.getElementById("labelGrayscaleTextBox"),Le=document.getElementById("containerFor-checkboxFilterGrayscale"),se=document.getElementById("checkboxFilterGrayscale");if(pc&&Le&&se){var ng=pc.style;ng.width=aa+"px";ng.height="20px";ng.left=Q+"px";ng.top=H+3+"px";ng.visibility="visible";Z.Utils.setTextNodeStyle(pc,"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none");var Qg=Le.style;
Qg.width=1.5*mc+"px";Qg.height=1.5*ic+"px";Qg.left=Q+aa+3+"px";Qg.top=H-3+"px";se.width=mc;se.height=ic;H+=T}var zd=document.getElementById("labelThresholdTextBox"),Rd=document.getElementById("containerFor-checkboxFilterThreshold"),ni=document.getElementById("checkboxFilterThreshold");if(zd&&Rd&&ni){var lf=zd.style;lf.width=aa+"px";lf.height="20px";lf.left=Q+"px";lf.top=H+3+"px";lf.visibility="visible";Z.Utils.setTextNodeStyle(zd,"black","verdana",Kb+"px","none","normal","normal","normal","normal",
"1em","left","none");var Df=Rd.style;Df.width=1.5*mc+"px";Df.height=1.5*ic+"px";Df.left=Q+aa+3+"px";Df.top=H-3+"px";ni.width=mc;ni.height=ic;H+=T}var ii=document.getElementById("labelInversionTextBox"),ah=document.getElementById("containerFor-checkboxFilterInversion"),Cg=document.getElementById("checkboxFilterInversion");if(ii&&ah&&Cg){var bg=ii.style;bg.width=aa+"px";bg.height="20px";bg.left=Q+"px";bg.top=H+3+"px";bg.visibility="visible";Z.Utils.setTextNodeStyle(ii,"black","verdana",Kb+"px","none",
"normal","normal","normal","normal","1em","left","none");var Xc=ah.style;Xc.width=1.5*mc+"px";Xc.height=1.5*ic+"px";Xc.left=Q+aa+3+"px";Xc.top=H-3+"px";Cg.width=mc;Cg.height=ic;H+=T}var tc=document.getElementById("labelEqualizeTextBox"),Bg=document.getElementById("containerFor-checkboxFilterEqualize"),Kh=document.getElementById("checkboxFilterEqualize");if(tc&&Bg&&Kh){var ag=tc.style;ag.width=aa+"px";ag.height="20px";ag.left=Q+"px";ag.top=H+3+"px";ag.visibility="visible";Z.Utils.setTextNodeStyle(tc,
"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none");var li=Bg.style;li.width=1.5*mc+"px";li.height=1.5*ic+"px";li.left=Q+aa+3+"px";li.top=H-3+"px";Kh.width=mc;Kh.height=ic;H+=T}var Bf=document.getElementById("labelEdgesTextBox"),hi=document.getElementById("containerFor-checkboxFilterEdges"),Cf=document.getElementById("checkboxFilterEdges");if(Bf&&hi&&Cf){var Dg=Bf.style;Dg.width=aa+"px";Dg.height="20px";Dg.left=Q+"px";Dg.top=H+3+"px";Dg.visibility="visible";Z.Utils.setTextNodeStyle(Bf,
"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none");var ch=hi.style;ch.width=1.5*mc+"px";ch.height=1.5*ic+"px";ch.left=Q+aa+3+"px";ch.top=H-3+"px";Cf.width=mc;Cf.height=ic;H+=T}var $g=document.getElementById("labelSepiaTextBox"),gj=document.getElementById("containerFor-checkboxFilterSepia"),eh=document.getElementById("checkboxFilterSepia");if($g&&gj&&eh){var Wc=$g.style;Wc.width=aa+"px";Wc.height="20px";Wc.left=Q+"px";Wc.top=H+3+"px";Wc.visibility="visible";Z.Utils.setTextNodeStyle($g,
"black","verdana",Kb+"px","none","normal","normal","normal","normal","1em","left","none");var md=gj.style;md.width=1.5*mc+"px";md.height=1.5*ic+"px";md.left=Q+aa+3+"px";md.top=H-3+"px";eh.width=mc;eh.height=ic}var Q=Nb-15-5*mc,H=Sa-10-ic,Gg=document.getElementById("imageFilterPanelDivider");if(Gg){Z.Utils.graphicSize(Gg,re,5.5);var dh=Gg.style;dh.left="15px";dh.top=qh+2+"px"}var Ki=document.getElementById("buttonImageFilterClear");if(Ki){Z.Utils.buttonSize(Ki,mc,ic);var hj=Ki.style;hj.left=Q+"px";
hj.top=H+"px";Q+=sb}var Re=document.getElementById("buttonImageFiltersClearAll");if(Re){Z.Utils.buttonSize(Re,mc,ic);var bh=Re.style;bh.left=Q+"px";bh.top=H+"px";Q+=sb}var Ef=document.getElementById("imageFilterStateDivider3");if(Ef){Z.Utils.graphicSize(Ef,Cc,T);var Qe=Ef.style;Qe.left=Q+"px";Qe.top=H+"px";Q+=If}var zc=document.getElementById("buttonImageFilterPanelHideOnPanel");if(zc){Z.Utils.buttonSize(zc,mc,ic);var ed=zc.style;ed.left=Q+"px";ed.top=H+"px"}var Y=null,cc=null;Z.contrastVisible&&
(J(null,"contrast",!0),Y=a.getImageFilterDefault("contrast"),F.setImageFilterSlider("contrast",Y),F.setImageFilterText("contrast",Y),a.setImageFilterValuePrior("contrast",Y));Z.sharpnessVisible&&(J(null,"sharpness",!0),Y=a.getImageFilterDefault("sharpness"),F.setImageFilterSlider("sharpness",Y),F.setImageFilterText("sharpness",Y),a.setImageFilterValuePrior("sharpness",Y));Z.blurrinessVisible&&(J(null,"blurriness",!0),Y=a.getImageFilterDefault("blurriness"),F.setImageFilterSlider("blurriness",Y),F.setImageFilterText("blurriness",
Y),a.setImageFilterValuePrior("blurriness",Y));Z.colorRedVisible&&(J(null,"colorRed",!0),Y=a.getImageFilterDefault("colorRed"),F.setImageFilterSlider("colorRed",Y),F.setImageFilterText("colorRed",Y),a.setImageFilterValuePrior("colorRed",Y));Z.colorGreenVisible&&(J(null,"colorGreen",!0),Y=a.getImageFilterDefault("colorGreen"),F.setImageFilterSlider("colorGreen",Y),F.setImageFilterText("colorGreen",Y),a.setImageFilterValuePrior("colorGreen",Y));Z.colorBlueVisible&&(J(null,"colorBlue",!0),Y=a.getImageFilterDefault("colorBlue"),
F.setImageFilterSlider("colorBlue",Y),F.setImageFilterText("colorBlue",Y),a.setImageFilterValuePrior("colorBlue",Y));Z.colorRedRangeVisible&&(J(null,"colorRedRange",!0),Y=a.getImageFilterDefault("colorRedRange"),F.setImageFilterSlider("colorRedRange",Y),F.setImageFilterText("colorRedRange",Y),a.setImageFilterValuePrior("colorRedRange",Y),J(null,"colorRedRange2",!0),cc=a.getImageFilterDefault("colorRedRange2"),F.setImageFilterSlider("colorRedRange2",cc),F.setImageFilterText("colorRedRange2",cc),a.setImageFilterValuePrior("colorRedRange2",
cc));Z.colorGreenRangeVisible&&(J(null,"colorGreenRange",!0),Y=a.getImageFilterDefault("colorGreenRange"),F.setImageFilterSlider("colorGreenRange",Y),F.setImageFilterText("colorGreenRange",Y),a.setImageFilterValuePrior("colorGreenRange",Y),J(null,"colorGreenRange2",!0),cc=a.getImageFilterDefault("colorGreenRange2"),F.setImageFilterSlider("colorGreenRange2",cc),F.setImageFilterText("colorGreenRange2",cc),a.setImageFilterValuePrior("colorGreenRange2",cc));Z.colorBlueRangeVisible&&(J(null,"colorBlueRange",
!0),Y=a.getImageFilterDefault("colorBlueRange"),F.setImageFilterSlider("colorBlueRange",Y),F.setImageFilterText("colorBlueRange",Y),a.setImageFilterValuePrior("colorBlueRange",Y),J(null,"colorBlueRange2",!0),cc=a.getImageFilterDefault("colorBlueRange2"),F.setImageFilterSlider("colorBlueRange2",cc),F.setImageFilterText("colorBlueRange2",cc),a.setImageFilterValuePrior("colorBlueRange2",cc));Z.gammaVisible&&(J(null,"gamma",!0),Y=a.getImageFilterDefault("gamma"),F.setImageFilterSlider("gamma",Y),F.setImageFilterText("gamma",
Y),a.setImageFilterValuePrior("gamma",Y));Z.gammaRedVisible&&(J(null,"gammaRed",!0),Y=a.getImageFilterDefault("gammaRed"),F.setImageFilterSlider("gammaRed",Y),F.setImageFilterText("gammaRed",Y),a.setImageFilterValuePrior("gammaRed",Y));Z.gammaGreenVisible&&(J(null,"gammaGreen",!0),Y=a.getImageFilterDefault("gammaGreen"),F.setImageFilterSlider("gammaGreen",Y),F.setImageFilterText("gammaGreen",Y),a.setImageFilterValuePrior("gammaGreen",Y));Z.gammaBlueVisible&&(J(null,"gammaBlue",!0),Y=a.getImageFilterDefault("gammaBlue"),
F.setImageFilterSlider("gammaBlue",Y),F.setImageFilterText("gammaBlue",Y),a.setImageFilterValuePrior("gammaBlue",Y));Z.hueVisible&&(J(null,"hue",!0),Y=a.getImageFilterDefault("hue"),F.setImageFilterSlider("hue",Y),F.setImageFilterText("hue",Y),a.setImageFilterValuePrior("hue",Y));Z.saturationVisible&&(J(null,"saturation",!0),Y=a.getImageFilterDefault("saturation"),F.setImageFilterSlider("saturation",Y),F.setImageFilterText("saturation",Y),a.setImageFilterValuePrior("saturation",Y));Z.lightnessVisible&&
(J(null,"lightness",!0),Y=a.getImageFilterDefault("lightness"),F.setImageFilterSlider("lightness",Y),F.setImageFilterText("lightness",Y),a.setImageFilterValuePrior("lightness",Y));Z.whiteBalanceVisible&&(J(null,"whiteBalance",!0),Y=a.getImageFilterDefault("whiteBalance"),F.setImageFilterSlider("whiteBalance",Y),F.setImageFilterText("whiteBalance",Y),a.setImageFilterValuePrior("whiteBalance",Y));Z.noiseVisible&&(J(null,"noise",!0),Y=a.getImageFilterDefault("noise"),F.setImageFilterSlider("noise",Y),
F.setImageFilterText("noise",Y),a.setImageFilterValuePrior("noise",Y));Z.brightnessVisible&&(J(null,"brightness",!0),Y=a.getImageFilterDefault("brightness"),F.setImageFilterSlider("brightness",Y),F.setImageFilterText("brightness",Y),a.setImageFilterValuePrior("brightness",Y))}}}if(Z.preloadVisible){var nc=document.getElementById("preloadDivider"),Eg=document.getElementById("buttonPreload");if(nc&&Eg){Z.Utils.graphicSize(nc,v,B);var Fg=nc.style;Fg.top=S+"px";Z.imageSet||(Fg.left=M+"px",M+=ia);Z.Utils.buttonSize(Eg,
D,P);var Hg=Eg.style;Hg.left=M+"px";Hg.top=K+"px";M+=C;Z.imageSet&&(Fg.left=M+"px",M+=ia);M+=8}}if(1==Z.helpVisible||3==Z.helpVisible){var nd=document.getElementById("buttonHelp");if(nd){Z.Utils.buttonSize(nd,D,P);var hf=nd.style;hf.left=M+"px";hf.top=K+"px";M+=C+8}}if(Z.comparison&&Z.syncVisible){var Fi=parseInt(Z.Utils.getResource("DEFAULT_TOOLBARLABELFONTSIZE"),10),Fh=document.getElementById("labelSyncTextBox"),Wh=document.getElementById("containerFor-checkboxSyncComparison"),og=document.getElementById("checkboxSyncComparison");
if(Fh&&Wh&&og){var fh=Fh.style;fh.width="28px";fh.height="20px";fh.left=M+"px";fh.top=K+6+"px";fh.visibility="visible";Z.Utils.setTextNodeStyle(Fh,"black","verdana",Fi+"px","none","normal","normal","normal","normal","1em","left","none");var Hh=Wh.style;Hh.width=1.5*D+"px";Hh.height=1.5*P+"px";Hh.left=M+28+3+"px";Hh.top=K+2+"px";og.width=D;og.height=P;og.checked=Z.initialSync}}var $f=document.getElementById("progressTextBox");if($f){var Gd=$f.style;Gd&&(bd?Gd.display="none":(Gd.display="inline-block",
Gd.width=R+"px",Gd.height=Aa+"px",Gd.left=k-parseFloat(qa.style.left)-parseFloat(Gd.width)+"px",Gd.top=(l-parseFloat(Gd.height))/2+"px"))}};this.syncSliderToViewportZoom=function(a){n(a)};this.syncImageFilterPanel=function(b,e,f){F.setImageFilterSlider(b,e,f);F.setImageFilterText(b,e);a.setImageFilterValuePrior(b,e)};this.clearImageFilterInPanel=function(a,b){var e=document.getElementById("imageFilterList");if(e){var f=b?e.options.length-1:Z.Utils.arrayIndexOfObjectValue(e.options,"value",a);if(-1!=
f&&(e.options.remove(f),e.options.length>f&&e.options[f].value==e.options[f-1].value)){var g=e.options[f-1].text,k=e.options[f].text,g=g.substring(0,g.indexOf(":\u00a0\u00a0")+2),l=k.substring(k.indexOf(":\u00a0\u00a0")+3,k.length),k=k.substring(k.indexOf(":\u00a0\u00a0")+3,k.length),k=parseFloat(k)+parseFloat(l);e.options[f-1].text=g+k.toString();e.options.remove(f)}2==e.options.length&&(e.options[e.options.length]=new Option("\u00a0\u00a0None","null"))}if("grayscale"==a||"threshold"==a||"inversion"==
a||"normalize"==a||"equalize"==a||"edges"==a||"sepia"==a){if(e="checkboxFilter"+Z.Utils.stringUpperCaseFirstLetter(a),e=document.getElementById(e))e.checked=!1}else if(e=(f="2"==a.substring(a.length-1))?"2":"",g=f?a.substring(0,a.length-1):a,f=-1==a.indexOf("gamma")?0:1,F.setImageFilterSlider(g,f),e=document.getElementById(g+"TextElement"+e))e.value=f};this.setImageFilterSlider=function(b,e,f){var g="2"!=b.substring(b.length-1)?b:b.substring(0,b.length-1);if(Z[g+"Visible"]){g=a.getImageFilterRangeMaxAbsolute(b);
e/=g;switch(b){case "brightness":e+=.5;break;case "contrast":e+=.3333;break;case "colorRed":e+=.5;break;case "colorGreen":e+=.5;break;case "colorBlue":e+=.5;break;case "saturation":e+=.5;break;case "lightness":e+=.5}Z.Toolbar.setFilterSliderReferences(b);"undefined"!==typeof Pa&&"undefined"!==typeof Ba&&(b=parseFloat(Pa.left),g=parseFloat(Pa.left)+parseFloat(Pa.width)-parseFloat(Ba.width),e=e*(g-b)+b,e<b&&(e=b),e>g&&(e=g),(f?f:Ba).left=e+"px")}};this.setImageFilterText=function(a,b){var e="2"==a.substring(a.length-
1),f=e?"2":"",e=e?a.substring(0,a.length-1):a;if(Z[e+"Visible"]){-1==a.indexOf("gamma")&&(b=Math.round(b));var g=b.toString();document.getElementById(e+"TextElement"+f).value=g}};this.setFilterSliderReferences=function(a){Fb=null;switch(a){case "brightness":$d&&(Za=$d,Pa=$d.style,ab=Eb,Ba=Eb.style);break;case "contrast":ae&&(Za=ae,Pa=ae.style,ab=ub,Ba=ub.style);break;case "sharpness":Sc&&(Za=Sc,Pa=Sc.style,ab=Fc,Ba=Fc.style);break;case "blurriness":Gc&&(Za=Gc,Pa=Gc.style,ab=qe,Ba=qe.style);break;
case "colorRed":gc&&(Za=gc,Pa=gc.style,ab=Cd,Ba=Cd.style);break;case "colorGreen":Ud&&(Za=Ud,Pa=Ud.style,ab=Ae,Ba=Ae.style);break;case "colorBlue":ec&&(Za=ec,Pa=ec.style,ab=Uc,Ba=Uc.style);break;case "colorRedRange":sc&&(Za=sc,Pa=sc.style,ab=xc,Ba=xc.style,Fb=btfCRR2.style);break;case "colorRedRange2":sc&&(Za=sc,Pa=sc.style,ab=btfCRR2,Ba=btfCRR2.style,Fb=xc.style);break;case "colorGreenRange":ce&&(Za=ce,Pa=ce.style,ab=vf,Ba=vf.style,Fb=btfCGR2.style);break;case "colorGreenRange2":ce&&(Za=ce,Pa=ce.style,
ab=btfCGR2,Ba=btfCGR2.style,Fb=vf.style);break;case "colorBlueRange":dc&&(Za=dc,Pa=dc.style,ab=ye,Ba=ye.style,Fb=btfCBR2.style);break;case "colorBlueRange2":dc&&(Za=dc,Pa=dc.style,ab=btfCBR2,Ba=btfCBR2.style,Fb=ye.style);break;case "gamma":wf&&(Za=wf,Pa=wf.style,ab=Vf,Ba=Vf.style);break;case "gammaRed":be&&(Za=be,Pa=be.style,ab=Ne,Ba=Ne.style);break;case "gammaGreen":r&&(Za=r,Pa=r.style,ab=Da,Ba=Da.style);break;case "gammaBlue":Rb&&(Za=Rb,Pa=Rb.style,ab=Jd,Ba=Jd.style);break;case "hue":Id&&(Za=Id,
Pa=Id.style,ab=Dd,Ba=Dd.style);break;case "saturation":Md&&(Za=Md,Pa=Md.style,ab=Wg,Ba=Wg.style);break;case "lightness":vg&&(Za=vg,Pa=vg.style,ab=yg,Ba=yg.style);break;case "whiteBalance":Me&&(Za=Me,Pa=Me.style,ab=zg,Ba=zg.style);break;case "noise":Ce&&(Za=Ce,Pa=Ce.style,ab=ff,Ba=ff.style)}};this.syncSliderToViewportImageSet=function(a){fa(a)};this.z457=function(a){N(a)};this.backgroundEventsHandler=function(a){a=Z.Utils.event(a);if(a=Z.Utils.relatedTarget(a)){var b=a.parentNode;b&&(b=b.id)&&(la||
Db||ib||-1==b.indexOf("button")||-1!=b.indexOf("buttonContainer")||Z.Utils.setButtonDefaults(a.parentNode))}};this.positionButtonBorder=function(a){var b=Z.annotationFileShared?"0":V;if("buttonColor"==a.substr(0,11))var e=document.getElementById("buttonBorderSm"+b);else if(a=="buttonViewMode"+b||a=="buttonEditModeFieldOfView"+b||a=="buttonEditModeText"+b||a=="buttonEditModeShape"+b||a=="buttonEditModeFreehand"+b||a=="buttonEditModePolygon"+b||a=="buttonEditModeMeasure"+b)e=document.getElementById("buttonBorderLg"+
b);var f=document.getElementById(a);e&&f&&(a=="buttonClearAll"+b&&(f=document.getElementById("buttonViewMode"+tbViewportID)),a=e.style,f=f.style,a.left=parseFloat(f.left)-2+"px",a.top=parseFloat(f.top)-2+"px")};this.showImageFilterPanel=function(a){var b=document.getElementById("imageFilterPanelBackground"),e=document.getElementById("buttonContainerImageFilter"),f=document.getElementById("buttonImageFilterPanelShow"),g=document.getElementById("buttonImageFilterPanelHide");b&&e&&f&&g&&(b.style.width=
a?ld+"px":"0px",e.style.display=a?"inline-block":"none",f.style.display=a?"none":"inline-block",g.style.display=a?"inline-block":"none");Qd=a};this.addFilterToImageFilterList=function(a,b,e,f){var g=document.getElementById("imageFilterList");if(g){var k=Z.Utils.stringUpperCaseFirstLetter(a),l=Z.Utils.arrayIndexOfObjectValueSubstring(g.options,"text",k),r="\u00a0\u00a0"+k;"\u00a0\u00a0None"==g.options[g.options.length-1].text&&g.options.remove(g.options.length-1);k="";"undefined"!==typeof b&&null!==
b&&(k=Z.Utils.roundToFixed(b,3).toString());b="";"undefined"!==typeof e&&null!==e&&(b="-"+Z.Utils.roundToFixed(e,3).toString());f?(a=g.options[l].text,a=a.substring(0,a.indexOf(":\u00a0\u00a0")+3),g.options[l].text=a+k+b):-1==g.options[g.options.length-1].text.toLowerCase().indexOf(a.toLowerCase())?(g.options[g.options.length]=new Option(r,a),Z.Utils.stringValidate(k)&&(g.options[g.options.length-1].text+=":\u00a0\u00a0"+k+b)):(a=g.options[g.options.length-1].text,a=a.substring(0,a.indexOf(":\u00a0\u00a0")+
3),g.options[g.options.length-1].text=a+k+b)}}};
Z.ZoomifyNavigator=function(a){function b(){"undefined"===typeof bb&&(Z.clearCallback(Z.comparison&&"0"!=R?"navigator2TileLoaded":"navigatorTileLoaded",b),e(),D||(D=!0,Z.Utils.validateCallback("navigatorInitialized"),Z.Viewer.validateViewerReady("navigatorInitialized")),n())}function e(b){"unconverted"!=Z.tileSource?bb="undefined"!==typeof b&&null!==b?b:a.getNavigatorImage():Z.useCanvas&&(bb=a.createUnconvertedImageThumbnail(b));if(pa&&bb){b=Z.Utils.createContainerElement("div","testImageContainer",
"inline-block","absolute","hidden",ya+"px",Ra+"px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);b.appendChild(bb);b.removeChild(bb);b=bb.width;var e=bb.height;0!=b&&0!=e?(pa.innerHTML="",pa.appendChild(bb),bb.alt=Ab,bb.id="navigatorImage",F=bb,g(ya,Ra,Va,jb,Lb,b,e)):window.setTimeout(u.drawNavigatorImage,100)}else window.setTimeout(u.drawNavigatorImage,100)}function f(){D&&(N&&(window.clearInterval(N),N=null),da&&S&&xa&&La&&pa&&Ha&&F&&ca&&V||(da=ja,S=da.style,xa=ja.firstChild,
La=xa.style,pa=ja.childNodes[1],Ha=pa.style,F=ja.childNodes[1].firstChild,ca=ja.childNodes[2],V=ca.style))}function g(b,e,f,g,l,n,u){l||(l=Lb);if("undefined"===typeof b||null===b)b=Z.navigatorW;if("undefined"===typeof e||null===e)e=Z.navigatorH;if("undefined"===typeof f||null===f)f=0;if("undefined"===typeof g||null===g)g=0;da||(da=ja);S||(S=da.style);"undefined"!==typeof n&&null!=n&&"undefined"!==typeof u&&null!=u&&(F=da.childNodes[1].firstChild);F&&(0==F.width&&"undefined"!==n&&null!==n&&(F.width=
n),0==F.height&&"undefined"!==u&&null!==u&&(F.height=u));da&&S&&F&&(Z.tracking&&(l=0),"undefined"!==typeof l&&null!==l&&(n=F.width/F.height,u=Z.viewerW/Z.viewerH,l=0==l?u:n,1<n?e=b/l:(b=e,b*=l)),S.width=b+"px",S.height=e+"px",Z.narrative&&(f+=Z.narrativeW+15,g+=15),S.left=f+"px",S.top=g+"px",k(b,e));Z.navigatorW=b;Z.navigatorH=e;if(Z.tracking||Z.annotations||Z.narrative)Z.Ruler&&Z.Ruler.getInitialized()&&(f=-1==Z.rulerL&&Z.Navigator?Z.navigatorL:Z.rulerL,g=-1==Z.rulerT&&Z.Navigator?Z.navigatorT+Z.navigatorH+
1:Z.rulerT,Z.Ruler.setSizeAndPosition(Z.rulerW,Z.rulerH,f,g)),Z.userPanelVisible&&null!==Z.UserPanel&&(b=Z.rulerW,e=parseInt(Z.Utils.getResource("DEFAULT_USERPANELHEIGHT"),10),f=Z.Utils.calculateUserPanelCoords(Z.userPanelPosition,b,e,Z.viewerW,Z.viewerH),Z.Utils.sizeAndPositionUserPanel(Z.UserPanel.style,b,e,f.x,f.y)),Z.imageList&&a.getStatus("initializedImageList")&&(a.setSizeAndPositionImageList(),Z.comparison&&(b=0==a.getViewportID()?Z.Viewport1:Z.Viewport0)&&b.getStatus("initializedImageList")&&
b.setSizeAndPositionImageList())}function k(a,b){F||(F=ja.childNodes[1].firstChild);if(F&&0!=F.width&&0!=F.height){if(La||(La=ja.firstChild.style),Ha||(Ha=ja.childNodes[1].style),La&&Ha&&(La.width=a+"px",La.height=b+"px",l(a,b),Ha.width=F.width+"px",Ha.height=F.height+"px",Ha.left=(a-F.width)/2+"px",Ha.top=(b-F.height)/2+"px",n(),Z.comparison)){if(!e)var e=document.getElementById("navigatorBorder"+R);e&&(e=e.style,e.width=a-2+"px",e.height=b-2+"px",e.left=parseFloat(La.left)+"px",e.top=parseFloat(La.top)+
"px",e.display=R==Z.viewportCurrentID?"inline-block":"none")}}else window.setTimeout(function(){k(a,b)},100)}function l(a,b){F||(F=ja.childNodes[1].firstChild);if(F){var e=F.width,f=F.height,g=e/f,k=a/e,l=b/f;k<=l?(e=a,f=a/g,navImageT=(b-a/e*f)/2):l<k&&(f=b,e=b*g,navImageL=(a-b/f*e)/2);F.width=e;F.height=f}}function E(a){!S&&ja&&(S=ja.style);S&&(S.display=a?"inline-block":"none")}function n(){if(a&&a.getStatus("initializedViewport")){G();w();var b=a.calculateCurrentCenterCoordinates();K(b)}}function w(){if(F&&
V){var b=F.width/Z.imageW,e=F.height/Z.imageH,f=a.getZoom(Z.comparison&&R!=Z.viewportCurrentID),b=Z.viewerW*b/f;Z.comparison&&(b/=2);e=Z.viewerH*e/f;V.width=b+"px";V.height=e+"px"}}function G(){!Ha&&ja&&(Ha=ja.childNodes[1].style);if(Ha){var b=a.getRotation();Z.Utils.rotateElement(Ha,b,!0)}}function K(a){if(F&&V&&Ha){if("undefined"===typeof a||null===a||0==a.x&&0==a.y)a=new Z.Utils.Point(Z.imageX,Z.imageY);if("undefined"===typeof z||null===z)z=Z.imageZ;var b=Z.imageR;0>b&&(b+=360);var e=parseFloat(F.width),
f=parseFloat(F.height),b=Z.Utils.rotatePoint(e/Z.imageW*a.x-e/2,f/Z.imageH*a.y-f/2,-b);a=b.x-parseFloat(V.width)/2;e=b.y-parseFloat(V.height)/2;b=parseFloat(S.width)/2;e=parseFloat(S.height)/2+e-1;V.left=b+a+(Z.comparison?-1:0)+"px";V.top=e+"px"}}function W(b){if(F&&V&&Ha){b=Z.imageR;0>b&&(b+=360);var e=parseFloat(V.left),f=parseFloat(V.top),g=parseFloat(S.width)/2,k=parseFloat(S.height)/2,f=f-k,e=e-g+parseFloat(V.width)/2,g=f+parseFloat(V.height)/2;b=Z.Utils.rotatePoint(e,g,b);e=parseFloat(F.width);
g=parseFloat(F.height);f=e/Z.imageW;b=new Z.Utils.Point((b.x+e/2)/f,(b.y+g/2)/f);a.syncViewportToNavigator(b)}}function J(b){Z.interactive&&(a.zoomAndPanAllStop(!1,!0),Z.mouseIsDown=!0,Z.comparison&&Z.Viewer.viewportSelect(parseInt(R,10)),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask(),da&&ca&&V&&(b=Z.Utils.event(b),ca.mouseXPrior=b.clientX,ca.mouseYPrior=b.clientY,dragPtStart=new Z.Utils.Point(b.clientX,b.clientY),Z.Utils.addEventListener(da,"mousemove",oa),Z.Utils.addEventListener(da,
"mouseup",ga),Z.Utils.addEventListener(document,"mouseup",ga)))}function oa(a){if(Z.interactive&&ca&&V){var b=parseFloat(V.left),e=parseFloat(V.top);V.left=b+(a.clientX-ca.mouseXPrior)+"px";V.top=e+(a.clientY-ca.mouseYPrior)+"px";ca.mouseXPrior=a.clientX;ca.mouseYPrior=a.clientY;W(!1);return!1}}function ga(b){if(Z.interactive&&(Z.mouseIsDown=!1,da&&ca&&V)){document.mousemove=null;document.mouseup=null;Z.Utils.removeEventListener(da,"mousemove",oa);Z.Utils.removeEventListener(da,"mouseup",ga);Z.Utils.removeEventListener(document,
"mouseup",ga);b=Z.Utils.event(b);var e=new Z.Utils.Point(b.clientX,b.clientY);if(e=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,e.x,e.y)<qa){var f=Z.Utils.getElementPosition(ja);V.left=b.clientX-f.x-parseFloat(V.width)/2+"px";V.top=b.clientY-f.y-parseFloat(V.height)/2+"px"}W(e);Z.comparison&&e||a.updateView()}}function ma(a){Z.interactive&&(Z.mouseIsDown=!0,a.preventDefault(),da&&ca&&V&&(a=Z.Utils.getFirstTouch(a)))&&(a=new Z.Utils.Point(a.pageX,a.pageY),dragPtStart=new Z.Utils.Point(a.x,
a.y),ca.mouseXPrior=a.x,ca.mouseYPrior=a.y)}function fa(a){if(Z.interactive&&(a.preventDefault(),Z.mousePan)){if(ca&&V&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);var b=parseFloat(V.left),e=parseFloat(V.top);V.left=b+(a.x-ca.mouseXPrior)+"px";V.top=e+(a.y-ca.mouseYPrior)+"px";ca.mouseXPrior=a.x;ca.mouseYPrior=a.y;W(!1)}return!1}}function v(b){if(Z.interactive&&(Z.mouseIsDown=!1,da&&ca&&V)){if(b=Z.Utils.getFirstTouch(b)){b=new Z.Utils.Point(b.pageX,b.pageY);var e=new Z.Utils.Point(b.x,
b.y);if(e=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,e.x,e.y)<Ua){var f=Z.Utils.getElementPosition(ja);V.left=b.x-f.x-parseFloat(V.width)/2+"px";V.top=b.y-f.y-parseFloat(V.height)/2+"px"}}W(e);a.updateView()}}function C(b){if(Z.interactive&&(Z.mouseIsDown=!1,da&&ca&&V)){if(b=Z.Utils.getFirstTouch(b)){b=new Z.Utils.Point(b.pageX,b.pageY);var e=new Z.Utils.Point(b.x,b.y);if(e=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,e.x,e.y)<Ua){var f=Z.Utils.getElementPosition(ja);
V.left=b.x-f.x-parseFloat(V.width)/2+"px";V.top=b.y-f.y-parseFloat(V.height)/2+"px"}}W(e);a.updateView()}}var u=this,D=!1,R=a.getViewportID().toString(),N,ja,da,S,xa,La,pa,Ha,F,ca,V,bb,Ab=Z.Utils.getResource("z439"),qa=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDNAVIGATOR"),10),Ua=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDNAVIGATOR"),10),ya=Z.navigatorW,Ra=Z.navigatorH,Va=Z.navigatorL,jb=Z.navigatorT,Lb=Z.navigatorFit;Z.comparison&&"1"==R&&(Va=Z.viewerW-ya-1);(function(){ja=
Z.Utils.createContainerElement("div","navigatorDisplay"+R,"inline-block","absolute","hidden",ya+"px",Ra+"px",Va+"px",jb+"px","solid","1px","transparent","0px","0px","normal",null,!0);da=Z.NavigatorDisplay=ja;S=da.style;Z.slideshow&&Z.Utils.setOpacity(Z.NavigatorDisplay,0);S.zIndex=(Z.baseZIndex+4).toString();var e=parseFloat(Z.Utils.getResource("z82")),f=Z.Utils.getResource("z83"),k=Z.Utils.getResource("z83NOALPHA"),f=Z.Utils.createContainerElement("div","navigatorBackground","inline-block","absolute",
"hidden",ya+"px",Ra+"px","0px","0px","none","0px",f,"0px","0px","normal",null,!0);Z.Utils.setOpacity(f,e,k);ja.appendChild(f);xa=f;La=xa.style;e=Z.Utils.createContainerElement("div","navigatorImageContainer","inline-block","absolute","hidden",ya+"px",Ra+"px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);ja.appendChild(e);pa=e;Ha=pa.style;e=Z.Utils.createContainerElement("div","navigatorRectangle","inline-block","absolute","hidden",ya+1+"px",Ra+1+"px",Va+"px",jb+"px","solid",
"1px","transparent","0px","0px","normal",null,!0);e.style.borderColor=Z.Utils.stringValidateColorValue(Z.navigatorRectangleColor);ja.appendChild(e);ca=e;V=ca.style;Z.comparison&&(e=Z.Utils.getResource("DEFAULT_NAVIGATORBORDERCOLOR"),k=Z.Utils.createContainerElement("div","navigatorBorder"+R,"inline-block","absolute","hidden",ya+1+"px",Ra+1+"px",Va+"px",jb+"px","solid","1px","transparent","0px","0px","normal",null,!0),k.style.borderColor=Z.Utils.stringValidateColorValue(e),ja.appendChild(k),nBO=k,
nboS=xa.style);Z.ViewerDisplay.appendChild(ja);g(ya,Ra,Va,jb,Lb,null,null);E(1==Z.navigatorVisible||2==Z.navigatorVisible);Z.Utils.addEventListener(da,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(da,"mousedown",J);Z.Utils.addEventListener(da,"touchstart",ma);Z.Utils.addEventListener(da,"touchmove",fa);Z.Utils.addEventListener(da,"touchend",v);Z.Utils.addEventListener(da,"touchcancel",C);a&&(a.getStatus("precacheLoadedViewport")||"unconverted"==Z.tileSource)?b():Z.setCallback(Z.comparison&&
"0"!=R?"navigator2TileLoaded":"navigatorTileLoaded",b)})();this.drawNavigatorImage=function(a){e(a)};this.drawNavigatorImage=function(a){e(a)};this.setImage=function(){Z.tracking&&ja&&0<ja.childNodes.length&&ja.removeChild(navigatorTrackingOverlay);e()};this.getInitialized=function(){return D};this.setVisibility=function(a){E(a)};this.setSelected=function(a){if(!b)var b=document.getElementById("navigatorBorder"+R);b&&(b.style.display=a?"inline-block":"none")};this.syncToViewport=function(){n()};this.z657=
function(){w()};this.z659=function(){G()};this.z658=function(a){K(a)};this.setViewport=function(b){a=b;R=a.getViewportID().toString();Z.overlays||u.setImage()};this.drawNavigatorTrackingOverlay=function(b,e){var f=document.getElementById("navigatorTrackingOverlay");if("undefined"===typeof f||null===f)f=Z.Utils.createContainerElement("div","navigatorTrackingOverlay","none","absolute","visible",ya+1+"px",Ra+1+"px",Va+"px",jb+"px","none","0px","transparent","0px","0px","normal",null,!0),ja.appendChild(f);
if(f){for(;f.hasChildNodes();)f.removeChild(f.lastChild);if("undefined"===typeof e||null===e)e=Z.Navigator.getSizeAndPositionNavigatorImage();if(e)for(var g=e.height/Z.imageH,k=Math.round(e.width/Z.imageW*Z.viewerW),g=Math.round(Z.viewerH*g),l=0,n=b.length;l<n;l++){if(b[l].complete){var v=a.getCoordinatesFromTrackingCellID(b[l].id);if(null!==v.x&&null!==v.y&&null!==v.z){var D=v.z/100,C=k/D,w=g/D,F=Math.floor(v.x*C),v=Math.floor(v.y*w),C=F+C<=e.width?C:e.width-F,w=v+w<=e.height?w:e.height-v,E="cellComp"+
l.toString(),D=getTrackingOverlayColor(D);f[E]=Z.Utils.createContainerElement("div",E,"inline-block","absolute","visible",C+"px",w+"px",F+"px",v+"px","solid","1px",D,"0px","0px","normal",null,!0);f.appendChild(f[E]);Z.Utils.setOpacity(f[E],.25)}}}else window.setTimeout(function(){u.drawNavigatorTrackingOverlay(b)},10)}};getTrackingOverlayColor=function(a){a=Z.Utils.convertZoomPercentToMagnification(100*a,Z.sourceMagnification,!0);return Z.Utils.stringValidateColorValue(Z.Utils.getResource("UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER"+
(2>a?"1":4>a?"2":10>a?"4":16>a?"10":25>a?"16":40>a?"25":60>a?"40":100>a?"60":"INFINITY")))};this.z682=function(){D?f():N=window.setInterval(f,300)};this.setSizeAndPosition=function(a,b,e,f,k,l,n){g(a,b,e,f,k,l,n)};this.getSizeAndPositionNavigatorImage=function(){F||(F=ja.childNodes[1].firstChild);var a=null;"undefined"!==typeof F.parentNode&&null!==F.parentNode&&(a=F.parentNode.style,a={width:F.width,height:F.height,left:parseFloat(a.left)-1,top:parseFloat(a.top)-1});return a}};
Z.ZoomifyGallery=function(a){function b(a){Ua=Z.viewportCurrent.getSlides();for(var b=0,e=Ua.length;b<e;b++)f(null,null,Ua[b]);a()}function e(a){for(var b=0,e=Z.imageSetLength;b<e;b++)f(null,Z["Viewport"+b.toString()]);a()}function f(b,e,g){var k="undefined"!==typeof e&&null!==e?!1:!0,l=k?a:e,n=Z.slideshow&&"undefined"!==typeof g&&null!==g;if("unconverted"!=Z.tileSource){if(Ra="ZoomifyImageFolder"==Z.tileSource?n?Z.Utils.cacheProofPath(g.media+"/TileGroup0/0-0-0."+Z.tileType):Ra=Z.Utils.cacheProofPath(l.getImagePath()+
"/TileGroup0/0-0-0."+Z.tileType):n?null:l.formatTilePath(0,0,0),null!==Ra)if(Va=null,Va=new Image,Va.onload=b,Va.onerror=K,"offsetLoading"!=Ra){if(Z.slideshow||!k)k=n?g.internalID:e.getViewportID().toString(),g=n?g.name:e.getViewportID().toString(),ya[ya.length]={internalID:k,image:Va,name:g};"ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource&&null===Z.tileHandlerPathFull?(g=new Z.NetConnector,l=l.getViewportID(),g.loadImage(Ra,Z.Utils.createCallback(null,b),"loadingGalleryThumbnail",
"gallery",null,l)):Va.src=Ra}else window.setTimeout(function(){f(b)},100)}else"undefined"!==typeof unconvertedImage&&null!==unconvertedImage?(Va=l.createUnconvertedImageThumbnail(unconvertedImage),k&&"function"===typeof b?b():ya[ya.length]="undefined"!==typeof e?{id:e.getViewportID().toString(),image:Va}:{id:null,image:null}):window.setTimeout(function(){f(b,e)},100)}function g(){var a=ya&&Ua&&ya.length==Ua.length;a&&(a=Z.Utils.arrayImageLoadingValidate(ya));a?l():window.setTimeout(function(){g()},
100)}function k(){var a=ya&&Ua&&ya.length==Ua.length;a&&(a=Z.Utils.arrayImageLoadingValidate(ya));if(a)if(a=Z.Utils.arrayIndexOfObjectValue(ya,"internalID","0"),-1!=a){a=ya[a].image;Va=a.cloneNode(!1);a=null;if("undefined"===typeof b)var b=null;l()}else window.setTimeout(function(){k()},100);else window.setTimeout(function(){k()},100)}function l(a,b){"undefined"!==typeof b&&null!==b&&(Va=b);pa=Z.Utils.createContainerElement("div","galleryDisplay","inline-block","absolute","hidden","1px","1px","0px",
"0px","solid","1px","transparent","0px","0px","normal",null,!0);F=Z.GalleryDisplay=pa;ca=F.style;Z.slideshow&&Z.Utils.setOpacity(Z.GalleryDisplay,0);ca.zIndex=(Z.baseZIndex+12).toString();var e=parseFloat(Z.Utils.getResource("DEFAULT_GALLERYBACKGROUNDALPHA")),f=Z.Utils.getResource("DEFAULT_GALLERYBACKGROUNDCOLOR"),g=Z.Utils.getResource("DEFAULT_GALLERYBACKGROUNDCOLORNOALPHA"),f=Z.Utils.createContainerElement("div","galleryBackground","inline-block","absolute","hidden","1px","1px","0px","0px","none",
"0px",f,"0px","0px","normal",null,!0);Z.Utils.setOpacity(f,e,g);pa.appendChild(f);gB=f;V=gB.style;e=Z.Utils.createContainerElement("div","galleryScrollPanel","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);Z.GalleryScrollPanel=e;Va.alt=Z.Utils.getResource("UI_GALLERYACCESSIBILITYALTATTRIBUTE");pa.appendChild(e);bb=e;gspS=bb.style;e=Z.Utils.createContainerElement("div","galleryRectangle","inline-block","absolute","hidden","1px","1px",
"0px","0px","solid","2px","transparent","0px","0px","normal",null,!0);e.style.borderColor=Z.Utils.stringValidateColorValue(Z.galleryRectangleColor);pa.appendChild(e);Ab=e;qa=Ab.style;Z.ViewerDisplay.appendChild(pa);n();w(1==Z.galleryVisible||2==Z.galleryVisible);Z.Utils.addEventListener(F,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(F,"mousedown",W);Z.Utils.addEventListener(document,"touchstart",ma);Z.Utils.addEventListener(document,"touchmove",fa);Z.Utils.addEventListener(document,
"touchend",v);Z.Utils.addEventListener(document,"touchcancel",C);for(var k,l,f=parseFloat(Z.GalleryDisplay.style.height),E=parseFloat(Z.GalleryDisplay.style.width),gb=Z.galleryM,B=gb,N=gb,R=0,J=ya.length;R<J;R++){var K=Z.Utils.createContainerElement("div","imgContainer"+R.toString(),"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);K.appendChild(ya[R].image);g=K.firstChild;k=g.width;l=g.height;Z.GalleryScrollPanel.appendChild(K);giC=
K;gicS=giC.style;g.title=ya[R].name;e=Math.round(f-2*gb);l=e/l;k=Math.round(k*l);g.width=k;g.height=e;K.style.width=k+"px";K.style.height=e+"px";K.style.left=N+"px";K.style.top=gb+"px";B+=k+gb;N+=k+gb;Z.Utils.addEventListener(K,"mouseup",ga);Z.Utils.addEventListener(K,"touchend",u);Z.Utils.addEventListener(K,"touchcancel",D)}gspS.width=B+"px";gspS.height=f+"px";gspS.left=B<E?(E-B)/2+"px":"0px";S.syncGalleryToViewport(Z.slideshow?0:Z.imageSet?Z.viewportCurrentID:0);Z.Utils.setOpacity(Z.GalleryDisplay,
1);w(!0);xa||(xa=!0,Z.Utils.validateCallback("galleryInitialized"),Z.Viewer.validateViewerReady("galleryInitialized"))}function E(){xa&&(La&&(window.clearInterval(La),La=null),F&&ca&&gB&&V&&Ab&&qa||(F=pa,ca=F.style,gB=pa.firstChild,V=gB.style,Ab=pa.childNodes[2],qa=Ab.style))}function n(a,b,e,f){var g=Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.toolbarPosition==Z.galleryPosition?Z.toolbarH+2:0;if("undefined"===typeof a||null===a)a=-1!=Z.galleryW?Z.galleryW:Z.viewerW;if("undefined"===
typeof b||null===b)b=Z.galleryH;if("undefined"===typeof e||null===e)e=0;if("undefined"===typeof f||null===f)f=-1!=Z.galleryT?Z.galleryT:0==Z.galleryPosition?g:Z.viewerH-g-Z.galleryH;F||(F=pa);ca||(ca=F.style);F&&ca&&(ca.width=a+"px",ca.height=b+"px",ca.left=e-1+"px",ca.top=f+"px",V||(V=pa.firstChild.style),V&&(V.width=2*a+"px",V.height=b+"px",V.left="0px"))}function w(a){!ca&&pa&&(ca=pa.style);ca&&(ca.display=a?"inline-block":"none")}function G(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a)){a=a.parentNode.id;
var b=a.indexOf("imgContainer");-1!=b&&(a=a.substring(b+12,a.length),Z.slideshow?(Z.slideshowPlaying&&Z.viewportCurrent.slideshowStop(),Z.viewportCurrent.goToSlide(a,null,null,!0)):Z.imageSet&&Z.Viewer.viewportSelect(parseInt(a,10)))}}function K(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_GALLERYIMAGEPATHINVALID"))}function W(b){if(b=Z.Utils.event(b))a.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask(),Z.mouseIsDownGallery=!0,dragPtStart=Z.Utils.getMousePosition(b),
Aa=dragPtStart.x,Z.Utils.removeEventListener(F,"mousedown",W),Z.Utils.addEventListener(document,"mousemove",J),Z.Utils.addEventListener(document,"mouseup",oa),R()}function J(a){if(a=Z.Utils.event(a))Aa=Z.Utils.getMousePosition(a).x}function oa(a){if(a=Z.Utils.event(a))Z.mouseIsDownGallery=!1,Z.Utils.removeEventListener(document,"mousemove",J),Z.Utils.removeEventListener(document,"mouseup",oa),Z.Utils.addEventListener(F,"mousedown",W)}function ga(a){if(a=Z.Utils.event(a)){var b=Z.Utils.getMousePosition(a),
b=Z.mouseOutDownPointGallery?Z.mouseOutDownPointGallery:new Z.Utils.Point(b.x,b.y);Math.abs(b.x-dragPtStart.x)<jb&&G(a)}}function ma(b){if(b=Z.Utils.event(b))if(b.preventDefault(),b=Z.Utils.getFirstTouch(b))a.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask(),Z.mouseIsDownGallery=!0,b=new Z.Utils.Point(b.pageX,b.pageY),dragPtStart=new Z.Utils.Point(b.x,b.y),Aa=dragPtStart.x,R()}function fa(a){if(a=Z.Utils.event(a))if(a.preventDefault(),a=Z.Utils.getFirstTouch(a))Aa=
a.pageX;return!1}function v(a){if(a=Z.Utils.event(a))a.preventDefault(),Z.mouseIsDownGallery=!1}function C(a){if(a=Z.Utils.event(a))a.preventDefault(),Z.mouseIsDownGallery=!1}function u(a){if(a=Z.Utils.event(a)){a.preventDefault();var b=Z.Utils.getFirstTouch(a);b&&(b=new Z.Utils.Point(b.pageX,b.pageY),b=Z.mouseOutDownPointGallery?Z.mouseOutDownPointGallery:new Z.Utils.Point(b.x,b.y),Math.abs(b.x-dragPtStart.x)<jb&&G(a))}}function D(a){if(a=Z.Utils.event(a)){a.preventDefault();var b=Z.Utils.getFirstTouch(a);
b&&(b=new Z.Utils.Point(b.pageX,b.pageY),b=Z.mouseOutDownPointGallery?Z.mouseOutDownPointGallery:new Z.Utils.Point(b.x,b.y),Math.abs(b.x-dragPtStart.x)<jb&&G(a))}}function R(){1<Z.smoothPanEasing&&(N(),P=dragPtStart.x,null===ta&&(ta=parseFloat(gspS.left)),null===Lb&&(Lb=window.setInterval(ja,50)))}function N(){null!==Lb&&(window.clearInterval(Lb),Aa=ta=P=Lb=null,Fa=la=0,Qa=Na=null)}function ja(){var a=parseFloat(gspS.left);if(Z.mouseIsDownGallery||Na){var b=(Na?Qa:Aa)-P,e=a-ta;if(!(isNaN(b)||isNaN(e)||
0==b&&0==e)){var f=Na?1:100;la=Math.round((b-e)/(Z.smoothPanEasing*(Na?Z.smoothPanGlide:1))*f/f);Z.mouseIsDownGallery?Fa=la:Math.abs(la)>Math.abs(Fa)&&(smoothPanDeltaX=Fa);a+=la;b=da(a);gspS.left=b+"px";la-=a-b;a=Z.GalleryScrollPanel.childNodes[Ha].style;qa.left=parseFloat(gspS.left)+parseFloat(a.left)-1+"px";Na&&0==Math.round(la*f)/f&&(Na=!1)}}else Z.mouseIsDownGallery||null!==Na||0==la?N():(b=da(a+Fa),Fa=b-a,0!=Fa&&(Qa=Aa+Fa,Na=!0))}function da(a){parseFloat(Z.GalleryScrollPanel.childNodes[Ha].style.width);
var b=parseFloat(ca.width),e=parseFloat(gspS.width);e<b?0>a?a=0:a>=b-e?a=b-e:Z.mouseIsDownGallery||Na||(a=(b-e)/2):0<a?a=0:a<=b-e&&(a=b-e);return a}var S=this,xa=!1;a.getViewportID();var La,pa,Ha,F,ca,V,bb,Ab,qa,Ua=[],ya=[],Ra,Va,jb=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT"),10),Lb=null,P=null,ta=null,Aa=null,la=0,Fa=0,Na=null,Qa=null;Z.slideshow?b(g):Z.imageSet?e(k):f(l);this.initializeGallery=function(a,b){l(a,b)};this.getInitialized=function(){return xa};this.setVisibility=
function(a){w(a)};this.syncGalleryToViewport=function(a){if(Z.GalleryScrollPanel){Ha=a;a=Z.GalleryScrollPanel.childNodes[a].style;var b=parseFloat(ca.width),e=parseFloat(gspS.left),f=parseFloat(a.left),g=parseFloat(a.top),k=parseFloat(a.width),l=parseFloat(a.height),n=f;0>f+e&&(n=-f+1);f+k+e>b&&(console.log(b,e,f,k),n=-(f+k+1-b));n!=f&&(b=da(n),gspS.left=b+"px",e=b,f=parseFloat(a.left));qa.width=k-2+"px";qa.height=l-3+"px";qa.left=f-1+e+"px";qa.top=g+"px"}};this.setViewport=function(b){a=b;a.getViewportID()};
this.validateGalleryGlobals=function(){xa?E():La=window.setInterval(E,300)};this.setSizeAndPosition=function(a,b,e,f){n(a,b,e,f)}};
Z.ZoomifyRuler=function(a){function b(){var a=2*parseFloat(Z.Utils.getResource("z82MORE")),b=Z.Utils.getResource("z83NOALPHA"),e=Z.Utils.getResource("z83"),e=Z.Utils.createContainerElement("div","buttonContainerRulerSettings","inline-block","absolute","visible","0px","0px","0px","0px","none","0px",e,"0px","0px","normal","default",!0);Z.Utils.setOpacity(e,a,b);Z.RulerDisplay.appendChild(e);Z.Utils.addEventListener(e,"mouseover",Z.Toolbar.backgroundEventsHandler);a=Z.Utils.createContainerElement("div",
"rulerSettingsPanelLabelTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);b=document.createTextNode(Z.Utils.getResource("UI_RULERSETTINGSPANELLABEL"));a.appendChild(b);e.appendChild(a);for(var f=Z.Utils.getResource("CONTENT_RULERUNITSCHOICELISTTITLE"),g=Z.Utils.getResource("CONTENT_RULERUNITSCHOICELISTVALUES").split(","),k=[],a=0,b=g.length;a<b;a++)k[a]={text:g[a],value:a};a=new Z.Utils.createSelectElement("unitsList",f,k,
"0px","0px","0px",null,"visible",null,"change");Z.RulerDisplay.appendChild(a);a=Z.Utils.createContainerElement("div","rulerScaleTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);b=document.createTextNode(Z.Utils.getResource("UI_RULERSCALELABEL"));a.appendChild(b);Z.RulerDisplay.appendChild(a);a=Z.Utils.createTextElement("rulerScaleTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,
"hidden","hidden","off");Z.RulerDisplay.appendChild(a);Z.Utils.addEventListener(a.firstChild,"keydown",oa);Z.Utils.addEventListener(a.firstChild,"blur",ga);a=Z.Utils.createContainerElement("div","unitsPerImageTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);b=document.createTextNode(Z.Utils.getResource("UI_RULERUNITSPERIMAGELABEL"));a.appendChild(b);b=new Z.Utils.Radiobutton("radiobuttonUnitsPerImage","units","Units/Image",
"1px","1px","1px","1px",null,null,"TIP_RULERUNITSPERIMAGE");e.appendChild(a);e.appendChild(b);a=Z.Utils.createContainerElement("div","pixelsPerUnitTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);b=document.createTextNode(Z.Utils.getResource("UI_RULERPIXELSPERUNITLABEL"));a.appendChild(b);b=new Z.Utils.Radiobutton("radiobuttonPixelsPerUnit","units","Pixels/Unit","1px","1px","1px","1px",null,null,"TIP_RULERPIXELSPERUNIT");
e.appendChild(a);e.appendChild(b);f=Z.Utils.getResource("CONTENT_RULERLISTTYPELISTTITLE");g=Z.Utils.getResource("CONTENT_RULERLISTTYPELISTVALUES").split(",");k=[];a=0;for(b=g.length;a<b;a++)k[a]={text:g[a],value:a};a=new Z.Utils.createSelectElement("listTypeList",f,k,"0px","0px","0px",null,"visible",null,"change");Z.RulerDisplay.appendChild(a);for(var f=Z.Utils.getResource("CONTENT_RULERSOURCEMAGNIFICATIONLISTTITLE"),g=Z.Utils.getResource("CONTENT_RULERSOURCEMAGNIFICATIONLISTTEXT").split(","),k=Z.Utils.getResource("CONTENT_RULERSOURCEMAGNIFICATIONLISTVALUES").split(","),
l=[],a=0,b=g.length;a<b;a++)l[a]={text:g[a],value:k[a]};a=new Z.Utils.createSelectElement("sourceMagnificationList",f,l,"0px","0px","0px",null,"visible",null,"change");Z.RulerDisplay.appendChild(a);a=Z.Utils.createContainerElement("div","rulerSettingsPanelDivider","inline-block","absolute","visible","1px","1px","1px","1px","none","0px","grey","0px","0px","normal","default");e.appendChild(a);a=new Z.Utils.Button("buttonRulerSettingsCancel",null,Z.skinPath,bc[139],bc[140],bc[141],"1px","1px","1px",
"1px","mouseover",Z.Toolbar.z457,"TIP_RULERSETTINGSCANCEL");e.appendChild(a.elmt);a=new Z.Utils.Button("buttonRulerSettingsSave",null,Z.skinPath,bc[130],bc[131],bc[132],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_RULERSETTINGSSAVE");e.appendChild(a.elmt);ca=document.getElementById("buttonContainerRulerSettings");V=document.getElementById("rulerSettingsPanelLabelTextBox");bb=document.getElementById("unitsList");Ab=document.getElementById("rulerScaleTextBox");qa=document.getElementById("textBoxFor-rulerScaleTextElement");
Ua=document.getElementById("rulerScaleTextElement");ya=document.getElementById("unitsPerImageTextBox");Ra=document.getElementById("containerFor-radiobuttonUnitsPerImage");Va=document.getElementById("pixelsPerUnitTextBox");jb=document.getElementById("containerFor-radiobuttonPixelsPerUnit");Lb=document.getElementById("listTypeList");P=document.getElementById("sourceMagnificationList");ta=document.getElementById("rulerSettingsPanelDivider");Aa=document.getElementById("buttonRulerSettingsCancel");la=
document.getElementById("buttonRulerSettingsSave")}function e(){1==Z.rulerListType&&0!=Fa?(Qa=[],Qa=Z.tracking?[{text:"1.25x",value:1.25},{text:"1.5x",value:1.5},{text:"2x",value:2},{text:"2.5x",value:2.5},{text:"4x",value:4},{text:"5x",value:5},{text:"10x",value:10},{text:"16x",value:16},{text:"20x",value:20},{text:"25x",value:25},{text:"32x",value:32},{text:"40x",value:40},{text:"50x",value:50},{text:"60x",value:60},{text:"100x",value:100},{text:"150x",value:150},{text:"250x",value:250}]:[{text:"1.25x",
value:1.25},{text:"2.5x",value:2.5},{text:"5x",value:5},{text:"10x",value:10},{text:"20x",value:20},{text:"40x",value:40},{text:"60x",value:60},{text:"100x",value:100}]):Qa=[{text:"10%",value:10},{text:"20%",value:20},{text:"30%",value:30},{text:"40%",value:40},{text:"50%",value:50},{text:"60%",value:60},{text:"70%",value:70},{text:"80%",value:80},{text:"90%",value:90},{text:"100%",value:100}]}function f(){var b=100*Z.minZ,e=100*Z.maxZ,f=Math.round(b),g=Math.round(e),k="%";-1==b&&(b=Math.round(100*
a.calcZoomDecimalToFitDisplay()));1==Z.rulerListType&&0!=Fa&&(b=Z.Utils.convertZoomPercentToMagnification(b,Fa),f=Math.round(b),k="x");for(;Qa[0].value<=f;)Qa=Z.Utils.arraySplice(Qa,0,1);-1==e&&(e=Math.round(100*a.calcZoomDecimalToFitDisplay()));1==Z.rulerListType&&0!=Fa&&(e=Z.Utils.convertZoomPercentToMagnification(e,Fa),g=Math.round(e),k="x");for(;Qa[Qa.length-1].value>=g;)Qa=Z.Utils.arraySplice(Qa,Qa.length-1,1);Qa=Z.Utils.arraySplice(Qa,0,0,{text:f.toString()+k+(f==b?"":"~")+"",value:f});Qa[Qa.length]=
{text:g.toString()+k+(g==e?"":"~")+"",value:e};Z.Utils.updateSelectElement(Ha,Qa);Ha.selectedIndex=0}function g(){Z.Toolbar.getSkinArray();Z.Toolbar.getSkinSizes();parseInt(Z.Utils.getResource("z63"),10);var a=Z.rulerW,b=Z.rulerH,e=-1==Z.rulerL&&Z.Navigator?Z.navigatorL:Z.rulerL,f=-1==Z.rulerT&&Z.Navigator?Z.navigatorT+Z.navigatorH+1:Z.rulerT,g=(b-15)/2-1,l=Z.narrativeMode?23:0;kc=0!=Z.rulerListType?a-59-16-l-1:a-10-l;var n=(b-1+5)/2,u=kc/2-5,v=n-10,C="pixels"==Z.units?7:0;D&&N&&rsbnlS&&rsbnrS&&ja&&
da&&S&&xa&&La&&pa&&(k(a,b,e,f),D.width=a+"px",D.height=b+"px",D.left="0px",D.top="0px",F&&(F.width="59px",F.left=a-59-4-l+"px",F.top=(b-20)/2+"px",F.visibility="visible"),N.width=kc+"px",N.height="1px",N.left="6px",N.top=n+3+"px",rsbnlS.width="1px",rsbnlS.height="6px",rsbnlS.left="6px",rsbnlS.top=n+"px",rsbnrS.width="1px",rsbnrS.height="6px",rsbnrS.left=6+kc+"px",rsbnrS.top=n+"px",da.width=kc+"px",da.height="15px",da.left="13px",da.top=v+"px",xa.width=u+"px",xa.height="15px",xa.left=16-C+"px",xa.top=
v+"px",pa.width=u+"px",pa.height="15px",pa.left=kc/2+15-C+"px",pa.top=v+"px");if(Z.narrativeMode){if(b=document.getElementById("buttonRulerSettingsShow"))e=b.style,Z.Utils.buttonSize(b,15,15),e.left=a-15-5-1+"px",e.top=g+"px",b.style.display="inline-block";D&&ca&&V&&bb&&qa&&Ua&&ya&&Ra&&Va&&jb&&Lb&&P&&ta&&Aa&&la&&(b=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSLABELFONTSIZE"),10),f=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSTEXTFONTSIZE"),10),l=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSTEXTPADDINGSMALL"),
10),a=parseInt(D.width,10),n=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSHEIGHT"),10),e=Z.Utils.getResource("black"),g=n-15-8+2,u=ca.style,u.width=a+"px",u.height=n+"px",u.left="0px",u.top="0px",n=V.style,n.width="160px",n.height="20px",n.left="9px",n.top="9px",Z.Utils.setTextNodeStyle(V.firstChild,e,"verdana",b+1+"px","none","normal","normal","normal","normal","1em","left","none"),n=bb.style,n.width="67px",n.height="20px",n.left="8px",n.top="29px",n=Ab.style,n.width="50px",n.height="20px",
n.left=a-50-60+"px",n.top="33px",Z.Utils.setTextNodeStyle(Ab.firstChild,e,"verdana",b+"px","none","normal","normal","normal","normal","1em","left","none"),n=qa.style,n.width="60px",n.height="18px",n.left=a-60-8-2+"px",n.top="29px",Z.Utils.setTextAreaStyle(qa,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","left","none",l+"px"),f=ya.style,f.width="80px",f.height="20px",f.left="10px",f.top="57px",Z.Utils.setTextNodeStyle(ya.firstChild,e,"verdana",b+"px","none","normal","normal",
"normal","normal","1em","left","none"),f=Ra.style,f.width="19px",f.height="19px",f.left="81px",f.top="53px",f=Va.style,f.width="80px",f.height="20px",f.left="110px",f.top="57px",Z.Utils.setTextNodeStyle(Va.firstChild,e,"verdana",b+"px","none","normal","normal","normal","normal","1em","left","none"),b=jb.style,b.width="19px",b.height="19px",b.left=a-19-8-3+"px",b.top="53px",b=Lb.style,b.width="109px",b.height="20px",b.left="8px",b.top="76px",b=P.style,b.width="69px",b.height="20px",b.left="123px",
b.top="76px",b=ta.style,b.width=a-16+"px",b.height="1px",b.left="8px",b.top=g-6+"px",Z.Utils.buttonSize(Aa,15,15),b=Aa.style,b.left=a-30-5-8-3+"px",b.top=g+"px",Z.Utils.buttonSize(la,15,15),b=la.style,b.left=a-15-8-3+"px",b.top=g+"px");K(!1,!1)}else if(b=document.getElementById("buttonRulerSettingsShow"))b.style.display="none"}function k(a,b,e,f){if("undefined"===typeof a||null===a)a=Z.rulerW;if("undefined"===typeof b||null!==b)b=Z.rulerH;if("undefined"===typeof e||null!==e)e=-1==Z.rulerL&&Z.Navigator?
Z.navigatorL:Z.rulerL;if("undefined"===typeof f||null!==f)f=-1==Z.rulerT&&Z.Navigator?Z.navigatorT+Z.navigatorH+1:Z.rulerT;C.width=a+"px";C.height=b+"px";Z.narrative&&(e+=Z.narrativeW+15,f+=15);C.left=e+"px";C.top=f+"px";ib=f}function l(a){C||(C=Z.RulerDisplay.style);C&&(C.display=a?"inline-block":"none")}function E(b){a&&a.getStatus("initializedViewport")&&(n(),w(b))}function n(){var b=a.getZoom(),e="pixels"==Z.units?0:4;if(F){F.visibility="visible";var f;f=0!=Fa?Fa*b:100*b;1>f?Math.round(100*f):
Math.round(f)}f=0;for(var g=Yb.length;f<g;f++)Yb[f].symbol==Z.units&&(Zc=f);bd=null!==Qb&&0!=Qb?Qb:null!==xb&&0!=xb?Z.imageW/xb:1;b=Z.Utils.roundToFixed(kc/bd/b,e);S.firstChild.nodeValue=b.toString();pa.visibility="visible";La.firstChild.nodeValue="um"!=Yb[Zc].symbol?Yb[Zc].symbol:"\u03bcm"}function w(b){b&&e();if(F){var g,k,l=Math.round(100*a.getZoom())==Math.round(1E3*a.getZoom())/1E3*100?"":"~";2==Z.rulerListType?(g=Math.round(100*a.getZoom()),g=Math.round(g),k="%"):1==Z.rulerListType&&0!=Fa&&
(g=100*Z.Utils.convertZoomPercentToMagnification(a.getZoom(),Fa),g=Math.round(g),k="x");l=g.toString()+k+l;for(k=insertIndex=0;g>Qa[k].value;)k++;b&&f();insertIndex=k;if(insertIndex<Qa.length&&g==Qa[insertIndex].value)Z.Utils.updateSelectElement(Ha,Qa);else{var n=Z.Utils.arrayClone("magnifications",Qa,n),n=Z.Utils.arraySplice(n,insertIndex,0,{text:l,value:g.toString()});Z.Utils.updateSelectElement(Ha,n)}Ha.selectedIndex=insertIndex}}function G(b){var e=0;if(b=Z.Utils.event(b))b=Z.Utils.target(b),
e=parseInt(b.options[b.selectedIndex].value,10),isNaN(e)||a.zoomAndPanToView(a.viewX,a.viewY,(1==Z.rulerListType?100*e/Fa:e)/100)}function K(a,b){if(C&&ca&&V&&bb&&Ab&&qa&&Ua&&ya&&Ra&&Va&&jb&&Lb&&P&&Aa&&la){if("undefined"===typeof a||null===a)a="none"==ca.style.display;var e=a?"inline-block":"none";ca.style.display=e;V.style.display=e;bb.style.display=e;Ab.style.display=e;qa.style.display=e;Ua.style.display=e;ya.style.display=e;Ra.style.display=e;Va.style.display=e;jb.style.display=e;Lb.style.display=
e;P.style.display=e;Aa.style.display=e;la.style.display=e;var e=parseInt(Z.Utils.getResource("z191"),10),f=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSHEIGHT"),10);a?(C.height=f+"px",C.top=ib-(f-e)+"px"):(C.height=e+"px",C.top=ib+"px");if(b){if(Z.fileHandlerPath){(e=Z.Viewport.getImageMetadataXML())||(e=Z.Utils.xmlConvertTextToDoc("<IMAGEMETADATA></IMAGEMETADATA>"));f=e.getElementsByTagName("RULER")[0];f||(f=e.createElement("RULER"),e.getElementsByTagName("IMAGEMETADATA")[0].appendChild(f));
Ra.firstChild.checked?(Z.unitsPerImage=Ua.value.toString(),f.setAttribute("UNITSPERIMAGE",Z.unitsPerImage.toString())):(Z.pixelsPerUnit=Ua.value.toString(),f.setAttribute("PIXELSPERUNIT",Z.pixelsPerUnit.toString()));var g=bb.options[bb.selectedIndex].text;Z.units=g;f.setAttribute("UNITS",g.toString());g=Lb.options[Lb.selectedIndex].value;Z.rulerListType=g;f.setAttribute("LISTTYPE",g);g=P.options[P.selectedIndex].value;Z.sourceMagnification=parseFloat(g);f.setAttribute("SOURCEMAGNIFICATION",g);f=e.getElementsByTagName("SIGNATURE")[0];
f||(f=e.createElement("SIGNATURE"),e.getElementsByTagName("IMAGEMETADATA")[0].appendChild(f));f.setAttribute("USER",Z.userName);f.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());Z.imageMetadataXML=e;e=Z.imagePath.substring(0,Z.imagePath.lastIndexOf("."))+".xml";(new Z.NetConnector).postXML(Z.fileHandlerPath,Z.imageMetadataXML,"postingImageMetadata",e)}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_RULERSETTINGSFILEHANDLER"),!0,null,"center");W()}else a||(J(),W())}}function W(){n();w(!0);
a.z623()}function J(){if(bb&&Ab&&Ra&&jb&&P){null!==Z.unitsPerImage?(Ua.value=Z.unitsPerImage,Ra.firstChild.checked=!0):(Ua.value=Z.pixelsPerUnit,jb.firstChild.checked=!0);var a=Z.Utils.arrayIndexOfObjectValue(bb.options,"text",Z.units);-1!=a&&(bb.selectedIndex=a);Lb.selectedIndex=1==Z.rulerListType&&0!=Fa?2:3;a=Z.Utils.arrayIndexOfObjectValue(P.options,"value",Z.sourceMagnification.toString());-1!=a&&(P.selectedIndex=a)}}function oa(a){if((a=Z.Utils.event(a))&&Z.Utils.target(a))switch(a.keyCode){case 8:case 9:case 37:case 38:case 39:case 40:break;
case 13:return a.preventDefault(),!1;default:if(!/^[0-9]+$/.test(a.key)||" "==a.key)return a.preventDefault(),!1}}function ga(a){(a=Z.Utils.event(a))&&Z.Utils.target(a)&&(Z.Viewer.initializeViewerKeyEventListeners(!0),Z.Viewer.initializeViewerKeyDefaultListeners(!0))}var ma=!1,fa=a.getViewportID(),v,C,u,D,R,N,ja,da,S,xa,La,pa,Ha,F,ca,V,bb,Ab,qa,Ua,ya,Ra,Va,jb,Lb,P,ta,Aa,la;Z.Utils.getResource("z442");var Fa=Z.sourceMagnification,Na,Qa=[],xb=Z.unitsPerImage,Qb=Z.pixelsPerUnit,bd=1,Yb=[],Zc=-1,kc=1,
bc=Z.Toolbar.getSkinArray(),ib=0;(function(){Z.RulerDisplay=Z.Utils.createContainerElement("div","RulerDisplay","inline-block","absolute","hidden","1px","1px","0px","0px","solid","1px","transparent","0px","0px","normal");v=Z.RulerDisplay;C=v.style;var k=parseFloat(Z.Utils.getResource("z82")),n=Z.Utils.getResource("z83"),w=Z.Utils.getResource("z83NOALPHA"),n=Z.Utils.createContainerElement("div","rulerBackground","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",n,"0px","0px",
"normal",null,!0);Z.Utils.setOpacity(n,k,w);Z.RulerDisplay.appendChild(n);u=n;D=u.style;k=Z.Utils.getResource("z198");w=Z.Utils.createContainerElement("div","rulerScaleBar","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",k,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(w);R=w;N=R.style;Z.RulerDisplay.style.zIndex=(Z.baseZIndex+8).toString();w=Z.Utils.createContainerElement("div","rulerScaleBarNotchL","inline-block","absolute","hidden","1px","1px","0px","0px","none",
"0px",k,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(w);rSBNL=w;rsbnlS=rSBNL.style;k=Z.Utils.createContainerElement("div","rulerScaleBarNotchR","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",k,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(k);rSBNR=k;rsbnrS=rSBNR.style;k=parseInt(Z.Utils.getResource("z194"),10);w=Z.Utils.createContainerElement("div","errorTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px",
"0px","nowrap",null,!0);n=document.createTextNode("");w.appendChild(n);Z.Utils.setTextNodeStyle(n,"black","verdana",k+"px","none","normal","normal","normal","normal","1em","center","none");Z.RulerDisplay.appendChild(w);ja=w;da=ja.style;w=Z.Utils.createContainerElement("div","scaleTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);n=document.createTextNode("");w.appendChild(n);Z.Utils.setTextNodeStyle(n,"black","verdana",k+"px",
"none","normal","normal","normal","normal","1em","right","none");Z.RulerDisplay.appendChild(w);S=w;xa=S.style;w=Z.Utils.createContainerElement("div","unitTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);n=document.createTextNode("");w.appendChild(n);Z.Utils.setTextNodeStyle(n,"black","verdana",k+"px","none","normal","normal","normal","normal","1em","left","none");Z.RulerDisplay.appendChild(w);La=w;pa=La.style;0!=Z.rulerListType&&
(e(),Na=new Z.Utils.createSelectElement("magnificationList","",Qa,1,1,1,null,!0,G,"change"),Z.RulerDisplay.appendChild(Na),Ha=Na,F=Ha.style,f());Z.ViewerDisplay.appendChild(Z.RulerDisplay);Z.narrativeMode&&(k=new Z.Utils.Button("buttonRulerSettingsShow",null,Z.skinPath,bc[172],bc[173],bc[174],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_RULERSETTINGSSHOW"),Z.RulerDisplay.appendChild(k.elmt),b());Z.narrative&&Z.setCallback("loadingImageMetadataXMLFailed",function(){a.createImageMetadataXML(fa)});
Yb=[{magnitude:Math.pow(10,24),symbol:"Ym"},{magnitude:Math.pow(10,21),symbol:"Zm"},{magnitude:Math.pow(10,18),symbol:"Em"},{magnitude:Math.pow(10,15),symbol:"Pm"},{magnitude:Math.pow(10,12),symbol:"Tm"},{magnitude:Math.pow(10,9),symbol:"Gm"},{magnitude:Math.pow(10,6),symbol:"Mm"},{magnitude:Math.pow(10,3),symbol:"km"},{magnitude:Math.pow(10,2),symbol:"hm"},{magnitude:Math.pow(10,1),symbol:"dam"},{magnitude:Math.pow(10,0),symbol:"m"},{magnitude:Math.pow(10,-1),symbol:"dm"},{magnitude:Math.pow(10,
-2),symbol:"cm"},{magnitude:Math.pow(10,-3),symbol:"mm"},{magnitude:Math.pow(10,-6),symbol:"um"},{magnitude:Math.pow(10,-9),symbol:"nm"},{magnitude:Math.pow(10,-12),symbol:"pm"},{magnitude:Math.pow(10,-15),symbol:"fm"},{magnitude:Math.pow(10,-18),symbol:"am"},{magnitude:Math.pow(10,-21),symbol:"zm"},{magnitude:Math.pow(10,-24),symbol:"ym"},{magnitude:Math.pow(10,-24),symbol:"pixels"}];g();l(Z.rulerVisible);Z.Utils.addEventListener(v,"mouseover",Z.Utils.stopPropagation);ma||(ma=!0,Z.Utils.validateCallback("rulerInitialized"),
Z.Viewer.validateViewerReady("rulerInitialized"));E()})();this.getInitialized=function(){return ma};this.setVisibility=function(a){l(a)};this.setSizeAndPosition=function(a,b,e,f,g){k(a,b,e,f,g)};this.syncToViewport=function(a){E()};this.toggleEditMode=function(){K(!1,!1);g();n()};this.showRulerSettings=function(a,b){K(a,b)};this.updateRulerDisplay=function(){W()};this.populateRulerSettings=function(){J()}};
Z.ZoomifyNarrative=function(){function a(){if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){Z.Toolbar.setSizeAndPosition(Z.toolbarCurrentW,Z.toolbarH,0,1==Z.toolbarPosition?Z.viewerH-Z.toolbarH:0);Z.clearCallback("toolbarInitialized",a);var e=Z.Toolbar.getSkinArray();if(Z.narrativeMode){var f=Z.Utils.createContainerElement("div","narrativePanelEditBorder","inline-block","absolute","visible","1px","1px","1px","1px","solid","1px","transparent","0px","0px","normal","default");Z.NarrativeDisplay.appendChild(f);
f=Z.Utils.createContainerElement("div","narrativePanelBottomEdge","inline-block","absolute","visible","1px","1px","1px","1px","none","0px",sg,"0px","0px","normal","default");Z.NarrativeDisplay.appendChild(f)}f=Z.Utils.createContainerElement("div","buttonContainerNarrativeEdit","inline-block","absolute","visible","0px","0px","0px","0px","none","0px","transparent","0px","0px","normal","default",!0);Z.NarrativeDisplay.appendChild(f);Z.Utils.addEventListener(f,"mouseover",Z.Toolbar.backgroundEventsHandler);
var g=Z.Utils.createContainerElement("div","narrativeFormatLabelTextBox","inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),k=document.createTextNode(Z.Utils.getResource("UI_NARRATIVEFORMATLABEL"));g.appendChild(k);Z.NarrativeDisplay.appendChild(g);g=new Z.Utils.Button("buttonNarrativeBold",null,Z.skinPath,e[142],e[143],e[144],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVEBOLD");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeItalic",
null,Z.skinPath,e[145],e[146],e[147],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVEITALIC");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeUnderline",null,Z.skinPath,e[148],e[149],e[150],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVEUNDERLINE");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeScaleDown",null,Z.skinPath,e[151],e[152],e[153],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVESCALEDOWN");f.appendChild(g.elmt);
g=new Z.Utils.Button("buttonNarrativeScaleUp",null,Z.skinPath,e[154],e[155],e[156],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVESCALEUP");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeAlignLeft",null,Z.skinPath,e[157],e[158],e[159],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVEALIGNLEFT");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeAlignCenter",null,Z.skinPath,e[160],e[161],e[162],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,
"TIP_NARRATIVEALIGNCENTER");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeAlignRight",null,Z.skinPath,e[163],e[164],e[165],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVEALIGNRIGHT");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeAlignJustify",null,Z.skinPath,e[166],e[167],e[168],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVEALIGNJUSTIFY");f.appendChild(g.elmt);g=Z.Utils.createContainerElement("div","narrativeSetInitialLabelTextBox","inline-block",
"absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_NARRATIVESETINITIALLABEL"));g.appendChild(k);Z.NarrativeDisplay.appendChild(g);g=Z.Utils.createContainerElement("div","narrativeSetInitialImageLabelTextBox","inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_NARRATIVESETINITIALIMAGELABEL"));
g.appendChild(k);Z.NarrativeDisplay.appendChild(g);g=new Z.Utils.Button("buttonNarrativeSetInitialImage",null,Z.skinPath,e[169],e[170],e[171],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVESETINITIALIMAGE");f.appendChild(g.elmt);g=Z.Utils.createContainerElement("div","narrativeSetInitialLabelsLabelTextBox","inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_NARRATIVESETINITIALLABELSLABEL"));
g.appendChild(k);Z.NarrativeDisplay.appendChild(g);g=new Z.Utils.Button("buttonNarrativeSetInitialLabels",null,Z.skinPath,e[169],e[170],e[171],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVESETINITIALLABELS");f.appendChild(g.elmt);g=Z.Utils.createContainerElement("div","narrativeLinkLabelTextBox","inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_NARRATIVELINKLABEL"));
g.appendChild(k);Z.NarrativeDisplay.appendChild(g);g=[{text:Z.Utils.getResource("CONTENT_NARRATIVEPLACEHOLDERLISTTEXT"),value:"0"}];k=Z.Utils.getResource("CONTENT_NARRATIVELABELLISTTITLE");Ua=new Z.Utils.createSelectElement("narrativeLabelList",k,g,"0px","0px","0px",null,"visible",D,"change");Z.NarrativeDisplay.appendChild(Ua);k=Z.Utils.getResource("CONTENT_NARRATIVEMEDIALISTTITLE");ya=new Z.Utils.createSelectElement("narrativeMediaList",k,g,"0px","0px","0px",null,"visible",R,"change");Z.NarrativeDisplay.appendChild(ya);
Z.narrativeImageListTitle=Z.Utils.getResource("CONTENT_NARRATIVEIMAGELISTTITLE");Ra=new Z.Utils.createSelectElement("narrativeImageList",Z.narrativeImageListTitle,g,"0px","0px","0px",null,"visible",N,"change");Z.NarrativeDisplay.appendChild(Ra);g=Z.Utils.createContainerElement("div","narrativeLinkURLLabelTextBox","inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_NARRATIVELINKURLLABEL"));
g.appendChild(k);Z.NarrativeDisplay.appendChild(g);g=Z.Utils.createTextElement("narrativeLinkEditTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.Utils.addEventListener(g.firstChild,"focus",S);Z.Utils.addEventListener(g.firstChild,"keydown",xa);Z.Utils.addEventListener(g.firstChild,"blur",La);Z.NarrativeDisplay.appendChild(g);g=new Z.Utils.Button("buttonNarrativeLinkClear",null,Z.skinPath,e[180],e[181],e[182],"0px","0px","0px",
"0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVELINKCLEAR");f.appendChild(g.elmt);g=new Z.Utils.Graphic("tabNarrativeToolsShow",Z.skinPath,e[178],"1px","1px","1px","1px");Z.NarrativeDisplay.appendChild(g.elmt);g=Z.Utils.createContainerElement("div","narrativeTabToolsTextBox","inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_NARRATIVETABTOOLSTEXT"));g.appendChild(k);Z.NarrativeDisplay.appendChild(g);
g=new Z.Utils.Button("buttonNarrativeToolsShow",null,Z.skinPath,e[179],e[179],e[179],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_FORMATTINGTOOLSSHOW");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeEdit",null,Z.skinPath,e[136],e[137],e[138],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVEEDIT");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativePreview",null,Z.skinPath,e[175],e[176],e[177],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVEVIEW");
f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeCancel",null,Z.skinPath,e[139],e[140],e[141],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVECANCEL");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonNarrativeSave",null,Z.skinPath,e[130],e[131],e[132],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_NARRATIVESAVE");f.appendChild(g.elmt);g=new Z.Utils.Button("buttonHelpNarrative",null,Z.skinPath,e[43],e[44],e[45],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,
"z342NARRATIVE");f.appendChild(g.elmt);bc=document.getElementById("narrativeFormatLabelTextBox");ib=document.getElementById("narrativePanelEditBorder");nb=document.getElementById("narrativePanelBottomEdge");gb=document.getElementById("buttonNarrativeBold");B=document.getElementById("buttonNarrativeItalic");fb=document.getElementById("buttonNarrativeUnderline");wb=document.getElementById("buttonNarrativeScaleDown");Db=document.getElementById("buttonNarrativeScaleUp");$a=document.getElementById("buttonNarrativeAlignLeft");
ia=document.getElementById("buttonNarrativeAlignCenter");ld=document.getElementById("buttonNarrativeAlignRight");sd=document.getElementById("buttonNarrativeAlignJustify");Qd=document.getElementById("narrativeSetInitialLabelTextBox");Nd=document.getElementById("narrativeSetInitialImageLabelTextBox");X=document.getElementById("buttonNarrativeSetInitialImage");Od=document.getElementById("narrativeSetInitialLabelsLabelTextBox");Zd=document.getElementById("buttonNarrativeSetInitialLabels");Sd=document.getElementById("narrativeLinkLabelTextBox");
Eb=document.getElementById("narrativeLabelList");ve=document.getElementById("narrativeMediaList");$d=document.getElementById("narrativeImageList");we=document.getElementById("narrativeLinkURLLabelTextBox");vc=document.getElementById("textBoxFor-narrativeLinkEditTextElement");ae=document.getElementById("narrativeLinkEditTextElement");yb=document.getElementById("buttonNarrativeLinkClear");Rc=document.getElementById("tabNarrativeToolsShow");Fc=document.getElementById("narrativeTabToolsTextBox");Tc=document.getElementById("buttonNarrativeToolsShow");
bNED=document.getElementById("buttonNarrativeEdit");ub=document.getElementById("buttonNarrativePreview");de=document.getElementById("buttonNarrativeCancel");Ec=document.getElementById("buttonNarrativeSave");Sc=document.getElementById("buttonHelpNarrative");Z.Utils.validateCallback("narrativePanelEditingFeaturesCreated");b();f=new Z.Utils.Graphic("tabFileManagerShow",Z.skinPath,e[178],"1px","1px","1px","1px");Z.NarrativeDisplay.appendChild(f.elmt);f=Z.Utils.createContainerElement("div","fileManagerTabFilesTextBox",
"inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);g=document.createTextNode(Z.Utils.getResource("UI_FILEMANAGERTABFILESTEXT"));f.appendChild(g);Z.NarrativeDisplay.appendChild(f);f=new Z.Utils.Button("buttonFileManagerShow",null,Z.skinPath,e[179],e[179],e[179],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_FILEMANAGERSHOW");Z.NarrativeDisplay.appendChild(f.elmt);f=Z.Utils.getResource("UI_NARRATIVESCREENCOLOR");g=Z.Utils.createContainerElement("div",
"buttonContainerFileManager","inline-block","absolute","visible","0px","0px","0px","0px","none","0px",f,"0px","0px","normal","default",!0);Z.NarrativeDisplay.appendChild(g);Z.Utils.addEventListener(g,"mouseover",Z.Toolbar.backgroundEventsHandler);for(var k=Z.Utils.getResource("CONTENT_FILETYPESELECTITEMTEXT"),l=Z.Utils.getResource("CONTENT_FILETYPESCHOICELISTTEXT").split(";"),n=Z.Utils.getResource("CONTENT_FILETYPESCHOICELISTVALUES").split(","),u=[],v=0,C=l.length;v<C;v++)u[v]={text:l[v],value:n[v]};
k=new Z.Utils.createSelectElement("fileTypeList",k,u,"0px","0px","0px",null,"visible",Ha,"change");Z.NarrativeDisplay.appendChild(k);k=[{text:Z.Utils.getResource("CONTENT_FILESELECTITEMTEXT"),value:"0"}];k=new Z.Utils.createSelectElement("filenameList",null,k,"0px","0px","0px",null,"visible",F,"change");Z.NarrativeDisplay.appendChild(k);k=Z.Utils.createTextElement("filenameTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.Utils.addEventListener(k.firstChild,
"focus",ca);Z.Utils.addEventListener(k.firstChild,"keydown",V);Z.Utils.addEventListener(k.firstChild,"blur",bb);Z.NarrativeDisplay.appendChild(k);k=Z.Utils.createContainerElement("div","fileManagerPanelLabelTextBox","inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);l=document.createTextNode(Z.Utils.getResource("UI_FILEMANAGERLABEL"));k.appendChild(l);g.appendChild(k);k="";k=Z.Utils.getResource("DEFAULT_NARRATIVEFILETYPESUPLOAD");k=
Z.Utils.createInputElement("narrNarrativeUpInput",Z.narrativeFolderPath,"hidden",k,"multiple","narrative");g.appendChild(k);k=Z.Utils.getResource("DEFAULT_NARRATIVEIMAGEFILETYPESUPLOAD");k=Z.Utils.createInputElement("narrImageUpInput",Z.narrativeImageFolderPath,"hidden",k,"multiple","image");g.appendChild(k);k=Z.Utils.getResource("DEFAULT_NARRATIVEMEDIAFILETYPESUPLOAD");k=Z.Utils.createInputElement("narrMediaUpInput",Z.narrativeMediaFolderPath,"hidden",k,"multiple","media");g.appendChild(k);k=Z.Utils.getResource("DEFAULT_NARRATIVEANNOTATIONFILETYPESUPLOAD");
k=Z.Utils.createInputElement("narrLabelUpInput",Z.narrativeAnnotationFolderPath,"hidden",k,"multiple","label");g.appendChild(k);k=new Z.Utils.Button("buttonFileManagerUpload",null,Z.skinPath,e[24],e[25],e[26],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_FILEUPLOAD");g.appendChild(k.elmt);k=new Z.Utils.Button("buttonFileManagerDownload",null,Z.skinPath,e[27],e[28],e[29],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_FILEDOWNLOAD");g.appendChild(k.elmt);k=new Z.Utils.Button("buttonFileManagerDelete",
null,Z.skinPath,e[127],e[128],e[129],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_FILEDELETE");g.appendChild(k.elmt);k=new Z.Utils.Button("buttonFileManagerNew",null,Z.skinPath,e[133],e[134],e[135],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_FILENEW");g.appendChild(k.elmt);f=Z.Utils.createContainerElement("div","buttonContainerDownloadPanel","inline-block","absolute","visible","0px","0px","0px","0px","none","0px",f,"0px","0px","normal","default",!0);Z.NarrativeDisplay.appendChild(f);
Z.Utils.addEventListener(f,"mouseover",Z.Toolbar.backgroundEventsHandler);g=Z.Utils.createContainerElement("div","downloadPanelLabelTextBox","inline-block","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_DOWNLOADPANELLABEL"));g.appendChild(k);f.appendChild(g);g=Z.Utils.createContainerElement("div","filenameDownloadLinkTextBox","inline-block","absolute","auto","0px","0px","0px","0px","solid","0px",
"white","0px","2px",null,"text",!1);Z.NarrativeDisplay.appendChild(g);g=Z.Utils.createTextElement("downloadPanelInfoTextElement","","1px","1px","1px","1px","0px","none","0px",!1,"verdana","1px","none",null,2,"hidden","hidden","hard");Z.NarrativeDisplay.appendChild(g);e=new Z.Utils.Button("buttonDownloadPanelClose",null,Z.skinPath,e[139],e[140],e[141],"0px","0px","0px","0px","mouseover",Z.Toolbar.z457,"TIP_DOWNLOADPANELCLOSE");f.appendChild(e.elmt);Bd=document.getElementById("tabFileManagerShow");
Gc=document.getElementById("fileManagerTabFilesTextBox");Ic=document.getElementById("buttonFileManagerShow");qe=document.getElementById("fileManagerPanelLabelTextBox");Gb=document.getElementById("fileTypeList");gc=document.getElementById("filenameList");Td=document.getElementById("textBoxFor-filenameTextElement");Cd=document.getElementById("filenameTextElement");ib=document.getElementById("narrativePanelEditBorder");nb=document.getElementById("narrativePanelBottomEdge");Ud=document.getElementById("buttonContainerFileManager");
ze=document.getElementById("buttonFileManagerUpload");Ae=document.getElementById("buttonFileManagerDownload");ec=document.getElementById("buttonFileManagerDelete");ee=document.getElementById("buttonFileManagerNew");Vd=document.getElementById("buttonContainerDownloadPanel");Uc=document.getElementById("downloadPanelLabelTextBox");wc=document.getElementById("filenameDownloadLinkTextBox");sc=document.getElementById("textBoxFor-downloadPanelInfoTextElement");cd=document.getElementById("downloadPanelInfoTextElement");
xc=document.getElementById("buttonDownloadPanelClose")}else Z.setCallback("toolbarInitialized",a),Z.Toolbar=new Z.ZoomifyToolbar(null)}function b(){if(Z.Viewport&&Z.Viewport.getStatus("initializedViewport")){var a=Z.Utils.getResource("CONTENT_NARRATIVEIMAGELISTINVIEWERTITLE"),e=Z.Utils.getResource("CONTENT_ANNOTATIONFILELISTTITLE");Z.Viewport&&(Z.Viewport.createImageChoiceList(a,ye,null),Z.Viewport.createAnnotationFileChoiceList(e,ye))}else Z.setCallback("viewportInitialized",b)}function e(){var a=
parseInt(Z.Utils.getResource("DEFAULT_NARRATIVEPANELTEXTFONTSIZE"),10),b=parseInt(Z.Utils.getResource("DEFAULT_NARRATIVEPANELTEXTPADDINGSMALL"),10),e=Z.narrativeW,f=Z.viewerH,g=e-28-12-2+2,k=Z.narrativeMode?f-200-13-20-6:f-25-60-19,l=e-10-2,n=f-k-125+2,u=f-20-75-27-20-6,v=u+25+5,D=v+25+1,C=D+25+1;if(Z.NarrativeDisplay&&bd&&Yb&&Zc&&kc){var w=Z.NarrativeDisplay.style;w.width=e+"px";w.height=f+"px";w.left="0px";w.top="0px";w=Yb.style;w.width=g+"px";w.height=k+"px";w.left="6px";w.top="40px";w.border=
"1px";w.padding="14px";g=Zc.style;Z.Utils.graphicSize(Zc,30,27);g.left="6px";g.top="5px";w=kc.style;w.width="100px";w.height="20px";w.left=parseFloat(g.left)+parseFloat(g.width)+3+"px";w.top="11px";var w=bd.style,E="undefined"!==typeof bNED&&"undefined"!==typeof ub;w.width=Z.narrativeMode?e-parseFloat(g.width)-100-40+5+"px":E?e-20-6-1-25+"px":e-12+"px";w.left=Z.narrativeMode?e-(e-parseFloat(g.width)-100-40)-6-5+"px":E?"45px":"6px";w.top=Z.narrativeMode?"10px":f-20-6-3+"px";w.display="inline-block";
Z.Utils.setTextNodeStyle(bd.firstChild,"black","verdana",Hc+"px","none","normal","normal","normal","normal","1em","left","none")}Z.narrativeMode&&Z.narrativeText?bc&&ib&&nb&&gb&&B&&fb&&wb&&Db&&$a&&ia&&ld&&sd&&Qd&&Nd&&X&&Od&&Zd&&Sd&&Eb&&ve&&$d&&we&&vc&&ae&&yb&&Rc&&Tc&&bNED&&ub&&de&&Ec&&Sc&&(!Z.viewportCurrent||Z.narrative&&!Z.narrativeMode||Z.viewportCurrent.showLists(!0),da(!0),ib&&nb&&(g=ib.style,g.width=l+"px",g.height=n+"px",g.left=20/3-2+"px",g.top=k+50+30+5+"px",k=nb.style,k.width=l+"px",k.height=
"1px",k.left=g.left,k.top=parseFloat(g.top)+n+1+"px"),l=bc.style,l.width="50px",l.height="20px",l.left="18px",l.top=u+4+"px",Z.Utils.setTextNodeStyle(bc.firstChild,dc,"verdana",Hc+"px","none","normal","normal","normal","normal","1em","left","none"),Z.Utils.buttonSize(gb,26,26),l=gb.style,l.left="74px",l.top=u+"px",Z.Utils.buttonSize(B,26,26),l=B.style,l.left="97px",l.top=u+"px",Z.Utils.buttonSize(fb,26,26),l=fb.style,l.left="120px",l.top=u+"px",Z.Utils.buttonSize(wb,26,26),l=wb.style,l.left="148px",
l.top=u+"px",Z.Utils.buttonSize(Db,26,26),l=Db.style,l.left="171px",l.top=u+"px",Z.Utils.buttonSize($a,26,26),l=$a.style,l.left="199px",l.top=u+"px",Z.Utils.buttonSize(ia,26,26),l=ia.style,l.left="222px",l.top=u+"px",Z.Utils.buttonSize(ld,26,26),l=ld.style,l.left="245px",l.top=u+"px",Z.Utils.buttonSize(sd,26,26),l=sd.style,l.left="268px",l.top=u+"px",u=Qd.style,u.width="80px",u.height="20px",u.left="18px",u.top=v+4+"px",Z.Utils.setTextNodeStyle(Qd.firstChild,dc,"verdana",Hc+"px","none","normal","normal",
"normal","normal","1em","left","none"),u=Nd.style,u.width="50px",u.height="20px",u.left="112px",u.top=v+4+"px",Z.Utils.setTextNodeStyle(Nd.firstChild,dc,"verdana",Hc+"px","none","italic","normal","normal","normal","1em","left","none"),Z.Utils.buttonSize(X,20,20),u=X.style,u.left="161px",u.top=v+"px",u=Od.style,u.width="50px",u.height="20px",u.left="200px",u.top=v+4+"px",Z.Utils.setTextNodeStyle(Od.firstChild,dc,"verdana",Hc+"px","none","italic","normal","normal","normal","1em","left","none"),Z.Utils.buttonSize(Zd,
20,20),u=Zd.style,u.left="251px",u.top=v+"px",v=Sd.style,v.width="50px",v.height="20px",v.left="18px",v.top=D+4+"px",Z.Utils.setTextNodeStyle(Sd.firstChild,dc,"verdana",Hc+"px","none","normal","normal","normal","normal","1em","left","none"),v=Eb.style,v.width="73px",v.left="63px",v.top=D+"px",v=ve.style,v.width="73px",v.left="141px",v.top=D+"px",v=$d.style,v.width="73px",v.left="219px",v.top=D+"px",D=we.style,D.width="50px",D.height="20px",D.left="64px",D.top=C+4+"px",Z.Utils.setTextNodeStyle(we.firstChild,
dc,"verdana",Hc+"px","none","italic","normal","normal","normal","1em","left","none"),D=vc.style,D.width=e-65-25-60+3+"px",D.height="18px",D.left="98px",D.top=C+"px",ae.value=Z.Utils.getResource("UI_NARRATIVELINKEDITPROMPT"),Z.Utils.setTextAreaStyle(vc,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","left","none",b+"px"),Z.Utils.buttonSize(yb,20,20),a=yb.style,a.left=e-20-20+1+"px",a.top=C+"px",Z.Utils.graphicSize(Rc,80,32),C=Rc.style,C.left=e/2-100+1+"px",C.top=f-20-6-14+
"px",a=Fc.style,a.width="70px",a.height="20px",a.left=parseFloat(C.left)+4+"px",a.top=f-20-6-3+"px",Z.Utils.setTextNodeStyle(Fc.firstChild,dc,"verdana",Hc+"px","none","normal","normal","normal","normal","1em","center","none"),Z.Utils.buttonSize(Tc,70,28),C=Tc.style,C.left=e/2-100+1+"px",C.top=f-20-6-17+"px",Z.Utils.buttonSize(bNED,20,20),C=bNED.style,C.left="19px",C.top=f-20-6-2+"px",Z.Utils.buttonSize(ub,20,20),C=ub.style,C.left="19px",C.top=f-20-6-2+"px",C.display="inline-block",Z.Utils.buttonSize(de,
20,20),C=de.style,C.left=e-50-20-20-2+"px",C.top=f-20-6-2+"px",Z.Utils.buttonSize(Ec,20,20),C=Ec.style,C.left=e-25-20-20-2+"px",C.top=f-20-6-2+"px",Z.Utils.buttonSize(Sc,20,20),C=Sc.style,C.left=e-20-20-2+"px",C.top=f-20-6-2+"px"):(Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),da(!1))}function f(){e();ja();pa(!1);n();Z.setCallback("narrativeFileUploaded",n);Z.setCallback("narrativeFilePosted",n);J();Z.setCallback("narrativeImageUploaded",J);W();Z.setCallback("narrativeMediaUploaded",W);Z.annotations&&
Z.Viewport&&Z.Viewport.getStatus("annotationsLoadedViewport")&&Z.Viewport.getStatus("annotationPanelInitializedViewport")&&w();Z.setCallback("labelListUpdated",w);G();Z.setCallback("narrativeAnnotationFileUploaded",G);Z.setCallback("narrativeAnnotationFilePosted",G)}function g(a){var b=new Z.NetConnector;a=Z.Utils.stringEscapeSpaces(a);b.loadHTML(a,k,null,"loadingNarrativeHTML")}function k(a){if(4==a.readyState&&200==a.status&&Z.Utils.stringValidate(a.responseText)){Z.narrativeText.innerHTML=Z.narrativeTextPrior.innerHTML=
a.responseText;var b=a=null,e=null,f=document.getElementById("narrativeDataForm");if(f){if(f=document.getElementById("zImagePath"))a=f.value;if(f=document.getElementById("zAnnotationPath"))b=f.value}else f=l("narrativeDataForm");if(null===a&&(f=document.getElementById("narrativeImageList"))){var g=Z.Utils.stringValidate(Z.narrativeImageListTitle)&&"none"!=Z.narrativeImageListTitle?1:0;a=f.options[g].value;null===b&&(b=Z.narrativeAnnotationFolderPath+(f.options[g].text+"-annotations.xml"),Z.setCallback("loadingAnnotationsXMLFailed",
function(){Ab.createAnnotationFile()}))}null!==a&&a!=Z.imagePath?(null!==b&&(e="zAnnotationPath="+b),Z.Viewer.setImage(a,e)):null!==b&&Z.Viewer.setAnnotationPath(b)}else Z.narrativeText.innerHTML=Z.narrativeTextPrior.innerHTML=Z.Utils.getResource("CONTENT_NARRATIVESELECTITEMTEXT")}function l(a){var b=document.createElement("form");if(b){b.id=a;b.method="post";b.action="";a=document.createElement("input");a.id="zImagePath";a.name="zImagePath";a.type="hidden";a.value=Z.imagePath;b.appendChild(a);var e=
document.createElement("input");a.id="zAnnotationPath";a.name="zAnnotationPath";e.type="hidden";e.value=Z.annotationPath;b.appendChild(e);a=document.createElement("input");a.id="zUserName";a.name="zUserName";a.type="hidden";b.appendChild(a);a=document.createElement("input");a.id="zDateTime";a.name="zDateTime";a.type="hidden";b.appendChild(a);(a=document.getElementsByTagName("body")[0])&&a.appendChild(b)}return b}function E(a,b){var e=document.getElementById(a);if(e)e.value=b;else{var f=document.getElementById("narrativeDataForm");
f||(f=l("narrativeDataForm"));f&&(e||(e=document.createElement("input"),e.id=a,e.name=a,f.appendChild(e)),e&&(e.value=b))}}function n(){if(Z.fileHandlerPath){var a=Z.Utils.getResource("DEFAULT_NARRATIVEFILETYPESLIST");(new Z.NetConnector).loadFileList(Z.fileHandlerPath,"narrativeList",Z.narrativeFolderPath,a)}}function w(){if("undefined"!==typeof Ua&&null!==Ua){var a=Z.Viewport.getLabelList();if(null!==a&&0<a.length){var b=Z.Utils.getResource("CONTENT_NARRATIVELABELLISTTITLE");a[0].text!=b&&a.splice(0,
0,{text:b,value:"0",poiID:"0",editable:!0});Z.Utils.updateSelectElement(Ua,a,null)}}}function G(){Z.fileHandlerPath&&(new Z.NetConnector).loadFileList(Z.fileHandlerPath,"annotationFileList",Z.narrativeAnnotationFolderPath,"xml")}function K(a){var b=document.getElementById("annotationFileList");if(b){var e=Z.Viewport.getAnnotationPath();Z.Utils.updateSelectElement(b,a,e);a=Z.Utils.arrayIndexOfObjectValue(b.options,"text",la);-1!=a&&b.selectedIndex!=a&&(b.selectedIndex=a)}else b=Z.Utils.getResource("CONTENT_ANNOTATIONFILELISTTITLE"),
Z.Viewport.createAnnotationFileChoiceList(b,a)}function W(){if(Z.fileHandlerPath){var a=Z.Utils.getResource("DEFAULT_NARRATIVEMEDIAFILETYPESLIST");(new Z.NetConnector).loadFileList(Z.fileHandlerPath,"mediaList",Z.narrativeMediaFolderPath,a)}}function J(){if(Z.fileHandlerPath){var a=Z.Utils.getResource("DEFAULT_NARRATIVEIMAGEFILETYPESLIST");(new Z.NetConnector).loadFileList(Z.fileHandlerPath,"imageList",Z.narrativeImageFolderPath,a)}}function oa(a,b,e){var f=document.getElementById("fileTypeList");
if(f&&Z.fileHandlerPath){var g=f.options[f.selectedIndex].value,k,l,u,v;switch(g){case "Narratives":g="narrative";k=n;l=Z.Utils.getResource("CONTENT_NARRATIVELISTTITLE");u=Z.narrativeFolderPath;v=qa;break;case "Images":g="image";k=J;l=Z.Utils.getResource("CONTENT_NARRATIVEIMAGELISTTITLE");u=Z.narrativeImageFolderPath;v=Ra;break;case "Media":g="media";k=W;l=Z.Utils.getResource("CONTENT_NARRATIVEMEDIALISTTITLE");u=Z.narrativeMediaFolderPath;v=ya;break;case "Label Sets":g="labels",k=G,l=Z.Utils.getResource("CONTENT_ANNOTATIONFILELISTTITLE"),
u=Z.narrativeAnnotationFolderPath,v=annotationFileList}Z.setCallback("newFilenamePosted-"+g,k);"narrative"!=g&&"labels"!=g&&Z.setCallback("newFilenamePosted-"+g,function(){ga(g,a,b)});a!=l&&(-1==Z.Utils.arrayIndexOfObjectValue(v,"text",b)?(a=Z.Utils.stringEscapeSpaces(a),b=Z.Utils.stringEscapeSpaces(b),"narrative"==g?Aa=b:"labels"==g&&(la=b),f=u+a+"."+e,e=u+b+"."+e,k=new Z.NetConnector,k.renameFile(Z.fileHandlerPath,"renamingFile-"+g,f,e),"image"==g&&(f=u+a+".xml",e=u+b+".xml",k=new Z.NetConnector,
k.renameFile(Z.fileHandlerPath,"renamingFile-ruler",f,e),u=Z.narrativeAnnotationFolderPath,f=u+a+"-annotations.xml",e=u+b+"-annotations.xml",k=new Z.NetConnector,k.renameFile(Z.fileHandlerPath,"renamingFile-labels",f,e))):(Z.Utils.showMessage(Z.Utils.getResource("ERROR_FILEMANAGERRENAMEFILENAMEEXISTS"),!1,Z.messageDurationShort,"center",!1,"5"),u=document.getElementById("filenameList"),document.getElementById("filenameTextElement").value=u.options[u.selectedIndex].text))}}function ga(a,b,e){Z.Viewer.disablePageExitEventHandler();
C();a=1;for(var f=qa.length;a<f;a++){var g=new Z.NetConnector,k=Z.Utils.stringEscapeSpaces(qa.options[a].value);g.loadHTMLToRenameIn(k,ma,null,"loadingNarrativeHTML",b,e)}Z.Viewer.initializePageExitEventHandler()}function ma(a){var b=a.responseText;4==a.readyState&&200==a.status&&Z.Utils.stringValidate(a.responseText)&&-1!=b.indexOf(a.zOldName)&&(b=b.replace(new RegExp(a.zOldName,"g"),a.zNewName),(new Z.NetConnector).postHTML(Z.fileHandlerPath,b,a.zFilePath))}function fa(a){if(a=Z.Utils.event(a))if(a=
Z.Utils.target(a))a.value=Z.Utils.htmlClearHighlight(a.innerHTML),Z.narrativeTextPrior.innerHTML=a.innerHTML,Ua.selectedIndex=0,ya.selectedIndex=0,Ra.selectedIndex=0,Z.Viewer.initializeViewerKeyEventListeners(!1),Z.Viewer.initializeViewerKeyDefaultListeners(!1)}function v(a){(a=Z.Utils.event(a))&&Z.Utils.target(a)&&((a=Z.Utils.relatedTarget(a))&&a==narrativeLinkEditTextElement&&(a=Z.Utils.htmlGetSelection(),Z.Utils.stringValidate(a)&&(tf=a,Z.Utils.htmlHighlightSelection(a),a=Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTSTART"),
ce=Z.narrativeText.innerHTML.search(a))),Z.Viewer.initializeViewerKeyEventListeners(!0),Z.Viewer.initializeViewerKeyDefaultListeners(!0))}function C(a){Z.localUse?Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALSAVING"),!1,Z.messageDurationStandard,"center",!0):Z.Utils.stringValidate(Z.fileHandlerPath)?-1!=Z.fileHandlerPath.indexOf(Z.Utils.getResource("z13"))||Z.demoNoSave?Z.Utils.showMessage(Z.Utils.getResource("z14"),!1,Z.messageDurationStandard,"center",!0):(E("zUserName",Z.userName),
E("zDateTime",Z.Utils.getCurrentUTCDateAsString()),Z.Utils.showMessage(Z.Utils.getResource("z15"),!1,Z.messageDurationStandard,"center",!1,"5"),"undefined"!==typeof a&&Z.Utils.stringValidate(a)||(a=qa.options[qa.selectedIndex].text),a=Z.narrativeFolderPath+a+".htm",(new Z.NetConnector).postHTML(Z.fileHandlerPath,Z.narrativeText.innerHTML,a)):Z.Utils.showMessage(Z.Utils.getResource("ERROR_NARRATIVEFILEHANDLER"),!0,null,"center",!0)}function u(){var a=!0;"undefined"!==typeof Z.narrativeText.innerHTML&&
"undefined"!==typeof Z.narrativeTextPrior.innerHTML&&(a=Z.narrativeText.innerHTML!=Z.narrativeTextPrior.innerHTML);return a}function D(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);Z.Utils.htmlClearLinkFromSelection();a=Z.Utils.htmlGetSelection();var e="";" "==a.substr(a.indexOf("</span>")-1,1)&&(a=Z.Utils.stringRemoveNestedSpace(a,"</span>"),e=" ");Z.Utils.stringValidate(a)?(b=b.options[b.selectedIndex].value,Z.Utils.htmlReplaceSelection("<a href=\"javascript:Z.Viewport.goToLabelByIDAndImage('"+
Z.imagePath+"', '"+b+"', null, false, true)\" onmouseover=\"Z.Viewport.setLabelHighlightByDisplayID('"+b+'\', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">'+a+"</a>"+e),Z.narrativeText.innerHTML=Z.Utils.htmlClearHighlight(Z.narrativeText.innerHTML)):Z.Utils.showMessage(Z.Utils.getResource("ERROR_NARRATIVENOTEXTSELECTIONFORSTYLE"),!0,Z.messageDurationStandard,"center",null)}}function R(a){if(a=Z.Utils.event(a)){a=Z.Utils.target(a);Z.Utils.htmlClearLinkFromSelection();var b=Z.Utils.htmlGetSelection();
Z.Utils.stringValidate(b)?(Z.Utils.htmlReplaceSelection('<a href="'+a.options[a.selectedIndex].value+'" target="_blank">'+b+"</a>"),Z.narrativeText.innerHTML=Z.Utils.htmlClearHighlight(Z.narrativeText.innerHTML)):Z.Utils.showMessage(Z.Utils.getResource("ERROR_NARRATIVENOTEXTSELECTIONFORSTYLE"),!0,Z.messageDurationStandard,"center",null)}}function N(a){if(a=Z.Utils.event(a)){a=Z.Utils.target(a);Z.Utils.htmlClearLinkFromSelection();var b=Z.Utils.htmlGetSelection();Z.Utils.stringValidate(b)?(Z.Utils.htmlReplaceSelection("<a href=\"javascript:Z.Viewer.setImage('"+
a.options[a.selectedIndex].value+"')\">"+b+"</a>"),Z.narrativeText.innerHTML=Z.Utils.htmlClearHighlight(Z.narrativeText.innerHTML)):Z.Utils.showMessage(Z.Utils.getResource("ERROR_NARRATIVENOTEXTSELECTIONFORSTYLE"),!0,Z.messageDurationStandard,"center",null)}}function ja(){if(Rc&&Fc&&Tc&&Bd&&Gc&&Ic&&qe&&Gb&&gc&&Td&&Cd&&ib&&nb&&Ud&&ze&&Ae&&ec&&ee&&Vd&&Uc&&wc&&sc&&cd&&xc){var a=parseInt(Z.Utils.getResource("DEFAULT_FILEMANAGERPANELLABELFONTSIZE"),10),b=parseInt(Z.Utils.getResource("DEFAULT_FILEMANAGERPANELTEXTFONTSIZE"),
10),e=parseInt(Z.Utils.getResource("DEFAULT_FILEMANAGERPANELTEXTPADDINGSMALL"),10),f=ib.style,g=parseInt(f.width,10)-2,k=parseInt(f.height,10)-2,l=parseInt(f.left,10)+2,f=parseInt(f.top,10)+2,n=g-20,u=f+10+9,v=u+20+8,D=g/2-50-6;Z.Utils.graphicSize(Bd,80,32);var C=Bd.style;C.left=g/2-25-2+"px";C.top=Rc.style.top;var w=Gc.style;w.width="70px";w.height="20px";w.left=parseFloat(C.left)+4+"px";w.top=Fc.style.top;Z.Utils.setTextNodeStyle(Gc.firstChild,dc,"verdana",a+"px","none","normal","normal","normal",
"normal","1em","center","none");C=Ic.style;Z.Utils.buttonSize(Ic,70,28);C.left=g/2-25-2+"px";C.top=Tc.style.top;C=qe.style;C.width="100px";C.height="20px";C.left="11px";C.top="23px";Z.Utils.setTextNodeStyle(qe.firstChild,dc,"verdana",a+"px","none","normal","normal","normal","normal","1em","left","none");C=Gb.style;C.width=n-100+"px";C.height="20px";C.left=l+10+100+"px";C.top=u+"px";u=gc.style;u.width=n+"px";u.height="20px";u.left=l+10+"px";u.top=v+"px";n=Td.style;n.width=parseFloat(u.width)-20+"px";
n.height="18px";n.left=parseFloat(u.left)+"px";n.top=parseFloat(u.top)+"px";Z.Utils.setTextAreaStyle(Td,"black","verdana",b+"px","none","normal","normal","normal","normal","1em","left","none",e+"px");Cd.value=gc.options[0].text;n=Ud.style;n.width=g+"px";n.height=k+"px";n.left=l+"px";n.top=f+"px";Z.Utils.buttonSize(ze,20,20);n=ze.style;n.left=D+10-2+"px";n.top="75px";Z.Utils.buttonSize(Ae,20,20);n=Ae.style;n.left=D+10+25-2+"px";n.top="75px";Z.Utils.buttonSize(ec,20,20);n=ec.style;n.left=D+10+50+2+
"px";n.top="75px";Z.Utils.buttonSize(ee,20,20);n=ee.style;n.left=D+10+75+2+"px";n.top="75px";D=Vd.style;D.width=g+"px";D.height=k+"px";D.left=l+"px";D.top=f+"px";l=Uc.style;l.width="100px";l.height="20px";l.left="11px";l.top="23px";Z.Utils.setTextNodeStyle(Uc.firstChild,dc,"verdana",a+"px","none","normal","normal","normal","normal","1em","left","none");l=wc.style;l.width=parseFloat(u.width)+"px";l.height="18px";l.left=parseFloat(u.left)+"px";l.top=parseFloat(u.top)+"px";Z.Utils.setHTMLTextStyle(wc,
"black","verdana",b+2+"px","none","normal","normal","normal","normal","1em","center","none");wc.innerHTML="";l=wc.style;b=sc.style;b.width=parseFloat(l.width)-50+"px";b.height="26px";b.left=parseFloat(l.left)+4+"px";b.top=parseFloat(l.top)+20+8+"px";Z.Utils.setTextAreaStyle(sc,dc,"verdana",a-1+"px","none","normal","normal","normal","normal","1em","center","none",e+"px");cd.style.backgroundColor=Z.Utils.getResource("UI_NARRATIVESCREENCOLOR");cd.value=Z.Utils.getResource("UI_DOWNLOADINFOLABEL");Z.Utils.buttonSize(xc,
20,20);a=xc.style;a.left=g-25-6+"px";a.top=k-25-10+"px"}}function da(a){var b=a?"inline-block":"none";bc&&ib&&nb&&gb&&B&&fb&&wb&&Db&&$a&&ia&&ld&&sd&&Qd&&Nd&&X&&Od&&Zd&&Sd&&$d&&ve&&Eb&&Rc&&Fc&&Tc&&Bd&&Gc&&Ic&&bNED&&ub&&de&&Ec&&Sc&&(bc.style.display=b,ib.style.display=b,nb.style.display=b,gb.style.display=b,B.style.display=b,fb.style.display=b,wb.style.display=b,Db.style.display=b,$a.style.display=b,ia.style.display=b,ld.style.display=b,sd.style.display=b,Qd.style.display=b,Nd.style.display=b,X.style.display=
b,Od.style.display=b,Zd.style.display=b,Sd.style.display=b,$d.style.display=b,ve.style.display=b,Eb.style.display=b,we.style.display=b,vc.style.display=b,yb.style.display=b,Rc.style.display=b,Fc.style.display=b,Tc.style.display=b,Bd.style.display=b,Gc.style.display=b,Ic.style.display=b,bNED.style.display="inline-block",ub.style.display=b,de.style.display=b,Ec.style.display=b,Sc.style.display=b);b=a?!0:!1;Z.narrativeText.contentEditable=b;Z.narrativeText.readOnly=!b;a=a?"text":"none";Z.narrativeText.style.userSelect=
a;Z.narrativeText.style.webkitUserSelect=a;Z.narrativeText.style.mozUserSelect=a;Z.narrativeText.style.msUserSelect=a}function S(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a))a.value==Z.Utils.getResource("UI_NARRATIVELINKEDITPROMPT")&&(a.value=""),a.contentEditable=!0,Z.Viewer.initializeViewerKeyEventListeners(!1),Z.Viewer.initializeViewerKeyDefaultListeners(!1)}function xa(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);if(b)switch(a.keyCode){case 8:case 9:case 37:case 38:case 39:case 40:break;
case 13:return a.preventDefault(),b.blur(),!1;default:if(!/^[a-zA-Z0-9._^/:()-]+$/.test(a.key)||" "==a.key)return a.preventDefault(),Z.Utils.showMessage(Z.Utils.getResource("ERROR_CHARACTERNOTPERMITTEDINLINK"),!1,Z.messageDurationStandard,"center",!1,"5"),!1}}}function La(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a)){Z.Viewer.initializeViewerKeyEventListeners(!0);Z.Viewer.initializeViewerKeyDefaultListeners(!0);var b=Z.Utils.getResource("UI_NARRATIVELINKEDITPROMPT"),e=Z.Utils.stringValidate(a.value)&&
a.value!=b,f=tf;Z.Utils.htmlClearLinkFromSelection();Z.Utils.stringValidate(f)&&e?Z.narrativeText.innerHTML=Z.Utils.htmlCreateURLLink(Z.narrativeText.innerHTML,ce,tf,a.value):!Z.Utils.stringValidate(f)&&e?Z.Utils.showMessage(Z.Utils.getResource("ERROR_NARRATIVENOTEXTSELECTIONFORLINK"),!0,Z.messageDurationStandard,"center",null):Z.Utils.stringValidate(f)&&!e&&Z.Utils.showMessage(Z.Utils.getResource("ERROR_NARRATIVENOVALIDLINK"),!0,Z.messageDurationStandard,"center",null);e||(a.value=b);Z.narrativeText.innerHTML=
Z.Utils.htmlClearHighlight(Z.narrativeText.innerHTML)}}function pa(a,b){b?a&&(a=Qb):Qb=a;var e=a?"inline-block":"none",f=Z.Utils.getResource("CONTENT_FILESELECTITEMTEXT");if(nb&&Rc&&Fc&&Tc&&Bd&&Gc&&Ic&&Gb&&gc&&Td&&Ud&&Vd&&Uc&&wc&&sc&&xc){var g=parseFloat(Z.NarrativeDisplay.style.zIndex),k=(g+1).toString(),l=(g+3).toString(),n=(g+4).toString(),u=(g+5).toString();nb.style.zIndex=(g+2).toString();Rc.style.zIndex=a?k:l;Bd.style.zIndex=a?l:k;Fc.style.zIndex=n;Gc.style.zIndex=n;Tc.style.zIndex=u;Ic.style.zIndex=
u;Gb.style.display=e;gc.style.display=e;Td.style.display=a&&gc.options[0].text!=f?"inline-block":"none";Ud.style.display=e;Vd.style.display="none";Uc.style.display="none";wc.style.display="none";sc.style.display="none";xc.style.display="none"}}function Ha(a){if(a=document.getElementById("fileTypeList")){var b=a.selectedIndex,e=a.options[b].value,f=[];if(a.options[b].text!=Z.Utils.getResource("CONTENT_FILETYPESELECTITEMTEXT")){switch(e){case "Narratives":f=Va;break;case "Images":f=jb;break;case "Media":f=
Lb;break;case "Label Sets":f=P}Z.Utils.updateSelectElement(filenameList,f);Qa&&(b=Z.Utils.arrayIndexOfObjectValue(filenameList.options,"text",Qa),-1!=b&&(filenameList.selectedIndex=b),Qa=null);0<filenameList.options.length&&(-1!=filenameList.options[0].text.indexOf("...")&&filenameList.options[0].remove(),F())}else a=[{text:Z.Utils.getResource("CONTENT_FILESELECTITEMTEXT"),value:"0"}],Z.Utils.updateSelectElement(filenameList,a),F()}}function F(a){a=Z.Utils.getResource("CONTENT_FILESELECTITEMTEXT");
var b=document.getElementById("textBoxFor-filenameTextElement"),e=document.getElementById("filenameList"),f=document.getElementById("filenameTextElement"),g="inline-block"==e.style.display;0<e.options.length&&(b.style.display=g&&e.options[0].text!=a?"inline-block":"none",f.value=e.options[e.selectedIndex||0].text)}function ca(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a))a.value!=Z.Utils.getResource("CONTENT_NARRATIVELISTTITLE")?(a.contentEditable=!0,Z.Viewer.initializeViewerKeyEventListeners(!1),
Z.Viewer.initializeViewerKeyDefaultListeners(!1)):a.contentEditable=!1,"filenameTextElement"==a.id&&(Fa=a.value)}function V(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);if(b)switch(a.keyCode){case 8:case 9:case 37:case 38:case 39:case 40:break;case 13:return a.preventDefault(),b.blur(),!1;default:if(!(new RegExp(/^[-\w^&'@{}[\],$=!#().%+~ ]+$/)).test(a.key))return a.preventDefault(),Z.Utils.showMessage(Z.Utils.getResource("ERROR_CHARACTERNOTPERMITTEDINFILENAME"),!1,Z.messageDurationShort,"center",
!1,"5"),!1}}}function bb(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a))Z.Viewer.initializeViewerKeyEventListeners(!0),Z.Viewer.initializeViewerKeyDefaultListeners(!0),Qa=Na=a.value,a=document.getElementById("filenameList"),a=a.value.substring(a.value.lastIndexOf(".")+1,a.value.length),"undefined"!==typeof Na&&"undefined"!=Na&&Z.Utils.stringValidate(Na)&&"undefined"!==typeof Fa&&"undefined"!=Fa&&Z.Utils.stringValidate(Fa)&&Na!=Fa&&document.getElementById("fileTypeList")&&oa(Fa,Na,a)}var Ab=this,
qa,Ua,ya,Ra,Va,jb,Lb,P,ta="",Aa="",la="",Fa="",Na="",Qa=null,xb=null,Qb=!1,bd,Yb,Zc,kc,bc,ib,gb,B,fb,wb,Db,$a,ia,ld,sd,Qd,Nd,X,Od,Zd,Sd,$d,ve,Eb,we,vc,ae,yb,ub,de,Ec,Sc,Rc,Fc,Tc,Bd,Gc,Ic,qe,Gb,gc,Td,Cd,nb,Ud,ze,Ae,ee,ec,Vd,Uc,wc,sc,cd,xc,tf=null,ce=null,uf=null;Z.narrativeW=310;var vf=Z.Utils.getResource("UI_NARRATIVESCREENCOLOR"),sg=Z.Utils.getResource("UI_NARRATIVEBORDERCOLOR"),dc=Z.Utils.getResource("UI_NARRATIVELABELCOLOR");Z.Utils.getResource("UI_NARRATIVEBUTTONCOLOR");var Hc=parseInt(Z.Utils.getResource("DEFAULT_NARRATIVEPANELLABELFONTSIZE"),
10);Z.NarrativeDisplay=Z.Utils.createContainerElement("div","NarrativeDisplay","inline-block","absolute","hidden","0px","0px","0px","0px","solid","1px",vf,"0px","0px","normal",null,!1);Z.ViewerDisplay.appendChild(Z.NarrativeDisplay);parseInt(Z.Utils.getResource("DEFAULT_NARRATIVEPANELLISTFONTSIZE"),10);var ye=[{text:Z.Utils.getResource("CONTENT_NARRATIVEPLACEHOLDERLISTTEXT"),value:"0"}],tg=Z.Utils.getResource("CONTENT_NARRATIVELISTTITLE");qa=new Z.Utils.createSelectElement("narrativeList",tg,ye,"0px",
"0px","0px",null,"visible",function(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a))u()&&C(ta),xb=a.selectedIndex,a=a.options[a.selectedIndex],a.text!=Z.Utils.getResource("CONTENT_NARRATIVELISTTITLE")?(uf=Z.narrativePath=a.value,g(a.value)):Z.narrativeText.innerHTML=Z.narrativeTextPrior.innerHTML=Z.Utils.getResource("CONTENT_NARRATIVESELECTITEMTEXT")},"change");Z.Utils.addEventListener(qa,"focus",function(a){ta=qa[qa.selectedIndex].text});Z.NarrativeDisplay.appendChild(qa);qa.style.display="none";
var wf=new Z.Utils.Graphic("narrativePanelZLogo",Z.skinPath+"/large","toolbarLogo.png","1px","1px","1px","1px"),Uf=Z.Utils.getResource("z427ZOOMIFY"),Vf=Z.Utils.getResource("z360ZOOMIFY"),xe=document.createElement("a");xe.setAttribute("title",Vf);xe.setAttribute("href",Uf);xe.setAttribute("target",Z.Utils.getResource("z427TARGET"));xe.setAttribute("outline","none");xe.appendChild(wf.elmt);Z.NarrativeDisplay.appendChild(xe);var be=Z.Utils.createContainerElement("div","narrativePanelLabelTextBox","inline-block",
"absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),df=document.createTextNode(Z.Utils.getResource("UI_NARRATIVEPANELLABEL"));be.appendChild(df);Z.NarrativeDisplay.appendChild(be);be.style.left="0px";be.style.top="0px";Z.Utils.setTextNodeStyle(be.firstChild,dc,"verdana","16px","none","normal","normal","normal","bold","1em","left","none");var Ne=Z.Utils.createContainerElement("div","narrativeTextBox","inline-block","absolute","auto","0px","0px","0px",
"0px","solid","0px","white","0px","0px",null,"text",!1);Ne.style.overflowY="auto";Z.NarrativeDisplay.appendChild(Ne);Z.narrativeText=document.getElementById("narrativeTextBox");Z.narrativeText.innerHTML=Z.localUse?Z.narrativeMode?Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALNARRATIVELOADINGEDITMODE"):Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALNARRATIVELOADING"):Z.Utils.getResource("CONTENT_NARRATIVELOADINGTEXT");Z.Utils.setHTMLTextStyle(Z.narrativeText,"#333333","verdana","14px","none","normal","normal",
"normal","normal","1em","left","none");var xf=Z.Utils.createContainerElement("div","narrativeTextBoxPrior","none","absolute","auto","0px","0px","0px","0px","solid","0px","white","0px","0px",null,"text",!1);Z.NarrativeDisplay.appendChild(xf);Z.narrativeTextPrior=document.getElementById("narrativeTextBoxPrior");Yb=document.getElementById("narrativeTextBox");Zc=document.getElementById("narrativePanelZLogo");kc=document.getElementById("narrativePanelLabelTextBox");bd=document.getElementById("narrativeList");
Z.narrativeMode&&(Z.Utils.addEventListener(Z.narrativeText,"focus",fa),Z.Utils.addEventListener(Z.narrativeText,"blur",v));Z.NarrativeDisplay.style.zIndex=(Z.baseZIndex+36).toString();Z.narrativeMode?(Z.narrativeHelpPath=Z.Utils.getResource("DEFAULT_NARRATIVEHELPPATHEDIT"),Z.setCallback("narrativePanelEditingFeaturesCreated",f),a()):(Z.narrativeHelpPath=Z.Utils.getResource("DEFAULT_NARRATIVEHELPPATHVIEW"),e(),n());Z.localUse&&Z.Viewer.setImage("Images/ZoomifyImageExample3","Assets/Annotations/Narratives/ZoomifyImageExample1-annotations.xml&zMarkupMode=1&zFileHandlerPath=Assets/FileHandlers/files.php&zSkinPath=Assets/Skins/Narratives&zRulerVisible=2&zRulerWidth=200&zNavigatorWidth=200&zVirtualPointerVisible=1&zCaptionBoxes=1&zMaskVisible=1&zHelpWidth=550&zHelpHeight=500&zMagnifierVisible=2");
Z.Viewer.loadHelp(Z.narrativeHelpPath,"helpNarrative");this.drawLayoutNarrativePanel=function(){e()};this.configureNarrativeList=function(a){if(qa){var b=Z.Utils.getResource("CONTENT_NARRATIVELISTTITLE");a.splice(0,0,{text:b,value:"0",poiID:"0",editable:!0});Z.Utils.updateSelectElement(qa,a);if(1==qa.length)Ab.createNarrative();else if(1<qa.length)if(uf||""!=Aa)""==Aa&&null!==xb?(e=qa.options.length-1,xb>e&&(xb=e),e=qa.options[xb],e.text!=b&&(Z.narrativePath=e.value,g(e.value))):""!=Aa&&(b=Z.Utils.arrayIndexOfObjectValue(qa.options,
"text",Aa),-1!=b&&qa.selectedIndex!=b&&(xb=qa.selectedIndex=b,Z.narrativePath=qa.options[b].value));else{qa.selectedIndex=1;var e=qa.options[1];e.text!=b&&(Z.narrativePath=e.value,g(e.value))}Va=a;Ha()}else window.setTimeout(function(){Ab.configureNarrativeList(a)},100)};this.configureAnnotationFileChoiceListFromNarrative=function(a){if("undefined"===typeof a[0].value||null===a[0].value)for(var b=0,e=a.length;b<e;b++)a[b].value=Z.narrativeAnnotationFolderPath+a[b].text+"-annotations.xml";Z.Viewport&&
Z.Viewport.getStatus("annotationsLoadedViewport")?K(a):Z.setCallback("annotationsLoadedViewport",function(){K(a)});Z.annotationFileList=!0;P=a;Ha()};this.configureNarrativeMediaChoiceList=function(a){a.splice(0,0,{text:Z.Utils.getResource("CONTENT_NARRATIVEMEDIALISTTITLE"),value:"0",poiID:"0",editable:!0});Z.Utils.updateSelectElement(ya,a);Lb=a;Ha()};this.configureNarrativeImageChoiceList=function(a){if("undefined"===typeof a[0]||"undefined"===typeof a[0].optionalParams||null===a[0].optionalParams)for(var b=
0,e=a.length;b<e;b++)a[b].optionalParams="zAnnotationPath="+Z.narrativeAnnotationFolderPath+a[b].text+"-annotations.xml";b=Z.Utils.getResource("CONTENT_NARRATIVEIMAGELISTTITLE");"undefined"!==typeof a[0]&&a[0].text!=b&&(a.splice(0,0,{text:b,value:"0",poiID:"0",editable:!0}),Z.Utils.updateSelectElement(Ra,a),Z.Utils.validateCallback("initializedNarrativeImageList"));Z.Viewport?Ab.configureViewerImageChoiceList(a):Z.setCallback("initializedViewport",function(){var a=[{text:Z.Utils.getResource("CONTENT_NARRATIVEPLACEHOLDERLISTTEXT"),
value:"0"}],b=Z.Utils.getResource("CONTENT_NARRATIVEIMAGELISTINVIEWERTITLE");Z.setCallback("initializedImageList",function(){var a=document.getElementById("narrativeImageList");Z.Narrative.configureViewerImageChoiceList(a.options)});Z.Viewport.createImageChoiceList(b,a,null)});jb=a;Ha()};this.configureViewerImageChoiceList=function(a){for(var b=[],e=1,f=a.length;e<f;e++){var g=a[e].value,k=a[e].text,l=Z.Viewport.z535("image");b[b.length]={text:k,value:l,media:g,optionalParams:null}}b.splice(0,0,{text:Z.Utils.getResource("CONTENT_NARRATIVEIMAGELISTINVIEWERTITLE"),
value:"0",poiID:"0",editable:!0});Z.Viewport.updateImageList(b)};this.updateImageListFromNarrative=function(a){imageList&&Z.Utils.updateSelectElement(imageList,a,vpID,imagePath)};this.renamePropagate=function(a,b,e){ga(a,b,e)};this.cancelNarrative=function(a){g(Z.narrativePath)};this.saveNarrative=function(a){C()};this.toggleNarrativeMode=function(a){a="undefined"!==typeof a&&null!==a?a:!Z.narrativeMode;Z.narrativeMode&&u()&&C();bNED&&ub&&(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NARRATIVETOGGLEEDITVIEWMODES"),
!1,Z.messageDurationShort,"center",!0,"5"),Z.Utils.htmlClearSelection(),pa(a,!0),bNED.style.display=a?"none":"inline-block",ub.style.display=a?"inline-block":"none",Z.narrativeMode=a,e(),Z.Viewport.toggleEditMode(),Z.Ruler.toggleEditMode())};this.setSelectedTextFormat=function(a){var b=Z.Utils.htmlGetSelection();if(Z.Utils.stringValidate(b)){var e=null;switch(a){case "bold":-1!=b.indexOf("<strong>")?(e=b.replace(/<strong>/gi,""),e=e.replace(/<\/strong>/gi,"")):e="<strong>"+b+"</strong>";break;case "italic":-1!=
b.indexOf("<em>")?(e=b.replace(/<em>/gi,""),e=e.replace(/<\/em>/gi,"")):e="<em>"+b+"</em>";break;case "underline":-1!=b.indexOf("<u>")?(e=b.replace(/<u>/gi,""),e=e.replace(/<\/u>/gi,"")):e="<u>"+b+"</u>"}e&&Z.Utils.htmlReplaceSelection(e)}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_NARRATIVENOTEXTSELECTIONFORSTYLE"),!0,Z.messageDurationStandard,"center",null)};this.setSelectedTextFontSize=function(a){var b=Z.Utils.htmlGetSelection();if(Z.Utils.stringValidate(b)){var e=3;-1!=b.indexOf("<font")&&
(e=parseInt(b.substr(b.indexOf('<font size="')+12,1),10),b=b.replace(/<font size=\".*\">/gi,""),b=b.replace(/<\/font>/gi,""),Z.Utils.htmlReplaceSelection(b));a=e+("up"==a?1:-1);a=1>a?1:7<a?7:a;3!=a&&Z.Utils.htmlReplaceSelection('<font size="'+a.toString()+'">'+b+"</font>")}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_NARRATIVENOTEXTSELECTIONFORSTYLE"),!0,Z.messageDurationStandard,"center",null)};this.setCurrentParagraphAlignment=function(a){var b=Z.Utils.htmlGetSelectionParagraphNode();b&&
(b.style.textAlign=a)};this.setNarrativeDefaultImage=function(a){E("zImagePath",Z.imagePath)};this.setNarrativeDefaultAnnotations=function(a){E("zAnnotationPath",Z.annotationPath)};this.drawLayoutFileManagerPanel=function(){ja()};this.showNarrativePanelEditMode=function(a){da(a)};this.showFileManagerPanel=function(a,b){pa(a,b)};this.selectUploadFiles=function(){var a=document.getElementById("fileTypeList");a&&(a=a.options[a.selectedIndex].value,(a="Narratives"==a?document.getElementById("narrNarrativeUpInput"):
"Images"==a?document.getElementById("narrImageUpInput"):"Media"==a?document.getElementById("narrMediaUpInput"):"Label Sets"==a?document.getElementById("narrLabelUpInput"):null)&&a.click())};this.uploadFiles=function(a,b,e){if(Z.Utils.stringValidate(Z.fileHandlerPath))if(-1!=Z.fileHandlerPath.indexOf(Z.Utils.getResource("z13"))||Z.demoNoSave)Z.Utils.showMessage(Z.Utils.getResource("z14"),!1,Z.messageDurationStandard,"center",!0);else{Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEUPLOADING"),!1,
Z.messageDurationStandard,"center");Z.saveImageMessage=Z.Utils.getResource("ALERT_FILEUPLOADINPROGRESS");for(var f=0,g=b.length;f<g;f++){var k=a+Z.Utils.stringEscapeSpaces(b[f].name);(new Z.NetConnector).postFile(Z.fileHandlerPath,b[f],k,e)}}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLFILEHANDLERPATHINVALID"),!0,null,"center",!0)};this.showDownloadPanel=function(a){if(Vd&&Uc&&wc&&sc&&xc&&gc){var b=Z.Utils.getResource("CONTENT_FILESELECTITEMTEXT");if(Cd.value==b)Z.Utils.showMessage(Z.Utils.getResource("ERROR_FILEMANAGERNOFILESELECTION"),
!0,Z.messageDurationStandard,"center",null);else{Z.Narrative.showFileManagerPanel(!a);a=a?"inline-block":"none";Vd.style.display=a;Uc.style.display=a;wc.style.display=a;sc.style.display=a;xc.style.display=a;a=Z.Utils.getResource("ALERT_FILEMANAGERDOWNLOADNOCLICKTITLE");var e=Z.Utils.getResource("ALERT_FILEMANAGERDOWNLOADNOCLICKMESSAGE");wc.innerHTML='<a id="filenameDownloadLink" title="'+a+'" href="'+Z.Utils.stringEscapeSpaces(gc.options[gc.selectedIndex].value)+'">'+Z.Utils.stringEscapeSpaces(gc.options[gc.selectedIndex].text)+
"</a>";document.getElementById("filenameDownloadLink").onclick=function(){Z.Utils.showMessage(e,!1,Z.messageDurationStandard,"center",!1,"5");return!1}}}};this.downloadFiles=function(a,b,e){};this.createFile=function(a){if(a=document.getElementById("fileTypeList"))switch(a.options[a.selectedIndex].value){case "Narratives":u()&&C();Ab.createNarrative();break;case "Images":Z.Utils.showMessage(Z.Utils.getResource("ALERT_CREATINGIMAGE"),!0,null,"center");break;case "Media":Z.Utils.showMessage(Z.Utils.getResource("ALERT_CREATINGMEDIA"),
!0,null,"center");break;case "Label Sets":document.getElementById("imageList")&&Ab.createAnnotationFile(!0)}};this.createNarrative=function(){var a=Z.Utils.getCurrentUTCDateAsString();Z.narrativeText.innerHTML='<form id=narrativeDataForm method="post" action=""><input id = "zImagePath" name = "zImagePath" type = "hidden" value = '+Z.imagePath+' /><input id = "zAnnotationPath" name = "zAnnotationPath" type = "hidden" value = '+Z.annotationPath+' /><input id = "zUserName" name = "zUserName" type = "hidden" value = "" /><input id = "zDateTime" name = "zDateTime" type = "hidden" value = "" /></form>';
Z.narrativeText.innerHTML+="\n\n<div><p>"+Z.Utils.getResource("CONTENT_NARRATIVEPLACEHOLDERTEXT")+"</p></div>";Aa="Narrative-"+a;Z.narrativePath=Z.narrativeFolderPath+Aa+".htm";C(Aa)};this.createAnnotationFile=function(a){var b=Z.Utils.getCurrentUTCDateAsString();la=Z.imagePath.substring(Z.imagePath.lastIndexOf("/")+1,Z.imagePath.indexOf("."))+"-annotations-"+b+".xml";Z.annotationPath=Z.annotationFolder+"/"+la;Z.Viewport.createAnnotationsXMLFile(Z.annotationPath,a)};this.deleteFilePrep=function(){var a=
document.getElementById("fileTypeList");if(a&&Z.fileHandlerPath){var a=a.options[a.selectedIndex].value,b,e;switch(a){case "Narratives":a="narrative";b=n;e="ALERT_FILEMANAGERDELETINGNARRATIVE";break;case "Images":a="image";b=J;e="ALERT_FILEMANAGERDELETINGIMAGE";break;case "Media":a="media";b=W;e="ALERT_FILEMANAGERDELETINGMEDIA";break;case "Label Sets":a="labels",b=G,e="ALERT_FILEMANAGERDELETINGLABELSET"}var f=!0;null!==Z.narrativeMode&&(f=!0,null!==Z.narrativeMode&&(f=confirm(Z.Utils.getResource("ALERT_FILEMANAGERDELETEFILE"))));
f&&(Z.Utils.showMessage(Z.Utils.getResource(e),!1,Z.messageDurationStandard,"center",!1,"5"),"Narratives"==a?Aa=null:"Label Sets"==a&&(la=null),Z.setCallback("fileDeleted-"+a,b),b=new Z.NetConnector,a="deletingFile-"+a,e=document.getElementById("filenameList"),e=e.options[e.selectedIndex].value,e=Z.Utils.stringEscapeSpaces(e),b.deleteFile(Z.fileHandlerPath,a,e))}}};
Z.NetConnector=function(){function a(a,f,g,l,n){var w=a.substring(0,a.indexOf("?")),E=parseFloat(a.substring(a.indexOf("?")+1,a.indexOf(","))),J=parseFloat(a.substring(a.indexOf(",")+1,a.length)),E=new Z.Utils.Range(E,E+J);Z.useLocalFile?b(a,n,E,f,g,l,null):e(w,function(a){k(a,n)},E,f,g,l)}function b(a,b,e,f,g,k,n){e.end+=1;a=Z.localFile.slice(e.start,e.end);e=new FileReader;e.onloadend=function(a){a.target.readyState==FileReader.DONE&&l(a.target.result,b,f,g,k,n)};e.readAsArrayBuffer(a)}function e(a,
b,e,k,l,n,w,E,J,K){var G=f();if(null===G)Z.Utils.showMessage(Z.Utils.getResource("z295"));else{var W="function"===typeof b;if(W){var fa=b;b=function(){window.setTimeout(Z.Utils.createCallback(null,fa,G),1)};G.onreadystatechange=function(){4==G.readyState&&(G.onreadystatechange=new Function,b())}}try{if("undefined"!==typeof k){var F;if(-1!=a.indexOf("accessType")&&-1==a.indexOf("../../"))if(-1==k.indexOf("renamingFile")){var ca=a.indexOf("filePath=")+9;a=a.substring(0,ca)+"../../"+a.substring(ca)}else{var V=
a.indexOf("filePathOld=")+12;a=a.substring(0,V)+"../../"+a.substring(V);var ga=a.indexOf("filePathNew=")+12;a=a.substring(0,ga)+"../../"+a.substring(ga)}if(-1!=k.indexOf("List"))G.open("GET",a,W),Z.Utils.setObjectProperty(G,"zType",{value:k,writable:!1,enumerable:!1,configurable:!1}),G.setRequestHeader("Content-Type","application/json"),G.send(null);else if(-1!=k.indexOf("renamingFile"))G.open("POST",a,W),F=k.substring(k.indexOf("renamingFile-")+13,k.length),Z.Utils.setObjectProperty(G,"zType",{value:"renamingFile-"+
F,writable:!1,enumerable:!1,configurable:!1}),G.send(null);else if(-1!=k.indexOf("deletingFile"))G.open("POST",a,W),F=k.substring(k.indexOf("deletingFile-")+13,k.length),Z.Utils.setObjectProperty(G,"zType",{value:"deletingFile-"+F,writable:!1,enumerable:!1,configurable:!1}),G.send(null);else if("loadingIIIFJSON"==k)G.open("GET",a,W),G.send(null);else if(-1!=k.indexOf("loading")&&"undefined"===typeof e||null===e)G.open("GET",a,W),Z.Utils.setObjectProperty(G,"zType",{value:k,writable:!1,enumerable:!1,
configurable:!1}),"undefined"!==typeof E&&"undefined"!==typeof J&&"undefined"!==typeof K&&(Z.Utils.setObjectProperty(G,"zFilePath",{value:E,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(G,"zOldName",{value:J,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(G,"zNewName",{value:K,writable:!1,enumerable:!1,configurable:!1})),k&&-1!=k.indexOf("HTML")&&G.setRequestHeader("Content-Type","text/html"),G.send(null);else if(Z.localUse&&-1!=k.indexOf("post"))Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALSAVING"),
!1,Z.messageDurationStandard,"center",!0);else if("postingAnnotationsXML"==k||"postingTrackingXML"==k||"postingImageMetadata"==k){Z.postingXML=!0;G.open("POST",a,!0);Z.Utils.setObjectProperty(G,"zType",{value:k,writable:!1,enumerable:!1,configurable:!1});var ma=a.indexOf("&"),qa=a.indexOf("?");E=-1!=ma?a.substring(ma):a.substring(qa);Z.Utils.setObjectProperty(G,"zFile",{value:E,writable:!1,enumerable:!1,configurable:!1});G.setRequestHeader("Content-Type","application/xml");G.send(e)}else if("postingHTML"==
k)Z.postingHTML=!0,G.open("POST",a,!0),Z.Utils.setObjectProperty(G,"zType",{value:"postingHTML",writable:!1,enumerable:!1,configurable:!1}),G.setRequestHeader("Content-Type","text/html"),G.send(e);else if("postingImage"==k){Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVEUPLOADING"),!1,"none","center");Z.postingImage=!0;var oa=new FormData,ya=Z.legacySaveHandlerInUse?"fileToUpload":"fileData";a=Z.legacySaveHandlerInUse?a:a+"?accessType=saveImage";oa.append(ya,e);Z.Utils.addEventListener(G.upload,
"progress",Z.Utils.uploadProgress);G.open("POST",a,!0);Z.Utils.setObjectProperty(G,"zType",{value:k,writable:!1,enumerable:!1,configurable:!1});G.setRequestHeader("Content-Type","application/upload");G.send(oa)}else if("postingFile-narrative"==k||"postingFile-image"==k||"postingFile-media"==k||"postingFile-labelset"==k)Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEUPLOADING"),!1,"none","center"),Z.postingFile=!0,oa=new FormData,oa.append("filePath",e),Z.Utils.addEventListener(G.upload,"progress",
Z.Utils.uploadProgress),G.open("POST",a,!0),Z.Utils.setObjectProperty(G,"zType",{value:k,writable:!1,enumerable:!1,configurable:!1}),G.setRequestHeader("Content-Type","application/upload"),G.send(oa);else if("loadingZIFFileBytes"==k||"loadingPFFFileBytes"==k||"loadingImageTile"==k)"tile"!=l&&(a=Z.Utils.cacheProofPath(a)),G.open("GET",a,!0),G.responseType="arraybuffer",Z.Utils.setObjectProperty(G,"zType",{value:k,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(G,"zDataType",{value:l,
writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(G,"zTile",{value:n,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(G,"zChunkNumber",{value:w,writable:!1,enumerable:!1,configurable:!1}),Z.browser==Z.browsers.SAFARI&&G.setRequestHeader("If-Modified-Since","Thu, 01 Dec 1994 16:00:00 GMT"),G.setRequestHeader("Range","bytes="+e.start.toString()+"-"+e.end.toString()),G.send(null)}}catch(Ra){g(Ra,a,k),G=null,console.log(Ra)}}}function f(){var a=null;switch(Z.xmlHttpRequestSupport){case "XMLHttpRequest":a=
new XMLHttpRequest;break;case "Msxml2.XMLHTTP.6.0":a=new ActiveXObject("Msxml2.XMLHTTP.6.0");break;case "Msxml2.XMLHTTP.3.0":a=new ActiveXObject("Msxml2.XMLHTTP.3.0");break;case "Microsoft.XMLHTTP":a=new ActiveXObject("Microsoft.XMLHTTP")}return a}function g(a,b,e){1==Z.localUse&&(Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&7<=Z.browserVersion)?Z.Utils.showMessage(Z.Utils.getResource("z288"),!1,Z.messageDurationStandard,
"center"):1==Z.localUse&&"ZoomifyZIFFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z290"),!1,Z.messageDurationShort,"center"):1==Z.localUse&&"ZoomifyPFFFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z289"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(".zif")?Z.Utils.showMessage(Z.Utils.getResource("z256-ZIFBYTERANGE")+e+".",!1,Z.messageDurationShort,"center"):-1!=b.indexOf("ImageProperties.xml")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML"),
!0,null,"left"):-1!=b.toLowerCase().indexOf(".pff")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEHEADER"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(".pff")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML-DZI"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf("reply_data")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEOFFSET"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z200"))?Z.Utils.showMessage(Z.Utils.getResource("z256-TOOLBARSKINSXML"),
!0,null,"left"):-1!=b.indexOf(Z.Utils.getResource("DEFAULT_IMAGELISTXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGELISTXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("DEFAULT_COMPARISONXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("z256-COMPARISONXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z209"))?Z.Utils.showMessage(Z.Utils.getResource("z256-SLIDESXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z135"))?
Z.Utils.showMessage(Z.Utils.getResource("z256-HOTSPOTSXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z69"))?(Z.Utils.showMessage(Z.Utils.getResource("z256-CREATINGANNOTATIONSXMLFILE"),!1,Z.messageDurationShort,"center"),Z.Viewport.createAnnotationsXMLFile()):-1!=b.indexOf(Z.Utils.getResource("z68"))?Z.Utils.showMessage(Z.Utils.getResource("z256-ANNOTATIONSJSON"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(Z.Utils.getResource("z69HANDLERNAME1"))||-1!=
b.toLowerCase().indexOf(Z.Utils.getResource("z69HANDLERNAME1"))?Z.Utils.showMessage(Z.Utils.getResource("z256-ANNOTATIONSFILEHANDLER"),!1,Z.messageDurationShort,"center"):Z.Utils.showMessage(Z.Utils.getResource("z256"),!1,Z.messageDurationShort,"center")}function k(a,b){if(a)if(200!==a.status&&0!==a.status&&206!==a.status){var e=a.status,f=404==e?"Not Found":a.statusText;if(404==e&&"loadingImageMetadataXML"==a.zType)Z.Utils.validateCallback("loadingImageMetadataXMLFailed");else if(404==e&&"loadingAnnotationsXML"==
a.zType)Z.Utils.validateCallback("loadingAnnotationsXMLFailed");else if(Z.xmlParametersParsing)Z.Utils.showMessage(Z.Utils.getResource("z256-PARAMETERSXML"),!0,null,"left");else if(Z.Toolbar&&!Z.Toolbar.getInitialized())Z.Utils.showMessage(Z.Utils.getResource("z256-TOOLBARSKINSXML"),!0,null,"left");else if(Z.Viewport&&null!==Z.annotationPath&&Z.Viewport.getStatus("initializedViewport")&&!Z.Viewport.getStatus("XMLParsedViewport"))Z.Utils.showMessage(Z.Utils.getResource("z256-CREATINGANNOTATIONSXMLFILE"),
!1,Z.messageDurationShort,"center"),Z.Viewport.createAnnotationsXMLFile();else if("ZoomifyZIFFile"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z273RANGEREQUESTSZIF")+e+" - "+f,!0,null,"left");else if("ZoomifyPFFFile"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z273RANGEREQUESTSPFF")+e+" - "+f,!0,null,"left");else if("DZIFolder"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML-DZI")+e+" - "+f,!0,null,"left");else{var g=Z.Utils.verifyCallback("loadingImageXMLFailed");
g?(Z.Utils.validateCallback("loadingImageXMLFailed"),console.log(Z.Utils.getResource("z273")+e+" - "+f)):Z.Utils.showMessage(Z.Utils.getResource("z273")+e+" - "+f,!1,Z.messageDurationShort,"center")}}else if(a.zType)if(e=null,f="undefined"!==typeof Z.annotationPath&&Z.Utils.stringValidate(Z.annotationPath)&&".json"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-5,Z.annotationPath.length),"postingImage"==a.zType&&Z.postingImage)Z.postingImage=!1,(g=Z.Utils.verifyCallback("imageSaveComplete"))?
(Z.Utils.hideMessage(),Z.Utils.validateCallback("imageSaveComplete")):Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVESUCCESSFUL"),!1,Z.messageDurationShort,"center");else if(("postingFile-narrative"==a.zType||"postingFile-image"==a.zType||"postingFile-media"==a.zType||"postingFile-labelset"==a.zType)&&Z.postingFile)Z.postingFile=!1,"postingFile-narrative"==a.zType?Z.Utils.validateCallback("narrativeFileUploaded"):"postingFile-image"==a.zType?Z.Utils.validateCallback("narrativeImageUploaded"):
"postingFile-media"==a.zType?Z.Utils.validateCallback("narrativeMediaUploaded"):"postingFile-labelset"==a.zType&&Z.Utils.validateCallback("narrativeAnnotationFileUploaded"),Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEUPLOADSUCCESSFUL"),!1,Z.messageDurationShort,"center");else if("loadingZIFFileBytes"==a.zType||"loadingImageTile"==a.zType&&"ZoomifyZIFFile"==Z.tileSource)l(a,b,a.zType,a.zDataType);else if("loadingPFFFileBytes"==a.zType||"loadingImageTile"==a.zType&&"ZoomifyPFFFile"==Z.tileSource)l(a,
b,a.zType,a.zDataType);else{if(""==a.responseType||"document"==a.responseType)a.responseXML&&a.responseXML.documentElement&&!f?(e=a.responseXML,n(e,b)):a.responseText&&((e=a.responseText,"narrativeList"==a.zType||"mediaList"==a.zType||"imageList"==a.zType||"annotationFileList"==a.zType)?(e=Z.Utils.stringUnescapeSpaces(e),E(e,b,a.zType)):"postingHTML"==a.zType?(Z.postingHTML=!1,-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NARRATIVESAVESUCCESSFUL"),!1,
Z.messageDurationShort,"center"),Z.narrative&&Z.Utils.validateCallback("narrativeFilePosted")):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,"center")):"loadingAnnotationsJSON"!=a.zType||-1==e.indexOf("ANNOTATIONDATA")&&-1==e.indexOf("ZAS")&&-1==e.indexOf("Annotations")||!f?"postingAnnotationsXML"==a.zType||"postingTrackingXML"==a.zType||"postingImageMetadata"==a.zType?(Z.postingXML=!1,Z.Utils.showMessage(Z.Utils.getResource("z1"),!1,Z.messageDurationShort,"center",!1,"5"),Z.Viewport&&
Z.Viewport.setAllHotspotsSaved(),Z.narrative&&Z.Utils.validateCallback("narrativeAnnotationFilePosted")):-1!=a.zType.indexOf("renamingFile")?-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEMANAGERRENAMESUCCESSFUL"),!1,Z.messageDurationShort,"center",!1,"5"),e="newFilenamePosted-",fileType=a.zType.substring(a.zType.indexOf("renamingFile-")+13,a.zType.length),Z.Utils.validateCallback(e+fileType)):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,
"center"):-1!=a.zType.indexOf("deletingFile")?-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEMANAGERDELETIONSUCCESSFUL"),!1,Z.messageDurationShort,"center",!1,"5"),e="fileDeleted-",fileType=a.zType.substring(a.zType.indexOf("deletingFile-")+13,a.zType.length),Z.Utils.validateCallback(e+fileType)):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,"center"):"ZoomifyImageFolder"==Z.tileSource?(e=Z.Utils.xmlConvertTextToDoc(e),n(e,b)):
"ZoomifyZIFFile"==Z.tileSource?(e=Z.Utils.xmlConvertTextToDoc(e),n(e,b)):"ZoomifyPFFFile"==Z.tileSource&&(-1!=e.toUpperCase().indexOf("PFFHEADER")?(f=e.indexOf("reply_data=")+11,e=e.substring(f,e.length)):(f=e.indexOf("begin=")+6,g=e.indexOf("&",f),beginValue=e.substring(f,g),f=e.indexOf("reply_data=")+11,replyDataValue=e.substring(f,e.length),e="<PFFOFFSET BEGIN='"+beginValue+"' REPLYDATA='"+replyDataValue+"' />"),e=Z.Utils.xmlConvertTextToDoc(e),n(e,b)):E(e,b,"loadingAnnotationsJSON"))}else"IIIFImageServer"==
Z.tileSource&&a.responseText&&E(a.responseText,b,"loadingIIIFJSON");else Z.Utils.showMessage(Z.Utils.getResource("z272"),!1,Z.messageDurationShort,"center")}function l(a,b,e,f,g,k){if(Z.Viewport)if(Z.useLocalFile||(k=a.zChunkNumber,g=a.zTile),a=new Z.Utils.createUint8Array(Z.useLocalFile?a:a.response,0),"header"==f)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFHeader(a):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFHeader(a);
else{e=0;for(var l=Z.imageSetLength;e<l;e++)"ZoomifyZIFFile"==Z.tileSource?b==e&&Z["Viewport"+e.toString()].parseZIFHeader(a):"ZoomifyPFFFile"==Z.tileSource&&b==e&&Z["Viewport"+e.toString()].parsePFFHeader(a)}else if("jpegHeaders"==f)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport.parsePFFJPEGHeaders(a);else for(e=0,l=Z.imageSetLength;e<l;e++)b==e&&Z["Viewport"+e.toString()].parsePFFJPEGHeaders(a);else if("offset"==f)if(null===Z.tileSourceMultiple||"undefined"===typeof b||
null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFOffsetChunk(a,k):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFOffsetChunk(a,k);else for(e=0,l=Z.imageSetLength;e<l;e++)"ZoomifyZIFFile"==Z.tileSource?b==e&&Z["Viewport"+e.toString()].parseZIFOffsetChunk(a,k):"ZoomifyPFFFile"==Z.tileSource&&b==e&&Z["Viewport"+e.toString()].parsePFFOffsetChunk(a,k);else if("byteCount"==f)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport.parseZIFByteCountChunk(a,k);else for(e=
0,l=Z.imageSetLength;e<l;e++)b==e&&Z["Viewport"+e.toString()].parseZIFByteCountChunk(a,k);else if(f&&"image"==f.substring(0,5))if(W--,null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFImage(a,g,f):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFImage(a,g,f);else for(e=0,l=Z.imageSetLength;e<l;e++)"ZoomifyZIFFile"==Z.tileSource?b==e&&Z["Viewport"+e.toString()].parseZIFImage(a,g,f):"ZoomifyPFFFile"==Z.tileSource&&b==e&&Z["Viewport"+e.toString()].parsePFFImage(a,
g,f);else if("gallery"==f)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.viewportCurrent.parseZIFImage(a,g,f):"ZoomifyPFFFile"==Z.tileSource&&Z.viewportCurrent.parsePFFImage(a,g,f);else for(e=0,l=Z.imageSetLength;e<l;e++)"ZoomifyZIFFile"==Z.tileSource?b==e&&Z["Viewport"+e.toString()].parseZIFImage(a,g,f):"ZoomifyPFFFile"==Z.tileSource&&b==e&&Z["Viewport"+e.toString()].parsePFFImage(a,g,f);else"loadingZIFFileBytes"==e||"loadingImageTile"==e&&"ZoomifyZIFFile"==
Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z256-ZIFBYTES"),!1,Z.messageDurationShort,"center"):("loadingPFFFileBytes"==e||"loadingImageTile"==e&&"ZoomifyPFFFile"==Z.tileSource)&&Z.Utils.showMessage(Z.Utils.getResource("z256-PFFBYTES"),!1,Z.messageDurationShort,"center")}function E(a,b,e){var f=null;try{f=JSON.parse(a)}catch(g){Z.Utils.showMessage(g.name+Z.Utils.getResource("z276")+g.message)}if(f)if("narrativeList"==e)b=Z.Utils.jsonConvertObjectToDataProvider(f),Z.Narrative.configureNarrativeList(b);
else if("imageList"==e)b=Z.Utils.jsonConvertObjectToDataProvider(f),Z.Narrative.configureNarrativeImageChoiceList(b);else if("mediaList"==e)b=Z.Utils.jsonConvertObjectToDataProvider(f),Z.Narrative.configureNarrativeMediaChoiceList(b);else if("annotationFileList"==e)b=Z.Utils.jsonConvertObjectToDataProvider(f),Z.Narrative.configureAnnotationFileChoiceListFromNarrative(b);else if("loadingIIIFJSON"==e)if(Z.iiifInfoJSONObject=f,a='<IMAGE_PROPERTIES WIDTH="'+f.width+'" HEIGHT="'+f.height+'" />',a=Z.Utils.xmlConvertTextToDoc(a),
"undefined"===typeof b||null===b||null===Z.imageSetLength)Z.Viewport&&Z.Viewport.z602(a);else for(e=0,f=Z.imageSetLength;e<f;e++)b==e&&Z["Viewport"+e.toString()].z602(a);else if("loadingAnnotationsJSON"==e)if(Z.annotationJSONObject=f,a=Z.Utils.jsonConvertObjectToXMLText(f),a=Z.Utils.xmlConvertTextToDoc(a),"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseAnnotationsXML(a);else for(e=0,f=Z.imageSetLength;e<f;e++)b==e&&Z["Viewport"+e.toString()].parseAnnotationsXML(a);else Z.overlays?(Z.overlayJSONObject=
f,a=Z.Utils.jsonConvertObjectToXMLText(f),a=Z.Utils.xmlConvertTextToDoc(a),Z.Viewer&&Z.Viewer.parseImageSetXML(a,"overlay")):Z.Utils.showMessage(Z.Utils.getResource("z276-TYPEUNKNOWN"))}function n(a,b){if(a&&a.documentElement){var e=a.documentElement.tagName;if(Z.xmlParametersParsing)Z.Utils.parseParametersXML(a);else if("USERDATA"==e)Z.Utils.parseUsersXML(a);else if("COPYRIGHT"==e){var e=a.documentElement.getAttribute("STATEMENTTEXT"),f=a.documentElement.getAttribute("DECLINEDTEXT");Z.Utils.stringValidate(e)?
Z.Utils.showCopyright(e,f):Z.Utils.showMessage(Z.Utils.getResource("z255"),!0)}else if("IMAGE_PROPERTIES"==e||"ZIFHEADER"==e||"PFFHEADER"==e||"Image"==e){if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyImageFolder"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource||"DZIFolder"==Z.tileSource||"ImageServer"==Z.tileSource)if("multiple"!=Z.imagePath)e="undefined"===typeof b||null===b||0==b?Z.Viewport:Z["Viewport"+b.toString()],e.z602(a);else for(e=0,f=Z.imageSetLength;e<f;e++)b==e&&Z["Viewport"+e.toString()].z602(a)}else if("PFFOFFSET"==
e)if("multiple"!=Z.imagePath)e=null===Z.tileSourceMultiple||"undefined"===typeof b||null===b||0==b?Z.Viewport:Z["Viewport"+b.toString()],e.parsePFFOffsetChunkServlet(a);else for(e=0,f=Z.imageSetLength;e<f;e++)b==e&&Z["Viewport"+e.toString()].parsePFFOffsetChunkServlet(a);else if("SKINDATA"==e)"function"===typeof Z.xmlCallbackFunction?Z.xmlCallbackFunction(a):Z.Toolbar&&Z.Toolbar.parseSkinXML(a);else if("IMAGEMETADATA"==e)Z.Viewport&&Z.Viewport.parseImageMetadataXML(a);else if("IMAGELISTDATA"==e)if(null===
Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseImageListXML(a);else for(e=0,f=Z.imageSetLength;e<f;e++)b==e&&Z["Viewport"+e.toString()].parseImageListXML(a,b);else if("COMPARISONDATA"==e)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"comparison");else if("OVERLAYDATA"==e)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"overlay");else if("SLIDEDATA"==e)Z.Viewport&&Z.Viewport.parseSlidesXML(a);else if("HOTSPOTDATA"==e)if("undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseHotspotsXML(a);
else for(e=0,f=Z.imageSetLength;e<f;e++)b==e&&Z["Viewport"+e.toString()].parseHotspotsXML(a);else if("ANIMATIONDATA"==e)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"animation");else if("GEODATA"==e)Z.Viewport&&Z.Viewport.parseGeoCoordinatesXML(a);else if("ANNOTATIONDATA"==e||"ZAS"==e||"Annotations"==e)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseAnnotationsXML(a);else for(e=0,f=Z.imageSetLength;e<f;e++)b==e&&Z["Viewport"+e.toString()].parseAnnotationsXML(a,
b);else if("SLIDESTACKDATA"==e)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"slidestack");else if("TRACKINGDATA"==e)if("undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseTrackingXML(a);else for(e=0,f=Z.imageSetLength;e<f;e++)b==e&&Z["Viewport"+e.toString()].parseTrackingXML(a,b);else Z.postingImage?Z.Utils.showMessage(Z.Utils.getResource("ERROR_SAVEIMAGEHANDLERPATHINVALID"),!0):Z.Utils.showMessage(Z.Utils.getResource("z296"),!0)}else Z.Utils.showMessage(Z.Utils.getResource("z293"),!0)}function w(b,
e,f,g,k,l){if(W<J)return W++,("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource&&null===Z.tileHandlerPathFull)&&("undefined"!==typeof k&&null!==k||"navigator"==f)?a(b,f,g,k,l):(e=Z.Utils.createCallback(null,G,e),(new K(b,e,f)).start()),!0;-1==Z.Utils.arrayIndexOfObjectValue(fa,"sc",b)&&(fa[fa.length]={sc:b,cb:e,ct:g,t:k},ma||(ma=window.setInterval(function(){var a=fa[0];w(a.sc,a.cb,"loadingImageFromQueue",a.ct,a.t)&&(fa=Z.Utils.arraySplice(fa,0,1));0==fa.length&&ma&&(window.clearInterval(ma),
ma=null)},ga)));return!1}function G(a,b,e){W--;if("function"===typeof a)try{a(e)}catch(f){Z.Utils.showMessage(f.name+Z.Utils.getResource("z245")+b+" "+f.message,!0)}}function K(a,b,e){function f(e){g.onload=null;g.onabort=null;g.onerror=null;k&&window.clearTimeout(k);window.setTimeout(function(){b(a,e?g:null)},1)}var g=null,k=null;this.start=function(){g=new Image;var b=function(){f(!1)};g.onload=function(){f(!0)};g.onabort=b;g.onerror=b;k=window.setTimeout(function(){console.log(Z.Utils.getResource("z253"));
f(!1);Z.Viewport.traceDebugValues("imageRequestTimeout",e+" timeout: "+a)},oa);g.src=a}}var W=0,J=parseInt(Z.Utils.getResource("z140"),10),oa=parseFloat(Z.Utils.getResource("z139")),ga=Z.Utils.getResource("DEFAULT_IMAGELOADQUEUEDELAY"),ma,fa=[];this.loadHTML=function(a,b,f,g){e(a,b,null,g)};this.loadHTMLToRenameIn=function(a,b,f,g,k,l){e(a,b,null,g,null,null,null,a,k,l)};this.loadXML=function(a,b,f){"undefined"===typeof b||null===b?e(a,k,null,f):e(a,function(a){k(a,b)},null,f)};this.loadFileList=
function(a,b,f,g){if(!Z.localUse&&"undefined"!==typeof b&&Z.Utils.stringValidate(b)){var l="undefined"!==typeof f&&Z.Utils.stringValidate(f)?"filePath="+f:"",n="undefined"!==typeof g&&Z.Utils.stringValidate(g)?"fileTypes="+g:"",w=""!=l&&""!=n?"&":"";e(a+(""!=l||""!=n?"?":"")+"accessType=list"+w+"filePath="+f+w+"fileTypes="+g,k,null,b)}};this.renameFile=function(a,b,f,g){"undefined"!==typeof f&&Z.Utils.stringValidate(f)&&"undefined"!==typeof g&&Z.Utils.stringValidate(g)&&e(a+"?accessType=rename&filePathOld="+
f+"&filePathNew="+g,k,null,b)};this.deleteFile=function(a,b,f){f="undefined"!==typeof f&&Z.Utils.stringValidate(f)?"filePath="+f:"";e(a+"?accessType=delete&"+f,k,null,b)};this.loadJSON=function(a,b,f){"undefined"===typeof b||null===b?e(a,k,null,f):e(a,function(a){k(a,b)},null,f)};this.loadByteRange=function(a,f,g,l,n,w,E,G){f=new Z.Utils.Range(f,g);Z.useLocalFile?b(a,G,f,l,n,w,E):e(a,function(a){k(a,G)},f,l,n,w,E)};this.postXML=function(a,b,f,g){if("undefined"!==typeof g&&Z.Utils.stringValidate(g)){var l=
Z.legacySaveHandlerInUse?"":"accessType=save";e(a+"?"+l+(""!=l?"&":"")+(Z.legacySaveHandlerInUse?"file="+g:"filePath="+g),k,b,f)}};this.postHTML=function(a,b,f){"undefined"!==typeof f&&Z.Utils.stringValidate(f)&&e(a+"?accessType=save&"+("filePath="+f),k,b,"postingHTML")};this.postImage=function(a,b){e(a,k,b,"postingImage")};this.postFile=function(a,b,f,g){"undefined"!==typeof f&&Z.Utils.stringValidate(f)&&e(a+"?accessType=save&"+("filePath="+f),k,b,"postingFile-"+g)};this.loadImage=function(a,b,e,
f,g,k){w(a,b,e,f,g,k)}};
Z.Utils={addCrossBrowserMethods:function(){document.addEventListener?(this.disableTextInteraction=function(a){if(a){var b=a.parentNode.style;b&&(a.parentNode.unselectable="on",b.userSelect="none",b.MozUserSelect="none",b.webkitUserSelect="none",b.webkitTouchCallout="none",b.webkitTapHighlightColor="transparent")}},this.renderQuality=function(a,b){b&&a.style.setProperty("image-rendering","high"==b?"optimizeQuality":"optimizeSpeed",null)},this.setOpacity=function(a,b,e){Z.alphaSupported?a.style.opacity=
b:e&&(a.style.backgroundColor=e)}):document.attachEvent&&(this.disableTextInteraction=function(a){a&&(a.parentNode.unselectable="on",a.parentNode.onselectstart=function(){return!1})},this.renderQuality=function(a,b){b&&(a.style.msInterpolationMode="high"==b?"bicubic":"nearest-neighbor")},this.setOpacity=function(a,b,e){Z.alphaSupported?(b*=100,a.style.zoom=1,a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")",a.style.filter="alpha(opacity="+b+")",100==b&&(a.style.filter="")):e&&
(a.style.backgroundColor=e)})},addCrossBrowserEvents:function(){document.addEventListener?(this.addEventListener=function(a,b,e){a&&("mousewheel"==b&&a.addEventListener("DOMMouseScroll",e,!1),a.addEventListener(b,e,!1))},this.removeEventListener=function(a,b,e){a&&("mousewheel"==b&&a.removeEventListener("DOMMouseScroll",e,!1),a.removeEventListener(b,e,!1))},this.event=function(a){return a},this.target=function(a){return a.target},this.relatedTarget=function(a){return a.relatedTarget},this.isRightMouseButton=
function(a){var b=!1;if(2==a.which||3==a.which)b=!0;return b},this.preventDefault=function(a){a.preventDefault()},this.stopPropagation=function(a){a.stopPropagation()}):document.attachEvent&&(this.addEventListener=function(a,b,e){if(-1==this._findListener(a,b,e)){var f=function(){var b=window.event;Function.prototype.call?e.call(a,b):(a._currentListener=e,a._currentListener(b),a._currentListener=null)};a.attachEvent("on"+b,f);b={target:a,eventName:b,handler:e,handler2:f};var f=(a.document||a).parentWindow,
g="l"+this._listenerCounter++;f._allListeners||(f._allListeners={});f._allListeners[g]=b;a._listeners||(a._listeners=[]);a._listeners[a._listeners.length]=g;f._unloadListenerAdded||(f._unloadListenerAdded=!0,f.attachEvent("onunload",this._removeAllListeners))}},this.removeEventListener=function(a,b,e){if(a&&(e=this._findListener(a,b,e),-1!=e)){var f=(a.document||a).parentWindow,g=a._listeners[e];a.detachEvent("on"+b,f._allListeners[g].handler2);a._listeners=Z.Utils.arraySplice(a._listeners,e,1);delete f._allListeners[g]}},
this.event=function(a){return window.event},this.target=function(a){return a.srcElement},this.relatedTarget=function(a){var b=null;"mouseover"==a.type?b=a.fromElement:"mouseout"==a.type&&(b=a.toElement);return b},this.isRightMouseButton=function(a){var b=!1;2==a.button&&(b=!0);return b},this.preventDefault=function(a){a&&(a.returnValue=!1)},this.stopPropagation=function(a){a.cancelBubble=!0},this._findListener=function(a,b,e){var f=a._listeners;if(!f)return-1;a=(a.document||a).parentWindow;for(var g=
f.length-1;0<=g;g--){var k=a._allListeners[f[g]];if(k&&k.eventName==b&&k.handler==e)return g}return-1},this._removeAllListeners=function(){for(id in this._allListeners){var a=this._allListeners[id];a.target.detachEvent("on"+a.eventName,a.handler2);delete this._allListeners[id]}},this._listenerCounter=0)},declareGlobals:function(){Z.pageContainerID=null;Z.pageContainer=null;Z.imagePath=null;Z.usingDirectoryExtensions=null;Z.imageFilename=null;Z.imagePath2=null;Z.imageMetadataXML=null;Z.parameters=
null;Z.xmlParametersPath=null;Z.xMLParametersPath=null;Z.xmlParametersParsing=null;Z.xMLParametersParsing=null;Z.skinPath=null;Z.skinMode=null;Z.cacheProofCounter=0;Z.timerCounter=0;Z.platform=null;Z.browsers=null;Z.browser=null;Z.browserVersion=null;Z.scaleThreshold=null;Z.canvasSupported=null;Z.cssTransformsSupported=null;Z.cssTransformProperty=null;Z.cssTransformNoUnits=null;Z.alphaSupported=null;Z.renderQuality=null;Z.ellipseDrawingSupported=null;Z.rotationSupported=null;Z.fullScreenSupported=
null;Z.arrayMapSupported=null;Z.arraySpliceSupported=null;Z.float32ArraySupported=null;Z.uInt8ArraySupported=null;Z.localFilesSupported=null;Z.useLocalFile=null;Z.localFile=null;Z.xmlHttpRequestSupport=null;Z.definePropertySupported=null;Z.responseArraySupported=null;Z.responseArrayPrototyped=!1;Z.definedObjectPropertiesArr=[];Z.touchSupport=null;Z.gestureSupport=null;Z.mobileDevice=null;Z.localUse=null;Z.singleFileSupported=null;Z.onReady=null;Z.onAnnotationReady=null;Z.initialX=null;Z.initialY=
null;Z.initialZ=null;Z.initialZoom=null;Z.minZ=null;Z.minZoom=null;Z.maxZ=null;Z.maxZoom=null;Z.zoomSpeed=null;Z.panSpeed=null;Z.smoothPan=null;Z.smoothPanEasing=null;Z.smoothZoom=null;Z.smoothZoomEasing=null;Z.smoothPanGlide=null;Z.autoResize=null;Z.fadeIn=null;Z.fadeInSpeed=null;Z.toolbarInternal=null;Z.toolbarVisible=null;Z.toolbarBackgroundVisible=null;Z.toolbarAutoShowHide=null;Z.toolbarW=null;Z.toolbarH=null;Z.toolbarPosition=null;Z.navigatorVisible=null;Z.navigatorW=null;Z.navigatorWidth=null;
Z.navigatorH=null;Z.navigatorHeight=null;Z.navigatorL=null;Z.navigatorLeft=null;Z.navigatorT=null;Z.navigatorTop=null;Z.navigatorFit=null;Z.navigatorRectangleColor=null;Z.GalleryScrollPanel=null;Z.galleryVisible=null;Z.galleryM=null;Z.galleryAutoShowHide=null;Z.galleryW=null;Z.galleryWidth=null;Z.galleryH=null;Z.galleryHeight=null;Z.galleryL=null;Z.galleryT=null;Z.galleryPosition=null;Z.galleryRectangleColor=null;Z.mouseIsDownGallery=null;Z.clickZoom=null;Z.doubleClickZoom=null;Z.doubleClickDelay=
null;Z.clickPan=null;Z.zoomAndPanInProgressID=null;Z.clickZoomAndPanBlock=!1;Z.mousePan=null;Z.keys=null;Z.constrainPan=null;Z.constrainPanLimit=null;Z.constrainPanStrict=null;Z.panBuffer=null;Z.tooltipsVisible=null;Z.helpVisible=null;Z.helpPath=null;Z.helpCustom=!1;Z.helpContent=null;Z.helpW=null;Z.helpWidth=null;Z.helpH=null;Z.helpHeight=null;Z.helpL=null;Z.helpLeft=null;Z.helpT=null;Z.helpTop=null;Z.minimizeVisible=null;Z.sliderZoomVisible=null;Z.sliderVisible=null;Z.zoomButtonsVisible=null;Z.panButtonsVisible=
null;Z.resetVisible=null;Z.fullViewVisible=null;Z.fullScreenVisible=null;Z.fullPageVisible=null;Z.initialFullPage=null;Z.fullPageInitial=null;Z.fullScreenEntering=null;Z.progressVisible=null;Z.messagesVisible=null;Z.logoVisible=null;Z.logoLink=null;Z.logoLinkURL=null;Z.logoCustomPath=null;Z.bookmarksGet=null;Z.bookmarksSet=null;Z.copyrightPath=null;Z.watermarkPath=null;Z.watermarks=null;Z.virtualPointerVisible=null;Z.virtualPointerPath=null;Z.crosshairsVisible=null;Z.zoomRectangle=null;Z.rulerVisible=
null;Z.units=null;Z.unitsPerImage=null;Z.pixelsPerUnit=null;Z.sourceMagnification=null;Z.magnification=null;Z.rulerListType=null;Z.rulerW=null;Z.rulerWidth=null;Z.rulerH=null;Z.rulerHeight=null;Z.rulerL=null;Z.rulerLeft=null;Z.rulerT=null;Z.rulerTop=null;Z.measureVisible=!1;Z.rotationVisible=null;Z.rotationFree=null;Z.initialR=null;Z.initialRotation=null;Z.imageListPath=null;Z.imageList=null;Z.imageListTitle=null;Z.imageListFolder=null;Z.imageListFileShared=!1;Z.imageSetImageListPath=null;Z.imageListTimeout=
null;Z.screensaver=!1;Z.screensaverSpeed=null;Z.tour=!1;Z.tourPath=null;Z.tourListTitle=null;Z.tourPlaying=null;Z.tourStop=!1;Z.comparison=!1;Z.comparisonPath=null;Z.syncVisible=null;Z.initialSync=null;Z.syncComparison=null;Z.slideshow=!1;Z.slidePath=null;Z.slideListTitle=null;Z.slideButtonsVisible=null;Z.slideshowPlaying=null;Z.slideshowStopping=null;Z.slideTransitionTimeout=null;Z.slideTransitionSpeed=null;Z.slideOpacity=0;Z.audioContent=!1;Z.audioMuted=!1;Z.audioPlaying=null;Z.audioStopped=null;
Z.hotspots=!1;Z.hotspotPath=null;Z.hotspotFolder=null;Z.hotspotListTitle=null;Z.hotspotsDrawOnlyInView=!0;Z.captionBoxes=!1;Z.captionsColorsDefault=!0;Z.captionOffset=null;Z.maskVisible=null;Z.maskScale=null;Z.maskBorder=null;Z.maskingSelection=!1;Z.maskFadeTimeout=null;Z.maskFadeSpeed=null;Z.maskOpacity=0;Z.maskClearOnUserAction=null;Z.annotations=!1;Z.annotationPath=null;Z.annotationFolder=null;Z.annotationXMLText=null;Z.labelShapesInternal=null;Z.annotationJSONObject=null;Z.annotationsAddMultiple=
null;Z.annotationsAutoSave=null;Z.annotationsAutoSaveImage=null;Z.annotationPanelVisible=null;Z.annotationPanelVisibleState=!1;Z.clickURLEntryVisible=null;Z.saveButtonVisible=null;Z.labelClickSelect=null;Z.labelHighlight=null;Z.simplePath=!1;Z.noPost=!1;Z.noPostDefaults=!0;Z.unsavedEditsTest=!0;Z.externalEditPermissionFunction=null;Z.annotationSort="none";Z.annotationXMLAperioLoad=null;Z.annotationXMLAperioPost=null;Z.fileHandlerPath=null;Z.fileHandlerProvided=!1;Z.saveHandlerPath=null;Z.saveImageHandlerPath=
null;Z.saveImageFull=null;Z.postingXML=!1;Z.postingHTML=!1;Z.postingImage=!1;Z.postingFile=!1;Z.magnifierVisible=null;Z.magnifierW=null;Z.magnifierH=null;Z.magnifierL=null;Z.magnifierT=null;Z.narrativePath=null;Z.narrativeFolderPath=null;Z.narrativeImageFolderPath=null;Z.narrativeMediaFolderPath=null;Z.narrativeAnnotationFolderPath=null;Z.narrative=null;Z.narrativeMode=null;Z.narrativeW=0;Z.narrativeImageListTitle=null;Z.narrativePathProvided=!1;Z.narrativeHelpPath=null;Z.narrativeHelpContent=null;
Z.narrativeText=null;Z.narrativeTextPrior=null;Z.annotationFileList=null;Z.coordinatesVisible=null;Z.geoCoordinatesPath=null;Z.geoCoordinatesVisible=null;Z.geoCoordinatesFolder=null;Z.preloadVisible=null;Z.imageFilters=null;Z.imageFiltersVisible=null;Z.initialImageFilters=null;Z.brightnessVisible=null;Z.contrastVisible=null;Z.sharpnessVisible=null;Z.blurrinessVisible=null;Z.colorRedVisible=null;Z.colorGreenVisible=null;Z.colorBlueVisible=null;Z.colorRedRangeVisible=null;Z.colorGreenRangeVisible=null;
Z.colorBlueRangeVisible=null;Z.gammaVisible=null;Z.gammaRedVisible=null;Z.gammaGreenVisible=null;Z.gammaBlueVisible=null;Z.hueVisible=null;Z.saturationVisible=null;Z.lightnessVisible=null;Z.whiteBalanceVisible=null;Z.normalizeVisible=null;Z.equalizeVisible=null;Z.noiseVisible=null;Z.grayscaleVisible=null;Z.thresholdVisible=null;Z.inversionVisible=null;Z.edgesVisible=null;Z.sepiaVisible=null;Z.saveImageFull=null;Z.saveImageFilename=null;Z.saveImageFormat=null;Z.saveImageCompression=null;Z.saveImageBackColor=
null;Z.tracking=!1;Z.trackingPath=null;Z.trackingFolder=null;Z.trackingPathProvided=!1;Z.trackingEditMode=!1;Z.trackingFileShared=!1;Z.imageSetTrackingPath=null;Z.trackingPanelPosition=null;Z.trackingCounts=[];Z.trackingTypeCurrent="0";Z.trackingOverlayVisible=!1;Z.initialTrackingOverlayVisible=null;Z.trackingCellCurrent=null;Z.trackingPanelVisible=null;Z.trackingPanelVisibleState=!1;Z.userName=null;Z.userInitials=null;Z.userLogin=null;Z.userNamePrompt=null;Z.userNamePromptRetry=null;Z.userPath=null;
Z.userFolder=null;Z.userPathProvided=!1;Z.userList=[];Z.userLogging=!1;Z.UserPanel=null;Z.userPanelVisible=null;Z.userPanelPosition=0;Z.userPanelVisibleState=!1;Z.canvas=null;Z.baseZIndex=null;Z.debug=null;Z.hideOverlayBackfill=null;Z.demoNoSave=null;Z.imageProperties=null;Z.serverIP=null;Z.serverPort=null;Z.tileHandlerPath=null;Z.tileHandlerPathFull=null;Z.iiifInfoJSONObject=null;Z.iiifScheme=null;Z.iIIFScheme=null;Z.iiifServer=null;Z.iIIFServer=null;Z.iiifPrefix=null;Z.iIIFPrefix=null;Z.iiifIdentifier=
null;Z.iIIFIdentifier=null;Z.iiifRegion=null;Z.iIIFRegion=null;Z.iiifSize=null;Z.iIIFSize=null;Z.iiifRotation=null;Z.iIIFRotation=null;Z.iiifQuality=null;Z.iIIFQuality=null;Z.iiifFormat=null;Z.iIIFFormat=null;Z.tileW=null;Z.tileH=null;Z.tileType="jpg";Z.tilesPNG=null;Z.fieldOfViewVisible=null;Z.freehandVisible=null;Z.textVisible=null;Z.shapeVisible=null;Z.rectangleVisible=null;Z.polygonVisible=null;Z.captionTextColor=null;Z.captionBackColor=null;Z.labelLineColor=null;Z.labelFillColor=null;Z.captionTextVisible=
!0;Z.captionBackVisible=!0;Z.labelFillVisible=!1;Z.labelLineVisible=!0;Z.captionPosition=null;Z.annotationPathProvided=!1;Z.saveHandlerProvided=!1;Z.fileHandlerProvided=!1;Z.imageSetPathProvided=!1;Z.slidePathProvided=!1;Z.saveImageHandlerProvided=!1;Z.tileSource=null;Z.requestTiles=!1;Z.tileSourceMultiple=null;Z.pffJPEGHeadersSeparate=!1;Z.dziSubfoldersToSkip=null;Z.dziImagePropertiesFilename=null;Z.dziImageSubfolder=null;Z.focal=null;Z.quality=null;Z.markupMode=null;Z.editMode=null;Z.editAdmin=
!1;Z.editing=null;Z.labelMode="view";Z.editModePrior=Z.editMode;Z.xmlCallbackFunction=null;Z.labelClickDrag=!0;Z.sliderFocus="zoom";Z.overlayPath=null;Z.overlays=!1;Z.overlayJSONObject=null;Z.overlaysInitialVisibility=null;Z.animation=!1;Z.animationPath=null;Z.animationCount=0;Z.animationAxis=null;Z.animator=null;Z.animationFlip=null;Z.slidestack=!1;Z.slidestackPath=null;Z.imageSet=!1;Z.imageSetPath=null;Z.imageSetLength=null;Z.imageSetListPosition=null;Z.imageSetListTitle=null;Z.imageSetStart=null;
Z.imageSetLoop=null;Z.sliderImageSetVisible=null;Z.mouseWheelParmeterProvided=null;Z.mouseWheel=null;Z.imageSetHotspotPath=null;Z.hotspotFileShared=!1;Z.imageSetAnnotationPath=null;Z.annotationFileShared=!1;Z.messageDurationLong=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONLONG"),10);Z.messageDurationStandard=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONSTANDARD"),10);Z.messageDurationShort=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONSHORT"),10);Z.messageDurationVeryShort=
parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONVERYSHORT"),10);Z.Viewer=null;Z.ViewerDisplay=null;Z.Viewport=null;Z.Toolbar=null;Z.ToolbarDisplay=null;Z.ToolbarMinimized=!1;Z.TooltipDisplay=null;Z.Navigator=null;Z.Navigator2=null;Z.NavigatorDisplay=null;Z.MessageDisplay=null;Z.messages=null;Z.messageDisplayList=[];Z.overlayMessage=null;Z.CoordinatesDisplay=null;Z.coordinates=null;Z.coordinatesSave=null;Z.CopyrightDisplay=null;Z.imageW=null;Z.imageH=null;Z.imageD=null;Z.imageCtrX=null;Z.imageCtrY=
null;Z.imageX=0;Z.imageY=0;Z.imageZ=0;Z.imageR=0;Z.priorX=0;Z.priorY=0;Z.priorZ=0;Z.priorR=0;Z.preventDupCall=!1;Z.fitZ=null;Z.fillZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.rotating="stop";Z.fullView=!1;Z.fullViewPrior=!1;Z.interactive=!0;Z.useCanvas=!0;Z.expressParamsEnabled=null;Z.proParamsEnabled=null;Z.specialStorageEnabled=null;Z.enterpriseParamsEnabled=null;Z.updateViewPercent=0;Z.TraceDisplay=null;Z.traces=null;Z.mouseIsDown=!1;Z.buttonIsDown=!1;Z.keyIsDown=!1;Z.altKeyIsDown=
!1;Z.mouseWheelIsDown=!1;Z.mouseWheelCompleteDuration=null;Z.mouseWheelCompleteTimer=null;Z.mouseOutDownPoint=null;maxTileB=maxTileR=maxTier=0;Z.viewportCurrentID=0;Z.viewportCurrent=null;Z.viewportChangeTimeout=null},detectBrowserFeatures:function(){var a=window.navigator.userAgent,a=-1!=a.indexOf("Win")?"windows":-1!=a.indexOf("Mac")?"macintosh":"other";Z.browsers={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6};var b=Z.browsers.UNKNOWN,e=0,f=1E4,g=navigator.appName,k=navigator.appVersion,
l=!1,E=!1,n=navigator.userAgent.toLowerCase();if(-1!=n.indexOf("edge"))b=Z.browsers.EDGE,e=k;else if("Microsoft Internet Explorer"==g&&window.attachEvent&&window.ActiveXObject)e=n.indexOf("msie"),b=Z.browsers.IE,e=parseFloat(n.substring(e+5,n.indexOf(";",e))),l="undefined"!==typeof document.documentMode;else if("Netscape"==g&&-1!=n.indexOf("trident"))b=Z.browsers.IE,e=11;else if("Netscape"==g&&window.addEventListener){var w=n.indexOf("firefox"),g=n.indexOf("safari"),k=n.indexOf("chrome");0<=w?(b=
Z.browsers.FIREFOX,e=parseFloat(n.substring(w+8)),f=1E4):0<=g&&(f=n.substring(0,g).lastIndexOf("/"),b=0<=k?Z.browsers.CHROME:Z.browsers.SAFARI,e=parseFloat(n.substring(f+1,g)),f=1E4);g=new Image;g.style.getPropertyValue&&(E=g.style.getPropertyValue("image-rendering"))}else"Opera"==g&&window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera)&&(b=Z.browsers.OPERA,e=parseFloat(k));var g=window.File&&window.FileReader&&window.Blob,G;if(window.XMLHttpRequest)netReq=new XMLHttpRequest,
G="XMLHttpRequest";else if(window.ActiveXObject)for(var k=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],w=0,K=k.length;w<K;w++)try{netReq=new ActiveXObject(k[w]);G=k[w];break}catch(W){}var k="response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype,J=document.createElement("canvas"),w=!(!J.getContext||!J.getContext("2d")),K=!(b==Z.browsers.SAFARI&&4>e||b==
Z.browsers.CHROME&&2>e),w=w&&K,K=!(b==Z.browsers.CHROME&&2>e),E=l||E?"high":null,l=w&&!!J.getContext("2d").ellipse,oa=(document.documentElement||{}).style||{},J=!1,ga=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],ma,fa;for(;ma=ga.shift();)if("undefined"!==typeof oa[ma]){J=!0;fa=/webkit/i.test(ma);break}var oa=J,ga="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,v=-1<n.indexOf("iphone")||
-1<n.indexOf("ipad")||-1<n.indexOf("ipod"),n=-1<n.indexOf("android")||v,C=!1;if("undefined"!==typeof document.cancelFullScreen||"undefined"!==typeof document.webkitCancelFullScreen||"undefined"!==typeof document.mozCancelFullScreen||"undefined"!==typeof document.oCancelFullScreen||"undefined"!==typeof document.msCancelFullScreen||"undefined"!==typeof document.msExitFullscreen)C=!0;var u=Array.prototype.map,D=Array.prototype.splice,R=!1;try{new Float32Array(1),R=!0}catch(W){}var N=!1;try{new Uint8Array(1),
N=!0}catch(W){}var ja=!1;if("function"==typeof Object.defineProperty)try{Object.defineProperty({},"x",{}),ja=!0}catch(W){}var da;switch(window.location.protocol){case "http:":da=!1;break;case "https:":da=!1;break;case "file:":da=!0;break;default:da=null}var S=!(Z.browser==Z.browsers.IE&&9>Z.browserVersion||Z.browser==Z.browsers.OPERA&&15>Z.browserVersion||Z.browser==Z.browsers.CHROME&&25>Z.browserVersion&&Z.browser==Z.browsers.FIREFOX&&20>Z.browserVersion&&Z.browser==Z.browsers.SAFARI&&5>Z.browserVersion);
Z.platform=a;Z.browser=b;Z.browserVersion=e;Z.scaleThreshold=f;Z.localFilesSupported=g;Z.xmlHttpRequestSupport=G;Z.responseArraySupported=k;Z.canvasSupported=w;Z.useCanvas=Z.canvasSupported;Z.imageFilters=!Z.useCanvas&&Z.imageFilters?!1:Z.imageFilters;Z.cssTransformsSupported=J;Z.cssTransformProperty=ma;Z.cssTransformNoUnits=fa;Z.alphaSupported=K;Z.renderQuality=E;Z.ellipseDrawingSupported=l;Z.rotationSupported=oa;Z.fullScreenSupported=C;Z.arrayMapSupported=u;Z.arraySpliceSupported=D;Z.float32ArraySupported=
R;Z.uInt8ArraySupported=N;Z.definePropertySupported=ja;Z.touchSupport=ga;Z.gestureSupport=v&&ga;Z.mobileDevice=n;Z.localUse=da;Z.singleFileSupported=S},getBookmarksURL:function(){if(Z.bookmarksGet){var a=window.location.href,b=a.indexOf("?");if(-1!=b){var e="",f=-1,g=-1,k=-1,l=-1,E=Z.imageW/2,n=Z.imageH/2,w=-1,G=0,e=a.substring(b+1,a.length);if("IIIFImageServer"!=Z.tileSource)f=e.indexOf("x="),g=e.indexOf("y="),k=e.indexOf("z="),l=e.indexOf("r="),-1==l&&(l=e.length+1),-1!=f&&(E=parseFloat(e.substring(f+
2,g-1))),-1!=g&&(n=parseFloat(e.substring(g+2,k-1))),-1!=k&&(w=parseFloat(e.substring(k+2,l-1))),l!=e.length+1&&(G=parseFloat(e.substring(l+2,e.length)));else{for(var K,W,J,a=e.split("/"),b=a.length-1;-1<b;b--)if(e=a[b],-1!=e.indexOf(",")){J=parseInt(a[b+1],10);if(isNaN(J)||0>J||360<J)J=0;W=e.split(",");K=a[b-1].split(",");break}E=Math.round(parseFloat(K[0])+parseFloat(K[2])/2);n=Math.round(parseFloat(K[1])+parseFloat(K[3])/2);w=Math.round(parseFloat(W[0])/parseFloat(K[2])*100)/100;G=J}}Z.initialX=
E;Z.initialY=n;Z.initialZ=w/100;Z.initialR=G}},setBookmarksURL:function(){if(Z.bookmarksSet){var a=Z.Viewport.getCoordinatesBookmark(null,"IIIFImageServer"==Z.tileSource);window.history.replaceState({id:"zBookmark"},"",a)}},enforceUserLogin:function(a,b){var e=!0,f=this.readCookie("zoomifyUserLogin");Z.Utils.stringValidate(f)&&(Z.Viewer.configureViewer(),Z.userName=f,Z.userInitials=Z.Utils.stringGetInitials(Z.userName),Z.Utils.stringValidate(Z.userGuestPrompt)&&Z.userName==Z.userGuestPrompt&&Z.userList.splice(0,
0,{name:Z.userGuestPrompt,id:"0",countCell:0,countImage:0}),e=!1);!Z.userPathProvided||"undefined"!==typeof b&&null!==b||(this.loadUsersXML(),e=!1);e&&(Z.Utils.stringValidate(Z.userName)?Z.userName!=Z.userGuestPrompt&&Z.Utils.stringValidate(Z.userName)&&b&&-1==Z.Utils.arrayIndexOfObjectValue(b,"name",Z.userName)?(Z.Utils.stringValidate(Z.userNamePromptRetry)||Z.Utils.getResource("UI_USERNAMEPROMPTRETRY"),a=Z.Utils.getResource("UI_USERNAMEPROMPTRETRY")):a="complete":"undefined"!==typeof a&&Z.Utils.stringValidate(Z.promptText)||
(a=Z.Utils.stringValidate(Z.userNamePrompt)?Z.userNamePrompt:Z.Utils.getResource("UI_USERNAMEPROMPT")),"complete"!=a?(Z.userName=prompt(a,Z.userGuestPrompt),Z.Utils.enforceUserLogin(Z.userName,b)):(Z.Utils.hideMessage(),Z.userInitials=Z.Utils.stringGetInitials(Z.userName),document.cookie="zoomifyUserLogin="+Z.userName,Z.Utils.stringValidate(Z.userGuestPrompt)&&Z.userName==Z.userGuestPrompt&&Z.userList.splice(0,0,{name:Z.userGuestPrompt,id:"0",countCell:0,countImage:0}),Z.Viewer.configureViewer()))},
loadUsersXML:function(){var a;Z.Utils.stringValidate(Z.userPath)&&(Z.simplePath?a=Z.userPath:(".json"!=Z.userPath.toLowerCase().substring(Z.userPath.length-5,Z.userPath.length)&&".xml"!=Z.userPath.toLowerCase().substring(Z.userPath.length-4,Z.userPath.length)&&(Z.userPath=Z.userPath+"/"+Z.Utils.getResource("DEFAULT_USERXMLFILE")),a=Z.Utils.cacheProofPath(Z.userPath)));if("undefined"!==typeof a&&Z.Utils.stringValidate(a)){var b=new Z.NetConnector;-1!=a.toLowerCase().indexOf(".xml")?b.loadXML(a,null,
"loadingUsersXML"):-1!=a.toLowerCase().indexOf(".json")&&b.loadJSON(a,null,"loadingUsersXML")}else"string"===typeof Z.userXMLText&&Z.Utils.stringValidate(Z.userXMLText)?(a=Z.Utils.xmlConvertTextToDoc(Z.userXMLText),self.parseUsersXML(a)):"undefined"!==typeof Z.userJSONObject&&"object"===typeof Z.userJSONObject&&null!==Z.userJSONObject&&(a=Z.Utils.jsonConvertObjectToXMLText(Z.userJSONObject),a=Z.Utils.xmlConvertTextToDoc(a),self.parseUsersXML(a))},parseUsersXML:function(a){Z.Viewer.setStatus("XMLParsedViewer",
!1);var b=a.getElementsByTagName("SETUP")[0];if(b){0!=Z.userPanelVisible&&(Z.userPanelPosition=b.getAttribute("PANELPOSITION"));var e=b.getAttribute("GUESTPROMPT");Z.userGuestPrompt="undefined"!==typeof e&&Z.Utils.stringValidate(e)?e:"";Z.Utils.stringValidate(Z.userNamePrompt)||(e=b.getAttribute("PROMPTTEXT"),Z.userNamePrompt="undefined"!==typeof e&&Z.Utils.stringValidate(e)?e:"");Z.Utils.stringValidate(Z.userNamePromptRetry)||(b=b.getAttribute("PROMPTRETRYTEXT"),Z.userNamePromptRetry="undefined"!==
typeof b&&Z.Utils.stringValidate(b)?b:"")}if(a=a.getElementsByTagName("USERS")[0])for(a=a.getElementsByTagName("USER"),b=0,e=a.length;b<e;b++){var f=a[b];Z.userList[Z.userList.length]={name:f.getAttribute("NAME"),id:f.getAttribute("ID"),countCell:0,countImage:0}}Z.Viewer.setStatus("XMLParsedViewer",!0);"undefined"!==typeof Z.userList&&0<Z.userList.length&&(Z.Utils.hideMessage(),this.enforceUserLogin(null,Z.userList),Z.Viewer.setStatus("usersLoadedViewer",!0),Z.Utils.validateCallback("usersLoaded"),
Z.userPanelVisible&&null===Z.UserPanel&&(Z.Viewer.getStatus("readyViewer")?Z.Utils.createUserPanel(Z.userList):Z.setCallback("readyViewer",function(){Z.Utils.createUserPanel(Z.userList)})))},createUserPanel:function(a){var b=Z.Utils.createContainerElement("div","userPanelDisplay","inline-block","absolute","hidden","1px","1px","1px","1px","solid","1px","transparent","0px","0px","normal","default");Z.UserPanel=b;var e=b.style;Z.ViewerDisplay.appendChild(b);e.zIndex=(Z.baseZIndex+42).toString();e=Z.Utils.createContainerElement("div",
"userPanelBackground","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal");b.appendChild(e);parseInt(Z.Utils.getResource("DEFAULT_USERPANELLISTFONTSIZE"),10);Z.Utils.getResource("CONTENT_USERPLACEHOLDERLISTTEXT");if("undefined"===typeof userCountainer||null===userCountainer){var f=Z.Utils.createContainerElement("div","containerUserLabels","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",
null,!0);b.appendChild(f);var g=Z.Utils.createContainerElement("div","labelNameTextBox","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),k=document.createTextNode(Z.Utils.getResource("UI_USERPANELLABELNAME"));g.appendChild(k);f.appendChild(g);Z.tracking&&(g=Z.Utils.createContainerElement("div","labelCountPerUserTextBox","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,
!0),k=document.createTextNode(Z.Utils.getResource("UI_USERPANELLABELCOUNT")),g.appendChild(k),f.appendChild(g),g=Z.Utils.createContainerElement("div","labelUserCountersShowTextBox","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),k=document.createTextNode(Z.Utils.getResource("UI_USERPANELLABELSHOW")),g.appendChild(k),f.appendChild(g));var l="#FFFFFF",f=parseInt(Z.Utils.getResource("DEFAULT_USERPANELLABELFONTSIZE"),10),g=6,k=0;containerUsers=
Z.Utils.createContainerElement("div","containerUsers","inline-block","absolute","auto","1px","1px","0px","0px","solid","1px","#FFFFFF","0px","0px","nowrap",null,!0);containerUsers.style.overflowX="hidden";b.appendChild(containerUsers);for(var b=0,E=a.length;b<E;b++){l=0==b%2?"#F8F8F8":"#FFFFFF";l=Z.Utils.createContainerElement("div","rowContainer","inline-block","absolute","visible","100%","24px","0px",k+"px","none","0px",l,"0px","0px","nowrap",null,!0);containerUsers.appendChild(l);var n="rowNameTextBox"+
b.toString(),w="rowNameTextNode"+b.toString();l[n]=Z.Utils.createContainerElement("div",n,"inline-block","absolute","visible","100px","20px",g+"px","6px","none","0px","transparent","0px","0px","nowrap",null,!0);l[w]=document.createTextNode(a[b].name);l[n].appendChild(l[w]);l.appendChild(l[n]);Z.Utils.setTextNodeStyle(l[n],"black","verdana",f+"px","none","normal","normal","normal","normal","1em","left","none");Z.tracking&&(g+=100,n="rowCountPerUserTextBox"+b.toString(),w="rowCountPerUserTextNode"+
b.toString(),l[n]=Z.Utils.createContainerElement("div",n,"inline-block","absolute","visible","100px","20px",g+"px","6px","none","0px","transparent","0px","0px","nowrap",null,!0),l[w]=document.createTextNode(null!==a[b].countImage?a[b].countImage:"0"),l[n].appendChild(l[w]),l.appendChild(l[n]),Z.Utils.setTextNodeStyle(l[n],"black","verdana",f+"px","none","normal","normal","normal","normal","1em","left","none"),g+=30,n="checkboxUserCountersShow"+b.toString(),l[n]=new Z.Utils.Checkbox(n,"show","20px",
"20px",g+"px","1px","click",Z.Toolbar.z457,"TIP_COUNTERTYPESHOW"),l.appendChild(l[n]),document.getElementById(n).checked=!0);g=6;k+=24}}Z.Utils.drawLayoutUserPanel();Z.Utils.addEventListener(e,"mousedown",Z.Utils.preventDefault)},drawLayoutUserPanel:function(){var a=parseInt(Z.Utils.getResource("DEFAULT_USERPANELWIDTH"),10),b=parseInt(Z.Utils.getResource("DEFAULT_USERPANELHEIGHT"),10),e=Z.Utils.calculateUserPanelCoords(Z.userPanelPosition,a,b,Z.viewerW,Z.viewerH),f=Z.UserPanel.style;Z.Utils.sizeAndPositionUserPanel(f,
a,b,e.x,e.y);Z.userPanelVisibleState=Z.userPanelVisible&&"0"!=Z.userPanelPosition;f.display=1==Z.userPanelVisible||2==Z.userPanelVisible?"inline-block":"none";var g=parseFloat(Z.Utils.getResource("z82")),k=Z.Utils.getResource("z83"),l=Z.Utils.getResource("z83NOALPHA"),E=parseInt(Z.Utils.getResource("DEFAULT_USERLABELWIDTH"),10),n=parseInt(Z.Utils.getResource("DEFAULT_USERPANELLABELFONTSIZE"),10),e=a-16-2,f=b-32-4,w=document.getElementById("userPanelBackground");if(w){var G=w.style;G.width=a+"px";
G.height=b+"px";G.backgroundColor=k;Z.Utils.setOpacity(w,g,l)}dx=12;if(b=document.getElementById("containerUserLabels"))g=b.style,g.width=a+"px",g.height="15px",g.left=dx+"px",g.top="7px",g.visibility="visible",Z.Utils.setTextNodeStyle(b.firstChild,"black","verdana",n+"px","none","normal","normal","normal","normal","1em","left","none");dx=0;if(a=document.getElementById("labelNameTextBox"))b=a.style,b.width=E+"px",b.height="15px",b.left="0px",b.top="0px",Z.Utils.setTextNodeStyle(a.firstChild,"black",
"verdana",n+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=1.5*E;if(a=document.getElementById("labelCountPerUserTextBox"))b=a.style,b.width=E+"px",b.height="15px",b.left=dx+"px",b.top="0px",Z.Utils.setTextNodeStyle(a.firstChild,"black","verdana",n+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=E-4;if(a=document.getElementById("labelUserCountersShowTextBox"))b=a.style,b.width=E+"px",b.height="15px",b.left=dx+"px",b.top="0px",Z.Utils.setTextNodeStyle(a.firstChild,
"black","verdana",n+"px","none","normal","normal","normal","normal","1em","left","none"),dx+=E-12;dy=24;if(E=document.getElementById("containerUsers"))n=E.style,n.width=e+"px",n.height=f+"px",n.left="8px",n.top=dy+"px",E.size=6},calculateUserPanelCoords:function(a,b,e,f,g){if(null===Z.userPanelVisible)e=a=-1E3;else switch(a){case "0":e=a=-1E3;break;case "1":a=Z.navigatorL;e=Z.navigatorT+Z.navigatorH+Z.rulerH+2;break;case "2":a=f-b-15;e=15;2==Z.trackingPanelPosition&&(e+=170);break;case "3":a=f-b-
15;e=0<Z.toolbarVisible&&8!=Z.toolbarVisible?g-e-15:g-15;break;case "4":a=15;e=0<Z.toolbarVisible&&8!=Z.toolbarVisible?g-e-15:g-15;break;default:a=f-b-15,e=15}return new Z.Utils.Point(a,e)},sizeAndPositionUserPanel:function(a,b,e,f,g){"undefined"!==typeof b&&null!==b&&(a.width=b+"px");"undefined"!==typeof e&&null!==e&&(a.height=e+"px");"undefined"!==typeof f&&null!==f&&(a.left=f+"px");"undefined"!==typeof g&&null!==g&&(a.top=g+"px");Z.imageList&&Z.viewportCurrent.getStatus("initializedImageList")&&
Z.viewportCurrent.setSizeAndPositionImageList()},enforceCopyright:function(){this.readCookie("zoomifyImageCopyright")?Z.Viewer.configureViewer():this.loadCopyrightText()},loadCopyrightText:function(){(new Z.NetConnector).loadXML(Z.copyrightPath,null,"loadingCopyrightXML")},showCopyright:function(a,b){var e=this.getResource("z102"),f=this.getResource("z101");Z.CopyrightDisplay=this.createContainerElement("div","CopyrightDisplay","inline-block","absolute","hidden",Z.viewerW-2+"px",Z.viewerH-2+"px",
"0px","0px","solid","1px",e,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.CopyrightDisplay);Z.CopyrightDisplay.style.zIndex=(Z.baseZIndex+46).toString();var g=parseFloat(Z.CopyrightDisplay.style.width)/2-220,e=parseFloat(Z.CopyrightDisplay.style.height)/2-100,k=this.createContainerElement("div","textBox","inline-block","absolute","hidden","440px","200px",g+"px",e+"px","none","0px","transparent","0px","0px","normal",null,!0);k.id="textBox";Z.CopyrightDisplay.appendChild(k);var l=document.createTextNode(a);
k.appendChild(this.createCenteredElement(l,"copyrightTextNode"));this.setTextNodeStyle(l,"black","verdana","16px","none","normal","normal","normal","normal","1em","justify","none");var l=this.createContainerElement("div","declinedTextContainer","hidden","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0),E=document.createTextNode(b);l.appendChild(E);k.appendChild(l);g=g+220-95;e=e+200+20;k=this.getResource("z418");k=new Z.Utils.Button("buttonAgree",
k,null,null,null,null,"80px","20px",g+"px",e+"px","mousedown",this.copyrightAgreeButtonHandler,"z332","solid","1px",f,"0px","0px");Z.CopyrightDisplay.appendChild(k.elmt);g+=110;k=this.getResource("z419");f=new Z.Utils.Button("buttonExit",k,null,null,null,null,"80px","20px",g+"px",e+"px","mousedown",this.copyrightExitButtonHandler,"z333","solid","1px",f,"0px","0px");Z.CopyrightDisplay.appendChild(f.elmt)},hideCopyright:function(){var a=document.getElementById("copyrightTextNode").firstChild,b=document.getElementById("declinedTextContainer").firstChild.nodeValue;
a.nodeValue=b;a=document.getElementById("buttonAgree");Z.Utils.removeEventListener(a,"mousedown",this.copyrightAgreeButtonHandler);Z.CopyrightDisplay.removeChild(a);a=document.getElementById("buttonExit");Z.Utils.removeEventListener(a,"mousedown",this.copyrightExitButtonHandler);Z.CopyrightDisplay.removeChild(a)},copyrightAgreeButtonHandler:function(a){Z.ViewerDisplay.removeChild(Z.CopyrightDisplay);document.cookie="zoomifyImageCopyright=confirmed";Z.Viewer.configureViewer()},copyrightExitButtonHandler:function(a){Z.Utils.hideCopyright()},
parseParametersXML:function(a){Z.xmlParametersParsing=!1;var b="";a=a.getElementsByTagName("ZOOMIFY")[0];zImagePath=a.getAttribute("IMAGEPATH");zImagePath2=a.getAttribute("IMAGEPATH2");"undefined"!==typeof zImagePath&&Z.Utils.stringValidate(zImagePath)&&(Z.imagePath=zImagePath);"undefined"!==typeof zImagePath2&&Z.Utils.stringValidate(zImagePath2)&&(Z.imagePath2=zImagePath2);for(var e=Z.Utils.getResource("DEFAULT_PARAMETERLISTTEXT").split(","),f=0,g=e.length;f<g;f++){var k=e[f],l=Z.Utils.stringLowerCaseFirstLetter(k.substr(1)).toUpperCase(),
l=a.getAttribute(l);"undefined"!==typeof l&&Z.Utils.stringValidate(l)&&(b+=k+"="+l+"&")}e=a.getAttribute("FULLPAGEINITIAL");"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&(b+="zInitialFullPage="+e+"&");e=a.getAttribute("TOOLBARSKINXMLPATH");"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&(b+="zSkinPath="+e+"&");e=a.getAttribute("TOOLBARTOOLTIPS");"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&(b+="zTooltipsVisible="+e+"&");e=a.getAttribute("SHOWTOOLTIPS");"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&
(b+="zTooltipsVisible="+e+"&");e=a.getAttribute("WATERMARKMEDIA");"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&(b+="zWatermarkPath="+e+"&");e=a.getAttribute("SLIDESXMLPATH");"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&(b+="zSlidePath="+e+"&");e=a.getAttribute("HOTSPOTSXMLPATH");"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&(b+="zHotspotPath="+e+"&");e=a.getAttribute("ANNOTATIONSXMLPATH");"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&(b+="zAnnotationPath="+e+"&");e=a.getAttribute("SAVETOFILE");
"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&(b+="zSaveImageHandlerPath="+e+"&");b="&"==b.slice(-1,b.length)?b.slice(0,b.length-1):b;b=unescape(b);b=Z.Utils.stringUnescapeAmpersandCharacters(b);Z.Utils.arrayClear(Z.parameters);Z.parameters=Z.Utils.parseParameters(b);Z.initialize()},parseParameters:function(a){var b=[];if("object"===typeof a)b=a;else if("string"===typeof a){a=a.split("&");for(var e=0,f=a.length;e<f;e++){var g=a[e],k=g.indexOf("=");if(0<k){var l=g.substring(0,k),g=g.substring(k+
1);b[l]=g}}}return b},parametersToDelimitedString:function(a,b){var e="",f;for(f in a)e+=f+"="+a[f].toString()+b;return e=e.slice(0,-1)},setParameters:function(a){var b=this.getResource("z110"),e=this.getResource("z109"),f=this.getResource("z108");Z.expressParamsEnabled=b!=e?!0:!1;Z.expressParamsEnabled||(Z.toolbarInternal=!0);var e=this.getResource("z187"),g=this.getResource("z186"),b=this.getResource("z185");Z.proParamsEnabled=e!=g?!0:!1;var k=this.getResource("z215"),e=this.getResource("z214"),
g=this.getResource("z213");Z.specialStorageEnabled=k!=e?!0:!1;var l=this.getResource("z107"),E=this.getResource("z106"),k=this.getResource("z105");Z.enterpriseParamsEnabled=l!=E?!0:!1;null===Z.skinPath&&(Z.skinPath=this.getResource("z201"));null===Z.skinMode&&(Z.skinMode=this.getResource("z199"));isNaN(parseFloat(this.getResource("z143")))||(Z.initialX=parseFloat(this.getResource("z143")));isNaN(parseFloat(this.getResource("z144")))||(Z.initialY=parseFloat(this.getResource("z144")));isNaN(parseFloat(this.getResource("z145")))||
(Z.initialZ=parseFloat(this.getResource("z145")));null!==Z.minZ||isNaN(parseFloat(this.getResource("z163")))||(Z.minZ=parseFloat(this.getResource("z163")));null!==Z.maxZ||isNaN(parseFloat(this.getResource("z153")))||(Z.maxZ=parseFloat(this.getResource("z153")));null!==Z.zoomSpeed||isNaN(parseFloat(this.getResource("z241")))||(Z.zoomSpeed=parseFloat(this.getResource("z241")));null!==Z.panSpeed||isNaN(parseFloat(this.getResource("z175")))||(Z.panSpeed=parseFloat(this.getResource("z175")));null!==Z.fadeInSpeed||
isNaN(parseFloat(this.getResource("z111")))||(Z.fadeInSpeed=parseFloat(this.getResource("z111")));Z.fadeIn=0<Z.fadeInSpeed;null===Z.navigatorVisible&&(Z.navigatorVisible=parseInt(this.getResource("z171"),10));null===Z.navigatorW&&(Z.navigatorW=parseInt(this.getResource("z172"),10));null===Z.navigatorH&&(Z.navigatorH=parseInt(this.getResource("z167"),10));null===Z.navigatorL&&(Z.navigatorL=parseInt(this.getResource("z168"),10));null===Z.navigatorT&&(Z.navigatorT=parseInt(this.getResource("z170"),10));
null===Z.navigatorFit&&(Z.navigatorFit=this.getResource("z166"));null===Z.navigatorRectangleColor&&(Z.navigatorRectangleColor=this.getResource("z169"));if(null===Z.galleryVisible||Z.slideshow)Z.galleryVisible=parseInt(this.getResource("DEFAULT_GALLERYVISIBLE"),10);if(null===Z.galleryAutoShowHide||Z.slideshow)Z.galleryAutoShowHide=2==Z.galleryVisible;null===Z.galleryW&&(Z.galleryW=parseInt(this.getResource("DEFAULT_GALLERYWIDTH"),10));null===Z.galleryH&&(Z.galleryH=parseInt(this.getResource("DEFAULT_GALLERYHEIGHT"),
10));null===Z.galleryM&&(Z.galleryM=parseInt(this.getResource("DEFAULT_GALLERYMARGIN"),10));null===Z.galleryL&&(Z.galleryL=parseInt(this.getResource("DEFAULT_GALLERYLEFT"),10));null===Z.galleryT&&(Z.galleryT=parseInt(this.getResource("DEFAULT_GALLERYTOP"),10));null===Z.galleryPosition&&(Z.galleryPosition=parseFloat(this.getResource("DEFAULT_GALLERYPOSITION")));null===Z.galleryRectangleColor&&(Z.galleryRectangleColor=this.getResource("DEFAULT_GALLERYRECTANGLECOLO R"));null===Z.clickZoom&&(Z.clickZoom=
"0"!=this.getResource("z93"));null===Z.doubleClickZoom&&(Z.doubleClickZoom="0"!=this.getResource("DEFAULT_DOUBLECLICKZOOM"));null===Z.doubleClickDelay&&(Z.doubleClickDelay=parseFloat(this.getResource("DEFAULT_DOUBLECLICKDELAY")));null===Z.clickPan&&(Z.clickPan="0"!=this.getResource("z92"));null===Z.mousePan&&(Z.mousePan="0"!=this.getResource("z164"));null===Z.constrainPan&&(Z.constrainPan="0"!=this.getResource("z95"));null===Z.constrainPanLimit&&(Z.constrainPanLimit=parseInt(this.getResource("z95LIMIT"),
10));null===Z.constrainPanStrict&&(Z.constrainPanStrict="0"!=this.getResource("z95STRICT"));null===Z.panBuffer&&(Z.panBuffer=parseFloat(this.getResource("z173")));null===Z.smoothPan&&(Z.smoothPan=Z.useCanvas&&!Z.comparison&&"0"!=this.getResource("DEFAULT_SMOOTHPAN"));null===Z.smoothPanEasing&&(Z.smoothPanEasing=parseInt(this.getResource("DEFAULT_SMOOTHPANEASING"),10));null===Z.smoothPanGlide&&(Z.smoothPanGlide=parseInt(this.getResource("DEFAULT_SMOOTHPANGLIDE"),10));null===Z.smoothZoom&&(Z.smoothZoom=
"0"!=this.getResource("DEFAULT_SMOOTHZOOM"));null===Z.smoothZoomEasing&&(Z.smoothZoomEasing=parseInt(this.getResource("DEFAULT_SMOOTHZOOMEASING"),10));null===Z.keys&&(Z.keys="0"!=this.getResource("z146"));null===Z.canvas&&(Z.canvas="0"!=this.getResource("z88"));null===Z.baseZIndex&&(Z.baseZIndex=parseInt(this.getResource("DEFAULT_BASEZINDEX"),10));null===Z.debug&&(Z.debug=parseInt(this.getResource("z104"),10));null===Z.toolbarVisible&&(Z.toolbarVisible=parseInt(this.getResource("z223"),10));null===
Z.toolbarBackgroundVisible&&(Z.toolbarBackgroundVisible=parseInt(this.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLE"),10));null===Z.toolbarAutoShowHide&&(Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible);null===Z.toolbarPosition&&(Z.toolbarPosition=parseFloat(this.getResource("z222")));null===Z.logoVisible&&(Z.logoVisible="0"!=this.getResource("z150"));null===Z.logoCustomPath&&(Z.logoCustomPath=this.getResource("z149"));
null===Z.minimizeVisible&&(Z.minimizeVisible="0"!=this.getResource("z162"));null===Z.sliderZoomVisible&&(Z.sliderZoomVisible="0"!=this.getResource("DEFAULT_SLIDERZOOMVISIBLE"));null===Z.mouseWheel&&(Z.mouseWheel=parseInt(this.getResource("DEFAULT_MOUSEWHEEL"),10));null===Z.zoomButtonsVisible&&(Z.zoomButtonsVisible="0"!=this.getResource("DEFAULT_ZOOMBUTTONSVISIBLE"));null===Z.panButtonsVisible&&(Z.panButtonsVisible="0"!=this.getResource("z174"));null===Z.resetVisible&&(Z.resetVisible="0"!=this.getResource("DEFAULT_RESETVISIBLE"));
null===Z.tooltipsVisible&&(Z.tooltipsVisible="0"!=this.getResource("z224"));null===Z.helpVisible&&(Z.helpVisible=parseInt(this.getResource("z128"),10));null===Z.helpW&&(Z.helpW=parseInt(this.getResource("z422"),10));null===Z.helpH&&(Z.helpH=parseInt(this.getResource("z421"),10));null===Z.progressVisible&&(Z.progressVisible="0"!=this.getResource("z184"));null===Z.messagesVisible&&(Z.messagesVisible="0"!=this.getResource("DEFAULT_MESSAGESVISIBLE"));null===Z.fullViewVisible&&(Z.fullViewVisible="0"!=
this.getResource("z121"));null===Z.fullScreenVisible&&(Z.fullScreenVisible="0"!=this.getResource("z119"));null===Z.fullPageVisible&&(Z.fullPageVisible="0"!=this.getResource("z118"));null===Z.initialFullPage&&(Z.initialFullPage="0"!=this.getResource("z141"));null===Z.bookmarksGet&&(Z.bookmarksGet="0"!=this.getResource("DEFAULT_BOOKMARKSGET"));null===Z.bookmarksSet&&(Z.bookmarksSet="0"!=this.getResource("DEFAULT_BOOKMARKSSET"));!0!==Z.measureVisible&&(Z.measureVisible="0"!=this.getResource("z157"));
null===Z.rotationVisible&&(Z.rotationVisible="0"!=this.getResource("z190"));null===Z.rotationFree&&(Z.rotationFree="0"!=this.getResource("DEFAULT_ROTATIONFREE"));null===Z.initialR&&(Z.initialR=this.getResource("DEFAULT_INITIALR"));null!==Z.screensaverSpeed||isNaN(parseFloat(this.getResource("DEFAULT_SCREENSAVERSPEED")))||(Z.screensaverSpeed=parseFloat(this.getResource("DEFAULT_SCREENSAVERSPEED")));null!==Z.maskScale||isNaN(parseFloat(this.getResource("DEFAULT_MASKSCALE")))||(Z.maskScale=parseFloat(this.getResource("DEFAULT_MASKSCALE")));
null!==Z.maskFadeSpeed||isNaN(parseFloat(this.getResource("DEFAULT_MASKFADESPEED")))||(Z.maskFadeSpeed=parseFloat(this.getResource("DEFAULT_MASKFADESPEED")));null===Z.maskClearOnUserAction&&(Z.maskClearOnUserAction="0"!=this.getResource("DEFAULT_MASKCLEARONUSERACTION"));null===Z.units&&(Z.units=this.getResource("z231"));null===Z.sourceMagnification&&(Z.sourceMagnification=parseInt(this.getResource("z212"),10));null===Z.virtualPointerVisible&&(Z.virtualPointerVisible="0"!=this.getResource("z233"));
null===Z.virtualPointerPath&&(Z.virtualPointerPath=this.getResource("z232"));null===Z.crosshairsVisible&&(Z.crosshairsVisible="0"!=this.getResource("z103"));null===Z.zoomRectangle&&(Z.zoomRectangle="0"!=this.getResource("DEFAULT_ZOOMRECTANGLE"));null===Z.rulerVisible&&(Z.rulerVisible=parseInt(this.getResource("z196"),10));null===Z.rulerListType&&(Z.rulerListType=this.getResource("z193"));null===Z.rulerW&&(Z.rulerW=parseInt(this.getResource("z197"),10));null===Z.rulerH&&(Z.rulerH=parseInt(this.getResource("z191"),
10));null===Z.rulerL&&(Z.rulerL=parseInt(this.getResource("z192"),10));null===Z.rulerT&&(Z.rulerT=parseInt(this.getResource("z195"),10));isNaN(parseFloat(this.getResource("z210")))||(Z.slideTransitionSpeed=parseFloat(this.getResource("z210")));null===Z.slideButtonsVisible&&(Z.slideButtonsVisible="0"!=this.getResource("DEFAULT_SLIDEBUTTONSVISIBLE"));null===Z.coordinatesVisible&&(Z.coordinatesVisible="0"!=this.getResource("z100"));null===Z.geoCoordinatesVisible&&(Z.geoCoordinatesVisible="0"!=this.getResource("DEFAULT_GEOCOORDINATESVISIBLE"));
null===Z.preloadVisible&&(Z.preloadVisible="0"!=this.getResource("DEFAULT_PRELOADVISIBLE"));null===Z.focal&&(Z.focal=parseInt(this.getResource("z114"),10));null===Z.quality&&(Z.quality=parseInt(this.getResource("z188"),10));null===Z.magnifierVisible&&(Z.magnifierVisible="0"!=this.getResource("DEFAULT_MAGNIFIERVISIBLE"));null===Z.magnifierW&&(Z.magnifierW=parseInt(this.getResource("DEFAULT_MAGNIFIERWIDTH"),10));null===Z.magnifierH&&(Z.magnifierH=parseInt(this.getResource("DEFAULT_MAGNIFIERHEIGHT"),
10));null===Z.magnifierL&&(Z.magnifierL=parseInt(this.getResource("DEFAULT_MAGNIFIERLEFT"),10));null===Z.magnifierT&&(Z.magnifierT=parseInt(this.getResource("DEFAULT_MAGNIFIERTOP"),10));null===Z.narrativeFolderPath&&(Z.narrativeFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEFOLDERPATH"));null===Z.narrativeImageFolderPath&&(Z.narrativeImageFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEIMAGEFOLDERPATH"));null===Z.narrativeMediaFolderPath&&(Z.narrativeMediaFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEMEDIAFOLDERPATH"));
null===Z.narrativeAnnotationFolderPath&&(Z.narrativeAnnotationFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEANNOTATIONFOLDERPATH"));null===Z.saveImageFull&&(Z.saveImageFull="0"!=this.getResource("DEFAULT_SAVEIMAGEFULL"));null===Z.saveImageFilename&&(Z.saveImageFilename=this.getResource("DEFAULT_SAVEIMAGEFILENAME"));null===Z.saveImageFormat&&(Z.saveImageFormat=this.getResource("DEFAULT_SAVEIMAGEFORMAT"));null===Z.saveImageCompression&&(Z.saveImageCompression=parseFloat(this.getResource("DEFAULT_SAVEIMAGECOMPRESSION")));
E=E=l=l=null;document.body&&(l=document.body.style,l=l.backgroundColor);var n=document.getElementById(Z.pageContainerID);n&&(E=Z.Utils.getElementStyle(n),E=E.backgroundColor);null===Z.saveImageBackColor&&(Z.saveImageBackColor=Z.Utils.stringValidate(E)&&"transparent"!=E?E:Z.Utils.stringValidate(l)&&"transparent"!=l?l:Z.Utils.getResource("DEFAULT_SAVEIMAGEBACKCOLOR"));null===Z.imageFilters&&(Z.imageFilters="0"!=this.getResource("DEFAULT_IMAGEFILTERS"));null===Z.initialImageFilters&&(Z.initialImageFilters=
"0"!=this.getResource("z142"));null===Z.brightnessVisible&&(Z.brightnessVisible="0"!=this.getResource("DEFAULT_BRIGHTNESSVISIBLE"));null===Z.contrastVisible&&(Z.contrastVisible="0"!=this.getResource("DEFAULT_CONTRASTVISIBLE"));null===Z.sharpnessVisible&&(Z.sharpnessVisible="0"!=this.getResource("DEFAULT_SHARPNESSVISIBLE"));null===Z.blurrinessVisible&&(Z.blurrinessVisible="0"!=this.getResource("DEFAULT_BLURRINESSVISIBLE"));null===Z.colorRedVisible&&(Z.colorRedVisible="0"!=this.getResource("DEFAULT_COLORREDVISIBLE"));
null===Z.colorGreenVisible&&(Z.colorGreenVisible="0"!=this.getResource("DEFAULT_COLORGREENVISIBLE"));null===Z.colorBlueVisible&&(Z.colorBlueVisible="0"!=this.getResource("DEFAULT_COLORBLUEVISIBLE"));null===Z.colorRedRangeVisible&&(Z.colorRedRangeVisible="0"!=this.getResource("DEFAULT_COLORREDRANGEVISIBLE"));null===Z.colorGreenRangeVisible&&(Z.colorGreenRangeVisible="0"!=this.getResource("DEFAULT_COLORGREENRANGEVISIBLE"));null===Z.colorBlueRangeVisible&&(Z.colorBlueRangeVisible="0"!=this.getResource("DEFAULT_COLORBLUERANGEVISIBLE"));
null===Z.gammaVisible&&(Z.gammaVisible="0"!=this.getResource("DEFAULT_GAMMAVISIBLE"));null===Z.gammaRedVisible&&(Z.gammaRedVisible="0"!=this.getResource("DEFAULT_GAMMAREDVISIBLE"));null===Z.gammaGreenVisible&&(Z.gammaGreenVisible="0"!=this.getResource("DEFAULT_GAMMAGREENVISIBLE"));null===Z.gammaBlueVisible&&(Z.gammaBlueVisible="0"!=this.getResource("DEFAULT_GAMMABLUEVISIBLE"));null===Z.hueVisible&&(Z.hueVisible="0"!=this.getResource("DEFAULT_HUEVISIBLE"));null===Z.saturationVisible&&(Z.saturationVisible=
"0"!=this.getResource("DEFAULT_SATURATIONVISIBLE"));null===Z.lightnessVisible&&(Z.lightnessVisible="0"!=this.getResource("DEFAULT_LIGHTNESSVISIBLE"));null===Z.whiteBalanceVisible&&(Z.whiteBalanceVisible="0"!=this.getResource("DEFAULT_WHITEBALANCEVISIBLE"));null===Z.normalizeVisible&&(Z.normalizeVisible="0"!=this.getResource("DEFAULT_NORMALIZEVISIBLE"));null===Z.equalizeVisible&&(Z.equalizeVisible="0"!=this.getResource("DEFAULT_EQUALIZEVISIBLE"));null===Z.noiseVisible&&(Z.noiseVisible="0"!=this.getResource("DEFAULT_NOISEVISIBLE"));
null===Z.grayscaleVisible&&(Z.grayscaleVisible="0"!=this.getResource("DEFAULT_GRAYSCALEVISIBLE"));null===Z.thresholdVisible&&(Z.thresholdVisible="0"!=this.getResource("DEFAULT_THRESHOLDVISIBLE"));null===Z.inversionVisible&&(Z.inversionVisible="0"!=this.getResource("DEFAULT_INVERSIONVISIBLE"));null===Z.edgesVisible&&(Z.edgesVisible="0"!=this.getResource("DEFAULT_EDGESVISIBLE"));null===Z.sepiaVisible&&(Z.sepiaVisible="0"!=this.getResource("DEFAULT_SEPIAVISIBLE"));null===Z.fieldOfViewVisible&&(Z.fieldOfViewVisible=
"0"!=this.getResource("DEFAULT_FIELDOFVIEWVISIBLE"));null===Z.textVisible&&(Z.textVisible="0"!=this.getResource("z217"));null===Z.shapeVisible&&(Z.shapeVisible="0"!=this.getResource("DEFAULT_SHAPEVISIBLE"));null===Z.freehandVisible&&(Z.freehandVisible="0"!=this.getResource("z116"));null===Z.polygonVisible&&(Z.polygonVisible="0"!=this.getResource("z181"));null===Z.annotationPanelVisible&&(Z.annotationPanelVisible=parseInt(this.getResource("DEFAULT_ANNOTATIONPANELVISIBLE"),10));null===Z.labelShapesInternal&&
(Z.labelShapesInternal="1"==this.getResource("DEFAULT_LABELSHAPESINTERNAL"));null===Z.annotationsAddMultiple&&(Z.annotationsAddMultiple="0"!=this.getResource("DEFAULT_ANNOTATIONSADDMULTIPLE"));null===Z.annotationsAutoSave&&(Z.annotationsAutoSave="0"!=this.getResource("DEFAULT_ANNOTATIONSAUTOSAVE"));null===Z.annotationsAutoSaveImage&&(Z.annotationsAutoSaveImage="0"!=this.getResource("DEFAULT_ANNOTATIONSAUTOSAVEIMAGE"));null===Z.saveButtonVisible&&(Z.saveButtonVisible="0"!=this.getResource("DEFAULT_ANNOTATIONSAVEBUTTONVISIBLE"));
null===Z.labelClickSelect&&(Z.labelClickSelect="0"!=this.getResource("DEFAULT_LABELCLICKSELECT"));null===Z.labelHighlight&&(Z.labelHighlight="0"!=this.getResource("DEFAULT_LABELHIGHLIGHT"));null===Z.userPanelVisible&&(Z.userPanelVisible=this.getResource("DEFAULT_USERPANELVISIBLE"));null===Z.userNamePrompt&&(Z.userNamePrompt=Z.Utils.getResource("UI_USERNAMEPROMPT"));null===Z.userNamePromptRetry&&(Z.userNamePromptRetry=Z.Utils.getResource("UI_USERNAMEPROMPTRETRY"));null===Z.trackingPanelVisible&&(Z.trackingPanelVisible=
parseInt(this.getResource("DEFAULT_TRACKINGPANELVISIBLE"),10));null===Z.initialTrackingOverlayVisible&&(Z.initialTrackingOverlayVisible=parseInt(this.getResource("DEFAULT_INITIALTRACKINGOVERLAYVISIBLE"),10));null===Z.sliderImageSetVisible&&(Z.sliderImageSetVisible="0"!=this.getResource("DEFAULT_IMAGESETSLIDERVISIBLE"));if("object"===typeof a&&null!==a){l=this.getResource("z287");Z.annotationPathProvided="undefined"!==typeof a.zHotspotPath||"undefined"!==typeof a.zAnnotationPath||"undefined"!==typeof a.zAnnotationXMLText||
"undefined"!==typeof a.zAnnotationJSONObject||"undefined"!==typeof a.zNarrativePath;Z.saveHandlerProvided="undefined"!==typeof a.zSaveHandlerPath||"undefined"!==typeof a.zNoPost&&"1"==a.zNoPost;Z.fileHandlerProvided=Z.saveHandlerProvided||"undefined"!==typeof a.zFileHandlerPath;Z.saveImageHandlerProvided="undefined"!==typeof a.zFileHandlerPath||"undefined"!==typeof a.zSaveImageHandlerPath;Z.narrativePathProvided="undefined"!==typeof a.zNarrativePath;Z.imageSetPathProvided="undefined"!==typeof a.zAnimationPath||
"undefined"!==typeof a.zSlidestackPath;Z.mouseWheelParmeterProvided="undefined"!==typeof a.zMouseWheel;Z.trackingPathProvided="undefined"!==typeof a.zTrackingPath||"undefined"!==typeof a.zTrackingXMLText||"undefined"!==typeof a.zTrackingJSONObject;Z.userPathProvided="undefined"!==typeof a.zUserPath||"undefined"!==typeof a.zUserXMLText||"undefined"!==typeof a.zUserJSONObject;Z.slidePathProvided=Z.imagePath&&-1!=Z.imagePath.indexOf("zSlidePath")||"undefined"!==typeof a.zSlidePath;var E=Z.slidePathProvided||
Z.comparison||Z.overlays||Z.slideshow||Z.imageSetPathProvided||Z.animation||Z.slidestack,w;for(w in a)if(!("function"===typeof a[w]&&"zOnAnnotationReady"!==w&&"zOnReady"!==w||E&&("each"==w||"eachSlice"==w||"all"==w||"any"==w||"collect"==w||"detect"==w||"findAll"==w||"select"==w||"grep"==w||"include"==w||"member"==w||"inGroupsOf"==w||"inject"==w||"invoke"==w||"max"==w||"min"==w||"partition"==w||"pluck"==w||"reject"==w||"sortBy"==w||"toArray"==w||"zip"==w||"size"==w||"inspect"==w||"_reverse"==w||"_each"==
w||"clear"==w||"first"==w||"last"==w||"compact"==w||"flatten"==w||"without"==w||"uniq"==w||"intersect"==w||"clone"==w)||-1!=w.indexOf("this.indexOf")))if("undefined"===typeof Z[Z.Utils.stringLowerCaseFirstLetter(w.substr(1))])E?console.log(l+" "+w):alert(l+" "+w);else if(pValue=a[w],Z.expressParamsEnabled||"zNavigatorVisible"==w)switch(w){case "zOnAnnotationReady":"function"===typeof pValue&&Z.setCallback("annotationPanelInitializedViewer",pValue);break;case "zOnReady":"function"===typeof pValue&&
Z.setCallback("readyViewer",pValue);break;case "zInitialX":isNaN(parseFloat(pValue))||(Z.initialX=parseFloat(pValue));break;case "zInitialY":isNaN(parseFloat(pValue))||(Z.initialY=parseFloat(pValue));break;case "zInitialZoom":"fit"==pValue&&(pValue="-1");"fill"==pValue&&(pValue="0");isNaN(parseFloat(pValue))||(Z.initialZ=parseFloat(pValue),Z.initialZ&&0<Z.initialZ&&100>=Z.initialZ&&(Z.initialZ/=100));break;case "zMinZoom":"fit"==pValue&&(pValue="-1");"fill"==pValue&&(pValue="0");isNaN(parseFloat(pValue))||
(Z.minZ=parseFloat(pValue),Z.minZ&&0<Z.minZ&&100>=Z.minZ&&(Z.minZ/=100));break;case "zMaxZoom":isNaN(parseFloat(pValue))||(Z.maxZ=parseFloat(pValue),Z.maxZ&&-1!=Z.maxZ&&(Z.maxZ/=100));break;case "zNavigatorVisible":Z.navigatorVisible=parseInt(pValue,10);break;case "zNavigatorRectangleColor":Z.navigatorRectangleColor=pValue;break;case "zToolbarInternal":Z.toolbarInternal=pValue;break;case "zToolbarVisible":Z.toolbarVisible=parseInt(pValue,10);Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&
6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible;break;case "zToolbarBackgroundVisible":"0"==pValue&&(Z.toolbarBackgroundVisible=!1);break;case "zLogoVisible":"0"==pValue&&(Z.logoVisible=!1);break;case "zMinimizeVisible":"0"==pValue&&(Z.minimizeVisible=!1);break;case "zSliderVisible":"0"==pValue&&(Z.sliderZoomVisible=!1);break;case "zZoomButtonsVisible":"0"==pValue&&(Z.zoomButtonsVisible=!1);break;case "zPanButtonsVisible":"0"==pValue&&(Z.panButtonsVisible=!1);break;case "zResetVisible":"0"==
pValue&&(Z.resetVisible=!1);break;case "zFullViewVisible":"1"==pValue?(Z.fullScreenVisible=!0,Z.fullPageVisible=!1):"0"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!1);break;case "zFullScreenVisible":"0"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!1);break;case "zFullPageVisible":"1"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!0);break;case "zInitialFullPage":"1"==pValue&&(Z.initialFullPage=!0);break;case "zFullPageInitial":alert(Z.Utils.getResource("z275")+" zFullPageInitial is now zInitialFullPage");
break;case "zSkinPath":Z.skinPath=pValue;break;case "zTooltipsVisible":"0"==pValue&&(Z.tooltipsVisible=!1);break;case "zHelpVisible":Z.helpVisible=parseInt(pValue,10);break;case "zHelpPath":Z.helpPath=pValue;Z.helpCustom=!0;break;case "zHelpWidth":isNaN(parseInt(pValue,10))||(Z.helpW=parseInt(pValue,10));break;case "zHelpHeight":isNaN(parseInt(pValue,10))||(Z.helpH=parseInt(pValue,10));break;case "zHelpLeft":isNaN(parseInt(pValue,10))||(Z.helpL=parseInt(pValue,10));break;case "zHelpTop":isNaN(parseInt(pValue,
10))||(Z.helpT=parseInt(pValue,10));break;case "zProgressVisible":"0"==pValue&&(Z.progressVisible=!1);break;case "zMessagesVisible":"0"==pValue&&(Z.messagesVisible=!1);break;case "zTileSource":"dzi"==pValue.toLowerCase()&&(Z.tileSource="DZIFolder");break;case "zUsingDirectoryExtensions":"1"==pValue&&(Z.usingDirectoryExtensions=!0);break;default:if(Z.proParamsEnabled)switch(w){case "zXMLParametersPath":Z.xmlParametersPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.loadParametersXML();break;case "zZoomSpeed":Z.zoomSpeed=
parseInt(pValue,10);break;case "zPanSpeed":Z.panSpeed=parseInt(pValue,10);break;case "zFadeInSpeed":Z.fadeInSpeed=parseInt(pValue,10);Z.fadeIn=0<Z.fadeInSpeed&&!Z.imageFilters;break;case "zInteractive":"0"==pValue&&(Z.interactive=!1,Z.navigatorVisible=!1,Z.toolbarVisible=0,Z.clickZoom=!1,Z.doubleClickZoom=!1,Z.clickPan=!1,Z.mousePan=!1,Z.keys=!1);break;case "zClickZoom":"0"==pValue&&(Z.clickZoom=!1);break;case "zDoubleClickZoom":"0"==pValue&&(Z.doubleClickZoom=!1);break;case "zDoubleClickDelay":Z.doubleClickDelay=
parseInt(pValue,10);break;case "zClickPan":"0"==pValue&&(Z.clickPan=!1);break;case "zMousePan":"0"==pValue&&(Z.mousePan=!1);break;case "zKeys":"0"==pValue&&(Z.keys=!1);break;case "zConstrainPan":Z.constrainPan="0"!=pValue;Z.constrainPanLimit=parseInt(pValue,10);Z.constrainPanStrict="3"==pValue;break;case "zPanBuffer":n=parseFloat(pValue);isNaN(n)||(Z.panBuffer=n);break;case "zSmoothPan":"0"==pValue&&(Z.smoothPan=!1);break;case "zSmoothPanEasing":n=parseInt(pValue,10);1<=n&&5>=n&&(Z.smoothPanEasing=
n);break;case "zSmoothPanGlide":n=parseInt(pValue,10);1<=n&&5>=n&&(Z.smoothPanGlide=n);break;case "zSmoothZoom":"0"==pValue&&(Z.smoothZoom=!1);break;case "zSmoothZoomEasing":n=parseInt(pValue,10);1<=n&&4>=n&&(Z.smoothZoomEasing=n);break;case "zAutoResize":"1"==pValue&&(Z.autoResize=!0);break;case "zCanvas":"0"==pValue&&(Z.canvas=!1);Z.canvasSupported&&Z.canvas||(Z.useCanvas=!1);break;case "zBaseZIndex":Z.baseZIndex=parseInt(pValue,10);break;case "zDebug":Z.debug=parseInt(pValue,10);break;case "zHideOverlayBackfill":"1"==
pValue&&(Z.hideOverlayBackfill=!0);break;case "zDemoNoSave":"1"==pValue&&(Z.demoNoSave=!0);break;case "zImageProperties":Z.imageProperties=pValue;break;case "zNavigatorWidth":!isNaN(parseInt(pValue,10))&&(Z.navigatorW=parseInt(pValue,10),0<Z.rulerVisible&&null===Z.rulerW||-1==Z.rulerW)&&(Z.rulerW=Z.navigatorW);break;case "zNavigatorHeight":isNaN(parseInt(pValue,10))||(Z.navigatorH=parseInt(pValue,10));break;case "zNavigatorLeft":isNaN(parseInt(pValue,10))||(Z.navigatorL=parseInt(pValue,10));break;
case "zNavigatorTop":isNaN(parseInt(pValue,10))||(Z.navigatorT=parseInt(pValue,10));break;case "zNavigatorFit":isNaN(parseFloat(pValue))||(Z.navigatorFit=parseInt(pValue,10));break;case "zGalleryVisible":Z.galleryVisible=parseInt(pValue,10);Z.galleryAutoShowHide=2==Z.galleryVisible;break;case "zGalleryWidth":isNaN(parseInt(pValue,10))||(Z.galleryW=parseInt(pValue,10));break;case "zGalleryHeight":isNaN(parseInt(pValue,10))||(Z.galleryH=parseInt(pValue,10));break;case "zGalleryLeft":isNaN(parseInt(pValue,
10))||(Z.galleryL=parseInt(pValue,10));break;case "zGalleryTop":isNaN(parseInt(pValue,10))||(Z.galleryT=parseInt(pValue,10));break;case "zGalleryPosition":Z.galleryPosition=parseInt(pValue,10);break;case "zToolbarPosition":Z.toolbarPosition=parseInt(pValue,10);break;case "zLogoCustomPath":Z.logoCustomPath=pValue;break;case "zLogoLinkURL":this.stringValidate(pValue)&&("none"!==pValue&&-1==pValue.indexOf("http")&&(pValue="http://"+pValue),Z.logoLinkURL=pValue);break;case "zBookmarksGet":"1"==pValue&&
(Z.bookmarksGet=!0);break;case "zBookmarksSet":"1"==pValue&&(Z.bookmarksSet=!0);break;case "zCopyrightPath":Z.copyrightPath=pValue;break;case "zWatermarkPath":Z.watermarkPath=pValue;Z.watermarks=!0;break;case "zVirtualPointerVisible":"1"==pValue&&(Z.virtualPointerVisible=!0);break;case "zVirtualPointerPath":Z.virtualPointerPath=pValue;break;case "zCrosshairsVisible":"1"==pValue&&(Z.crosshairsVisible=!0);break;case "zZoomRectangle":"0"==pValue&&(Z.zoomRectangle=!1);break;case "zRulerVisible":Z.rulerVisible=
parseInt(pValue,10);break;case "zRulerListType":this.stringValidate(pValue)&&(Z.rulerListType=pValue);break;case "zRulerWidth":isNaN(parseInt(pValue,10))||(Z.rulerW=parseInt(pValue,10));break;case "zRulerHeight":isNaN(parseInt(pValue,10))||(Z.rulerH=parseInt(pValue,10));break;case "zRulerLeft":isNaN(parseInt(pValue,10))||(Z.rulerL=parseInt(pValue,10));break;case "zRulerTop":isNaN(parseInt(pValue,10))||(Z.rulerT=parseInt(pValue,10));break;case "zUnits":this.stringValidate(pValue)&&(Z.units=pValue);
break;case "zUnitsPerImage":isNaN(parseFloat(pValue))||(Z.unitsPerImage=parseFloat(pValue));break;case "zPixelsPerUnit":isNaN(parseFloat(pValue))||(Z.pixelsPerUnit=parseFloat(pValue));break;case "zSourceMagnification":isNaN(parseInt(pValue,10))||(Z.sourceMagnification=parseInt(pValue,10));break;case "zMagnification":alert(Z.Utils.getResource("z275")+" zMagnification is now zSourceMagnification");break;case "zMeasureVisible":Z.measureVisible="1"==pValue;break;case "zRotationVisible":"0"!=pValue&&(Z.rotationVisible=
!0,Z.rotationFree="1"==pValue);break;case "zInitialRotation":isNaN(parseFloat(pValue))||(Z.initialR=parseInt(pValue,10));break;case "zImageListPath":Z.imageListPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageList=!0;break;case "zScreensaver":"1"==pValue&&(Z.screensaver=!0,Z.tour=!0);break;case "zScreensaverSpeed":Z.screensaverSpeed=parseInt(pValue,10);break;case "zTourPath":Z.tourPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.hotspotPath=Z.tourPath;Z.hotspotFolder=Z.hotspotPath;".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-
4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/")));Z.tour=!0;break;case "zTourListTitle":Z.tourListTitle=pValue;break;case "zComparisonPath":Z.imageSetPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageSet=!0;Z.comparison=!0;Z.smoothPan=!1;break;case "zSyncVisible":"0"==pValue&&(Z.syncVisible=!1);break;case "zInitialSync":"0"==pValue&&(Z.initialSync=!1);break;case "zSlidePath":Z.slidePath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.slideshow=
!0;break;case "zSlideListTitle":Z.slideListTitle=pValue;break;case "zSlideButtonsVisible":"0"==pValue&&(Z.slideButtonsVisible=!1);break;case "zHotspotPath":Z.hotspotPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.hotspotFolder=Z.hotspotPath;".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/")));Z.hotspots=!0;break;case "zHotspotListTitle":Z.hotspotListTitle=pValue;break;case "zHotspotsDrawOnlyInView":"0"==
pValue&&(Z.hotspotsDrawOnlyInView=!1);break;case "zCaptionBoxes":"1"==pValue&&(Z.captionBoxes=!0);break;case "zCaptionOffset":Z.captionOffset=parseInt(pValue,10);break;case "zCaptionTextColor":Z.captionTextColor=Z.Utils.stringValidateColorValue(pValue);Z.captionsColorsDefault=!1;break;case "zCaptionBackColor":Z.captionBackColor=Z.Utils.stringValidateColorValue(pValue);Z.captionsColorsDefault=!1;break;case "zLabelLineColor":Z.labelLineColor=Z.Utils.stringValidateColorValue(pValue);break;case "zLabelFillColor":Z.labelFillColor=
Z.Utils.stringValidateColorValue(pValue);break;case "zCaptionTextVisible":"0"==pValue&&(Z.captionTextVisible=!1);break;case "zCaptionBackVisible":"0"==pValue&&(Z.captionBackVisible=!1);break;case "zLabelLineVisible":"0"==pValue&&(Z.labelLineVisible=!1);break;case "zLabelFillVisible":"1"==pValue&&(Z.labelFillVisible=!0);break;case "zCaptionPosition":Z.captionPosition=pValue;break;case "zCoordinatesVisible":"1"==pValue&&(Z.coordinatesVisible=!0);break;case "zGeoCoordinatesPath":Z.geoCoordinatesPath=
Z.Utils.stringRemoveTrailingSlash(pValue);Z.geoCoordinatesFolder=Z.geoCoordinatesPath;".xml"==Z.geoCoordinatesPath.toLowerCase().substring(Z.geoCoordinatesPath.length-4,Z.geoCoordinatesPath.length)&&(Z.geoCoordinatesFolder=Z.geoCoordinatesFolder.substring(0,Z.geoCoordinatesFolder.lastIndexOf("/")));Z.geoCoordinatesVisible=!0;Z.coordinatesVisible=!0;break;case "zPreloadVisible":"1"==pValue&&(Z.preloadVisible=!0);break;case "zOverlayPath":Z.imageSetPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageSet=
!0;Z.overlays=!0;break;case "zOverlayJSONObject":Z.overlayJSONObject=pValue;Z.imageSet=!0;Z.overlays=!0;break;case "zAnimationPath":Z.imageSetPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageSet=!0;Z.animation=!0;Z.mouseWheelParmeterProvided||(Z.mouseWheel=parseInt(this.getResource("DEFAULT_MOUSEWHEELANIMATION"),10),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom");Z.constrainPanStrict||(Z.constrainPanStrict=!0);break;case "zAnimationAxis":Z.animationAxis=this.stringValidate(pValue)&&"vertical"==
pValue?"vertical":"horizontal";break;case "zAnimator":Z.animator=this.stringValidate(pValue)&&"motion"==pValue?"motion":"position";break;case "zAnimationFlip":"1"==pValue&&(Z.animationFlip=!0);break;case "zImageSetSliderVisible":"0"==pValue&&(Z.sliderImageSetVisible=!1);break;case "zMouseWheel":Z.mouseWheel=parseInt(pValue,10);Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom";break;case "zTilesPNG":"1"==pValue&&(Z.tileType="png");break;case "zTileW":Z.tileW=parseInt(pValue,10);break;case "zTileH":Z.tileH=
parseInt(pValue,10);break;case "zMaskVisible":"1"==pValue&&(Z.maskVisible=!0);break;case "zMaskScale":Z.maskScale=parseFloat(pValue);break;case "zMaskBorder":"1"==pValue&&(Z.maskBorder=!0);break;case "zMaskFadeSpeed":Z.maskFadeSpeed=parseInt(pValue,10);break;case "zMaskClearOnUserAction":"0"==pValue&&(Z.maskClearOnUserAction=!1);break;default:if(Z.enterpriseParamsEnabled)switch(w){case "zImageFiltersVisible":if(Z.Utils.stringValidate(pValue))switch(pValue){case "all":Z.brightnessVisible=!0;Z.contrastVisible=
!0;Z.sharpnessVisible=!0;Z.blurrinessVisible=!0;Z.colorRedVisible=!0;Z.colorGreenVisible=!0;Z.colorBlueVisible=!0;Z.colorRedRangeVisible=!0;Z.colorGreenRangeVisible=!0;Z.colorBlueRangeVisible=!0;Z.gammaVisible=!0;Z.gammaRedVisible=!0;Z.gammaGreenVisible=!0;Z.gammaBlueVisible=!0;Z.hueVisible=!0;Z.saturationVisible=!0;Z.lightnessVisible=!0;Z.whiteBalanceVisible=!0;Z.noiseVisible=!0;Z.grayscaleVisible=!0;Z.thresholdVisible=!0;Z.inversionVisible=!0;Z.edgesVisible=!0;Z.sepiaVisible=!0;break;case "creative":Z.brightnessVisible=
!0;Z.contrastVisible=!0;Z.sharpnessVisible=!0;Z.blurrinessVisible=!0;Z.colorRedVisible=!0;Z.colorGreenVisible=!0;Z.colorBlueVisible=!0;Z.gammaVisible=!0;Z.whiteBalanceVisible=!0;Z.noiseVisible=!0;Z.grayscaleVisible=!0;Z.inversionVisible=!0;Z.sepiaVisible=!0;break;case "hsl":Z.hueVisible=!0;Z.saturationVisible=!0;Z.lightnessVisible=!0;break;case "pathology":Z.brightnessVisible=!0;Z.contrastVisible=!0;Z.sharpnessVisible=!0;Z.gammaRedVisible=!0;Z.gammaGreenVisible=!0;Z.gammaBlueVisible=!0;Z.whiteBalanceVisible=
!0;Z.thresholdVisible=!0;Z.edgesVisible=!0;break;case "colors":Z.colorRedVisible=!0;Z.colorGreenVisible=!0;Z.colorBlueVisible=!0;break;case "ranges":Z.colorRedRangeVisible=!0;Z.colorGreenRangeVisible=!0;Z.colorBlueRangeVisible=!0;break;case "gammaColors":Z.gammaRedVisible=!0;Z.gammaGreenVisible=!0;Z.gammaBlueVisible=!0;break;case "external":Z.imageFilters="external",Z.imageFiltersVisible=!0,Z.fadeIn=!1}break;case "zInitialImageFilters":"0"==pValue&&(Z.initialImageFilters=!1);break;case "zBrightnessVisible":"1"==
pValue&&(Z.brightnessVisible=!0);break;case "zContrastVisible":"1"==pValue&&(Z.contrastVisible=!0);break;case "zSharpnessVisible":"1"==pValue&&(Z.sharpnessVisible=!0);break;case "zBlurrinessVisible":"1"==pValue&&(Z.blurrinessVisible=!0);break;case "zColorRedVisible":"1"==pValue&&(Z.colorRedVisible=!0);break;case "zColorGreenVisible":"1"==pValue&&(Z.colorGreenVisible=!0);break;case "zColorBlueVisible":"1"==pValue&&(Z.colorBlueVisible=!0);break;case "zColorRedRangeVisible":"1"==pValue&&(Z.colorRedRangeVisible=
!0);break;case "zColorGreenRangeVisible":"1"==pValue&&(Z.colorGreenRangeVisible=!0);break;case "zColorBlueRangeVisible":"1"==pValue&&(Z.colorBlueRangeVisible=!0);break;case "zGammaVisible":"1"==pValue&&(Z.gammaVisible=!0);break;case "zGammaRedVisible":"1"==pValue&&(Z.gammaRedVisible=!0);break;case "zGammaGreenVisible":"1"==pValue&&(Z.gammaGreenVisible=!0);break;case "zGammaBlueVisible":"1"==pValue&&(Z.gammaBlueVisible=!0);break;case "zHueVisible":"1"==pValue&&(Z.hueVisible=!0);break;case "zSaturationVisible":"1"==
pValue&&(Z.saturationVisible=!0);break;case "zLightnessVisible":"1"==pValue&&(Z.lightnessVisible=!0);break;case "zWhiteBalanceVisible":"1"==pValue&&(Z.whiteBalanceVisible=!0);break;case "zNormalizeVisible":"1"==pValue&&(Z.normalizeVisible=!0);break;case "zEqualizeVisible":"1"==pValue&&(Z.equalizeVisible=!0);break;case "zNoiseVisible":"1"==pValue&&(Z.noiseVisible=!0);break;case "zGrayscaleVisible":"1"==pValue&&(Z.grayscaleVisible=!0);break;case "zThresholdVisible":"1"==pValue&&(Z.thresholdVisible=
!0);break;case "zInversionVisible":"1"==pValue&&(Z.inversionVisible=!0);break;case "zEdgesVisible":"1"==pValue&&(Z.edgesVisible=!0);break;case "zSepiaVisible":"1"==pValue&&(Z.sepiaVisible=!0);break;case "zAnnotationPath":Z.annotationPath=Z.Utils.stringRemoveTrailingSlash(pValue);"undefined"!==typeof Z.annotationPath&&Z.Utils.stringValidate(Z.annotationPath)?(Z.annotationFolder=Z.annotationPath,".xml"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-4,Z.annotationPath.length)&&(Z.annotationFolder=
Z.annotationFolder.substring(0,Z.annotationFolder.lastIndexOf("/"))),Z.annotations=!0):alert(this.getResource("ERROR_ANNOTATIONPATHMISSING"));break;case "zAnnotationPanelVisible":Z.annotationPanelVisible=parseInt(pValue,10);break;case "zClickURLEntryVisible":Z.clickURLEntryVisible=parseInt(pValue,10);break;case "zAnnotationXMLText":Z.annotationXMLText=pValue;Z.annotations=!0;break;case "zLabelShapesInternal":"0"==pValue&&(Z.labelShapesInternal=!1);break;case "zAnnotationJSONObject":Z.annotationJSONObject=
pValue;Z.annotations=!0;break;case "zAnnotationsAddMultiple":"0"==pValue&&(Z.annotationsAddMultiple=!1);break;case "zAnnotationsAutoSave":"0"==pValue?Z.annotationsAutoSave=!1:"2"==pValue&&(Z.annotationsAutoSaveImage=!0);break;case "zSaveButtonVisible":"0"==pValue&&(Z.saveButtonVisible=!1);break;case "zLabelClickSelect":"0"==pValue&&(Z.labelClickSelect=!1);break;case "zLabelClickDrag":"0"==pValue&&(Z.labelClickDrag=!1);break;case "zLabelHighlight":"0"==pValue&&(Z.labelHighlight=!1);break;case "zSimplePath":"1"==
pValue&&(Z.simplePath=!0);break;case "zNoPost":"1"==pValue&&(Z.noPost=!0);break;case "zNoPostDefaults":"0"==pValue&&(Z.noPostDefaults=!1);break;case "zUnsavedEditsTest":"0"==pValue&&(Z.unsavedEditsTest=!1);break;case "zAnnotationSort":Z.annotationSort=pValue;break;case "zAnnotationXMLAperioLoad":"1"==pValue&&(Z.annotationXMLAperioLoad=!0);break;case "zAnnotationXMLAperioPost":"1"==pValue&&(Z.annotationXMLAperioPost=!0);break;case "zFieldOfViewVisible":"0"==pValue&&(Z.fieldOfViewVisible=!1);break;
case "zTextVisible":"0"==pValue&&(Z.textVisible=!1);break;case "zShapeVisible":"0"==pValue&&(Z.shapeVisible=!1);break;case "zFreehandVisible":"0"==pValue&&(Z.freehandVisible=!1);break;case "zPolygonVisible":"0"==pValue&&(Z.polygonVisible=!1);break;case "zMarkupMode":if("1"==pValue||"2"==pValue)Z.annotationPathProvided||Z.imageSetPathProvided?(Z.editMode="markup",Z.markupMode=!0,Z.editing="addLabel","2"==pValue&&(Z.editAdmin=!0)):alert(this.getResource("ERROR_ANNOTATIONPATHMISSING"));break;case "zEditMode":if("1"==
pValue||"2"==pValue)Z.annotationPathProvided||Z.imageSetPathProvided?(Z.editMode="edit","2"==pValue&&(Z.editAdmin=!0)):alert(this.getResource("ERROR_ANNOTATIONPATHMISSING"));break;case "zMagnifierVisible":Z.magnifierVisible=parseInt(pValue,10);break;case "zMagnifierWidth":isNaN(parseInt(pValue,10))||(Z.magnifierW=parseInt(pValue,10));break;case "zMagnifierHeight":isNaN(parseInt(pValue,10))||(Z.magnifierH=parseInt(pValue,10));break;case "zMagnifierLeft":isNaN(parseInt(pValue,10))||(Z.magnifierL=parseInt(pValue,
10));break;case "zMagnifierTop":isNaN(parseInt(pValue,10))||(Z.magnifierT=parseInt(pValue,10));break;case "zNarrativePath":n=Z.narrativePath=Z.Utils.stringRemoveTrailingSlash(pValue);"undefined"!==typeof n&&Z.Utils.stringValidate(n)?(".htm"==n.toLowerCase().substring(n.length-4,n.length)?Z.narrativeFolderPath=n.substring(0,n.lastIndexOf("/")+1):Z.narrativeFolderPath=n+"/",Z.narrative=!0,Z.fieldOfViewVisible=!0,Z.logoVisible=!1,Z.minimizeVisible=!1):alert(this.getResource("ERROR_NARRATIVEPATHMISSING"));
break;case "zNarrativeImageFolderPath":n=Z.Utils.stringRemoveTrailingSlash(pValue);".htm"==n.toLowerCase().substring(n.length-4,n.length)?Z.narrativeImageFolderPath=n.substring(0,n.lastIndexOf("/")+1):Z.narrativeImageFolderPath=n+"/";break;case "zNarrativeMediaFolderPath":n=Z.Utils.stringRemoveTrailingSlash(pValue);".htm"==n.toLowerCase().substring(n.length-4,n.length)?Z.narrativeMediaFolderPath=n.substring(0,n.lastIndexOf("/")+1):Z.narrativeMediaFolderPath=n+"/";break;case "zNarrativeAnnotationFolderPath":n=
Z.Utils.stringRemoveTrailingSlash(pValue);".htm"==n.toLowerCase().substring(n.length-4,n.length)?Z.narrativeAnnotationFolderPath=n.substring(0,n.lastIndexOf("/")+1):Z.narrativeAnnotationFolderPath=n+"/";break;case "zNarrativeMode":"1"==pValue&&(Z.narrativePathProvided?Z.narrativeMode=!0:alert(this.getResource("ERROR_NARRATIVEPATHMISSING")));break;case "zSlidestackPath":Z.imageSetPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageSet=!0;Z.slidestack=!0;Z.mouseWheelParmeterProvided||(Z.mouseWheel=
parseInt(this.getResource("DEFAULT_MOUSEWHEELSLIDESTACK"),10),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom");break;case "zSaveHandlerPath":Z.saveHandlerPath=pValue;Z.fileHandlerPath=Z.saveHandlerPath;Z.legacySaveHandlerInUse=!0;break;case "zFileHandlerPath":Z.fileHandlerPath=pValue;Z.saveImageHandlerPath=pValue;break;case "zSaveImageHandlerPath":Z.saveImageHandlerPath=pValue;break;case "zSaveImageFull":"1"==pValue&&(Z.saveImageFull=!0);break;case "zSaveImageFilename":Z.Utils.stringValidate(pValue)&&
(Z.saveImageFilename=pValue);break;case "zSaveImageFormat":switch(pValue.toLowerCase()){case "png":Z.saveImageFormat="png";break;default:Z.saveImageFormat="jpg"}break;case "zSaveImageCompression":n=parseFloat(pValue);!isNaN(n)&&.1<=n&&1>=n&&(Z.saveImageCompression=n);break;case "zSaveImageBackColor":Z.saveImageBackColor=Z.Utils.stringValidateColorValue(pValue);break;case "zTrackingPath":Z.trackingPath=Z.Utils.stringRemoveTrailingSlash(pValue);"undefined"!==typeof Z.trackingPath&&Z.Utils.stringValidate(Z.trackingPath)?
(Z.trackingFolder=Z.trackingPath,".xml"==Z.trackingPath.toLowerCase().substring(Z.trackingPath.length-4,Z.trackingPath.length)&&(Z.trackingFolder=Z.trackingFolder.substring(0,Z.trackingFolder.lastIndexOf("/"))),Z.tracking=!0):alert(this.getResource("ERROR_TRACKINGPATHMISSING"));break;case "zTrackingEditMode":"1"==pValue&&(Z.trackingPathProvided?(Z.trackingEditMode="edit",Z.markupMode=!0,Z.editMode="markup",Z.editing="addLabel",Z.labelMode="counter",Z.editAdmin=!0):alert(this.getResource("ERROR_TRACKINGPATHMISSING-EDITING")));
break;case "zTrackingAuto":"1"==pValue&&(Z.trackingAuto=!0);break;case "zTrackingPanelVisible":Z.trackingPanelVisible=parseInt(pValue,10);break;case "zInitialTrackingOverlayVisible":"0"==pValue&&(Z.initialTrackingOverlayVisible=!1);break;case "zUserLogin":"1"==pValue?Z.userLogin="request":"skip"==pValue?(Z.userName=this.getResource("CONTENT_SKIPUSERNAME"),Z.userInitials=Z.Utils.stringGetInitials(Z.userName)):Z.Utils.stringValidate(pValue)&&(Z.userName=pValue,Z.userInitials=Z.Utils.stringGetInitials(Z.userName));
break;case "zUserNamePrompt":Z.Utils.stringValidate(pValue)&&(Z.userNamePrompt=pValue);break;case "zUserPath":Z.userPath=Z.Utils.stringRemoveTrailingSlash(pValue);"undefined"!==typeof Z.userPath&&Z.Utils.stringValidate(Z.userPath)?(Z.userFolder=Z.userPath,".xml"==Z.userPath.toLowerCase().substring(Z.userPath.length-4,Z.userPath.length)&&(Z.userFolder=Z.userFolder.substring(0,Z.userFolder.lastIndexOf("/"))),Z.userLogging=!0):alert(this.getResource("ERROR_USERPATHMISSING"));break;case "zUserPanelVisible":"0"!=
pValue&&(Z.userPathProvided?Z.userPanelVisible=parseInt(pValue,10):alert(this.getResource("ERROR_USERPATHMISSING")));break;default:if(Z.specialStorageEnabled==e)alert(g+" "+w);else switch(w){case "zServerIP":Z.serverIP=pValue;break;case "zServerPort":Z.serverPort=pValue;break;case "zTileHandlerPath":Z.tileHandlerPath=pValue;break;case "zRequestTiles":"1"==pValue&&(Z.requestTiles=!0);break;case "zIIIFScheme":Z.iiifScheme=pValue;break;case "zIIIFServer":Z.iiifServer=pValue;break;case "zIIIFPrefix":Z.iiifPrefix=
pValue;break;case "zIIIFIdentifier":Z.iiifIdentifier=pValue;break;case "zIIIFRegion":Z.iiifRegion=pValue;break;case "zIIIFSize":Z.iiifSize=pValue;break;case "zIIIFRotation":Z.iiifRotation=pValue;break;case "zIIIFQuality":Z.iiifQuality=pValue;break;case "zIIIFFormat":Z.iiifFormat=pValue;break;case "zImageW":Z.imageW=parseInt(pValue,10);Z.imageCtrX=Z.imageW/2;null!=Z.imageW&&0<Z.imageW&&null!=Z.imageH&&0<Z.imageH&&(Z.imageD=Math.round(Math.sqrt(Z.imageW*Z.imageW+Z.imageH*Z.imageH)));break;case "zImageH":Z.imageH=
parseInt(pValue,10);Z.imageCtrY=Z.imageH/2;null!=Z.imageW&&0<Z.imageW&&null!=Z.imageH&&0<Z.imageH&&(Z.imageD=Math.round(Math.sqrt(Z.imageW*Z.imageW+Z.imageH*Z.imageH)));break;case "zFocal":Z.focal=parseInt(pValue,10);break;case "zQuality":Z.quality=parseInt(pValue,10)}}else alert(k+" "+w)}else alert(b+" "+w)}else alert(f+" "+w)}Z.Utils.getBookmarksURL();if(Z.brightnessVisible||Z.contrastVisible||Z.sharpnessVisible||Z.blurrinessVisible||Z.colorRedVisible||Z.colorGreenVisible||Z.colorBlueVisible||Z.colorRedRangeVisible||
Z.colorGreenRangeVisible||Z.colorBlueRangeVisible||Z.gammaVisible||Z.gammaRedVisible||Z.gammaGreenVisible||Z.gammaBlueVisible||Z.hueVisible||Z.saturationVisible||Z.lightnessVisible||Z.whiteBalanceVisible||Z.normalizeVisible||Z.equalizeVisible||Z.noiseVisible||Z.grayscaleVisible||Z.thresholdVisible||Z.inversionVisible||Z.edgesVisible||Z.sepiaVisible)Z.imageFilters=!0,Z.imageFiltersVisible=!0,Z.fadeIn=!1;if(Z.Utils.stringValidate(Z.annotationPath)||Z.Utils.stringValidate(Z.fileHandlerPath)||Z.Utils.stringValidate(Z.saveImageHandlerPath))Z.enterpriseParamsEnabled?
(Z.Utils.stringValidate(Z.fileHandlerPath)&&(a=Z.saveImageHandlerPath,Z.fileHandlerPath=Z.fileHandlerPath,Z.saveImageHandlerPath=a),Z.Utils.stringValidate(Z.fileHandlerPath)&&(Z.fileHandlerPath=Z.fileHandlerPath)):(Z.annotationPath="",alert(k));Z.Utils.validateImagePath()},resetParametersXYZ:function(a){isNaN(parseFloat(this.getResource("z143")))||(Z.initialX=parseFloat(this.getResource("z143")));isNaN(parseFloat(this.getResource("z144")))||(Z.initialY=parseFloat(this.getResource("z144")));isNaN(parseFloat(this.getResource("z145")))||
(Z.initialZ=parseFloat(this.getResource("z145")));isNaN(parseFloat(this.getResource("z163")))||(Z.minZ=parseFloat(this.getResource("z163")));isNaN(parseFloat(this.getResource("z153")))||(Z.maxZ=parseFloat(this.getResource("z153")));if(this.stringValidate(a))for(var b=0,e=a.length;b<e;b++){var f=a[b],g=f.indexOf("=");if(0<g){var k=f.substring(0,g),f=f.substring(g+1);if(this.stringValidate(f))switch(k){case "zInitialX":isNaN(parseFloat(f))||(Z.initialX=parseFloat(f));break;case "zInitialY":isNaN(parseFloat(f))||
(Z.initialY=parseFloat(f));break;case "zInitialZoom":"fit"==f&&(f="-1");"fill"==f&&(f="0");isNaN(parseFloat(f))||(Z.initialZ=parseFloat(f),Z.initialZ&&1<Z.initialZ&&(Z.initialZ/=100));break;case "zMinZoom":"fit"==f&&(f="-1");"fill"==f&&(f="0");isNaN(parseFloat(f))||(Z.minZ=parseFloat(f),Z.minZ&&1<Z.minZ&&(Z.minZ/=100));break;case "zMaxZoom":isNaN(parseFloat(f))||(Z.maxZ=parseFloat(f),Z.maxZ&&1<Z.maxZ&&(Z.maxZ/=100))}}}},readCookie:function(a){a+="=";for(var b=document.cookie.split(";"),e=0,f=b.length;e<
f;e++){for(var g=b[e];" "==g.charAt(0);)g=g.substring(1,g.length);if(0==g.indexOf(a))return g.substring(a.length,g.length)}return null},validateImagePath:function(a){a="undefined"!==typeof a&&Z.Utils.stringValidate(a)?a:Z.imagePath;if(null!==a){var b=this.getResource("z213");if(-1==a.toLowerCase().indexOf(".zif")||Z.requestTiles)if(Z.usingDirectoryExtensions||-1==a.toLowerCase().indexOf(".jpg")&&-1==a.toLowerCase().indexOf(".png"))if(-1==a.toLowerCase().indexOf(".pff")||Z.requestTiles)if(Z.Utils.stringValidate(Z.iiifServer)){Z.tileSource=
"IIIFImageServer";a="undefined"!=typeof Z.iiifScheme&&Z.Utils.stringValidate(Z.iiifScheme)?Z.iiifScheme+"://":"https://";var b="undefined"!=typeof Z.iiifServer&&Z.Utils.stringValidate(Z.iiifServer)?Z.iiifServer+"/":null,e="undefined"!=typeof Z.iiifPrefix&&Z.Utils.stringValidate(Z.iiifPrefix)?Z.iiifPrefix+"/":null,f="undefined"!=typeof Z.iiifIdentifier&&Z.Utils.stringValidate(Z.iiifIdentifier)?Z.iiifIdentifier:null;Z.imagePath=a&&b&&f?a+b+e+f:Z.Utils.getResource("ERROR_SETTINGIIIFIMAGEPATH")}else"DZIFolder"==
Z.tileSource||-1!=a.toLowerCase().indexOf(".dzi")?(Z.tileSource="DZIFolder",b=a.toLowerCase(),e=a.lastIndexOf("/"),-1==e?(Z.dziImageSubfolder=a,Z.dziImagePropertiesFilename=Z.dziImageSubfolder+".dzi"):(a.substring(0,e).lastIndexOf("/"),f=b.substring(e+1,b.length).indexOf(".dzi"),-1!=f?Z.dziImagePropertiesFilename=a.substring(e+1,b.length):(Z.dziImagePropertiesFilename=b.substring(e+1,b.length),f=Z.dziImagePropertiesFilename.toLowerCase().indexOf(".xml")),Z.dziImageSubfolder=Z.dziImagePropertiesFilename.substring(0,
f)+"_files",Z.imagePath=a.substring(0,e))):Z.Utils.stringValidate(Z.tileHandlerPath)?Z.Utils.stringValidate(Z.tileHandlerPath)&&(Z.specialStorageEnabled?(Z.tileSource="ImageServer",a=Z.tileHandlerPath,Z.tileHandlerPathFull=a):alert(b)):Z.tileSource="ZoomifyImageFolder";else Z.imageFilename=a.substring(a.toLowerCase().lastIndexOf("/")+1),Z.specialStorageEnabled||Z.singleFileSupported?(Z.tileSource="ZoomifyPFFFile",Z.Utils.validateResponseArrayFunctionality(),Z.localUse&&Z.localFilesSupported&&null===
Z.localFile&&(Z.setCallback("imageFileSelected",Z.createViewer),Z.Utils.validateLocalViewing()),Z.specialStorageEnabled&&null!==Z.tileHandlerPath&&(a=Z.tileHandlerPath,Z.tileHandlerPathFull=a)):Z.singleFileSupported||null!==Z.tileHandlerPath?Z.specialStorageEnabled||alert(b):alert(this.getResource("ALERT_PFFREQUIRESNEWERBROWSER"));else Z.tileSource="unconverted";else Z.imageFilename=a.substring(a.toLowerCase().lastIndexOf("/")+1),Z.singleFileSupported?(Z.tileSource="ZoomifyZIFFile",Z.Utils.validateResponseArrayFunctionality(),
Z.localUse&&Z.localFilesSupported&&null===Z.localFile&&(Z.setCallback("imageFileSelected",Z.createViewer),Z.Utils.validateLocalViewing())):alert(this.getResource("z16"))}else if(Z.imageSet||Z.slideshow)Z.tileSourceMultiple=!0},validateLocalViewing:function(){var a=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay);Z.FileAccessDisplay=Z.Utils.createContainerElement("div","FileAccessDisplay","inline-block","relative","auto","308px","180px",(a.x-308)/2+"px",(a.y-180)/2+"px","solid","1px","lightGrey",
"0px","0px","normal",null,!0);Z.pageContainer.appendChild(Z.FileAccessDisplay);a=Z.Utils.getResource("ALERT_VALIDATELOCALZIFVIEWING-TITLE");a=Z.Utils.createTextElement("titleBox",a,"268px","28px","10px","15px","10px","none","0px",!0,"verdana","13px","none",null,1,"hidden","hidden",null);Z.FileAccessDisplay.appendChild(a);a.firstChild.style.textAlign="center";a.firstChild.style.fontWeight="bold";a=Z.Utils.getResource("ALERT_VALIDATELOCALZIFVIEWING-MESSAGE")+Z.imageFilename;a=Z.Utils.createTextElement("messageBox",
a,"268px","55px","10px","43px","10px","none","0px",!0,"verdana","13px","none",null,1,"hidden","hidden",null);Z.FileAccessDisplay.appendChild(a);a.firstChild.style.textAlign="center";var a=Z.Utils.createContainerElement("div","inputCont","inline-block","relative","auto","240px","30px","34px","138px","none","0px","lightGrey","0px","0px","normal",null,!0),b=document.createElement("input");b.setAttribute("type","file");a.appendChild(b);Z.FileAccessDisplay.appendChild(a);Z.Utils.addEventListener(b,"change",
Z.Utils.handleFileSelect)},handleFileSelect:function(a){Z.localFile=a.target.files[0];Z.useLocalFile=!0;Z.FileAccessDisplay.style.display="none";Z.Utils.validateCallback("imageFileSelected")},clearImageParameters:function(){Z.imagePath=null;Z.imagePath2=null;Z.imageMetadataXML=null;Z.parameters=null;Z.xmlParametersPath=null;Z.xmlParametersParsing=null;Z.initialX=null;Z.initialY=null;Z.initialZ=null;Z.minZ=null;Z.maxZ=null;Z.zoomAndPanInProgressID=null;Z.geoCoordinatesPath=null;Z.geoCoordinatesVisible=
null;Z.geoCoordinatesFolder=null;Z.tour=!1;Z.tourPath=null;Z.tourPlaying=null;Z.tourStop=!1;Z.hotspots=!1;Z.hotspotPath=null;Z.hotspotFolder=null;Z.narrative||(Z.annotations=!1,Z.annotationPath=null,Z.annotationPanelVisible=null,Z.clickURLEntryVisible=null,Z.annotationFolder=null,Z.annotationJSONObject=null,Z.annotationXMLText=null,Z.labelShapesInternal=null,Z.annotationsAddMultiple=null,Z.annotationsAutoSave=null,Z.annotationsAutoSaveImage=null);Z.initialR=null;Z.unitsPerImage=null;Z.pixelsPerUnit=
null;Z.sourceMagnification=null;Z.imageProperties=null;Z.annotationPathProvided=!1;Z.slidePathProvided=!1;Z.tileSource=null;Z.pffJPEGHeadersSeparate=!1;Z.focal=null;Z.quality=null;Z.sliderFocus="zoom";Z.animation=!1;Z.animationPath=null;Z.animationCount=0;Z.animationAxis=null;Z.animator=null;Z.animationFlip=null;Z.slidestack=!1;Z.slidestackPath=null;Z.imageSetHotspotPath=null;Z.hotspotFileShared=!1;Z.imageSetAnnotationPath=null;Z.annotationFileShared=!1;Z.imageW=null;Z.imageH=null;Z.imageD=null;Z.imageCtrX=
null;Z.imageCtrY=null;Z.imageX=0;Z.imageY=0;Z.imageZ=0;Z.imageR=0;Z.fitZ=null;Z.fillZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.rotating="stop";Z.postingXML=!1;Z.postingHTML=!1;Z.postingImage=!1;Z.postingFile=!1;Z.iiifInfoJSONObject=null;Z.iiifIdentifier=null;Z.iiifRegion=null;Z.iiifSize=null;Z.iiifRotation=null;Z.iiifQuality=null;Z.iiifFormat=null;maxTileB=maxTileR=maxTier=0},getResource:function(a){var b="";switch(a){case "z110":b="Enable Express parameters";break;case "z109":b=
"Changing This Violates License Agreement";break;case "z108":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Express, Pro, and Enterprise editions: ";break;case "z187":b="Enable Pro parameters";break;case "z186":b="Changing This Violates License Agreement";break;case "z185":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Pro and Enterprise editions: ";break;case "z215":b="Enable special storage support";
break;case "z214":b="Changing this violates License Agreement";break;case "z213":b="Support for Zoomify Image File (PFF) storage and other special storage options is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition.";break;case "z107":b="Enable Enterprise parameters";break;case "z106":b="Changing this violates License Agreement";break;case "z105":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition: ";
break;case "DEFAULT_PARAMETERLISTTEXT":b="zAnimationAxis,zAnimationFlip,zAnimationPath,zAnimator,zAnnotationJSONObject,zAnnotationPanelVisible,zAnnotationPath,zAnnotationSort,zAnnotationXMLAperioLoad,zAnnotationXMLAperioPost,zAnnotationXMLText,zAnnotationsAddMultiple,zAnnotationsAutoSave,zAutoResize,zBaseZIndex,zBlurrinessVisible,zBookmarksGet,zBookmarksSet,zBrightnessVisible,zCanvas,zCaptionBackColor,zCaptionBackVisible,zCaptionBoxes,zCaptionOffset,zCaptionPosition,zCaptionTextColor,zCaptionTextVisible,zClickPan,zClickURLEntryVisible,zClickZoom,zColorBlueRangeVisible,zColorBlueVisible,zColorGreenRangeVisible,zColorGreenVisible,zColorRedRangeVisible,zColorRedVisible,zComparisonPath,zConstrainPan,zContrastVisible,zCoordinatesVisible,zCopyrightPath,zCrosshairsVisible,zDebug,zDoubleClickDelay,zDoubleClickZoom,zEdgesVisible,zEditMode,zEqualizeVisible,zFadeInSpeed,zFieldOfViewVisible,zFileHandlerPath,zFocal,zFreehandVisible,zFullPageVisible,zFullScreenVisible,zFullViewVisible,zGalleryHeight,zGalleryLeft,zGalleryPosition,zGalleryTop,zGalleryVisible,zGalleryWidth,zGammaBlueVisible,zGammaGreenVisible,zGammaRedVisible,zGammaVisible,zGeoCoordinatesPath,zGrayscaleVisible,zHelpHeight,zHelpLeft,zHelpPath,zHelpTop,zHelpVisible,zHelpWidth,zHideOverlayBackfill,zDemoNoSave,zHotspotListTitle,zHotspotPath,zHotspotsDrawOnlyInView,zHueVisible,zIIIFFormat,zIIIFIdentifier,zIIIFPrefix,zIIIFQuality,zIIIFRegion,zIIIFRotation,zIIIFScheme,zIIIFServer,zIIIFSize,zImageFiltersVisible,zImageH,zImageListPath,zImageProperties,zImageSetSliderVisible,zImageW,zInitialFullPage,zInitialImageFilters,zInitialRotation,zInitialSync,zInitialTrackingOverlayVisible,zInitialX,zInitialY,zInitialZoom,zInteractive,zInversionVisible,zKeys,zLabelClickSelect,zLabelFillColor,zLabelFillVisible,zLabelHighlight,zLabelLineColor,zLabelLineVisible,zLabelShapesInternal,zLabelsClickDrag,zLightnessVisible,zLogoCustomPath,zLogoLinkURL,zLogoVisible,zMagnification,zMagnifierHeight,zMagnifierLeft,zMagnifierTop,zMagnifierVisible,zMagnifierWidth,zMarkupMode,zMaskBorder,zMaskClearOnUserAction,zMaskFadeSpeed,zMaskScale,zMaskVisible,zMaxZoom,zMeasureVisible,zMessagesVisible,zMinZoom,zMinimizeVisible,zMousePan,zMouseWheel,zNarrativeAnnotationFolderPath,zNarrativeImageFolderPath,zNarrativeMediaFolderPath,zNarrativeMode,zNarrativePath,zNavigatorFit,zNavigatorHeight,zNavigatorLeft,zNavigatorRectangleColor,zNavigatorTop,zNavigatorVisible,zNavigatorWidth,zNoPost,zNoPostDefaults,zNoiseVisible,zNormalizeVisible,zOnAnnotationReady,zOnReady,zOverlayJSONObject,zOverlayPath,zPanBuffer,zPanButtonsVisible,zPanSpeed,zPixelsPerUnit,zPolygonVisible,zPreloadVisible,zProgressVisible,zQuality,zRequestTiles,zResetVisible,zRotationVisible,zRulerHeight,zRulerLeft,zRulerListType,zRulerTop,zRulerVisible,zRulerWidth,zSaturationVisible,zSaveButtonVisible,zSaveHandlerPath,zSaveImageBackColor,zSaveImageCompression,zSaveImageFilename,zSaveImageFormat,zSaveImageFull,zSaveImageHandlerPath,zScreensaver,zScreensaverSpeed,zSepiaVisible,zServerIP,zServerPort,zShapeVisible,zSharpnessVisible,zSimplePath,zSkinPath,zSlideButtonsVisible,zSlideListTitle,zSlidePath,zSliderVisible,zSlidestackPath,zSmoothPan,zSmoothPanEasing,zSmoothPanGlide,zSmoothZoom,zSmoothZoomEasing,zSourceMagnification,zSyncVisible,zTextVisible,zThresholdVisible,zTileH,zTileHandlerPath,zTileSource,zTileW,zTilesPNG,zToolbarBackgroundVisible,zToolbarInternal,zToolbarPosition,zToolbarVisible,zTooltipsVisible,zTourListTitle,zTourPath,zTrackingAuto,zTrackingEditMode,zTrackingPanelVisible,zTrackingPath,zUnits,zUnitsPerImage,zUnsavedEditsTest,zUserLogin,zUserNamePrompt,zUserPanelVisible,zUserPath,zUsingDirectoryExtensions,zVirtualPointerPath,zVirtualPointerVisible,zWatermarkPath,zWhiteBalanceVisible,zXMLParametersPath,zZoomButtonsVisible,zZoomRectangle,zZoomSpeed";
break;case "z125":b="0";break;case "z124":b="8192";break;case "z123":b="1060";break;case "z90":b="ZoomifyZIFFile"==Z.tileSource?"1024":"256";break;case "z221":b="IIIFImageServer"!=Z.tileSource?"256":"512";break;case "z219":b="IIIFImageServer"!=Z.tileSource?"256":"512";break;case "z140":b="300";break;case "z139":b="60000";break;case "DEFAULT_IMAGELOADQUEUEDELAY":b="100";break;case "z218":b="1.15";break;case "z220":b="300";break;case "z81":b="6";break;case "z78":b="3";break;case "z80":b="5";break;case "z77":b=
"3";break;case "z79":b="3";break;case "z76":b="2";break;case "z75":b="0";break;case "z173":b=Z.mobileDevice?"1":"1.5";break;case "z173UNCONVERTED":b=Z.mobileDevice?Z.rotationVisible?"2":"1":"10";break;case "DEFAULT_z310SIZEMAXBROWSER":b="10000";break;case "DEFAULT_z310SIZEMAXFIREFOX":b="4000";break;case "DEFAULT_z310SIZEMAXMOBILE":b="3000";break;case "DEFAULT_z310SIZEMAXIMAGESET":b="1000";break;case "z74":reTxt=Z.mobileDevice?"1":"2";break;case "z88":b="1";break;case "DEFAULT_BASEZINDEX":b="2000";
break;case "DEFAULT_VALIDATEVIEWRETRYLIMIT":b="2";break;case "DEFAULT_VALIDATEVIEWRETRYDELAY":b="1000";break;case "z104":b="0";break;case "DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT":b="4";break;case "DEFAULT_MOUSECLICKTHRESHOLDTIMEVIEWPORT":b="500";break;case "DEFAULT_MOUSECLICKTHRESHOLDHOTSPOT":b="4";break;case "DEFAULT_TOUCHTAPTHRESHOLDVIEWPORT":b=Z.mobileDevice?"8":"6";break;case "DEFAULT_TOUCHTAPTHRESHOLDTIMEVIEWPORT":b="500";break;case "DEFAULT_MOUSECLICKTHRESHOLDNAVIGATOR":b="4";break;case "DEFAULT_TOUCHTAPTHRESHOLDNAVIGATOR":b=
Z.mobileDevice?"6":"3";break;case "z175":b="5";break;case "z176":b="10";break;case "z241":b="5";break;case "z242":b="0.02";break;case "z238":b="30";break;case "z240":b="20";break;case "z239":b="800";break;case "z93TIERSKIPTHRESHOLD":b="0.2";break;case "DEFAULT_ROTATIONSTEPDEGREES":b="1";break;case "DEFAULT_ROTATIONSTEPDURATION":b="1";break;case "z122":b="10";break;case "DEFAULT_PINCHTESTDURATION":b="10";break;case "DEFAULT_AUTORESIZESKIPDURATION":b="10";break;case "DEFAULT_MOUSEWHEEL":b="1";break;
case "DEFAULT_MOUSEWHEELANIMATION":b="1";break;case "DEFAULT_MOUSEWHEELSLIDESTACK":b="1";break;case "z165":b="300";break;case "z111":b="5";break;case "z112":b="0.067";break;case "z146":b="1";break;case "z164":b="1";break;case "z92":b="1";break;case "z93":b="1";break;case "DEFAULT_DOUBLECLICKZOOM":b="1";break;case "DEFAULT_DOUBLECLICKDELAY":b="250";break;case "z95":b="1";break;case "z95LIMIT":b="2";break;case "z95STRICT":b="0";break;case "DEFAULT_SMOOTHPAN":b="1";break;case "DEFAULT_SMOOTHPANEASING":b=
"2";break;case "DEFAULT_SMOOTHPANGLIDE":b="2";break;case "DEFAULT_SMOOTHZOOM":b="1";break;case "DEFAULT_SMOOTHZOOMEASING":b="2";break;case "z143":b=null;break;case "z144":b=null;break;case "z145":b=null;break;case "z163":b=null;break;case "z153":b="1";break;case "z83":b="#FBFAFA";break;case "z83NOALPHA":b="#FBFAFA";break;case "z83LIGHT":b="#FEFEFE";break;case "z82":b="0.75";break;case "z82MORE":b="0.9";break;case "DEFAULT_BACKGROUNDSMALLDALPHA":b="0.75";break;case "z87":b="#C0C0C0";break;case "z200":b=
"skinFiles.xml";break;case "z201":b="Assets/Skins/Default";break;case "z199":b="0";break;case "z171":b="2";break;case "z172":b="150";break;case "z167":b="100";break;case "z168":b="-1";break;case "z170":b="-1";break;case "z166":b=null;break;case "z169":b="#0000FF";break;case "DEFAULT_NAVIGATORBORDERCOLOR":b="#FFFFFF";break;case "DEFAULT_GALLERYVISIBLE":b=Z.slideshow?"2":"0";break;case "DEFAULT_GALLERYWIDTH":b="-1";break;case "DEFAULT_GALLERYHEIGHT":b="70";break;case "DEFAULT_GALLERYMARGIN":b="1";break;
case "DEFAULT_GALLERYLEFT":b="0";break;case "DEFAULT_GALLERYTOP":b="-1";break;case "DEFAULT_GALLERYPOSITION":b="1";break;case "DEFAULT_GALLERYBACKGROUNDALPHA":b="1";break;case "DEFAULT_GALLERYBACKGROUNDCOLOR":b="#696969";break;case "DEFAULT_GALLERYBACKGROUNDCOLORNOALPHA":b="#696969";break;case "DEFAULT_GALLERYRECTANGLECOLOR":b="#DDDDDD";break;case "z223":b="4";break;case "DEFAULT_TOOLBARBACKGROUNDVISIBLE":b="1";break;case "DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST":b="10";break;case "DEFAULT_TOOLBARHEIGHT":b=
"30";break;case "z222":b="1";break;case "z224":b="1";break;case "z128":b="1";break;case "z150":b="1";break;case "z149":b=null;break;case "z162":b="1";break;case "DEFAULT_SLIDERZOOMVISIBLE":b="1";break;case "z205ZOOM":b="10";break;case "DEFAULT_ZOOMBUTTONSVISIBLE":b="1";break;case "z174":b="1";break;case "DEFAULT_RESETVISIBLE":b="1";break;case "z121":b="1";break;case "z119":b="1";break;case "z120":b="white";break;case "z118":b="0";break;case "z141":b="0";break;case "DEFAULT_BOOKMARKSGET":b="0";break;
case "DEFAULT_BOOKMARKSSET":b="0";break;case "z232":b="Assets/VirtualPointer/virtualPointer.png";break;case "DEFAULT_ZOOMRECTANGLE":a=Z.comparison||null!==Z.imagePath&&-1!=Z.imagePath.indexOf("zComparisonPath")||"undefined"!==typeof Z.parameters&&null!==Z.parameters&&"undefined"!==typeof Z.parameters.zComparisonPath&&("undefined"===typeof Z.parameters.zZoomRectangle||0!=Z.parameters.zZoomRectangle);b=Z.mobileDevice||a||!Z.proParamsEnabled&&!Z.enterpriseParamsEnabled?"0":"1";break;case "z157":b="undefined"===
typeof Z.parameters||null===Z.parameters||"undefined"!==typeof Z.parameters.zMeasureVisible&&"0"==Z.parameters.zMeasureVisible||("undefined"===typeof Z.parameters.zMarkupMode||"1"!=Z.parameters.zMarkupMode&&"2"!=Z.parameters.zMarkupMode)&&("undefined"===typeof Z.parameters.zEditMode||"1"!=Z.parameters.zEditMode&&"2"!=Z.parameters.zEditMode)?"0":"1";break;case "DEFAULT_FULLVIEWEXITEXTERNALBUTTONCOLOR":b="\t#F8F8F8";break;case "z190":b="0";break;case "DEFAULT_ROTATIONFREE":b="0";break;case "DEFAULT_INITIALR":b=
"0";break;case "z184":b="1";break;case "z182":b="500";break;case "z183":b=" ";break;case "z183COLOR":b="#000000";break;case "DEFAULT_MESSAGESVISIBLE":b="1";break;case "z102":b="#D3D3D3";break;case "z101":b="#FFFFFF";break;case "z234":b="0.6";break;case "z235":b="0.33";break;case "z237":b="512";break;case "z236":b="384";break;case "z233":b="0";break;case "DEFAULT_MAGNIFIERVISIBLE":b="0";break;case "DEFAULT_MAGNIFIERMARGIN":b="10";break;case "DEFAULT_MAGNIFIERSCREENCOLOR":b="#D3D3D3";break;case "DEFAULT_MAGNIFIERINITIALVISIBILITY":b=
!0;break;case "DEFAULT_MAGNIFIERWIDTH":b="150";break;case "DEFAULT_MAGNIFIERHEIGHT":b="100";break;case "DEFAULT_MAGNIFIERBUTTONDIMENSION":b="15";break;case "DEFAULT_MAGNIFIERLEFT":b="-1";break;case "DEFAULT_MAGNIFIERTOP":b="-1";break;case "z103":b="0";break;case "z196":b="0";break;case "z193":b="2";break;case "z194":b="10";break;case "z198":b="#696969";break;case "z197":b="150";break;case "z191":b="30";break;case "z192":b="-1";break;case "z195":b="-1";break;case "z212":b="40";break;case "z231":b=
"pixels";break;case "DEFAULT_RULERSCREENCOLOR":b="#444444";break;case "DEFAULT_RULERLABELCOLOR":b="#cccccc";break;case "DEFAULT_RULERSETTINGSLABELFONTSIZE":b="11";break;case "DEFAULT_RULERSETTINGSTEXTFONTSIZE":b="11";break;case "DEFAULT_RULERSETTINGSTEXTPADDINGSMALL":b="3";break;case "DEFAULT_RULERSETTINGSHEIGHT":b="131";break;case "z156":b="170";break;case "z155":b="12";break;case "DEFAULT_CAPTIONBACKALPHA":b="0.5";break;case "z154":b="11";break;case "z100":b="0";break;case "DEFAULT_GEOCOORDINATESVISIBLE":b=
"0";break;case "DEFAULT_PRELOADVISIBLE":b="0";break;case "DEFAULT_SCREENSAVERSPEED":b="5";break;case "DEFAULT_MASKSCALE":b="1";break;case "DEFAULT_MASKFADESPEED":b="5";break;case "DEFAULT_MASKFADESTEP":b="0.05";break;case "DEFAULT_MASKCLEARONUSERACTION":b="1";break;case "DEFAULT_IMAGELISTXMLFILE":b="imageList.xml";break;case "DEFAULT_IMAGELISTPOSITION":b="2";break;case "DEFAULT_IMAGELISTSOURCE":b="NAME";break;case "DEFAULT_IMAGELISTWIDTH":b="200";break;case "z227":b="destinations.xml";break;case "z226":b=
!0;break;case "z225":b=!0;break;case "DEFAULT_COMPARISONXMLFILE":b="comparison.xml";break;case "DEFAULT_COMPARISONSYNCVISIBLE":b="1";break;case "DEFAULT_COMPARISONINITIALSYNC":b="1";break;case "DEFAULT_COMPARISONSYNC":b="1";break;case "DEFAULT_TOOLBARLABELFONTSIZE":b="11";break;case "z209":b="slides.xml";break;case "DEFAULT_SLIDESHOWAUTOSTART":b=!0;break;case "DEFAULT_SLIDESHOWAUTOLOOP":b=!0;break;case "z203":b="NAME";break;case "z204":b="200";break;case "z202":b="2";break;case "z210":b="2";break;
case "z211":b="0.05";break;case "DEFAULT_SLIDEBUTTONSVISIBLE":b="1";break;case "z135":b="hotspots.xml";break;case "z130":b="6";break;case "z130CANVAS":b="12";break;case "z161":b="2";break;case "z152":b="7";break;case "z129":b="14";break;case "z160":b="3";break;case "z151":b="14";break;case "z115":b="1.8";break;case "z134":b=!0;break;case "DEFAULT_HOTSPOTSMINSCALE":b="0.2";break;case "DEFAULT_HOTSPOTSMAXSCALE":b="2";break;case "z132":b="NAME";break;case "z133":b="200";break;case "z131":b="2";break;
case "DEFAULT_IMAGEFILTERS":b="0";break;case "z142":b="1";break;case "DEFAULT_BRIGHTNESSVISIBLE":b="0";break;case "DEFAULT_CONTRASTVISIBLE":b="0";break;case "DEFAULT_SHARPNESSVISIBLE":b="0";break;case "DEFAULT_BLURRINESSVISIBLE":b="0";break;case "DEFAULT_COLORREDVISIBLE":b="0";break;case "DEFAULT_COLORGREENVISIBLE":b="0";break;case "DEFAULT_COLORBLUEVISIBLE":b="0";break;case "DEFAULT_COLORREDRANGEVISIBLE":b="0";break;case "DEFAULT_COLORGREENRANGEVISIBLE":b="0";break;case "DEFAULT_COLORBLUERANGEVISIBLE":b=
"0";break;case "DEFAULT_GAMMAVISIBLE":b="0";break;case "DEFAULT_GAMMAREDVISIBLE":b="0";break;case "DEFAULT_GAMMAGREENVISIBLE":b="0";break;case "DEFAULT_GAMMABLUEVISIBLE":b="0";break;case "DEFAULT_HUEVISIBLE":b="0";break;case "DEFAULT_SATURATIONVISIBLE":b="0";break;case "DEFAULT_LIGHTNESSVISIBLE":b="0";break;case "DEFAULT_WHITEBALANCEVISIBLE":b="0";break;case "DEFAULT_NORMALIZEVISIBLE":b="0";break;case "DEFAULT_EQUALIZEVISIBLE":b="0";break;case "DEFAULT_NOISEVISIBLE":b="0";break;case "DEFAULT_GRAYSCALEVISIBLE":b=
"0";break;case "DEFAULT_THRESHOLDVISIBLE":b="0";break;case "DEFAULT_INVERSIONVISIBLE":b="0";break;case "DEFAULT_EDGESVISIBLE":b="0";break;case "DEFAULT_SEPIAVISIBLE":b="0";break;case "z205FILTER":b="10";break;case "z137":b="150";break;case "DEFAULT_IMAGEFILTERPANELLABELFONTSIZE":b="11";break;case "DEFAULT_IMAGEFILTERPANELTEXTFONTSIZE":b="11";break;case "DEFAULT_IMAGEFILTERTEXTPADDINGSMALL":b="2";break;case "DEFAULT_IMAGEFILTERSLIDERWIDTHMULTIPLIER":b="2";break;case "DEFAULT_FIELDOFVIEWVISIBLE":b=
"1";break;case "z217":b="1";break;case "DEFAULT_SHAPEVISIBLE":b="1";break;case "z116":b="1";break;case "z181":b="1";break;case "DEFAULT_ANNOTATIONPANELVISIBLE":b="2";break;case "DEFAULT_LABELSHAPESINTERNAL":b="1";break;case "DEFAULT_ANNOTATIONSADDMULTIPLE":b="1";break;case "DEFAULT_ANNOTATIONSAUTOSAVE":b="1";break;case "DEFAULT_ANNOTATIONSAUTOSAVEIMAGE":b="0";break;case "DEFAULT_ANNOTATIONSAVEBUTTONVISIBLE":b="1";break;case "DEFAULT_LABELCLICKSELECT":b="1";break;case "DEFAULT_LABELHIGHLIGHT":b="1";
break;case "DEFAULT_LABELHIGHLIGHTBORDERWIDTH":b="3px";break;case "DEFAULT_LABELHIGHLIGHTCOLOR":b="#FFFF99";break;case "DEFAULT_LABELFOVBORDERCOLOR":b="#FFFFFF";break;case "z69":b="annotations.xml";break;case "z68":b="annotations.json";break;case "z57":b=Z.labelShapesInternal?"circle":"circle.png";break;case "z57TYPE":b="shape";break;case "z69HANDLERNAME1":b="save";break;case "z69HANDLERNAME2":b="upload";break;case "z67":b=!0;break;case "z65":b="220";break;case "z61":b="264";break;case "z62":b="11";
break;case "z63":b="11";break;case "z64":b="11";break;case "z72SMALL":b="2";break;case "z72":b="3";break;case "z53":b="50";break;case "z51":b="122";break;case "z55":b="160";break;case "z54":b="88";break;case "z56":b="10";break;case "DEFAULT_ANNOTATIONCOMMENTHEIGHT":b="82";break;case "z59":b="82";break;case "z66":b="edit"==Z.editMode?"1":"0";break;case "z52":b="1";break;case "z60":b="edit"==Z.editMode?"1":"0";break;case "DEFAULT_ANNOTATIONCOMMENTVISIBILITY":b="1";break;case "z147":b="0.02";break;case "z148":b=
"30";break;case "DEFAULT_SHAPEWIDTH":b=100;break;case "DEFAULT_SHAPEHEIGHT":b=100;break;case "DEFAULT_SHAPELINEWIDTH":b=3;break;case "z177":b=2;break;case "DEFAULT_POLYGONALPHA":b=.3;break;case "z180":b=300;break;case "DEFAULT_LABELSTROKECOLOR":b="#FFFFFF";break;case "DEFAULT_LABELFILLCOLOR":b="#FFFFFF";break;case "z96":b="1";break;case "z98":b="#FFFFFF";break;case "z89":b="#000000";break;case "DEFAULT_CAPTIONBACKCOLOR":b="#FFFFFF";break;case "z177FREEHAND":b=2;break;case "z113":b="#FFFFFF";break;
case "z216":b="#999999";break;case "z97":b="10";break;case "DEFAULT_NARRATIVEPANELLISTFONTSIZE":b="12";break;case "DEFAULT_NARRATIVEPANELLABELFONTSIZE":b="12";break;case "DEFAULT_NARRATIVEPANELTEXTFONTSIZE":b="11";break;case "DEFAULT_NARRATIVEPANELTEXTPADDINGSMALL":b="3";break;case "DEFAULT_NARRATIVEEDITFONTSIZE":b="12";break;case "DEFAULT_NARRATIVEHIGHLIGHTSTART":b='<span style="color:#ffffff; background:#3399ff;">';break;case "DEFAULT_NARRATIVEHIGHLIGHTEND":b="</span>";break;case "DEFAULT_NARRATIVEHELPPATHEDIT":b=
"Assets/Help/Narratives/HelpEdit.htm";break;case "DEFAULT_NARRATIVEHELPPATHVIEW":b="Assets/Help/Narratives/HelpView.htm";break;case "DEFAULT_NARRATIVEFOLDERPATH":b="Assets/Narratives/";break;case "DEFAULT_NARRATIVEIMAGEFOLDERPATH":b="Images/";break;case "DEFAULT_NARRATIVEMEDIAFOLDERPATH":b="Assets/Media/";break;case "DEFAULT_NARRATIVEANNOTATIONFOLDERPATH":b="Assets/Annotations/Narratives/";break;case "DEFAULT_NARRATIVEFILETYPESUPLOAD":b=".htm, .html";break;case "DEFAULT_NARRATIVEFILETYPESLIST":b=
"htm@html";break;case "DEFAULT_NARRATIVEIMAGEFILETYPESUPLOAD":b=".zif, .pff";break;case "DEFAULT_NARRATIVEIMAGEFILETYPESLIST":b="zif@pff";break;case "DEFAULT_NARRATIVEMEDIAFILETYPESUPLOAD":b=".jpg, .jpeg, .png, .gif, .mp4, .mov, .ogg, .avi, .flv, .mp3";break;case "DEFAULT_NARRATIVEMEDIAFILETYPESLIST":b="jpg@jpeg@png@gif@mp4@mov@ogg@avi@flv@mp3";break;case "DEFAULT_NARRATIVEANNOTATIONFILETYPESUPLOAD":b=".xml, .json";break;case "DEFAULT_NARRATIVEANNOTATIONFILETYPESLIST":b="xml@json";break;case "DEFAULT_FILEMANAGERPANELLABELFONTSIZE":b=
"12";break;case "DEFAULT_FILEMANAGERPANELTEXTFONTSIZE":b="11";break;case "DEFAULT_FILEMANAGERPANELTEXTPADDINGSMALL":b="3";break;case "DEFAULT_TRACKINGPANELVISIBLE":b="2";break;case "DEFAULT_INITIALTRACKINGOVERLAYVISIBLE":b="1";break;case "DEFAULT_TRACKINGPANELWIDTH":b="350";break;case "DEFAULT_TRACKINGPANELHEIGHT":b="163";break;case "DEFAULT_TRACKINGPANELLABELFONTSIZE":b="12";break;case "DEFAULT_TRACKINGPANELLISTFONTSIZE":b="12";break;case "DEFAULT_TRACKINGPANELTEXTFONTSIZE":b="11";break;case "DEFAULT_TRACKINGTEXTPADDINGSMALL":b=
"2";break;case "DEFAULT_TRACKINGTEXTPADDING":b="3";break;case "DEFAULT_TRACKINGLABELWIDTH":b="50";break;case "DEFAULT_TRACKINGLABELTEXTWIDTH":b="122";break;case "DEFAULT_TRACKINGLISTWIDTH":b="160";break;case "DEFAULT_TRACKINGLISTNARROWWIDTH":b="88";break;case "DEFAULT_TRACKINGMARGIN":b="10";break;case "DEFAULT_TRACKINGALPHA":b="0.75";break;case "DEFAULT_USERPANELVISIBLE":b="0";break;case "DEFAULT_USERPANELWIDTH":b="200";break;case "DEFAULT_USERPANELHEIGHT":b="85";break;case "DEFAULT_USERPANELLABELFONTSIZE":b=
"12";break;case "DEFAULT_USERPANELLISTFONTSIZE":b="12";break;case "DEFAULT_USERLABELWIDTH":b="50";break;case "DEFAULT_IMAGESETLISTSOURCE":b="NAME";break;case "DEFAULT_IMAGESETLISTWIDTH":b="222";break;case "DEFAULT_IMAGESETLISTPOSITION":b="2";break;case "DEFAULT_IMAGESETSLIDERVISIBLE":b="1";break;case "z205IMAGESET":b="10";break;case "DEFAULT_OVERLAYSVISIBLE":b="1";break;case "DEFAULT_ANIMATIONOPTIMALMOTIONIMAGES":b="30";break;case "DEFAULT_ANIMATIONOPTIMALPOSITIONDELTA":b="50";break;case "DEFAULT_ANIMATIONAXIS":b=
"horizontal";break;case "DEFAULT_ANIMATOR":b="motion";break;case "DEFAULT_ANIMATIONFLIP":b="0";break;case "DEFAULT_SAVEIMAGEFULL":b="0";break;case "DEFAULT_SAVEIMAGEFILENAME":b="zoomifySavedImage";break;case "DEFAULT_SAVEIMAGEFORMAT":b="jpg";break;case "DEFAULT_SAVEIMAGECOMPRESSION":b="0.8";break;case "DEFAULT_SAVEIMAGEBACKCOLOR":b="#FFFFFF";break;case "DEFAULT_SAVEIMAGELABELMARGIN":b="50";break;case "DEFAULT_TRACKINGXMLFILE":b="tracking.xml";break;case "DEFAULT_TRACKINGPANELPOSITION":b="2";break;
case "DEFAULT_USERXMLFILE":b="users.xml";break;case "z159":b="lightgray";break;case "z158":b="white";break;case "DEFAULT_MESSAGEDURATIONLONG":b="5000";break;case "DEFAULT_MESSAGEDURATIONSTANDARD":b="3000";break;case "DEFAULT_MESSAGEDURATIONSHORT":b="1500";break;case "DEFAULT_MESSAGEDURATIONVERYSHORT":b="750";break;case "z99":b="lightgray";break;case "DEFAULT_TRACEDISPLAYTEXTFONTSIZE":b="11";break;case "DEFAULT_TRACEDISPLAYTEXTPADDINGSMALL":b="2";break;case "z229":b="#D3D3D3";break;case "z228":b="#FFFFFF";
break;case "z114":b="1";break;case "z188":b="55";break;case "DEFAULT_IMAGESETXMLFILE":b=Z.animation?"animation.xml":Z.overlay?"overlays.xml":"slidestack.xml";break;case "ALERT_POLYGONDATAINVALID":b="Polygon data invalid.";break;case "z9":b="Displaying or editing polygon hotspots requires a browser that supports the HTML5 canvas feature.";break;case "z12":b="Rotation requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case "ALERT_VALIDATELOCALZIFVIEWING-TITLE":b=
"Local Viewing Security";break;case "ALERT_VALIDATELOCALZIFVIEWING-MESSAGE":b="Use button below to verify file to view:\n\n";break;case "z16":b="Viewing Zoomify Images stored in the ZIF format requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case "ALERT_PFFREQUIRESNEWERBROWSER":b="Viewing Zoomify Images stored in the PFF format requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case "z8":b=
"\nClick the '?' button for help.";break;case "ALERT_LOADINGANNOTATIONS":b="\nLoading annotations...";break;case "z4SHORT":b="Click a button to\npick a label type";break;case "z4":b="Click a button to pick a label type.\nTips will show only on first use of each button.";break;case "ALERT_HOWTOEDITMODEVIEW":b="Click image to zoom-in.\nAlt-click to zoom-out.\nClick-drag to pan.";break;case "ALERT_HOWTOEDITMODEFIELDOFVIEW":b="Click to pick center of desired view.\nGraphics will only show when editing.";
break;case "ALERT_HOWTOEDITMODETEXT":b="\nClick in image to create caption. Edit text in panel.";break;case "ALERT_HOWTOEDITMODESHAPE":b="Select shape type from list.\nClick image to create shape.\nClick-drag shape to desired position.";break;case "ALERT_HOWTOEDITMODEFREEHAND":b="\nClick-drag in image to draw.";break;case "ALERT_HOWTOEDITMODERECTANGLE":b="\nClick-drag in image to create rectangle.";break;case "ALERT_HOWTOEDITMODEPOLYGON":b="Click in image to start polygon and add control points.\nRe-click first point to close the polygon.\nOr alt-click in image to leave polygon open.";
break;case "ALERT_HOWTOEDITMODEMEASURE":b="Click in image to measure length.\nAdditional clicks measure perimeter.\nRe-click starting point to measure area.";break;case "z3":b="Click links are disabled in edit mode\nto allow hotspot positioning by click-dragging:\n";break;case "ALERT_CLICKDRAGEXITTOVIEWMODE":a="measure"==Z.labelMode?"measure":"edit";b="Exiting "+a+" mode to allow mouse panning.\nTo navigate in "+a+" mode use arrow keys.";break;case "ALERT_NONEDITABLEPOI":b="\nThis POI is not editable.";
break;case "ALERT_NONEDITABLELABEL":b="\nThis label is not editable.";break;case "ALERT_NONEDITABLELABELPOI":b="\nThis label is not editable because its POI is not editable.";break;case "ALERT_NONEDITABLENOTE":b="\nThis note is not editable.";break;case "ALERT_NONEDITABLENOTEPOI":b="\nThis note is not editable because its POI is not editable.";break;case "ALERT_FOVLABELEXISTS":b="\nFOV label for current view exists.";break;case "ALERT_UNSAVEDEDITSEXIST-BROWSER":b="\nYou have unsaved edits. Stay on page to save edits?";
break;case "ALERT_UNSAVEDEDITSEXIST-CUSTOM":b="\nYou have unsaved edits.\nClick Cancel to stay on page to save edits.\nClick OK to DISCARD edits and proceed.";break;case "ALERT_CREATINGIMAGE":b="Please create zoomable images with the Zoomify Converter, then Upload.";break;case "ALERT_CREATINGMEDIA":b="\nPlease create media files with your tool of choice, then Upload.";break;case "z2":b="\nCancelling all unsaved edits.";break;case "z15":b="\nSaving unsaved edits.";break;case "z1":b="\nXML save complete.";
break;case "ALERT_MAGNIFIERREQUIRESCANVAS":b="The Magnifier requires a browser that supports the HTML5 canvas feature.";break;case "ALERT_FILEUPLOADING":b="\nUploading file...";break;case "ALERT_FILEUPLOADINPROGRESS":b="\nFile upload in progress: ";break;case "ALERT_FILEUPLOADSUCCESSFUL":b="\nFile upload complete";break;case "ALERT_NARRATIVETOGGLEEDITVIEWMODES":b="\nToggling between Edit and View modes...";break;case "ALERT_NARRATIVESAVESUCCESSFUL":b="\nNarrative save complete.";break;case "ALERT_FILEMANAGERRENAMESUCCESSFUL":b=
"\nFile rename complete.";break;case "ALERT_FILEMANAGERDOWNLOADNOCLICKTITLE":b="Right-click then &quot;Save Link/Target As...&quot; on Windows&#013;or Alt-click then &quot;Download Link As...&quot; on Macintosh";break;case "ALERT_FILEMANAGERDOWNLOADNOCLICKMESSAGE":b='Right-click then "Save Link/Target As..." on Windows\nor Alt-click then "Download Link As..." on Macintosh';break;case "ALERT_FILEMANAGERDELETEFILE":b="\nDelete seleted file?";break;case "ALERT_FILEMANAGERDELETINGNARRATIVE":b="\nDeleting selected narrative.";
break;case "ALERT_FILEMANAGERDELETINGIMAGE":b="\nDeleting selected image.";break;case "ALERT_FILEMANAGERDELETINGMEDIA":b="\nDeleting selected media file.";break;case "ALERT_FILEMANAGERDELETINGLABELSET":b="\nDeleting selected label set file.";break;case "ALERT_FILEMANAGERDELETIONSUCCESSFUL":b="File deletion complete.";break;case "ALERT_IMAGESAVEPREPARING":b="\nPreparing to save full image...";break;case "ALERT_VIEWSAVEPREPARING":b="\nPreparing to save view...";break;case "ALERT_IMAGESAVELOADINGDATA":b=
"\nDownloading image data...";break;case "ALERT_IMAGESAVERECEIVINGTILE":b="\nReceiving image tile: ";break;case "ALERT_IMAGESAVEDRAWINGTILE":b="\nDrawing image tile: ";break;case "ALERT_IMAGESAVEDRAWINGANNOTATION":b="\nDrawing annotation: ";break;case "ALERT_IMAGESAVEUPLOADING":b="\nUploading...";break;case "ALERT_IMAGESAVEINPROGRESS":b="\nUploading image data to save as file: ";break;case "ALERT_VIEWSAVEINPROGRESS":b="\nUploading view data to save as file: ";break;case "ALERT_IMAGESAVESUCCESSFUL":b=
"\nImage save complete";break;case "ALERT_IMAGESAVEHTMLCAPTIONUNSUPPORTED":b="\nSaving HTML captions to image is not currently supported";break;case "z13":b="SAVEDISABLEDFORDEMO";break;case "z14":b="\nDemo edits are saved only during the browser session.";break;case "ALERT_PRELOADINGIMAGE-DATA":b="\nPreloading image content...";break;case "ALERT_PRELOADINGONEIMAGE-LOADINGTILES":b="\nPreloading current view for all zoom levels...";break;case "ALERT_PRELOADINGIMAGESET-LOADINGTILES":b=Z.animation?"\nPreloading current view for all images:":
"\nPreloading current view for all slides:";break;case "ALERT_PRELOADINGIMAGESET-UPDATINGVIEW":b=Z.animation?"\nUpdating current view for all images:":"\nUpdating current view for all slides:";break;case "ALERT_PRELOADING-STORINGORDRAWINGTILES":b=Z.imageSet?Z.animation?"\nDrawing animation:   Image ":"\nDrawing slidestack:   Slide ":"\nStoring preloaded image:";break;case "ALERT_LOADINTRACKINGDATA":b="\nLoading tracking data...";break;case "z11":b="\nProcessing image filter...";break;case "z10":b=
"\nProcessing backfill image filter...";break;case "z11-CONVOLUTION-ONMOUSEUP":b=" filter will begin on slider release...";break;case "z11-CONVOLUTION":b="\nProcessing image convolution filter...";break;case "z10-CONVOLUTION":b="\nProcessing backfill image convolution filter...";break;case "ALERT_LOADINGIMAGESET":b=Z.comparison?"\nLoading comparison images...":Z.overlays?"\nLoading overlays...":Z.animation?"\nLoading animation images...":"\nLoading slides...";break;case "ALERT_LOADINGUSERLIST":b=
"\nLoading username list to validate entry...";break;case "ALERT_USERNAMEACCEPTED":b="\nUsername accepted!";break;case "ERROR_ERROR":b="error";break;case "z287":b="Parameter unrecognized or deprecated - see the Parameters List documentation: ";break;case "z275":b="Parameter deprecated - please replace: ";break;case "ERROR_UNSUPPORTEDLOCALNARRATIVELOADING":b='<br><br><strong>Local viewing attempt detected:</strong><br><br>The Zoomify Narratives Solution is designed for web use rather than use on a local machine.<br><br>The Solution includes choice lists for narratives, annotations, images, and other media, however, browsers permit only limited access to the local file system, as a security precaution.<br><br>To see the Narratives Solution in action please upload your files to your web server or hosting service.<br><br>Or, for evaluation purposes, view a demo <a href="http://www.zoomify.com/assets/dynamic/120-Narratives-Editing.htm">here</a>.';
break;case "ERROR_UNSUPPORTEDLOCALNARRATIVELOADINGEDITMODE":b="<br><br><strong>Local viewing attempt detected!</strong><br><br>The Zoomify Narratives Solution is designed for web use rather than use on a local machine.<br><br>The Solution includes choice lists for narratives, annotations, images, and other media, however, browsers permit only limited access to the local file system, as a security precaution.<br><br>To see the Narratives Solution in action please upload your files to your web server or hosting service.<br><br>Or, for evaluation purposes, view a demo here:<br><br>www.zoomify.com/narratives.htm";
break;case "ERROR_UNSUPPORTEDLOCALSAVING":b="Standard browser security prevents local saving of edits.\nFor details see Developer Resources/Testing Tools/Local Host.";break;case "z288":b="Use Firefox for local viewing or see READ ME FIRST\nfile for optional settings for other browsers.";break;case "z290":b="Browsers allow ZIF file viewing only from a web server.\nPlease use Zoomify Image folders for local viewing.";break;case "z289":b="Browsers allow PFF file viewing only from a web server.\nPlease use Zoomify Image folders for local viewing.";
break;case "z249":b="Image failed to load: possible invalid path, missing image, or network error.";break;case "z280":b="Sorry!  Part of this view is not refreshing.  The network may be slow, or the website may be missing a file:  ";break;case "ERROR_SETTINGIIIFIMAGEPATH":b="Error setting IIIF image path";break;case "ERROR_VALIDATEVIEW":b="Sorry!  Part of this view is not refreshing. The network\nmay be slow, or the website may be missing a file.  ";break;case "z280-ZIF":b="Sorry!  Part of this view is not refreshing.  The network may be slow, or the ZIF file may be faulty:  ";
break;case "ERROR_ANNOTATIONPATHMISSING":b="Attempt to start edit mode or save data without providing path to annotations XML data file.";break;case "ERROR_TRACKINGPATHMISSING-EDITING":b="Attempt to start edit mode or save data without providing path to tracking XML data file.";break;case "ERROR_NARRATIVEPATHMISSING":b="\nAttempt to start narrative mode or save data without providing path to narrative XML data file.";break;case "ERROR_NARRATIVENOTEXTSELECTIONFORSTYLE":b="\nPlease select text in Narrative before setting style.";
break;case "ERROR_NARRATIVENOTEXTSELECTIONFORLINK":b="\nPlease select text in Narrative before setting link.";break;case "ERROR_NARRATIVENOVALIDLINK":b="\nPlease enter a URL before setting link.";break;case "ERROR_FILEMANAGERNOFILESELECTION":b="Please select a file in filenames list before\nattempting to download or delete.";break;case "ERROR_FILEMANAGERRENAMEFILENAMEEXISTS":b="\nSorry, a file with that name already exists.";break;case "ERROR_NARRATIVEFILEHANDLER":b="Error saving narrative: please make sure file handler path in web page matches save handler file location on webserver.";
break;case "ERROR_CHARACTERNOTPERMITTEDINFILENAME":b='A filename cannot contain any of the following characters:\n / : * ? " < > |';break;case "ERROR_CHARACTERNOTPERMITTEDINLINK":b="Please limit link characters to:\na-z A-Z 0-9 and ._-/()";break;case "ERROR_RULERSETTINGSFILEHANDLER":b="Error saving ruler settings: please make sure file handler path in web page matches save handler file location on webserver.";break;case "ERROR_HOTSPOTPOPUPPATHINVALID":b="Hotspot popup graphic failed to load: possible invalid path or missing file.";
break;case "ERROR_HOTSPOTMEDIAPATHINVALID":b="Hotspot media failed to load: possible invalid path, missing file, or legacy hotspot media such as library clip of Flash-based viewer.";break;case "z246":b="Media of one or more hotspots unsupported: hotspot media of type 'symbol' depend on internal Library of Flash-based viewers.";break;case "ERROR_XMLFILEHANDLERPATHMISSING":b="Attempt to initiate Edit mode without providing path to File Handler - server side script or other resource to post XML data.";
break;case "ERROR_XMLFILEHANDLERPATHINVALID":b="Annotations cannot be saved: missing or incorrect file\nhandler path parameter, or missing file on server.";break;case "z256-ZIFBYTERANGE":b="Error loading image: ZIF file data request failed. Request content type: ";break;case "z256-ZIFBYTES":b="Error loading image: ZIF file invalid.";break;case "z256-PFFBYTES":b="Error loading image: PFF file invalid.";break;case "z295":b="Browser does not support XMLHttpRequest.";break;case "z256-IMAGEXML":b="Error loading image: please make sure image path in web page matches image folder location on webserver.";
break;case "z256-IMAGEXML-DZI":b="Error loading DZI properties: please make sure image path in web page matches image folder location on webserver.";break;case "z256-PFFIMAGEHEADER":b="Error loading image: image header request invalid.";break;case "z256-PFFIMAGEOFFSET":b="Error loading image: image offset request invalid.";break;case "z256-PARAMETERSXML":b="Error loading parameters XML: please make sure the zXMLParametersPath value is correct.";break;case "z256-IMAGELISTXML":b="Error loading image list images: please make sure image list path in web page matches image list folder location on webserver.";
break;case "z256-TOOLBARSKINSXML":b="Error loading toolbar - skin files not found: please verify that the folders 'Assets/Skins/Default' are in same folder as the web page displaying the Viewer, or add zSkinPath parameter to web page. The zSkinPath parameter may be required if using a content management system such as Drupal, Joomla, or WordPress.";break;case "z256-COMPARISONXML":b="Error loading comparison images: please make sure comparison path in web page matches comparison folder location on webserver.";
break;case "z256-SLIDESXML":b="Error loading slides: please make sure slide path in web page matches slides folder location on webserver.";break;case "z256-HOTSPOTSXML":b="Error loading hotspots: please make sure hotspot path in web page matches hotspots folder location on webserver.";break;case "z256-CREATINGANNOTATIONSXMLFILE":b="Error finding annotations XML at location provided.\nCreating new file.";break;case "z256-ANNOTATIONSXML":b="Error loading annotations: please make sure annotation XML path in web page matches annotation folder location on webserver.";
break;case "z256-ANNOTATIONSJSON":b="Error loading annotations: please make sure annotation JSON path in web page matches annotation folder location on webserver.";break;case "z256-ANNOTATIONSFILEHANDLER":b="Error saving annotations: please make sure save handler path in web page matches save handler file location on webserver.";break;case "z256":b="Error making network request:\npossible invalid path or network error.";break;case "z272":b="Error related to network security: ";break;case "z273":b=
"Error related to network status: ";break;case "z273RANGEREQUESTSZIF":b="ZIF file not found at the path provided. A MIME type may be needed on the web server. Please see the READ ME FIRST file in the Zoomify product or contact Support. Error: ";break;case "z273RANGEREQUESTSPFF":b="PFF file not found at the path provided. A MIME type may be needed on the web server. Please see the READ ME FIRST file in the Zoomify product or contact Support. Error: ";break;case "z244":b=" converting XML text to XML doc (DOMParser): ";
break;case "z243":b=" converting XML doc to XML text (DOMParser): ";break;case "z276":b=" parsing JSON file to JSON object: ";break;case "z276-TYPEUNKNOWN":b="Error parsing JSON file - unknown use.";break;case "z277":b=" parsing JSON label to JSON object: ";break;case "z294":b="Browser does not support XML DOM.";break;case "z293":b="XML Doc invalid.";break;case "z296":b="XML invalid.";break;case "z255":b="Image XML invalid.";break;case "z252":b="Image properties XML invalid.";break;case "z250":b=
"Image properties invalid.";break;case "z251":b="Image properties parameter invalid.";break;case "z254":b="Image tile count does not match value in image XML. If the count is invalid display problems can result.";break;case "z245":b=" while executing callback: ";break;case "z253":b="\nImage tile request not fulfilled within time period expected";break;case "ERROR_UNCONVERTEDIMAGEPATHINVALID":b="Unconverted JPEG or PNG image failed to load: possible invalid path, missing image, or network error.";
break;case "ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE":b="\nTranslation of canvas failed";break;case "ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE":b="\nScaling of canvas failed";break;case "ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE":b="\nTransform on canvas failed";break;case "z271":b="Navigator image failed to load: possible invalid path, missing image, or network error.";break;case "z278":b="Skin XML invalid.";break;case "z279":b="The skin XML file has one or more faulty name lines.";break;
case "z291":b="Virtual pointer graphic failed to load: ";break;case "z292":b="Watermark image failed to load: ";break;case "ERROR_SAVEIMAGEHANDLERPATHINVALID":b="Image failed to save";break;case "ERROR_TRACKINGPATHMISSING":b="Attempt to initiate Tracking mode without providing path to tracking XML data file.";break;case "ERROR_USERPATHMISSING":b="Attempt to initiate user list display without providing path to users XML data file.";break;case "z283":b="Unknown element style - no known method to identify.";
break;case "z284":b="Unknown mouse position - no known method to calculate.";break;case "z285":b="Unknown mouse scroll - no known method to calculate.";break;case "z286":b="Unknown window size - no known method to calculate.";break;case "z282":b="Selected filter requires assignment of increment or toggle interface.";break;case "ERROR_IMAGEFILTEREQUALIZEARRAYSUPPORT":b="\nUnable to process Equalize filter: browser does not support Uint8ClampedArray";break;case "ERROR_IMAGESAVEUNABLETOCOMPUTEPROGRESS":b=
"unable to calculate progress";break;case "ERROR_IMAGESAVEEXTERNAL":b="\nExternal function error";break;case "ERROR_IMAGESAVELOCALUNSUPPORTEDBROWSER":b="\nLocal saving only supported by Firefox and Chrome browsers";break;case "z360ZOOMIFY":b="Open Zoomify Website";break;case "z360GENERIC":b="Launch Website";break;case "z363":a=Z.hotspots?"\nAlt-Click: Toggle Hotspot Visibility":Z.annotations?"\nAlt-Click: Toggle Label Visibility":"";b="Minimize Toolbar"+a;break;case "z341":a=Z.hotspots?"\nAlt-Click: Toggle Hotspot Visibility":
Z.annotations?"\nAlt-Click: Toggle Label Visibility":"";b="Expand Toolbar"+a;break;case "z400":b="Zoom Out";break;case "z385ZOOM":b="Zoom In And Out";break;case "z399":b="Zoom In";break;case "z370":b="Pan Left";break;case "z372":b="Pan Up";break;case "z369":b="Pan Down";break;case "z371":b="Pan Right";break;case "z378":b="Reset Initial View\nAlt-Click: Prior View";break;case "z391":b="Enter Full View";break;case "z391EXIT":b="Exit Full View";break;case "z391EXITEXTERNAL":b="Exit Full View";break;
case "z342":b="Show Help";break;case "z342MARKUP":b="Show Markup Help";break;case "z342ANNOTATION":b="Show Annotation Help";break;case "z380":b="Rotate Clockwise 90 Degrees";break;case "z381":b="Rotate Counterwise 90 Degrees";break;case "TIP_GALLERYSCROLLBUTTONLEFT":b="Scroll Gallery Left";break;case "TIP_GALLERYSCROLLBUTTONRIGHT":b="Scroll Gallery Right";break;case "z398":b="Click-Drag To Position";break;case "TIP_RULERSETTINGSSHOW":b="Show settings for Ruler for this image";break;case "TIP_RULERUNITSPERIMAGE":b=
"Scale value above is number of units";break;case "TIP_RULERPIXELSPERUNIT":b="Scale value above is number of pixels";break;case "TIP_RULERSETTINGSCANCEL":b="Cancel changes to Ruler settings";break;case "TIP_RULERSETTINGSSAVE":b="Save settings for Ruler for this image";break;case "z392":b="Begin Measuring";break;case "z392EXIT":b="Stop Measuring";break;case "z394":b="Prior Destination";break;case "z393":b="Next Destination";break;case "z395":b="Start Tour";break;case "z396":b="Stop Tour";break;case "TIP_SYNC":b=
"Synchronize Viewports";break;case "z384":b="Prior Slide";break;case "z383":b="Next Slide";break;case "z386":b="Start Slideshow";break;case "z387":b="Stop Slideshow";break;case "z321":b="Mute Sound";break;case "z322":b="Enable Sound";break;case "z350":b="Hide Image Filter Panel";break;case "z351":b="Show Image Filter Panel";break;case "z385BRIGHTNESS":b="Change Brightness";break;case "z385CONTRAST":b="Change Contrast";break;case "z385SHARPNESS":b="Change Sharpness";break;case "z385BLURRINESS":b="Change Blurriness";
break;case "z385COLORRED":b="Change Color Red";break;case "z385COLORGREEN":b="Change Color Green";break;case "z385COLORBLUE":b="Change Color Blue";break;case "z385COLORREDRANGE":b="Change Color Red Minimum";break;case "z385COLORGREENRANGE":b="Change Color Green Minimum";break;case "z385COLORBLUERANGE":b="Change Color Blue Minimum";break;case "z385COLORREDRANGE2":b="Change Color Red Maximum";break;case "z385COLORGREENRANGE2":b="Change Color Green Maximum";break;case "z385COLORBLUERANGE2":b="Change Color Blue Maximum";
break;case "z385GAMMA":b="Change Gamma";break;case "z385GAMMARED":b="Change Gamma Red";break;case "z385GAMMAGREEN":b="Change Gamma Green";break;case "z385GAMMABLUE":b="Change Gamma Blue";break;case "z385HUE":b="Change Hue";break;case "z385SATURATION":b="Change Saturation";break;case "z385LIGHTNESS":b="Change Lightness";break;case "z385WHITEBALANCE":b="Change White Balance";break;case "z385NOISE":b="Change Noise";break;case "TIP_GRAYSCALE":b="Set Grayscale Filter";break;case "TIP_THRESHOLD":b="Set Threshold Filter";
break;case "TIP_INVERSION":b="Set Inversion Filter";break;case "TIP_EQUALIZE":b="Set Equalize Filter";break;case "TIP_EDGES":b="Set Edges Filter";break;case "TIP_SEPIA":b="Set Sepia Filter";break;case "z352":b="Increase Filter";break;case "z349":b="Decrease Filter";break;case "z346":b="Apply Selected Filter";break;case "z347":b="Clear Last Filter";break;case "z347ALL":b="Clear All Filters";break;case "TIP_IMAGESETPRIOR":b=Z.animation?"Prior Image":"Prior Slide";break;case "z385IMAGESET":b=Z.animation?
"Change Image":"Change Slide";break;case "TIP_IMAGESETNEXT":b=Z.animation?"Next Image":"Next Slide";break;case "TIP_PRELOAD":b=Z.imageSet?Z.animation?"Preload Current View For All Images":"Preload Current View For All Slides":"Preload All Zoom Levels For Current View";break;case "TIP_POIGO":b="Go To Point Of Interest";break;case "TIP_LABELGO":b="Go To Label";break;case "z397":b="Image Navigation";break;case "TIP_EDITMODEFIELDOFVIEW":b="Field Of View";break;case "z340":b="Text Captions";break;case "TIP_EDITMODESHAPE":b=
"Arrow, Lines, & Shapes";break;case "z335":b="Freehand Drawings";break;case "z338":b="Polygons";break;case "z337":b="Measurements";break;case "z334":b="Colors";break;case "TIP_EDITMODELINESTYLE":b="Line Styles";break;case "z373":b="Add New POI";break;case "z376":b="Edit Current POI";break;case "z375":b="Delete Current POI";break;case "z374":b="Cancel POI Changes";break;case "z377":b="Save POI Changes";break;case "z353":b="Add New Label";break;case "z356":b="Edit Current Label";break;case "z355":b=
"Delete Current Label";break;case "z354":b="Cancel Label Changes";break;case "z357":b="Save Label Changes";break;case "z364":b="Add New Note";break;case "z367":b="Edit Current Note";break;case "z366":b="Delete Current Note";break;case "z365":b="Cancel Note Changes";break;case "z368":b="Save Note Changes";break;case "z324":b="Select Color";break;case "z325":b="Select Color";break;case "z326":b="Select Color";break;case "z327":b="Select Color";break;case "z328":b="Select Color";break;case "z329":b=
"Select Color";break;case "z330":b="Select Color";break;case "z331":b="Select Color";break;case "z359":b="Grow Label";break;case "z358":b="Shrink Label";break;case "z379":b="Hide Shape Until Mouse-Over";break;case "TIP_CAPTIONROLLOVER":b="Hide Caption Until Mouse-Over";break;case "TIP_TOGGLEMAGNIFIERMINIMIZE":b="Minimize Magnifier";break;case "TIP_TOGGLEMAGNIFIERMAXIMIZE":b="Maximize Magnifier";break;case "TIP_NARRATIVEBOLD":b="Bold Selected Text";break;case "TIP_NARRATIVEITALIC":b="Italicize Selected Text";
break;case "TIP_NARRATIVEUNDERLINE":b="Underline Selected Text";break;case "TIP_NARRATIVESCALEUP":b="Grow Selected Text";break;case "TIP_NARRATIVESCALEDOWN":b="Shrink Selected Text";break;case "TIP_NARRATIVEALIGNLEFT":b="Align Current Paragraph Left";break;case "TIP_NARRATIVEALIGNCENTER":b="Align Current Paragraph Centered";break;case "TIP_NARRATIVEALIGNRIGHT":b="Align Current Paragraph Right";break;case "TIP_NARRATIVEALIGNJUSTIFY":b="Align Current Paragraph Justified";break;case "TIP_NARRATIVESETINITIALIMAGE":b=
"Show Current Image When Opening This Narrative";break;case "TIP_NARRATIVESETINITIALLABELS":b="Show Current Labels When Opening This Narrative";break;case "TIP_NARRATIVELINKCLEAR":b="Clear Any Link On Selected Text";break;case "TIP_FORMATTINGTOOLSSHOW":b="Show Narrative Formatting Tools";break;case "TIP_FILEMANAGERSHOW":b="Show File Manager";break;case "TIP_NARRATIVEVIEW":b="Toggle to Preview Mode";break;case "TIP_NARRATIVEEDIT":b="Toggle Back To Edit Mode";break;case "TIP_NARRATIVECANCEL":b="Return Narrative To Last Saved State";
break;case "TIP_NARRATIVESAVE":b="Save Narrative";break;case "z342NARRATIVE":b="Narrative Help";break;case "TIP_FILEUPLOAD":b="Upload File...";break;case "TIP_FILEDOWNLOAD":b="Download Selected File";break;case "TIP_FILENEW":b="Create File Of Seleted Type";break;case "TIP_FILEDELETE":b="Delete Selected File";break;case "TIP_DOWNLOADPANELCLOSE":b="Close Download Panel";break;case "TIP_COUNTINGLISTHIDE":b="Hide Counter List";break;case "TIP_COUNTINGCOMPLETE":b="Set Current Cell Counting Complete";break;
case "TIP_TRACKINGNAVTOGGLE":b="Toggle Navigator Tracking Overlay";break;case "TIP_COUNTERCLEARLAST":b="Clear Last Counter Added";break;case "TIP_COUNTERCLEARTYPE":b="Clear Counters Of Selected Type";break;case "TIP_COUNTERSCLEARALL":b="Clear All Counters";break;case "TIP_COUNTERSSAVE":b="Save All";break;case "TIP_COUNTERTYPE":b="Set Image Click To Add This Type";break;case "TIP_COUNTERTYPESHOW":b="Show Labels For This Type In Image";break;case "TIP_COUNTERLIST":b="Show List Of Labels For This Type";
break;case "z342OK":b="Close Help Display";break;case "z362":b="Accept And Close Message";break;case "z361":b="Decline And Close Message";break;case "z332":b="Agree To Copyright And View Images";break;case "z333":b="Exit And Do Not View Images";break;case "z382":b="Toggle Full Page View";break;case "z390":b="Toggle Viewport Display";break;case "z388":b="Toggle Viewport Backfill";break;case "z389":b="Toggle Constrain Pan";break;case "z427ZOOMIFY":b="http://www.zoomify.com";break;case "z427":b="http://www.zoomify.com";
break;case "z427TARGET":b="_blank";break;case "UI_TOOLBARINTERNALBACKGROUNDALPHA":b="0.75";break;case "UI_TOOLBARINTERNALBACKGROUNDCOLOR":b="lightgray";break;case "UI_TOOLBARINTERNALBUTTONUPCOLOR":b="white";break;case "UI_TOOLBARINTERNALBUTTONOVERCOLOR":b="lightgray";break;case "UI_TOOLBARINTERNALBUTTONDOWNCOLOR":b="darkgray";break;case "UI_TOOLBARINTERNALBUTTONZOOMINTEXT":b="+";break;case "UI_TOOLBARINTERNALBUTTONRESETTEXT":b="Z";break;case "UI_TOOLBARINTERNALBUTTONZOOMOUTTEXT":b="-";break;case "z439":b=
"Navigator Bird's Eye View";break;case "z420":b="X";break;case "UI_GALLERYACCESSIBILITYALTATTRIBUTE":b="Scrolling Gallery Of Image Thumbnails";break;case "z441":b=" min";break;case "z440":b=" max";break;case "z442":b="units in %s";break;case "UI_RULERSETTINGSPANELLABEL":b="Ruler Image Settings";break;case "UI_RULERSCALELABEL":b="Scale";break;case "UI_RULERUNITSPERIMAGELABEL":b="Units/Image";break;case "UI_RULERPIXELSPERUNITLABEL":b="Pixels/Unit";break;case "z431":b="Length: ";break;case "z431TOTAL":b=
"Total length: ";break;case "z433":b="Perimeter: ";break;case "z430":b="Area: ";break;case "z434":b="\u00b2";break;case "z425":b="Filter List,\u00a0\u00a0\u2014,\u00a0\u00a0None";break;case "z426":b="null,null,null";break;case "UI_IMAGEFILTERPANELLABELBRIGHTNESS":b="Brightness";break;case "UI_IMAGEFILTERPANELLABELCONTRAST":b="Contrast";break;case "UI_IMAGEFILTERPANELLABELCOLORRED":b="Red";break;case "UI_IMAGEFILTERPANELLABELCOLORGREEN":b="Green";break;case "UI_IMAGEFILTERPANELLABELCOLORBLUE":b="Blue";
break;case "UI_IMAGEFILTERPANELLABELCOLORREDRANGE":b=Z.colorRedVisible?"Red Range":"Red";break;case "UI_IMAGEFILTERPANELLABELCOLORGREENRANGE":b=Z.colorGreenVisible?"Green Range":"Green";break;case "UI_IMAGEFILTERPANELLABELCOLORBLUERANGE":b=Z.colorBlueVisible?"Blue Range":"Blue";break;case "UI_IMAGEFILTERPANELLABELGAMMA":b="Gamma";break;case "UI_IMAGEFILTERPANELLABELGAMMARED":b="Gamma Red";break;case "UI_IMAGEFILTERPANELLABELGAMMAGREEN":b="Gamma Green";break;case "UI_IMAGEFILTERPANELLABELGAMMABLUE":b=
"Gamma Blue";break;case "UI_IMAGEFILTERPANELLABELHUE":b="Hue";break;case "UI_IMAGEFILTERPANELLABELSATURATION":b="Saturation";break;case "UI_IMAGEFILTERPANELLABELLIGHTNESS":b="Lightness";break;case "UI_IMAGEFILTERPANELLABELWHITEBALANCE":b="White Balance";break;case "UI_IMAGEFILTERPANELLABELNORMALIZE":b="Normalize";break;case "UI_IMAGEFILTERPANELLABELEQUALIZE":b="Equalize";break;case "UI_IMAGEFILTERPANELLABELNOISE":b="Noise";break;case "UI_IMAGEFILTERPANELLABELGLOW":b="Glow";break;case "UI_IMAGEFILTERPANELLABELSHARPNESS":b=
"Sharpness";break;case "UI_IMAGEFILTERPANELLABELBLURRINESS":b="Blurriness";break;case "UI_IMAGEFILTERPANELLABELGRAYSCALE":b="Grayscale";break;case "UI_IMAGEFILTERPANELLABELTHRESHOLD":b="Threshold";break;case "UI_IMAGEFILTERPANELLABELINVERSION":b="Inversion";break;case "UI_IMAGEFILTERPANELLABELEDGES":b="Edges";break;case "UI_IMAGEFILTERPANELLABELSEPIA":b="Sepia";break;case "z418":b="Agree";break;case "z419":b="Exit";break;case "UI_LISTMOUSEDOWNTEXT":b="Select an item...";break;case "z444":b="Tour Destinations";
break;case "z443":b="Slides";break;case "z424":b="Hotspots";break;case "z410":b="POI";break;case "z408":b="Label";break;case "z407":b="Caption";break;case "z413":b="Tooltip";break;case "z414":b="Click";break;case "z412":b="Scale";break;case "z411":b="Rollover:";break;case "UI_ANNOTATIONPANELLABELGRAPHICROLLOVER":b="Graphic";break;case "z407ROLLOVER":b="Caption";break;case "z409":b="Note";break;case "UI_ANNOTATIONLABELSHAPECHOICELISTTEXT":b="Arrow,Line,Square,Rectangle,Circle,Ellipse,Triangle";break;
case "UI_ANNOTATIONLABELSHAPECHOICELISTVALUES":b=Z.labelShapesInternal?"arrow,line,square,rectangle,circle,ellipse,triangle":"arrow.png,line.png,square.png,rectangle.png,circle.png,ellipse.png,triangle.png";break;case "UI_ANNOTATIONLABELLINESTYLECHOICELISTTEXT":b="Solid, Dashed, Dotted";break;case "UI_ANNOTATIONLABELLINESTYLECHOICELISTVALUES":b="solid,dashed,dotted";break;case "z401":b="Caption position...,Bottom Left,Bottom Center,Bottom Right,Center Left,Center Center,Center Right,Top Left,Top Center,Top Right";
break;case "z402":b="shim,7,8,9,4,5,6,1,2,3";break;case "z405":b="Open URL in...,Same Window,New Window,Parent Frame,Top Frame";break;case "z406":b="shim,_self,_blank,_parent,_top";break;case "UI_ANNOTATIONAPERIONONAME":b="Unnamed";break;case "UI_ANNOTATIONAPERIONONAMENORMEDIA":b="No name nor media";break;case "UI_TOOLBARLABELSYNC":b="Sync";break;case "UI_IMAGESETLISTTITLE":b=Z.comparison||Z.overlays?"":"ImageSet Slide List";break;case "UI_IMAGESETSTART":b="0";break;case "UI_IMAGESETLOOP":b="1";break;
case "UI_IMAGESETSLIDER":b=Z.comparison||Z.overlays?"0":"1";break;case "UI_TRACKINGROWBUTTONCOLORUPCOLOR":b="white";break;case "UI_TRACKINGROWBUTTONCOLOROVERCOLOR":b="lightgray";break;case "UI_TRACKINGROWBUTTONCOLORDOWNCOLOR":b="darkgray";break;case "UI_TRACKINGPANELLABELADD":b="Add";break;case "UI_TRACKINGPANELLABELSHOW":b="Show";break;case "UI_TRACKINGPANELLABELNAME":b="Name";break;case "UI_TRACKINGPANELLABELCOUNT":b="Cell";break;case "UI_TRACKINGPANELLABELCOUNTALL":b="All";break;case "UI_TRACKINGPANELLABELLIST":b=
"List";break;case "UI_TRACKINGPANELLABELCELL":b="Cell";break;case "UI_TRACKINGPANELLABELX":b="X";break;case "UI_TRACKINGPANELLABELY":b="Y";break;case "UI_TRACKINGPANELLABELZOOM":b="Zoom";break;case "UI_TRACKINGPANELLABELUSERNAME":b="UserName";break;case "UI_TRACKINGPANELLABELCURRENTCELL":b="Cell";break;case "UI_TRACKINGPANELLABELCOUNTINGCOMPLETE":b=Z.trackingAuto?"Viewed":"Complete";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER2":b="#000000";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER4":b=
"#8B4513";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER10":b="#FF0000";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER16":b="#FFFF00";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER25":b="#00FF00";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER40":b="#40E0D0";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER60":b="#0000FF";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER100":b="#000033";break;case "UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDERINFINITY":b="#FFFFFF";break;case "UI_USERNAMEPROMPT":b=
"Please enter a username for your edits";break;case "UI_USERNAMEPROMPTRETRY":b="Name not on approved list, please try again";break;case "UI_USERPANELLABELNAME":b="Name";break;case "UI_USERPANELLABELCOUNT":b="Count";break;case "UI_USERPANELLABELSHOW":b="Show";break;case "z422":b="430";break;case "z421":b="300";break;case "z423":b="OK";break;case "UI_HELPSCREENCOLOR":b="lightgray";break;case "UI_HELPBUTTONCOLOR":b="white";break;case "z437":b="430";break;case "z436":b="90";break;case "z435":b="Cancel";
break;case "z438":b="OK";break;case "z417":b="290";break;case "z415":b="220";break;case "z416":b="Mouse Coordinates\nAlt-click, select in list, right-click, Copy";break;case "UI_GEOCOORDINATESDISPLAYTEXT":b="Latitude & Longitude\nAlt-click, select in list, right-click, Copy";break;case "UI_IIIFCOORDINATESDISPLAYTEXT":b="IIIF Values For View\nAlt-click, select in list, right-click, Copy";break;case "UI_MAGNIFIERACCESSIBILITYALTATTRIBUTE":b="Magnifier Zoomed View";break;case "UI_NARRATIVELOGOCOLOR":b=
"#003366";break;case "UI_NARRATIVESCREENCOLOR":b="#444444";break;case "UI_NARRATIVEBORDERCOLOR":b="#696969";break;case "UI_NARRATIVELABELCOLOR":b="#cccccc";break;case "UI_NARRATIVEBUTTONCOLOR":b="white";break;case "UI_NARRATIVEPANELLABEL":b="Narrative";break;case "UI_NARRATIVEFORMATLABEL":b="Format";break;case "UI_NARRATIVESETINITIALLABEL":b="Set Initial";break;case "UI_NARRATIVESETINITIALIMAGELABEL":b="Image";break;case "UI_NARRATIVESETINITIALLABELSLABEL":b="Labels";break;case "UI_NARRATIVELINKLABEL":b=
"Link";break;case "UI_NARRATIVELINKURLLABEL":b="URL";break;case "UI_NARRATIVETABTOOLSTEXT":b="Tools";break;case "UI_NARRATIVELINKEDITPROMPT":b="Enter URL to link to...";break;case "UI_FILEMANAGERLABEL":b="Manage Files";break;case "UI_FILEMANAGERTABFILESTEXT":b="Files";break;case "UI_DOWNLOADPANELLABEL":b="Download File";break;case "UI_DOWNLOADINFOLABEL":b="Right-click link then Save As (Win)\nCtrl-click then Download (Mac)";break;case "UI_TRACEDISPLAYTITLE":b="Trace Values\n\n";break;case "z445":b=
"This panel is enabled using the HTML parameter 'zDebug=1' (basic) or 'zDebug=2' (adds tile tracing). It can be called in JavaScript as follows:\n\n   Z.Utils.trace('value to display');  \n\nThe buttons below display or modify important state values.  Web designers new to JavaScript will also benefit from the console, trace, profiling, and other debugging features of leading browsers.";break;case "UI_TRACEDISPLAYTILESTATUSTEXT":b="Required Cached Requested Loaded Displayed Waiting";break;case "UI_TRACEDISPLAYELAPSEDTIMETEXT":b=
"Seconds";break;case "UI_TRACEDISPLAYTILESPERSECONDTEXT":b="Loads / Second";break;case "z446":b="Show Globals";break;case "z449":b="Toggle Display";break;case "z447":b="Toggle Backfill";break;case "z448":b="Toggle Constrain Pan";break;case "z32":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Viewer Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>To explore this image, simply <strong>click</strong> the image to zoom in, <strong>double-click</strong> to zoom out, and <strong>click-drag</strong> to pan.<br><br>Shortcuts:<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-drag</strong> to create a <i>zoom-rectangle</i>.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click</strong> to zoom fully in.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-double-click</strong> to zoom fully out.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-Reset</strong> button to return to the prior view.<br>&nbsp;&nbsp;&nbsp;(Alt is Option on Macintosh).<br><br>The Navigator thumbnail overview can also be clicked or click-dragged to pan.<br><br>Use the Toolbar for exact navigation - if using a mouse, hold it over any button to see a helpful tip.<br><br>Keyboard shortcuts:<br>&nbsp;&nbsp;&nbsp;<strong>A</strong> or <strong>Shift</strong> to zoom in.<br>&nbsp;&nbsp;&nbsp;<strong>Z</strong> or <strong>Ctrl</strong> to zoom out.<br>&nbsp;&nbsp;&nbsp;<strong>Arrows</strong> change image in slideshow/animation.<br>&nbsp;&nbsp;&nbsp;<strong>Space Bar</strong> to toggle fullscreen view.<br>&nbsp;&nbsp;&nbsp;<strong>Escape</strong> to reset initial view or exits fullscreen.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-L</strong> to hide/show hotspots or labels.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-Minimize</strong> button - same as Alt-L.<br>&nbsp;&nbsp;&nbsp;<strong>Page Up/Down</strong> change image in a slidestack.<br>&nbsp;&nbsp;&nbsp;<strong>&lt;</strong> or <strong>&gt;</strong> to rotate image if rotation buttons visible.</font></p>";
break;case "z31":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Markup Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>Markup Mode allows fast, easy addition of labels to a zoomable image.<br><br><strong>Creating A Label</strong><br><br>Click any of the buttons at the top of the Markup Panel: Freehand, Text, Rectangle, Polygon, or Measure.<br><br>Next, click or click-drag in the image:<ul><li>Freehand drawings are created by click-dragging.<li>Text labels are created with a simple click in the image.<li>Shapes first require the type of shape to be chosen from the shape list. Then the shape is created by clicking the image.<li>Rectangles do not require multiple clicks - just click-drag and all four corners are automatically created and positioned.<li>Polygons require multiple clicks in the image to create corner <i>control points</i>.  Alt-click the image to create a final point, or click the first point to close the polygon.<li>Measurements are just like polygons but the caption dynamically changes to display the current length or area.<li>Control points of rectangles, polygons, and measurments can be click-dragged to modify a polygon.</ul>Use the Color button to set a color. The color selected affects freehand drawings, text captions, shape captions, and the lines and captions of rectangles, polygons, and measurements.<br><br>Use the View button to return to navigation mode.<br><br><strong>Editing Label Values</strong><br><br>The Markup Panel also displays the name and caption of the currently selected label for easy editing. Use the TAB key to implement any edits or click in the image.<br><br>Delete a label using the trash can button. The label will be removed from the image and the Markup Panel will display the prior label in the label list.<br><br>Save a label using the button with the disk icon. Or, use the label list to change the selected label - the previously selected label will be automatically saved.<br><br><i><strong>Special Tips:</strong><ul><li>Alt-click any label to display its name and caption in the Markup Panel for editing.<li>Alt-click-drag any completed label to reposition it in the image.<li>If using a mouse, hold the cursor over any button at any time to see a helpful reminder.</ul></i></font></p>";
break;case "z28":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Annotation Editing Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>The Annotation Panel provides an intuitive, visual means, to add <i>Points of Interest</i> to a zoomable image, including the option of associated <i>Labels</i> and <i>Notes</i>.<br><br><strong>Point Of Interests</strong><br><br>A Point Of Interest (POI) is a place in the image that is named and listed so that it can be navigated to easily.<br><br>To create a Point Of Interest, click the <i>Add</i> button beneath the Point Of Interest choice list at the top of the Annotation Panel to create a new Point of Interest. Or, click the <i>Edit</i> button to modify the current POI. If no Annotations have been created, a placeholder POI will be the only item in the Point Of Interest list.<br><br><i><strong>More Buttons:</strong></i><br><br>When the Add button is clicked, two different buttons will be displayed: <i>Save</i> and <i>Cancel</i>. If the Edit button is clicked, a third button will also be displayed: <i>Delete</i>.<br><br>Save a Point Of Interest using the button with the disk icon. Cancel edits to a Point Of Interest using the button with the large X icon.<br><br>Delete a Point Of Interest using the trash can button. The POI will be removed from the list and the prior POI in the list will be displayed.<br><br><i><strong>Important:</strong><ul><li>Changing the selected POI in the POI list will automatically save any edits to the current POI.<li>Clicking any of the buttons Save, Cancel, and Delete will leave the Add or Edit mode and return to Annotation Panel to its default display.<li>If using a mouse, hold the cursor over any button to see a helpful reminder.</ul></i><strong>Labels</strong><br><br>To add a new Label to the current Point Of Interest, click the Add button beneath the Label section of the Annotation Panel. Or, click the Edit button to edit the current Label. If no Labels have been created yet, the Label list will be empty.<br><br>If adding a new Label, click any of the buttons at the top of the Label section of the Annotation Panel: Freehand, Text, Rectangle, Polygon, or Measure.<br><br>Now click or click-drag in the image to create a new Label:<ul><li>Freehand drawings are created by click-dragging.<li>Text labels are created with a simple click in the image.<li>Shapes first require the type of shape to be chosen from the shape list. Then the shape is created by clicking the image.<li>Rectangles do not require multiple clicks - just click-drag and all four corners are automatically created and repositioned.<li>Polygons require multiple clicks in the image to create corner <i>control points</i>.  Alt-click the image to create a final point, or click the first point to close the polygon.<li>Measurements are just like polygons except that the caption dynamically changes to display the current length or area.</ul>Use the Color button to set the color of new freehand drawings, text captions, shape captions, and the lines and captions of rectangles, polygons, and measurements.<br><br>Use the View button to return to navigation mode in the current Label.<br><br><i><strong>Important:</strong><ul><li>In Add mode, multiple clicks or click-drags will create multiple Labels - to support rapid annotation authoring.<li>In Edit mode, any clicks or click-drags will simple replace the current Label in the image.<li>Alt-click any label in the image to display its values in the Annotatoin Panel for editing. (Add or Edit mode)<li>Alt-click-drag any completed label in the image to reposition it.  (Add or Edit mode)<li>Control points of rectangles, polygons, and measurments can be click-dragged to modify a polygon.</ul></i><i><strong>More Label Values:</strong></i><br><br>The Annotation Panel also displays the name, caption, tooltip, and click-URL of of the currently selected label for easy editing. Use the TAB key to implement any edits or click in another text field or in the image. <br><br>Two choice lists are also included: the first allows the caption to be positioned relative to the Label in the image while the second determines whether the click-URL (if any) will open in the current browser window or a new browser window or a specific frame in the web page. <br><br>The Scale buttons allow the Label to be sized in the image.  The Rollover checkbox can be used to hide a Label in the image until the cursor is over it (not supported by mobile devices).<br><br>The Save, Cancel, and Delete buttons for Labels work just as they do with Points of Interest, as described above. And remember, changing the selected Label in the Label list will automatically save any edits to the current Label. Alt-clicking or alt-click-dragging a Label in the image will also change the current Label in the Label list and cause any edits to be saved (see the first two Special Tips below).<br><br><i><strong>Important:</strong><ul><li>Changing the selected Label by clicking or click-dragging it in the image will change the selected Point Of Interest if the newly selected Label is associated with a different POI - if editing is in progress the edits will be automatically saved.<li>If using a mouse, hold the cursor over any button to see a helpful reminder.</ul></i><strong>Notes</strong><br><br>To add a new Note to the current Point Of Interest, click the Add button beneath the Note section of the Annotation Panel. Or, click the Edit button to edit the current Note. If no Notes have been created yet, the Note list will be empty.<br><br>Use the name and text fields to easily add or edit the Note values. Notes can hold a virtually unlimited number of characters (spaces included). A vertical scrollbar automatically appears when a note requires more lines than fit in the note area. Notes can contain carriage returns.<br><br>The Save, Cancel, and Delete buttons for Notes work just as they do with Points of Interest, as described above. And remember, changing the selected Note in the Note list will automatically save any edits to the current Note.</font></p>";
break;case "z30":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>\\/ \\/ \\/</strong></font></p>";break;case "z29":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Annotation Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>The Annotation Panel provides an intuitive display of <i>Points of Interest</i> in a zoomable image, along with associated <i>Labels</i> and <i>Notes</i>, if any.<br><br>A Point Of Interest (POI) is a place in the image that is named and listed so that it can be navigated to easily.<br><br>A Label is a visual element in the image: a freehand drawing, text caption, rectangle or other polygon, or a measurement.<br><br>A Note is text associated with a Point Of Interest. Notes can hold a virtually unlimited number of characters (spaces included). A vertical scrollbar automatically appears when a note requires more lines than fit in the note area.</font></p>";
break;case "CONTENT_HELPNARRATIVEVIEW":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Narrative Viewing Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>Narrative View Mode allows fast, intuitive viewing of descriptive notes about one or more zoomable images.<br><br>Loading Narrative Help...</font></p>";break;case "CONTENT_HELPNARRATIVEEDIT":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Narrative Editing Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>Narrative Edit Mode allows fast, intuitive authoring of descriptive notes about one or more zoomable images.<br><br>Loading Narrative Help...</font></p>";
break;case "CONTENT_RULERUNITSCHOICELISTTITLE":b="Units...";break;case "CONTENT_RULERUNITSCHOICELISTVALUES":b="Pixels,Ym,Zm,Em,Pm,Tm,Gm,Mm,km,hm,dam,m,dm,cm,mm,um,nm,pm,fm,am,zm,ym";break;case "CONTENT_RULERLISTTYPELISTTITLE":b="List Type...";break;case "CONTENT_RULERLISTTYPELISTVALUES":b="None,Magnification,Percentage";break;case "CONTENT_RULERSOURCEMAGNIFICATIONLISTTITLE":b="Source Magnification...";break;case "CONTENT_RULERSOURCEMAGNIFICATIONLISTTEXT":b="1.25x,2.5x,5x,10x,20x,40x,60x,100x";break;
case "CONTENT_RULERSOURCEMAGNIFICATIONLISTVALUES":b="1.25,2.5,5,10,20,40,60,100";break;case "CONTENT_SKIPUSERNAME":b="Anonymous User";break;case "z27":b="Whole Image";break;case "z43":b="New Point Of Interest ";break;case "z44":b=this.getResource("CONTENT_SKIPUSERNAME");break;case "z34":b="New Hotspot ";break;case "z33":b="Caption for hotspot ";break;case "z37":b="New Label ";break;case "z35":b="Caption for label ";break;case "CONTENT_LABELCOMMENT":b="Comment for label ";break;case "CONTENT_LABELCOMMENTMARKUPNOLABELS":b=
"Pick a label type above then click in the image to create!";break;case "CONTENT_ANNOTATIONPLACEHOLDERCOMMENTTEXT":b="";break;case "z45":b="Polygon ";break;case "z38":b="Tooltip for label ";break;case "z36":b="";break;case "z39":b=this.getResource("CONTENT_SKIPUSERNAME");break;case "z40":b="New Note ";break;case "z41":b="Note text";break;case "z42":b=this.getResource("CONTENT_SKIPUSERNAME");break;case "z20":b="List creation in progress...";break;case "z21":b="Note loading in progress...";break;case "CONTENT_CAPTIONFOVTEXT":b=
"FOV";break;case "CONTENT_CAPTIONFOVNOTETEXT":b="\nFOV caption and border visible only in edit mode";break;case "CONTENT_TOOLTIPFOV":b="Field Of View ";break;case "z25":b=Z.captionTextColor?Z.captionTextColor:"#FFFFFF";break;case "z22":b=Z.captionBackColor?Z.captionBackColor:"#000000";break;case "CONTENT_LABELLINECOLOR":b=Z.labelLineColor?Z.labelLineColor:"#FFFFFF";break;case "CONTENT_LABELFILLCOLOR":b=Z.labelFillColor?Z.labelFillColor:"#FFFFFF";break;case "z26":b=Z.captionTextVisible?"1":"0";break;
case "z23":b=Z.captionBackVisible?"1":"0";break;case "CONTENT_LABELLINEVISIBLE":b=Z.labelLineVisible?"1":"0";break;case "CONTENT_LABELFILLVISIBLE":b=Z.labelFillVisible?"1":"0";break;case "z24":b=Z.captionPosition?Z.captionPosition:"8";break;case "CONTENT_EDITABLE":b="1";break;case "CONTENT_LINESTYLE":b="solid";break;case "CONTENT_NARRATIVELOADINGTEXT":b="Narrative loading in progress...";break;case "CONTENT_NARRATIVELISTTITLE":b="Narratives...";break;case "CONTENT_NARRATIVEMEDIALISTTITLE":b="Media...";
break;case "CONTENT_NARRATIVEIMAGELISTTITLE":b="Image...";break;case "CONTENT_NARRATIVEIMAGELISTINVIEWERTITLE":b="Select image to display...";break;case "CONTENT_ANNOTATIONFILELISTTITLE":b="Select label set to display...";break;case "CONTENT_NARRATIVELABELLISTTITLE":b="Label...";break;case "CONTENT_NARRATIVEPLACEHOLDERLISTTEXT":b="List loading in progress...";break;case "CONTENT_NARRATIVEPLACEHOLDERTEXT":b="Enter narrative text here.";break;case "CONTENT_NARRATIVESELECTITEMTEXT":b="Select an item from the Narrative list.";
break;case "CONTENT_FILETYPESELECTITEMTEXT":b="First select a file type...";break;case "CONTENT_FILETYPESCHOICELISTTEXT":b="Narratives;Images (zoomable);Media (graphics, audio, video);Label Sets (files of labels)";break;case "CONTENT_FILETYPESCHOICELISTVALUES":b="Narratives,Images,Media,Label Sets";break;case "CONTENT_FILESELECTITEMTEXT":b="Then select a specific file...";break;case "CONTENT_TRACKINGPLACEHOLDERLISTTEXT":b="List creation in progress...";break;case "CONTENT_TRACKINGTEXTCOLOR":b="#FFFFFF";
break;case "CONTENT_TRACKINGLINECOLOR":b="#000000";break;case "CONTENT_TRACKINGFILLCOLOR":b="#FFFFFF";break;case "CONTENT_COUNTERNAME":b="Counter Type 0";break;case "CONTENT_COUNTERCAPTION":b="Caption for counter";break;case "CONTENT_COUNTERCAPTIONPOSITION":b="5";break;case "CONTENT_COUNTERFILLCOLOR":b="#FFFFFF";break;case "CONTENT_COUNTERCELL":b="0:0:100";break;case "CONTENT_COUNTERUSER":b="Anonymous User";break;case "CONTENT_COUNTERUSERINITIALS":b="AU";break;case "CONTENT_USERPLACEHOLDERLISTTEXT":b=
"List creation in progress...";break;default:b="Unexpected resource request"}return b},clearComponent:function(a){switch(a){case Z.Toolbar:Z.Toolbar=null;Z.Utils.clearDisplay(Z.ToolbarDisplay);Z.toolbarVisible=null;Z.toolbarBackgroundVisible=null;Z.skinPath=null;Z.sliderZoomVisible=null;Z.logoVisible=null;Z.minimizeVisible=null;Z.zoomButtonsVisible=null;Z.sliderVisible=null;Z.panButtonsVisible=null;Z.resetVisible=null;Z.fullScreenVisible=null;Z.tooltipsVisible=null;Z.helpVisible=null;Z.progressVisible=
null;break;case Z.Navigator:Z.navigatorVisible=null;Z.navigatorW=null;Z.navigatorH=null;Z.navigatorL=null;Z.navigatorT=null;Z.navigatorFit=null;Z.navigatorRectangleColor=null;break;case Z.Gallery:Z.Utils.clearDisplay(Z.GalleryDisplay);Z.Gallery=null;Z.galleryVisible=null;Z.galleryAutoShowHide=null;Z.galleryW=null;Z.galleryH=null;Z.galleryM=null;Z.galleryL=null;Z.galleryT=null;Z.galleryPosition=null;Z.galleryRectangleColor=null;break;case Z.Ruler:Z.Utils.clearDisplay(Z.RulerDisplay),Z.Ruler=null,Z.rulerVisible=
null,Z.rulerListType=null,Z.rulerW=null,Z.rulerH=null,Z.rulerL=null,Z.rulerT=null}},clearDisplay:function(a){if(a)if(Z.useCanvas&&"CANVAS"==a.tagName)Z.Utils.clearCanvas(a);else for(;a.hasChildNodes();)a.removeChild(a.lastChild)},clearCanvas:function(a){a=a.getContext("2d");a.save();try{a.setTransform(1,0,0,1,0,0)}catch(b){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE")),console.log("In function clearCanvas setting transform on canvas:  "+b)}a.clearRect(0,
0,a.canvas.width,a.canvas.height);a.restore()},colorCanvas:function(a,b){var e=a.getContext("2d");e.save();e.setTransform(1,0,0,1,0,0);e.fillStyle=b;e.fillRect(0,0,e.canvas.width,e.canvas.height);e.restore()},deleteDiv:function(a){if(a=document.getElementById(a)){for(;a.hasChildNodes();)a.removeChild(a.lastChild);a.parentNode.removeChild(a)}},createCallback:function(a,b){for(var e=[],f=2,g=arguments.length;f<g;f++)e[e.length]=arguments[f];return function(){for(var f=e.concat([]),g=0,E=arguments.length;g<
E;g++)f[f.length]=arguments[g];return b.apply(a,f)}},verifyCallback:function(a){var b=!1;if("undefined"!==typeof Z.callbacks)for(var e=Z.callbacks.slice(0),f=0,g=e.length;f<g;f++){var k=e[f];k&&k.callbackEvent==a&&"object"===typeof k&&"function"===typeof k.callbackFunction&&(b=!0)}return b},getCallbackFunction:function(a){var b=null;if("undefined"!==typeof Z.callbacks)for(var e=Z.callbacks.slice(0),f=0,g=e.length;f<g;f++){var k=e[f];k&&k.callbackEvent==a&&"object"===typeof k&&"function"===typeof k.callbackFunction&&
(b=k.callbackFunction)}return b},validateCallback:function(a){"undefined"===typeof Z.callbacks&&(Z.callbacks=[]);var b=Z.callbacks.slice(0);Z.Utils.functionCallWithDelay(function(){Z.Utils.validateCallbackDelayed(a,b)},10)},validateCallbackDelayed:function(a,b){for(var e=0,f=b.length;e<f;e++){var g=b[e];if(g&&g.callbackName==a&&"object"===typeof g&&"function"===typeof g.callbackFunction)switch(a){case "viewChanging":g.callbackFunction();break;case "viewPanningGetCurrentCoordinates":var k=Z.Viewport.getCoordinates();
g.callbackFunction(k);break;case "viewZoomingGetCurrentZoom":k=Z.Viewport.getZoom();g.callbackFunction(k);break;case "viewChangingGetCurrentCoordinatesFull":k=Z.Viewport.getCoordinatesFull();g.callbackFunction(k);break;case "viewUpdateCompleteGetLabelIDs":k=Z.Viewport.getLabelIDsInCurrentView(!1,!0,!0);g.callbackFunction(k);break;case "viewUpdateCompleteGetLabelInternalIDs":k=Z.Viewport.getLabelIDsInCurrentView(!0,!0,!0);g.callbackFunction(k);break;case "labelSavedGetJSONObject":if(k=Z.Viewport.getCurrentLabel())k=
k.internalID,k=Z.Viewport.getLabelJSONObject(k,!0),g.callbackFunction(k);break;case "labelCreatedGetInternalID":Z.Viewport&&Z.Viewport.getStatus("XMLParsedViewport")&&(k=Z.Viewport.getCurrentLabel())&&(k=k.internalID,g.callbackFunction(k));break;case "labelDrawnGetIDs":Z.Viewport&&(k=Z.Viewport.getCurrentLabel())&&g.callbackFunction(k.id,k.internalID);break;case "labelSelectedInViewportGetIDs":Z.Viewport&&(k=Z.Viewport.getCurrentLabel())&&g.callbackFunction(k.id,k.internalID);break;case "currentLabelChangedGetID":Z.Viewport&&
(k=Z.Viewport.getCurrentLabel())&&g.callbackFunction(k.id,k.internalID);break;default:g.callbackFunction()}}Z.Utils.arrayClear(b)},getContainerSize:function(a,b){var e=Z.Utils.getElementStyle(a),f=parseFloat(e.width),g=parseFloat(e.height);Z.Utils.stringValidate(e.width)&&-1!=e.width.indexOf("%")&&(f=parseFloat(Z.Utils.getElementStyleProperty(a,"width")));Z.Utils.stringValidate(e.height)&&-1!=e.height.indexOf("%")&&(g=parseFloat(Z.Utils.getElementStyleProperty(a,"height")));isNaN(f)&&(f=b.clientWidth);
isNaN(g)&&(g=b.clientHeight);if(0==f||0==g)winDimensions=Z.Utils.getWindowSize(),0==f&&(a.parentNode.style.width=winDimensions.x+"px",f=a.clientWidth),0==g&&(a.parentNode.style.height=winDimensions.y+"px",g=a.clientHeight);if(isNaN(f)||0==f)f=800;if(isNaN(g)||0==g)g=400;return new Z.Utils.Point(f,g)},createContainerElement:function(a,b,e,f,g,k,l,E,n,w,G,K,W,J,oa,ga,ma,fa){var v=document.createElement(a);this.stringValidate(b)&&(v.id=b);b=v.style;b.display=this.stringValidate(e)?e:"inline-block";b.position=
this.stringValidate(f)?f:"static";b.overflow=this.stringValidate(g)?g:"hidden";"canvas"==a?(this.stringValidate(k)&&v.setAttribute("width",k),this.stringValidate(l)&&v.setAttribute("height",l)):(this.stringValidate(k)&&(b.width=k),this.stringValidate(l)&&(b.height=l));this.stringValidate(E)&&(b.left=E);this.stringValidate(n)&&(b.top=n);b.borderStyle=this.stringValidate(w)?w:"none";b.borderWidth=this.stringValidate(G)?G:"0px";b.borderColor=this.stringValidate(fa)?fa:"#696969";b.background=this.stringValidate(K)?
K:"transparent";b.margin=this.stringValidate(W)?W:"0px";b.padding=this.stringValidate(J)?J:"0px";b.whiteSpace=this.stringValidate(oa)?oa:"normal";this.stringValidate(ga)&&(b.cursor=ga);"undefined"!==ma&&ma&&(Z.Utils.addEventListener(v,"touchstart",Z.Utils.preventDefault),Z.Utils.addEventListener(v,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(v,"contextmenu",Z.Utils.preventDefault));return v},createCenteredElement:function(a,b){var e=this.createContainerElement("div"),f=[];f[f.length]=
'<div style="#position:relative; display:table; height:100%; width:100%; border:none; margin:0px; padding:0px; overflow:hidden; text-align:left;">';f[f.length]='<div style="#position:absolute; display:table-cell; #top:50%; width:100%; border:none; margin:0px; padding:0px; vertical-align:middle;">';f[f.length]='<div id="'+b+'"; style="#position:relative; width:100%; #top:-50%; border:none; margin:0px; padding:0px; text-align:center;"></div></div></div>';e.innerHTML=f.join("");for(var f=e=e.firstChild,
g=e.getElementsByTagName("div");0<g.length;)f=g[0],g=f.getElementsByTagName("div");f.appendChild(a);return e},createTextElement:function(a,b,e,f,g,k,l,E,n,w,G,K,W,J,oa,ga,ma,fa){e=Z.Utils.createContainerElement("div","textBoxFor-"+a,"inline-block","absolute","hidden",e,f,g,k,E,n,"white","0px",l,"normal");f=document.createElement("textarea");e.appendChild(f);g=f.style;f.id=a;f.value=b;f.readOnly=w;g.width="100%";g.height="100%";g.margin="0";g.border="0";this.stringValidate(G)&&(g.fontFamily=G);this.stringValidate(K)&&
(g.fontSize=K);this.stringValidate(W)&&(g.resize=W);this.stringValidate(J)&&(f.columns=J);this.stringValidate(oa)&&(f.rows=oa);this.stringValidate(ga)&&(g.overflowX=ga);this.stringValidate(ma)&&(g.overflowY=ma);this.stringValidate(fa)&&(f.wrap="soft","off"==fa&&(g.whiteSpace="nowrap"));return e},createSelectElement:function(a,b,e,f,g,k,l,E,n,w,G){var K=document.createElement("select");K.id=a;Z.Utils.stringValidate(b)&&"none"!=b&&(K.options[0]=new Option(b,null));a=0;for(b=e.length;a<b;a++)K.options[K.options.length]=
new Option(e[a].text,e[a].value);Z.Utils.addEventListener(K,"undefined"!==typeof w&&null!==w?w:"change",n);K.size=G;e=K.style;e.width=f+"px";e.position="absolute";e.left=g+"px";e.top=k+"px";e.fontSize=null==l?"11px":l+"px";e.fontFamily="verdana";e.visibility=E;return K},updateSelectElement:function(a,b,e){if(a){var f=-1!=a.selectedIndex?a.selectedIndex:0;a.innerHTML="";for(var g=0,k=b.length;g<k;g++)a.options[a.options.length]=new Option(b[g].text,b[g].value.toString());"undefined"!==typeof e&&null!==
e&&(b=Z.Utils.arrayIndexOfObjectValue(b,"value",e),-1!=b&&(f=b));b=a.options.length-1;a.selectedIndex=f<=b?f:b}},createInputElement:function(a,b,e,f,g,k){var l=document.createElement("input");l.id=a;l.type="file";l.accept=f;l.multiple=g;l.style.visibility=e;Z.Utils.addEventListener(l,"change",function(){Z.Narrative.uploadFiles(b,this.files,k)});return l},getChildElementByID:function(a,b){for(var e=null,f=0,g=a.childNodes.length;f<g&&(e=a.childNodes[f],e.id!=b)&&(e=Z.Utils.getChildElementByID(e,b),
null===e);f++);return e},getElementPosition:function(a){for(var b=0,e=0,f="fixed"==this.getElementStyle(a).position,g=this.getOffsetParent(a,f);g;)b+=a.offsetLeft,e+=a.offsetTop,f&&(a=this.getPageScroll(),b+=a.x,e+=a.y),a=g,f="fixed"==this.getElementStyle(a).position,g=this.getOffsetParent(a,f);return new this.Point(b,e)},getOffsetParent:function(a,b){return b&&a!=document.body?document.body:a.offsetParent},getElementSize:function(a){return new this.Point(a.clientWidth,a.clientHeight)},getElementStyle:function(a){if(a.currentStyle)return a.currentStyle;
if(window.getComputedStyle)return window.getComputedStyle(a,"");this.showMessage(this.getResource("z283"))},getElementStyleProperty:function(a,b){if(window.getComputedStyle)return window.getComputedStyle(a,null).getPropertyValue(b);if(a.currentStyle)return a.currentStyle[b];this.showMessage(this.getResource("z283"))},getElementStylePropertyZIndex:function(a){var b=0;window.document.defaultView.getComputedStyle?b=window.document.defaultView.getComputedStyle(a,null).getPropertyValue("z-index"):a.currentStyle?
b=a.currentStyle["z-index"]:this.showMessage(this.getResource("z283"));return b},isElementFluid:function(a){var b=null,e=a.cloneNode(!1),f=!1,g=!1,k=null,l=null,E=0,n=0,w=Z.Utils.getElementStyle(a);w&&(E=w.width,n=w.height,b=-1!=E.indexOf("px")&&-1!=n.indexOf("px"));if(Z.browser!=Z.browsers.IE||9<=Z.browserVersion&&!b)window.getComputedStyle?value=window.getComputedStyle(e,null).width:e.currentStyle&&(value=e.currentStyle.width),"undefined"!==typeof value&&null!==value&&""!==value&&(f=-1!=value.toString().indexOf("%")||
"auto"==value),f||(window.getComputedStyle?value=window.getComputedStyle(e,null).height:e.currentStyle&&(value=e.currentStyle.height),"undefined"!==typeof value&&null!==value&&""!=value&&(g=-1!=value.toString().indexOf("%")||"auto"==value)),f||g||(k=Z.Utils.isElementFluidNew(a)),f||g||(l=0!=parseFloat(E)%1||0!=parseFloat(n)%1);return f||g||k||l},isElementFluidNew:function(a){var b=a.cloneNode(!1),e,f,g,k,l;g=f=!1;b.style.margin="0";b.style.padding="0";b.style.maxWidth="none";b.style.minWidth="none";
e=document.createElement("testContainer");e.style.display="block";e.style.width="800px";e.style.padding="0";e.style.margin="0";e.appendChild(b);a.parentNode.insertBefore(e,a);f=b.offsetWidth;e.style.width="900px";b.offsetWidth==f?(a.parentNode.removeChild(e),f=!1):(k=Math.floor(.125*f),l=Math.floor(100/900*b.offsetWidth),a.parentNode.removeChild(e),f=k==l?!0:!1);f||(b.style.margin="0",b.style.padding="0",b.style.maxHeight="none",b.style.minHeight="none",e=document.createElement("testContainer"),e.style.display=
"block",e.style.height="800px",e.style.padding="0",e.style.margin="0",e.appendChild(b),a.parentNode.insertBefore(e,a),g=b.offsetHeight,e.style.height="900px",b.offsetHeight==g?(a.parentNode.removeChild(e),g=!1):(k=Math.floor(.125*g),l=Math.floor(100/900*b.offsetHeight),a.parentNode.removeChild(e),g=k==l?!0:!1));return f||g},getEventTargetCoords:function(a){return getElementPosition(Z.Utils.target(a))},getFirstTouch:function(a){var b=null,e=a.touches;a=a.changedTouches;"undefined"!==typeof e?b=e[0]:
"undefined"!==typeof a&&(b=a[0]);return b},getSecondTouch:function(a){var b=null,e=a.touches;a=a.changedTouches;"undefined"!==typeof e?b=e[1]:"undefined"!==typeof a&&(b=a[1]);return b},getMousePosition:function(a){var b=0,e=0;"DOMMouseScroll"==a.type&&Z.browser==Z.browsers.FIREFOX&&3>Z.browserVersion?(b=a.screenX,e=a.screenY):"number"===typeof a.pageX?(b=a.pageX,e=a.pageY):"number"===typeof a.clientX?(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e=a.clientY+document.body.scrollTop+
document.documentElement.scrollTop):console.log(this.getResource("z284"));return new this.Point(b,e)},getMouseScroll:function(a){var b=0;"number"===typeof a.wheelDelta?b=a.wheelDelta:"number"===typeof a.detail?b=-1*a.detail:this.showMessage(this.getResource("z285"));return b?b/Math.abs(b):0},getPageScroll:function(){var a=0,b=0,e=document.documentElement||{},f=document.body||{};if("number"===typeof window.pageXOffset)a=window.pageXOffset,b=window.pageYOffset;else if(f.scrollLeft||f.scrollTop)a=f.scrollLeft,
b=f.scrollTop;else if(e.scrollLeft||e.scrollTop)a=e.scrollLeft,b=e.scrollTop;return new this.Point(a,b)},getScreenSize:function(){return new this.Point(screen.width,screen.height)},getWindowSize:function(){var a=0,b=0,e=document.documentElement||{},f=document.body||{};"number"===typeof window.innerWidth?(a=window.innerWidth,b=window.innerHeight):e.clientWidth||e.clientHeight?(a=e.clientWidth,b=e.clientHeight):f.clientWidth||f.clientHeight?(a=f.clientWidth,b=f.clientHeight):this.showMessage(this.getResource("z286"));
return new this.Point(a,b)},Button:function(a,b,e,f,g,k,l,E,n,w,G,K,W,J,oa,ga,ma,fa,v,C){a=Z.Utils.createContainerElement("span",a,"inline-block","absolute","hidden",l,E,n,w,J,oa,ga,ma,fa,v,C);if(Z.Utils.stringValidate(b)){var u=document.createTextNode(b);a.appendChild(Z.Utils.createCenteredElement(u));Z.Utils.setTextNodeStyle(u,"black","verdana","13px","none","normal","normal","normal","normal","1em","center","none")}else{e=Z.Utils.stringRemoveTrailingSlash(e);var D=Z.Utils.createGraphicElement(e+
"/"+f),R=Z.Utils.createGraphicElement(e+"/"+g),N=Z.Utils.createGraphicElement(e+"/"+k);D.style.width=R.style.width=N.style.width=l;D.style.height=R.style.height=N.style.height=E;D.style.position=R.style.position=N.style.position="absolute";Z.browser==Z.browsers.FIREFOX&&3>Z.browserVersion&&(D.style.top=R.style.top=N.style.top="");R.style.visibility=N.style.visibility="hidden";D.alt=R.alt=N.alt="";"undefined"!==typeof W&&Z.Utils.stringValidate(W)&&(D.alt=Z.Utils.getResource(W));a.appendChild(D);a.appendChild(R);
a.appendChild(N)}Z.Utils.addEventListener(a,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mousedown",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseup",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseout",Z.Utils.stopPropagation);"undefined"!==typeof imageUp&&(Z.Utils.addEventListener(D,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(R,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(N,
"contextmenu",Z.Utils.preventDefault));Z.Utils.addEventListener(a,"touchstart",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"touchend",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"touchcancel",Z.Utils.preventDefault);Z.Utils.stringValidate(b)||(Z.Utils.disableTextInteraction(u),Z.Utils.addEventListener(a,"contextmenu",Z.Utils.preventDefault));Z.tooltipsVisible&&Z.Utils.stringValidate(W)&&(a.title=Z.Utils.getResource(W));Z.Utils.setButtonHandler(a,G,K);this.elmt=a},buttonSize:function(a,
b,e){var f=a.style;f.width=b+"px";f.height=e+"px";e=a.firstChild;f=a.childNodes[1];a=a.childNodes[2];e&&f&&a&&(e.style.width=f.style.width=a.style.width=b+"px",e.style.height=f.style.height=a.style.height=b+"px")},setButtonDefaults:function(a){Z.Toolbar&&(Z.Utils.clearButtonSettings(a),Z.Utils.setButtonState(a,"up"),Z.Utils.setButtonHandler(a,"mouseover",Z.Toolbar.z457))},clearButtonSettings:function(a){var b=a.firstChild,e=a.childNodes[1],f=a.childNodes[2];b&&e&&f&&(b.style.visibility=e.style.visibility=
f.style.visibility="hidden",Z.Utils.removeEventListener(b,"mouseover",Z.Toolbar.z457),Z.Utils.removeEventListener(e,"mousedown",Z.Toolbar.z457),Z.Utils.removeEventListener(e,"mouseout",Z.Toolbar.z457),Z.Utils.removeEventListener(f,"mouseup",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchstart",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchend",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchcancel",Z.Toolbar.z457));Z.Utils.removeEventListener(a,"mouseover",Z.Toolbar.z457);Z.Utils.removeEventListener(a,
"mousedown",Z.Toolbar.z457);Z.Utils.removeEventListener(a,"mouseout",Z.Toolbar.z457);Z.Utils.removeEventListener(a,"mouseup",Z.Toolbar.z457)},setButtonState:function(a,b){var e="up"==b?a.firstChild:"down"==b?a.childNodes[1]:a.childNodes[2];e&&(e.style.visibility="visible")},setButtonHandler:function(a,b,e){e="undefined"!==e?e:Z.Toolbar.z457;var f="undefined"!==b?b:"mouseover";if("mouseover"==b&&"undefined"!==typeof a.firstChild)a=a.firstChild;else if("mousedown"!=b||"undefined"===typeof a.childNodes[1])"mouseup"==
b&&"undefined"!==typeof a.childNodes[2]?a=a.childNodes[2]:"mouseout"==b&&"undefined"!==typeof a.childNodes[1]&&(a=a.childNodes[1]);Z.Utils.addEventListener(a,"mousedown"==b?"touchstart":"touchend",e);Z.Utils.addEventListener(a,f,e)},Checkbox:function(a,b,e,f,g,k,l,E,n){var w=Z.Utils.createContainerElement("div","containerFor-"+a,"inline-block","absolute","hidden",e,f,g,k,"none","0px","transparent","0px","0px","normal"),G=document.createElement("input");w.appendChild(G);G.type="checkbox";G.id=a;G.value=
b;G.width=e;G.height=f;a=w.style;a.width=e+"px";a.height=f+"px";a.left=g+"px";a.top=k+"px";Z.Utils.addEventListener(G,l,E);Z.Utils.addEventListener(G,"touchstart",E);Z.tooltipsVisible&&Z.Utils.stringValidate(n)&&(G.title=Z.Utils.getResource(n));return w},Graphic:function(a,b,e,f,g,k,l,E){b=Z.Utils.stringRemoveTrailingSlash(b);b=Z.Utils.createGraphicElement(e?b+"/"+e:b);e=b.style;e.width=f;e.height=g;"undefined"!==typeof E&&Z.Utils.stringValidate(E)?b.alt=Z.Utils.getResource(E):b.alt="";e=Z.Utils.createContainerElement("span",
a,"inline-block","absolute","hidden",f,g,k,l,"none","0px","transparent","0px","0px","normal");e.appendChild(b);this.elmt=e;Z.Utils.addEventListener(b,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"touchstart",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"contextmenu",Z.Utils.preventDefault)},createGraphicElement:function(a){var b=this.createContainerElement("img"),e=null;Z.browser==Z.browsers.IE&&7>Z.browserVersion?(e=this.createContainerElement("span",null,"inline-block"),
b.onload=function(){e.style.width=e.style.width||b.width+"px";e.style.height=e.style.height||b.height+"px";b=b.onload=null},e.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'", sizingMethod="scale")'):(e=b,e.src=a);return e},graphicSize:function(a,b,e){var f=a.style;f.width=b+"px";f.height=e+"px";a=a.firstChild.style;a.width=b+"px";a.height=e+"px"},Radiobutton:function(a,b,e,f,g,k,l,E,n,w){var G=Z.Utils.createContainerElement("div","containerFor-"+a,"inline-block","absolute",
"hidden",f,g,k,l,"none","0px","transparent","0px","0px","normal"),K=document.createElement("input");G.appendChild(K);K.type="radio";K.id=a;K.name=b;K.value=e;K.width=f;K.height=g;a=G.style;a.width=f+"px";a.height=g+"px";a.left=k+"px";a.top=l+"px";null!==E&&null!==n&&(Z.Utils.addEventListener(K,E,n),Z.Utils.addEventListener(K,"radioEvnt",n));Z.tooltipsVisible&&Z.Utils.stringValidate(w)&&(K.title=Z.Utils.getResource(w));return G},Slider:function(a,b,e,f,g,k){var l=Z.Utils.stringUpperCaseFirstLetter(a),
E=a.toUpperCase(),n=Z.Utils.createContainerElement("div","label"+l+"TextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),w=document.createTextNode(Z.Utils.getResource("UI_IMAGEFILTERPANELLABEL"+E));n.appendChild(w);b.appendChild(n);n=new Z.Utils.Graphic("trackSliderFilter"+l,Z.skinPath,e[15],"1px","1px","0px","0px","z385"+E);b.appendChild(n.elmt);Z.Utils.addEventListener(n.elmt,"mousedown",f);Z.Utils.addEventListener(n.elmt,"touchstart",
f);Z.Utils.addEventListener(n.elmt,"mouseover",f);n=new Z.Utils.Button("buttonSliderFilter"+l,null,Z.skinPath,e[17],e[18],e[19],"1px","1px","1px","1px","mouseover",f,"z385"+E);b.appendChild(n.elmt);k&&(n=new Z.Utils.Button("buttonSliderFilter"+l+"2",null,Z.skinPath,e[17],e[18],e[19],"1px","1px","1px","1px","mouseover",f,"z385"+E+"2"),b.appendChild(n.elmt));e=Z.Utils.createTextElement(a+"TextElement","0","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden",
"off");Z.Utils.addEventListener(e.firstChild,"focus",g);Z.Utils.addEventListener(e.firstChild,"input",g);Z.Utils.addEventListener(e.firstChild,"change",g);Z.Utils.addEventListener(e.firstChild,"blur",g);b.appendChild(e);k&&(e=Z.Utils.createTextElement(a+"TextElement2","0","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off"),Z.Utils.addEventListener(e.firstChild,"focus",g),Z.Utils.addEventListener(e.firstChild,"input",g),Z.Utils.addEventListener(e.firstChild,
"change",g),Z.Utils.addEventListener(e.firstChild,"blur",g),b.appendChild(e))},Point:function(a,b){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0},Point3D:function(a,b,e){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0;this.z="number"===typeof e?e:0},Coordinates:function(a,b,e,f){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0;this.z="number"===typeof e?e:0;this.r="number"===typeof f?f:0},CoordinatesDisplayStyle:function(a,b,e,f,g,k,l,E,n,w,G){this.cLeft=
a;this.cTop=b;this.vWidth=e;this.vHeight=f;this.vLeft=g;this.vTop=k;this.bWidth=l;this.bHeight=E;this.bLeft=n;this.bTop=w;this.cRotation=G},Pair:function(a,b){this.a=a;this.b=b},Trio:function(a,b,e){this.a=a;this.b=b;this.c=e},Range:function(a,b){this.start="number"===typeof a?a:0;this.end="number"===typeof b?b:0},RangeScale:function(a,b){this.min="number"===typeof a?a:0;this.max="number"===typeof b?b:0},swapZIndices:function(a,b){var e=Z.Utils.getElementStylePropertyZIndex(a),f=Z.Utils.getElementStylePropertyZIndex(b);
if("auto"==e||"auto"==f)e=(Z.baseZIndex-101).toString(),f=(Z.baseZIndex-100).toString();a.style.zIndex=f;b.style.zIndex=e},stringValidate:function(a){return"undefined"!==typeof a&&null!==a&&""!==a&&"null"!==a},stringEscapeSpaces:function(a){var b=RegExp("_","g");a=a.replace(b,"__");b=RegExp(" ","g");return a=a.replace(b,"_")},stringUnescapeSpaces:function(a){var b=RegExp("__","g");a=a.replace(b,"_");b=RegExp("_","g");return a=a.replace(b," ")},stringGetInitials:function(a){var b="";a&&(b=a.replace(/[^a-zA-Z- ]/g,
"").match(/\b\w/g).join("").toUpperCase());return b},stringGetRelativePath:function(a,b){var e=a;a&&b&&(e="/"==a.slice(0,1)?0:a.split("/").length-1,e=Z.Utils.stringMultiply("../",e)+b);return e},stringLowerCaseFirstLetter:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},stringUpperCaseFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},stringMultiply:function(a,b){var e=Math.ceil(Math.log(b)/Math.LN2),f=a;do f+=f;while(0<--e);return f.slice(0,a.length*b)},stringPadFront:function(a,
b,e){return a=Z.Utils.stringMultiply(e,b-a.length)+a},stringRemoveLeadingZeros:function(a){var b="";"undefined"!==typeof a&&null!==a&&(b=1<a.length&&"0"==a.slice(0,1)&&"."!=a.slice(1,2)?a.slice(1,a.length):a);return b},stringRemoveDuplicateDots:function(a){var b="";if("undefined"!==typeof a&&null!==a){var e=a.indexOf("."),b=a.replace(/\./g,"");-1!=e&&(b=b.slice(0,e)+"."+b.slice(e))}return b},stringValidateTrailingSlashCharacter:function(a){"undefined"===typeof a&&null===a||"/"==a[a.length-1]||(a+=
"/");return a},stringRemoveTrailingSlash:function(a){return"undefined"===typeof a||null===a?"":"/"==a.slice(-1,a.length)?a.slice(0,a.length-1):a},stringRemoveTrailingSpace:function(a){return"undefined"===typeof a||null===a?"":" "==a.slice(-1,a.length)?a.slice(0,a.length-1):a},stringRemoveNestedSpace:function(a,b){var e=a;if("undefined"!==typeof a&&Z.Utils.stringValidate(a)){var f=a.indexOf(b);" "==a.substring(f-1,f)&&(e=a.slice(0,f-1)+a.slice(f))}return e},stringRemoveNestedString:function(a,b){var e=
a;if("undefined"!==typeof a&&Z.Utils.stringValidate(a))var e=a.indexOf(b),f=e+b.length,e=a.slice(0,e)+stringClean.slice(f);return e},stringValidateURLScheme:function(a){"undefined"!==typeof a&&null!==a&&"www"==a.slice(0,3)&&(a="http://"+a);return a},stringRemoveFileExtension:function(a){var b=a.length;"."==a.slice(b-4,b-3)&&(a=a.slice(0,b-4));return a},stringRemoveTabAndLineWrapCharacters:function(a){a=a.replace(/\n/g,"");a=a.replace(/\r/g,"");return a=a.replace(/\t/g,"")},stringUnescapeAmpersandCharacters:function(a){a=
a.replace(/\n/g,"");a=a.replace(/&#38;/g,"&");a=a.replace(/&#038;/g,"&");return a=a.replace(/&amp;/g,"&")},setHTMLTextDefaultCaptionStyle:function(a,b,e,f,g,k,l,E,n,w,G,K,W){a=a.style;-1==b.indexOf("color=")&&(a.color=e);-1==b.indexOf("font-family=")&&(a.fontFamily=f);-1==b.indexOf("font-size=")&&(a.fontSize=g);-1==b.indexOf("font-size-adjust=")&&(a.fontSizeAdjust=k);-1==b.indexOf("font-style=")&&(a.fontStyle=l);-1==b.indexOf("font-stretch=")&&(a.fontStretch=E);-1==b.indexOf("font-variant=")&&(a.fontVariant=
n);-1==b.indexOf("font-weight=")&&(a.fontWeight=w);-1==b.indexOf("line-height=")&&(a.lineHeight=G);-1==b.indexOf("text-align=")&&(a.textAlign=K);-1==b.indexOf("text-decoration=")&&(a.textDecoration=W)},setHTMLTextStyle:function(a,b,e,f,g,k,l,E,n,w,G,K){a=a.style;a.color=b;a.fontFamily=e;a.fontSize=f;a.fontSizeAdjust=g;a.fontStyle=k;a.fontStretch=l;a.fontVariant=E;a.fontWeight=n;a.lineHeight=w;a.textAlign=G;a.textDecoration=K},setTextAreaStyle:function(a,b,e,f,g,k,l,E,n,w,G,K,W){a=a.firstChild.style;
a.color=b;a.fontFamily=e;a.fontSize=f;a.fontSizeAdjust=g;a.fontStyle=k;a.fontStretch=l;a.fontVariant=E;a.fontWeight=n;a.lineHeight=w;a.textAlign=G;a.textDecoration=K;a.padding=W},setTextNodeStyle:function(a,b,e,f,g,k,l,E,n,w,G,K){a=a.parentNode.style;a.color=b;a.fontFamily=e;a.fontSize=f;a.fontSizeAdjust=g;a.fontStyle=k;a.fontStretch=l;a.fontVariant=E;a.fontWeight=n;a.lineHeight=w;a.textAlign=G;a.textDecoration=K},stringValidateNumberValue:function(a){var b="";"undefined"!==typeof a&&Z.Utils.stringValidate(a)&&
(b=a.replace(/(?!^-)[^0-9.]/g,""),b=Z.Utils.stringRemoveLeadingZeros(b),b=Z.Utils.stringRemoveDuplicateDots(b));return b},stringValidateColorValue:function(a){Z.Utils.stringValidate(a)?0!=a.indexOf("#")&&(a="#"+a):a="#000000";/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a)||(a="#000000");return a},hexToRGB:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,e,f,g){return e+e+f+f+g+g});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],
16),b:parseInt(a[3],16)}:null},htmlGetSelection:function(){var a="";if("undefined"!=typeof window.getSelection){var b=window.getSelection();if(b.rangeCount){for(var a=document.createElement("div"),e=0,f=b.rangeCount;e<f;++e)a.appendChild(b.getRangeAt(e).cloneContents());a=a.innerHTML}}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(a=document.selection.createRange().htmlText);return a},htmlHighlightSelection:function(a){Z.Utils.htmlReplaceSelection(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTSTART")+
a+Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTEND"))},htmlClearHighlight:function(a){a&&(a=a.replace(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTSTART"),"").replace(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTEND"),""));return a},htmlCreateURLLink:function(a,b,e,f){a&&(e=Z.Utils.stringRemoveTrailingSpace(e),f=Z.Utils.stringValidateURLScheme(f),f='<a href="'+f+'" target="_blank" >'+e+"</a>",a=a.substring(0,b)+f+a.substring(b+e.length));return a},htmlClearLinkFromSelection:function(){var a=
Z.Utils.htmlGetSelection();if(Z.Utils.stringValidate(a)){var b=null;-1!=a.indexOf(".zif');\">")?b=a.indexOf("zif');\">")+8:-1!=a.indexOf('_blank">')?b=a.indexOf('_blank">')+8:-1!=a.indexOf('clearLabelHighlightsAll(true)">')&&(b=a.indexOf('clearLabelHighlightsAll(true)">')+23);if(b){var e=a.indexOf("</a>");Z.Utils.htmlReplaceSelection(a.substring(b,e))}}},htmlReplaceSelection:function(a){if(a){var b;if(window.getSelection&&window.getSelection().getRangeAt){b=window.getSelection().getRangeAt(0);b.deleteContents();
var e=document.createElement("div");e.innerHTML=a;a=document.createDocumentFragment();for(var f;f=e.firstChild;)a.appendChild(f);b.insertNode(a)}else document.selection&&document.selection.createRange&&(b=document.selection.createRange(),b.pasteHTML(a))}},htmlClearSelection:function(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},htmlGetSelectionParagraphNode:function(){var a=null,b=window.getSelection?window.getSelection():document.selection?
document.selection.createRange():null;if(b){for(b=b.anchorNode;null!=b&&"p"!=b.localName&&"P"!=b.localName;)b=b.parentNode;b&&(a=b)}return a},htmlGetSelectionParagraphText:function(){var a="";Z.Utils.htmlGetSelectionParagraphNode()&&(a=parent.innerText||parent.textContent);return a},xmlConvertTextToDoc:function(a){var b=null;if(window.ActiveXObject)try{b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)}catch(e){this.showMessage(e.name+this.getResource("z244")+e.message)}else if(window.DOMParser)try{b=
(new DOMParser).parseFromString(a,"text/xml")}catch(e){this.showMessage(e.name+this.getResource("z244")+e.message)}else this.showMessage(this.getResource("z294"));return b},xmlConvertDocToText:function(a){var b=null;if(window.ActiveXObject)try{b=a.xml}catch(e){this.showMessage(e.name+this.getResource("z243")+e.message)}else if(window.DOMParser)try{b=(new XMLSerializer).serializeToString(a)}catch(e){this.showMessage(e.name+this.getResource("z243")+e.message)}else this.showMessage(this.getResource("z294"));
return b},xmlEscapeMinimal:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\r?\n/g,"%0A"));return b},xmlUnescapeMinimal:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/%0A/g,"\n").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"));return b},xmlEscapeMore:function(a){var b=null;"undefined"!==
typeof a&&null!==a&&(b=a.replace(/&/g,"&amp;").replace(/;/g,"&semi;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\r?\n/g,"%0A").replace(/,/g,"&comma;").replace(/:/g,"&colon;"));return b},xmlUnescapeMore:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/&colon;/g,":").replace(/&comma;/g,",").replace(/%0A/g,"\n").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&semi;/g,";").replace(/&amp;/g,
"&"));return b},xmlEscapingConvertURIToHTML:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/%0A/g,"\n").replace(/%40/g,"&#64;").replace(/%23/g,"&#35;").replace(/%24/g,"&#36;").replace(/%25/g,"&#37;").replace(/%5E/g,"&#94;").replace(/%26/g,"&#38;").replace(/%3D/g,"&#61;").replace(/%2B/g,"&#43;").replace(/%3A/g,"&#58;").replace(/%3B/g,"&#59;").replace(/%22/g,"&#34;").replace(/%5C/g,"&#92;").replace(/%2F/g,"&#47;").replace(/%3F/g,"&#63;").replace(/%3C/g,"&#60;").replace(/%3E/g,
"&#62;").replace(/%5B/g,"&#91;").replace(/%5D/g,"&#93;").replace(/%7B/g,"&#123;").replace(/%7D/g,"&#125;").replace(/%60/g,"&#96;").replace(/%27/g,"&#39;"));return b},xmlEscapingConvertHTMLToURI:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/\n/g,"%0A").replace(/&apos;/g,"%27").replace(/&quot;/g,"%22").replace(/&gt;/g,"%3E").replace(/&lt;/g,"%3C").replace(/&amp;/g,"%26").replace(/&#64;/g,"%40").replace(/&#35;/g,"%23").replace(/&#36;/g,"%24").replace(/&#37;/g,"%25").replace(/&#94;/g,
"%5E").replace(/&#38;/g,"%26").replace(/&#61;/g,"%3D").replace(/&#43;/g,"%2B").replace(/&#58;/g,"%3A").replace(/&#59;/g,"%3B").replace(/&#34;/g,"%22").replace(/&#92;/g,"%5C").replace(/&#47;/g,"%2F").replace(/&#63;/g,"%3F").replace(/&#60;/g,"%3C").replace(/&#62;/g,"%3E").replace(/&#91;/g,"%5B").replace(/&#93;/g,"%5D").replace(/&#123;/g,"%7B").replace(/&#125;/g,"%7D").replace(/&#96;/g,"%60").replace(/&#39;/g,"%27"));return b},jsonConvertObjectToDataProvider:function(a){for(var b=[],e=0,f=a.length;e<
f;e++){var g=a[e],g=g.substring(g.indexOf("../../")+6,g.length),k=g.substring(g.lastIndexOf("/")+1,g.lastIndexOf("."));b[b.length]={text:k,value:g,poiID:"0"}}return b},jsonConvertObjectToXMLText:function(a){var b=function(a,e){var f="";if(a instanceof Array)for(var E=0,n=a.length;E<n;E++)f+=b(a[E],e)+"\n";else if("object"===typeof a){E=!1;f+="<"+e;for(n in a)"object"!==typeof a[n]?f+=" "+n+'="'+a[n].toString()+'"':E=!0;f+=">";if(E)for(n in a)"#text"==n?f+=a[n]:"object"===typeof a[n]&&(f+=b(a[n],n));
f+="</"+e+">"}else f+="<"+e+">"+a.toString()+"</"+e+">";return f},e="",f;for(f in a)e+=b(a[f],f);return e.replace(/&/g,"&amp;").replace(/\t|\n/g,"")},jsonConvertXMLTextToJSONText:function(a){var b={convertToObject:function(a){var f={};if(1==a.nodeType){if(a.attributes.length)for(var g=0,k=a.attributes.length;g<k;g++)f[a.attributes[g].nodeName]=(a.attributes[g].nodeValue||"").toString();if(a.firstChild){for(var g=0,k=!1,l=a.firstChild;l;l=l.nextSibling)1==l.nodeType?k=!0:3==l.nodeType&&l.nodeValue.match(/[^ \f\n\r\t\v]/)&&
g++;if(k)if(2>g)for(b.reduceWhitespace(a),l=a.firstChild;l;l=l.nextSibling)3==l.nodeType?f["#text"]=b.escapeMinimal(l.nodeValue):f[l.nodeName]?f[l.nodeName]instanceof Array?f[l.nodeName][f[l.nodeName].length]=b.convertToObject(l):f[l.nodeName]=[f[l.nodeName],b.convertToObject(l)]:f[l.nodeName]=b.convertToObject(l);else a.attributes.length?f["#text"]=b.escapeMinimal(b.innerXML(a)):f=b.escapeMinimal(b.innerXML(a));else g&&(a.attributes.length?f["#text"]=b.escapeMinimal(b.innerXML(a)):f=b.escapeMinimal(b.innerXML(a)))}a.attributes.length||
a.firstChild||(f=null)}else 9==a.nodeType?f=b.convertToObject(a.documentElement):alert("This node type not supported : "+a.nodeType);return f},convertToJSONText:function(a,f){var g=f?'"'+f+'"':"";if(a instanceof Array){for(var k=0,l=a.length;k<l;k++)a[k]=b.convertToJSONText(a[k],"","\t");g+=(f?":[":"[")+(1<a.length?"\n\t"+a.join(",\n\t")+"\n":a.join(""))+"]"}else if(null==a)g+=(f&&":")+"null";else if("object"===typeof a){k=[];for(l in a)k[k.length]=b.convertToJSONText(a[l],l,"\t");g+=(f?":{":"{")+
(1<k.length?"\n\t"+k.join(",\n\t")+"\n":k.join(""))+"}"}else g="string"==typeof a?g+((f&&":")+'"'+a.toString()+'"'):g+((f&&":")+a.toString());return g},reduceWhitespace:function(a){a.normalize();for(var f=a.firstChild;f;)if(3==f.nodeType)if(f.nodeValue.match(/[^ \f\n\r\t\v]/))f=f.nextSibling;else{var g=f.nextSibling;a.removeChild(f);f=g}else 1==f.nodeType&&b.reduceWhitespace(f),f=f.nextSibling;return a},escapeMinimal:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,
"\\n").replace(/[\r]/g,"\\r")},innerXML:function(a){var b="";if("innerHTML"in a)b=a.innerHTML;else{var g=function(a){var b="";if(1==a.nodeType){for(var b=b+("<"+a.nodeName),e=0,f=a.attributes.length;e<f;e++)b+=" "+a.attributes[e].nodeName+"='"+(a.attributes[e].nodeValue||"").toString()+"'";if(a.firstChild){b+=">";for(e=a.firstChild;e;e=e.nextSibling)b+=g(e);b+="</"+a.nodeName+">"}else b+="/>"}else 3==a.nodeType&&(b+=a.nodeValue);return b};for(a=a.firstChild;a;a=a.nextSibling)b+=g(a)}return b}};9==
a.nodeType&&(xml=xml.documentElement);return jsonTextOut="{\n  "+b.convertToJSONText(b.convertToObject(b.reduceWhitespace(a)),a.nodeName,"\t").replace(/\t/g,"  ")+"\n}"},arrayClear:function(a){if(a)for(;0<a.length;)a.pop()},arrayClearObjectValue:function(a,b){for(var e=0,f=a.length;e<f;e++)a[e][b]=null},arrayClone:function(a,b,e){e=[];switch(a){case "pois":a=0;for(var f=b.length;a<f;a++)e[e.length]={text:b[a].text,value:b[a].value,id:b[a].id,x:b[a].x,y:b[a].y,z:b[a].z,user:b[a].user,date:b[a].date,
editable:b[a].editable};break;case "labels":a=0;for(f=b.length;a<f;a++)e[e.length]={text:b[a].text,value:b[a].value,poiID:b[a].poiID,editable:b[a].editable};break;case "hotspots":a=0;for(f=b.length;a<f;a++)e[e.length]={id:b[a].id,name:b[a].name,mediaType:b[a].mediaType,media:b[a].media,audio:b[a].audio,x:b[a].x,y:b[a].y,z:b[a].z,xScale:b[a].xScale,yScale:b[a].yScale,radius:b[a].radius,zMin:b[a].zMin,zMax:b[a].zMax,clickURL:b[a].clickURL,urlTarget:b[a].urlTarget,rollover:b[a].rollover,caption:b[a].caption,
tooltip:b[a].tooltip,textColor:b[a].textColor,backColor:b[a].backColor,lineColor:b[a].lineColor,fillColor:b[a].fillColor,textVisible:b[a].textVisible,backVisible:b[a].backVisible,lineVisible:b[a].lineVisible,fillVisible:b[a].fillVisible,captionPosition:b[a].captionPosition,saved:b[a].saved,visibility:b[a].visibility,internalID:b[a].internalID,poiID:b[a].poiID,captionHTML:b[a].captionHTML,tooltipHTML:b[a].tooltipHTML,polyClosed:b[a].polyClosed,polygonPts:b[a].polygonPts,showFor:b[a].showFor,transition:b[a].transition,
changeFor:b[a].changeFor,rotation:b[a].rotation,editable:b[a].editable,popup:b[a].popup,popupOffsetX:b[a].popupOffsetX,popupOffsetY:b[a].popupOffsetY,comment:b[a].comment,user:b[a].user,date:b[a].date,w:b[a].w,h:b[a].h,image:b[a].image,lineStyle:b[a].lineStyle};break;case "polygon":a=0;for(f=b.length;a<f;a++)e[e.length]={x:b[a].x,y:b[a].y};break;case "notes":a=0;for(f=b.length;a<f;a++)e[e.length]={text:b[a].text,value:b[a].value,noteText:b[a].noteText,poiID:b[a].poiID,id:b[a].id,user:b[a].user,date:b[a].date,
editable:b[a].editable};break;case "magnifications":for(a=0,f=b.length;a<f;a++)e[e.length]={text:b[a].text,value:b[a].value}}return e},arrayImageLoadingValidate:function(a){var b=!1;if(a&&0<a.length)for(var b=!0,e=0,f=a.length;e<f;e++)if(null===a[e]||0==a[e].image.width||0==a[e].image.height)b=!1;return b},arrayIndexOf:function(a,b,e){e?0>e&&(e=Math.max(0,a.length+e)):e=0;for(var f=a.length;e<f;e++)if(a[e]===b)return e;return-1},arrayIndexOfObjectValue:function(a,b,e,f){if("undefined"!==typeof a){f?
0>f&&(f=Math.max(0,a.length+f)):f=0;for(var g=a.length;f<g;f++)if(a[f][b]===e)return f}return-1},arrayIndexOfObjectTwoValues:function(a,b,e,f,g,k){if("undefined"!==typeof a){f?0>f&&(f=Math.max(0,a.length+f)):f=0;for(var l=a.length;f<l;f++)if(a[f][b]===e&&a[f][g].toString()===k.toString())return f}return-1},arrayIndexOfSubstring:function(a,b,e){e?0>e&&(e=Math.max(0,a.length+e)):e=0;for(var f=a.length;e<f;e++)if(-1!=a[e].indexOf(b))return e;return-1},arrayIndexOfObjectValueSubstring:function(a,b,e,
f,g){f?0>f&&(f=Math.max(0,a.length+f)):f=0;for(var k=a.length;f<k;f++)if(g){if(-1!=a[f][b].toLowerCase().indexOf(e))return f}else if(-1!=a[f][b].indexOf(e))return f;return-1},arrayIntersect:function(a,b){for(var e,f,g,k=[],l=0,E=a.length;l<E;l++){e=a[l];g=!1;for(var n=0,w=b.length;n<w&&e>=(f=b[n]);n++)if(f==e){g=!0;break}g&&(k[k.length]=a[l])}return k},arrayMap:function(a,b){var e=[];if(Z.arrayMapSupported)e=a.map(b);else for(var f=0,g=a.length;f<g;f++)e[f]=b(a[f]);return e},arraySplice:function(a,
b,e){if(Z.arraySpliceSupported)if(3<arguments.length)for(var f=3,g=arguments.length;f<g;f++)a.splice(b,e,arguments[f]);else a.splice(b,e);else{0>e&&(e=0);var k=[];if(3<arguments.length)for(f=3,g=arguments.length;f<g;f++)k[k.length]=arguments[f];for(var f=Z.Utils.arraySubarray(a,0,b),l=Z.Utils.arraySubarrayLen(a,b,e),g=Z.Utils.arraySubarray(a,b+e),k=f.concat(k,g),f=a.length=0,g=k.length;f<g;f++)a[a.length]=k[f];a=l}return a},arraySubarraySimple:function(a,b){return this.slice(a,b)},arraySortNumericAscending:function(a,
b,e){a.sort(function(a,b){return a-b});return a},arraySortNumericDescending:function(a,b,e){a.sort(function(a,b){return b-a});return a},arraySortByObjectValue:function(a,b,e,f){a.sort(function(a,e){return a[b]>e[b]});return a},arraySubarray:function(a,b,e){0>b&&(b=0);if(!e||e>a.length)e=a.length;if(b==e)return[];for(var f=[];b<e;b++)f[f.length]=a[b];return f},arraySubarrayLen:function(a,b,e){if(b>=a.length||e&&0>=e)return[];0>b&&(b=Math.abs(b)>a.length?0:a.length+b);if(!e||e+b>a.length)e=a.length-
b;for(var f=[],g=b;g<b+e;g++)f[f.length]=a[g];return f},arraySubtract:function(a,b){for(var e=a.slice(0),f=0,g=e.length;f<g;f++){for(var k=e[f],l=!1,E=0,n=b.length;E<n&&k>=(elmt2=b[E]);E++)if(elmt2==k){l=!0;break}l&&(e=Z.Utils.arraySplice(e,f--,1))}return e},arrayToArrayOfStrings:function(a){for(var b=[],e=0,f=a.length;e<f;e++)b[e]="undefined"!==typeof a[e]&&"undefined"!=a[e]&&null!==a[e]?a[e].toString():"";return b},arrayUnique:function(a){for(var b=1;b<a.length;)a[b-1]==a[b]?a=Z.Utils.arraySplice(a,
b,1):b++;return a},arrayUniqueByObjectValue:function(a,b){if("undefined"!==typeof a)for(var e=1;e<a.length;)a[e-1][b]==a[e][b]?a=Z.Utils.arraySplice(a,e,1):e++;return a},dataSlice:function(a,b,e){var f=e-b;e=new ArrayBuffer(e-b);e=new Uint8Array(e);for(var g=0;g<f;g++)e[g]=a[b+g];return e},playAudio:function(a,b){Z.audioMuted||Z.slideshowStopping||Z.tourStop||("undefined"!==typeof a&&null!==a?(a.play(),destinationNextAudio=null):Z.Utils.stringValidate(b)&&(Z.audioPlaying=new Audio(b),Z.audioPlaying.play()))},
loadAudio:function(a){Z.Utils.stringValidate(a)&&(destinationNextAudio=new Audio(a),destinationNextAudio.load())},stopAudio:function(a){"undefined"!==typeof a&&null!==a?(a.pause(),a.currentTime=0):("undefined"!==typeof Z.audioPlaying&&null!==Z.audioPlaying&&(Z.audioPlaying.pause(),Z.audioPlaying.currentTime=0),"undefined"!==typeof destinationNextAudio&&null!==destinationNextAudio&&(destinationNextAudio.pause(),destinationNextAudio.currentTime=0))},convertZoomPercentToMagnification:function(a,b,e){a=
a*b/100;e&&(a=1.5>a?1.25:2>a?1.5:2.5>a?2:4>a?2.5:5>a?4:10>a?5:16>a?10:20>a?16:25>a?20:32>a?25:40>a?32:50>a?40:60>a?50:100>a?60:150>a?100:250>a?150:250);return a},calculatePointsDistance:function(a,b,e,f){return Math.sqrt((a-=e)*a+(b-=f)*b)},convertPixelsToUnits:function(a,b,e){var f=1;"undefined"!==typeof b&&null!==b&&0!=b?f=b:"undefined"!==typeof e&&null!==e&&0!=e&&(f=Z.imageW/e);return a/f},polygonArea:function(a,b,e,f){if("undefined"===typeof f||null===f)f=4;a=a.slice(0);b?a[a.length]={x:a[0].x,
y:a[0].y}:"undefined"!==typeof e&&null!==e&&(a[a.length]={x:e.x,y:e.y});for(var g=e=b=0,k=a.length-1;g<k;g++)b+=a[g].x*a[g+1].y,e+=a[g].y*a[g+1].x;a=Z.Utils.convertPixelsToUnits((b-e)/2,Z.pixelsPerUnit,Z.unitsPerImage);a=Z.Utils.convertPixelsToUnits(a,Z.pixelsPerUnit,Z.unitsPerImage);return a=Z.Utils.roundToFixed(Math.abs(a),f)},polygonCenter:function(a,b,e,f){var g=0,k=0;if("undefined"!==typeof a&&null!==a&&0<a.length)if(k=a.slice(0),f)if(2==a.length)g=k[0],k=k[1];else{k[k.length]=[k[0][0],k[0][1]];
g=k[0];e=g[0];a=g[1];f=g[0];b=g[1];for(var l=1,E=k.length;l<E;l++)g=k[l],e=Math.min(e,g[0]),a=Math.min(a,g[1]),f=Math.max(f,g[0]),b=Math.max(b,g[1]);g=e+(f-e)/2;k=a+(b-a)/2}else{b?k[k.length]={x:k[0].x,y:k[0].y}:"undefined"!==typeof e&&null!==e&&(k[k.length]={x:e.x,y:e.y});g=k[0];e=g.x;a=g.y;f=g.x;b=g.y;l=1;for(E=k.length;l<E;l++)g=k[l],e=Math.min(e,g.x),a=Math.min(a,g.y),f=Math.max(f,g.x),b=Math.max(b,g.y);g=e+(f-e)/2;k=a+(b-a)/2}return new Z.Utils.Point(g,k)},PolygonDimensions:function(a,b){var e=
0,f=0;if("undefined"!==typeof a&&null!==a&&0<a.length){e=a.slice(0);"undefined"!==typeof b&&null!==b&&(e[e.length]={x:b.x+.1*(e[e.length-1].x-b.x),y:b.y+.1*(e[e.length-1].y-b.y)});for(var g=e[0].x,f=e[0].y,k=e[0].x,l=e[0].y,E=1,n=e.length;E<n;E++)e[E].x<g&&(g=e[E].x),e[E].x>k&&(k=e[E].x),e[E].y<f&&(f=e[E].y),e[E].y>l&&(l=e[E].y);e=k-g;f=l-f}this.w=e;this.h=f},polygonPerimeter:function(a,b,e,f){if("undefined"===typeof f||null===f)f=5;a=a.slice(0);b?a[a.length]={x:a[0].x,y:a[0].y}:"undefined"!==typeof e&&
null!==e&&(a[a.length]={x:e.x,y:e.y});e=b=0;for(var g=a.length-1;e<g;e++)b+=Z.Utils.calculatePointsDistance(a[e].x,a[e].y,a[e+1].x,a[e+1].y);b=Z.Utils.convertPixelsToUnits(b,Z.pixelsPerUnit,Z.unitsPerImage);return b=Z.Utils.roundToFixed(Math.abs(b),f)},fullScreenView:function(a,b,e){if("undefined"===typeof e||null===e)e=!1;if(b){b=document.documentElement;var f=null;b.requestFullScreen?(a.requestFullScreen(),f="fullscreenchange"):b.mozRequestFullScreen?(a.mozRequestFullScreen(),f="mozfullscreenchange"):
b.webkitRequestFullScreen?(a.webkitRequestFullScreen(),f="webkitfullscreenchange"):b.msRequestFullscreen&&(a.msRequestFullscreen(),f="MSFullscreenChange");f&&Z.Utils.addEventListener(document,f,Z.Viewport.fullScreenEscapeHandler)}else document.cancelFullScreen?(e||document.cancelFullScreen(),f="fullscreenchange"):document.mozCancelFullScreen?(e||document.mozCancelFullScreen(),f="mozfullscreenchange"):document.webkitCancelFullScreen?(e||document.webkitCancelFullScreen(),f="webkitfullscreenchange"):
document.msExitFullscreen&&(e||document.msExitFullscreen(),f="MSFullscreenChange"),f&&Z.Utils.removeEventListener(document,f,Z.Viewport.fullScreenEscapeHandler)},rotatePoint:function(a,b,e){var f=Math.PI/180*-e;e=a*Math.cos(f)-b*Math.sin(f);a=a*Math.sin(f)+b*Math.cos(f);return new Z.Utils.Point(e,a)},rotatePointOffCenter:function(a,b,e,f,g){g=g*Math.PI/180;e-=a;var k=f-b;f=e*Math.cos(g)-k*Math.sin(g);g=e*Math.sin(g)+k*Math.cos(g);return new Z.Utils.Point(f+a,g+b)},rotateElement:function(a,b,e){if(b!=
Z.imageR||e)b="rotate("+b.toString()+"deg)",a.transform=b,a.msTransform=b,a.mozTransform=b,a.webkitTransform=b,a.oTransform=b},getElementRotation:function(a){a=window.getComputedStyle(a,null);var b=(a.getPropertyValue("-webkit-transform")||a.getPropertyValue("-moz-transform")||a.getPropertyValue("-ms-transform")||a.getPropertyValue("-o-transform")||a.getPropertyValue("transform")||"error failure").split("(")[1],b=b.split(")")[0],b=b.split(",");a=b[0];b=b[1];a=Math.sqrt(a*a+b*b);return Math.round(Math.asin(b/
a)*(180/Math.PI))},getPositionRotated:function(a,b,e,f,g){if("undefined"===typeof g||null===g)g=Z.imageR;0>g&&(g+=360);g=g*Math.PI/180;a-=e;var k=b-f;b=a*Math.cos(g)-k*Math.sin(g);g=a*Math.sin(g)+k*Math.cos(g);e=Math.round(b+e);f=Math.round(g+f);return new Z.Utils.Point(e,f)},getDisplayPositionRotated:function(a,b){if("undefined"===typeof b||null===b)b=Z.imageR;0>b&&(b+=360);var e=parseFloat(a.left),f=parseFloat(a.top),g=parseFloat(a.width),k=parseFloat(a.height);return Z.Utils.getPositionRotated(e,
f,e+g/2,f+k/2,b)},translateElement:function(a,b,e){b="translate("+b.toString()+"px,"+e.toString()+"px)";a.transform=b;a.msTransform=b;a.mozTransform=b;a.webkitTransform=b;a.oTransform=b},scaleElement:function(a,b){var e="scale("+b.toString()+")";a.transform=e;a.msTransform=e;a.mozTransform=e;a.webkitTransform=e;a.oTransform=e},updateRotationForLegacyMedia:function(a){var b=0;switch(a){case "arrowDownLeft":b+=45;break;case "arrowLeft":b+=90;break;case "arrowUpLeft":b+=135;break;case "arrowUp":b+=180;
break;case "arrowUpRight":b+=225;break;case "arrowRight":b+=270;break;case "arrowDownRight":b+=315;break;case "lineHorizontal":b+=90}return b},filterImage:function(a,b,e,f){if(b){var g=a.width,k=a.height,l=a.data;"2"==b.substring(b.length-1)&&(b=b.substring(0,b.length-1));switch(b){case "brightness":if("undefined"===typeof e||null===e)e=40;f=0;for(b=l.length;f<b;f+=4)l[f]+=e,l[f+1]+=e,l[f+2]+=e;break;case "contrast":if("undefined"===typeof e||null===e)e=10;f=0;for(b=l.length;f<b;f+=4){var E=Math.round((l[f]+
l[f+1]+l[f+2])/3);127<E?(l[f]+=l[f]/E*e,l[f+1]+=l[f+1]/E*e,l[f+2]+=l[f+2]/E*e):(l[f]-=l[f]/E*e,l[f+1]-=l[f+1]/E*e,l[f+2]-=l[f+2]/E*e)}break;case "colorRed":if("undefined"===typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4)l[f]+=e;break;case "colorGreen":if("undefined"===typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4)l[f+1]+=e;break;case "colorBlue":if("undefined"===typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4)l[f+2]+=e;break;case "colorRedRange":if("undefined"!==typeof e&&null!==e&&"undefined"!==
typeof f&&null!==f)for(g=f,f=0,b=l.length;f<b;f+=4)k=l[f],k=k<e?e:k>g?g:k,l[f]=k;break;case "colorGreenRange":if("undefined"!==typeof e&&null!==e&&"undefined"!==typeof f&&null!==f)for(g=f,f=0,b=l.length;f<b;f+=4)k=l[f+1],k=k<e?e:k>g?g:k,l[f+1]=k;break;case "colorBlueRange":if("undefined"!==typeof e&&null!==e&&"undefined"!==typeof f&&null!==f)for(g=f,f=0,b=l.length;f<b;f+=4)k=l[f+2],k=k<e?e:k>g?g:k,l[f+2]=k;break;case "gamma":if("undefined"===typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4)l[f]=
255*Math.pow(l[f]/255,1/e),l[f+1]=255*Math.pow(l[f+1]/255,1/e),l[f+2]=255*Math.pow(l[f+2]/255,1/e);break;case "gammaRed":if("undefined"===typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4)l[f]=255*Math.pow(l[f]/255,1/e);break;case "gammaGreen":if("undefined"===typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4)l[f+1]=255*Math.pow(l[f+1]/255,1/e);break;case "gammaBlue":if("undefined"===typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4)l[f+2]=255*Math.pow(l[f+2]/255,1/e);break;case "hue":if("undefined"===
typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4){var k=l[f],n=l[f+1],g=l[f+2],g=Z.Utils.colorToHSL(k,n,g);g.h+=e/360;g=Z.Utils.colorToRGB(g.h,g.s,g.l);l[f]=g.r;l[f+1]=g.g;l[f+2]=g.b}break;case "saturation":if("undefined"===typeof e||null===e)e=1;0<e&&(e/=10);e=-100==e?0:0>e?(e+100)/100:0==e?1:e+1;f=0;for(b=l.length;f<b;f+=4)k=l[f],n=l[f+1],g=l[f+2],g=Z.Utils.colorToHSL(k,n,g),g.s=Math.min(Math.max(g.s*e,0),1),g=Z.Utils.colorToRGB(g.h,g.s,g.l),l[f]=g.r,l[f+1]=g.g,l[f+2]=g.b;break;case "lightness":if("undefined"===
typeof e||null===e)e=1;var w=-1*e;f=0;for(b=l.length;f<b;f+=4){var k=l[f],n=l[f+1],g=l[f+2],G=Math.max(k,n,g),E=(k+n+g)/3,E=2*Math.abs(G-E)/255*w/100;k!==G&&(k+=(G-k)*E);n!==G&&(n+=(G-n)*E);g!==G&&(g+=(G-g)*E);l[f]=k;l[f+1]=n;l[f+2]=g}case "whiteBalance":if("undefined"===typeof e||null===e)e=1;e=this.colorTempToRGB(e);f=0;for(b=l.length;f<b;f+=4)l[f]*=255/e.r,l[f+1]*=255/e.g,l[f+2]*=255/e.b;break;case "noise":if("undefined"===typeof e||null===e)e=1;f=0;for(b=l.length;f<b;f+=4)g=-e/2+Math.random()*
e*2,l[f]+=g,l[f+1]+=g,l[f+2]+=g;break;case "sharpness":if("undefined"===typeof e||null===e)e=1;l=[0,-.05,0,-.05,1.2,-.05,0,-.05,0];f=0;for(b=e/2;f<b;f++){e=1;for(g=l.length;e<g;e+=2)l[e]*=1.5;l[4]=Math.abs(4*l[1])+1}a=Z.Utils.convolveImage(a,l);break;case "blurriness":if("undefined"===typeof e||null===e)e=3;l=Math.abs(e);if(1<l){f=l/2;b=Math.ceil(l)+(1-Math.ceil(l)%2);l=new Z.Utils.createFloat32Array(b);f=(f+.5)/3;f*=f;e=-1/(2*f);k=1/Math.sqrt(2*Math.PI*f);n=Math.floor(b/2);for(f=g=0;f<b;f++)w=f-
n,w=k*Math.exp(w*w*e),l[f]=w,g+=w;f=0;for(b=l.length;f<b;f++)l[f]/=g;a=Z.Utils.convolveImageSeparable(a,l,l,!1)}break;case "grayscale":f=0;for(b=l.length;f<b;f+=4)k=l[f],n=l[f+1],g=l[f+2],e=Math.round(.299*k+.587*n+.114*g),l[f]=l[f+1]=l[f+2]=e;break;case "threshold":if("undefined"===typeof e||null===e)e=128;f=0;for(b=l.length;f<b;f+=4)k=l[f],n=l[f+1],g=l[f+2],l[f]=l[f+1]=l[f+2]=.2126*k+.7152*n+.0722*g>=e?255:0;break;case "inversion":f=0;for(b=l.length;f<b;f+=4)l[f]=255-l[f],l[f+1]=255-l[f+1],l[f+
2]=255-l[f+2],l[f+3]=255;break;case "normalize":b=255/Z.Viewport.getImageFilterRangeMaxAbsolute(b);e=Math.round(e*b);g=Math.round(f*b);f=Z.Utils.getColorRange(l,"red");c=f.min;d=f.max;f=0;for(b=l.length;f<b;f+=4)l[f]=(g-e)/(d-c)*(l[f]-c)+e;break;case "equalize":if("undefined"===typeof Uint8ClampedArray){Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGEFILTEREQUALIZEARRAYSUPPORT"),!1,Z.messageDurationStandard,"center");return}e=new Uint8ClampedArray(g*k);f=w=0;for(b=l.length;f<b;f+=4)k=l[f],n=l[f+
1],g=l[f+2],e[w]=.2126*k+.7152*n+.0722*g,w++;b=e.length;g=new Float32Array(256);for(f=k=0;f<b;++f)++g[~~e[f]],++k;n=g[0];for(f=1;256>f;++f)n=g[f]+=n;k=255/k;for(f=0;f<b;++f)e[f]=g[~~e[f]]*k;f=w=0;for(b=l.length;f<b;f+=4)k=l[f],n=l[f+1],g=l[f+2],g=Z.Utils.colorToHSL(k,n,g),g.l=e[w]/255,g=Z.Utils.colorToRGB(g.h,g.s,g.l),l[f]=g.r,l[f+1]=g.g,l[f+2]=g.b,w++;break;case "sepia":f=0;for(b=l.length;f<b;f+=4)n=l[f],w=l[f+1],G=l[f+2],e=l[f+3],g=.393*n+.769*w+.189*G,k=.349*n+.686*w+.168*G,n=.272*n+.534*w+.131*
G,l[f]=255>g?g:255,l[f+1]=255>k?k:255,l[f+2]=255>n?n:255,l[f+3]=e;break;case "edges":f=new Z.Utils.createFloat32Array([-1,-1,-1,-1,8,-1,-1,-1,-1]),a=Z.Utils.convolveImage(a,f,!0)}}return a},getColorRange:function(a){var b,e,f;b=e=a[0];for(var g=0,k=a.length;g<k;g+=4)f=a[g],b=b<f?b:f,e=e>f?e:f;return new Z.Utils.RangeScale(b,e)},getImageData:function(a){var b=this.getCanvas(a.width,a.height),e=b.getContext("2d");e.drawImage(a,0,0);return e.getImageData(0,0,b.width,b.height)},getCanvas:function(a,b){var e=
document.createElement("canvas");e.width=a;e.height=b;return e},createImageData:function(a,b){return document.createElement("canvas").getContext("2d").createImageData(a,b)},colorToHSL:function(a,b,e){a/=255;b/=255;e/=255;var f=Math.max(a,b,e),g=Math.min(a,b,e),k,l=(f+g)/2;if(f===g)k=g=0;else{var E=f-g,g=.5<l?E/(2-f-g):E/(f+g);switch(f){case a:k=(b-e)/E+(b<e?6:0);break;case b:k=(e-a)/E+2;break;case e:k=(a-b)/E+4}}return{h:k/6,s:g,l:l}},colorToRGB:function(a,b,e){if(0==b)e=b=a=e;else{var f=function(a,
b,e){0>e&&(e+=1);1<e&&--e;return e<1/6?a+6*(b-a)*e:.5>e?b:e<2/3?a+(b-a)*(2/3-e)*6:a},g=.5>e?e*(1+b):e+b-e*b,k=2*e-g;e=f(k,g,a+1/3);b=f(k,g,a);a=f(k,g,a-1/3)}return{r:255*e,g:255*b,b:255*a}},colorTempToRGB:function(a){a/=100;var b,e;66>=a?(b=255,e=Math.min(Math.max(99.4708025861*Math.log(a)-161.1195681661,0),255)):(b=Math.min(Math.max(329.698727446*Math.pow(a-60,-.1332047592),0),255),e=Math.min(Math.max(288.1221695283*Math.pow(a-60,-.0755148492),0),255));a=66<=a?255:19>=a?0:Math.min(Math.max(138.5177312231*
Math.log(a-10)-305.0447927307,0),255);return{r:b,g:e,b:a}},createImageDataFloat32:function(a,b){return{width:a,height:b,data:new Z.Utils.createFloat32Array(a*b*4)}},createFloat32Array:function(a){return Z.float32ArraySupported?new Float32Array(a):Array(a)},convolveImage:function(a,b,e){var f=Math.round(Math.sqrt(b.length)),g=Math.floor(f/2),k=a.data,l=a.width;a=a.height;e=e?1:0;for(var E=Z.Utils.createImageData(l,a),n=E.data,w=0;w<a;w++)for(var G=0;G<l;G++){for(var K=w,W=G,J=4*(w*l+G),oa=0,ga=0,ma=
0,fa=0,v=0;v<f;v++)for(var C=0;C<f;C++){var u=K+v-g,D=W+C-g;0<=u&&u<a&&0<=D&&D<l&&(u=4*(u*l+D),D=b[v*f+C],oa+=k[u]*D,ga+=k[u+1]*D,ma+=k[u+2]*D,fa+=k[u+3]*D)}n[J]=oa;n[J+1]=ga;n[J+2]=ma;n[J+3]=fa+e*(255-fa)}return E},convolveImageHorizontal:function(a,b,e){var f=b.length,g=Math.floor(f/2),k=a.data,l=a.width;a=a.height;e=e?1:0;for(var E=Z.Utils.createImageData(l,a),n=E.data,w=0;w<a;w++)for(var G=0;G<l;G++){for(var K=w,W=G,J=4*(w*l+G),oa=0,ga=0,ma=0,fa=0,v=0;v<f;v++)var C=K,u=Math.min(l-1,Math.max(0,
W+v-g)),C=4*(C*l+u),u=b[v],oa=oa+k[C]*u,ga=ga+k[C+1]*u,ma=ma+k[C+2]*u,fa=fa+k[C+3]*u;n[J]=oa;n[J+1]=ga;n[J+2]=ma;n[J+3]=fa+e*(255-fa)}return E},convolveImageVertical:function(a,b,e){var f=b.length,g=Math.floor(f/2),k=a.data,l=a.width;a=a.height;e=e?1:0;for(var E=Z.Utils.createImageData(l,a),n=E.data,w=0;w<a;w++)for(var G=0;G<l;G++){for(var K=w,W=G,J=4*(w*l+G),oa=0,ga=0,ma=0,fa=0,v=0;v<f;v++)var C=4*(Math.min(a-1,Math.max(0,K+v-g))*l+W),u=b[v],oa=oa+k[C]*u,ga=ga+k[C+1]*u,ma=ma+k[C+2]*u,fa=fa+k[C+3]*
u;n[J]=oa;n[J+1]=ga;n[J+2]=ma;n[J+3]=fa+e*(255-fa)}return E},convolveImageSeparable:function(a,b,e,f){return Z.Utils.convolveImageHorizontal(Z.Utils.convolveImageFloat32Vertical(a,e,f),b,f)},convolveImageFloat32:function(a,b,e){var f=Math.round(Math.sqrt(b.length)),g=Math.floor(f/2),k=a.data,l=a.width;a=a.height;e=e?1:0;for(var E={width:l,height:a,data:new Z.Utils.Float32ArrayZ(l*a*4)},n=E.data,w=0;w<a;w++)for(var G=0;G<l;G++){for(var K=w,W=G,J=4*(w*l+G),oa=0,ga=0,ma=0,fa=0,v=0;v<f;v++)for(var C=
0;C<f;C++)var u=Math.min(a-1,Math.max(0,K+v-g)),D=Math.min(l-1,Math.max(0,W+C-g)),u=4*(u*l+D),D=b[v*f+C],oa=oa+k[u]*D,ga=ga+k[u+1]*D,ma=ma+k[u+2]*D,fa=fa+k[u+3]*D;n[J]=oa;n[J+1]=ga;n[J+2]=ma;n[J+3]=fa+e*(255-fa)}return E},convolveImageFloat32Horizontal:function(a,b,e){var f=b.length,g=Math.floor(f/2),k=a.data,l=a.width;a=a.height;e=e?1:0;for(var E=Z.Utils.createImageDataFloat32(l,a),n=E.data,w=0;w<a;w++)for(var G=0;G<l;G++){for(var K=w,W=G,J=4*(w*l+G),oa=0,ga=0,ma=0,fa=0,v=0;v<f;v++)var C=K,u=Math.min(l-
1,Math.max(0,W+v-g)),C=4*(C*l+u),u=b[v],oa=oa+k[C]*u,ga=ga+k[C+1]*u,ma=ma+k[C+2]*u,fa=fa+k[C+3]*u;n[J]=oa;n[J+1]=ga;n[J+2]=ma;n[J+3]=fa+e*(255-fa)}return E},convolveImageFloat32Vertical:function(a,b,e){var f=b.length,g=Math.floor(f/2),k=a.data,l=a.width;a=a.height;e=e?1:0;for(var E=Z.Utils.createImageDataFloat32(l,a),n=E.data,w=0;w<a;w++)for(var G=0;G<l;G++){for(var K=w,W=G,J=4*(w*l+G),oa=0,ga=0,ma=0,fa=0,v=0;v<f;v++)var C=4*(Math.min(a-1,Math.max(0,K+v-g))*l+W),u=b[v],oa=oa+k[C]*u,ga=ga+k[C+1]*u,
ma=ma+k[C+2]*u,fa=fa+k[C+3]*u;n[J]=oa;n[J+1]=ga;n[J+2]=ma;n[J+3]=fa+e*(255-fa)}return E},intValue:function(a,b,e){var f=null;return f=e?(a[b+3]+(a[b+2]<<8)|a[b+1]<<16)+16777216*a[b]:(a[b]+(a[b+1]<<8)|a[b+2]<<16)+16777216*a[b+3]},longValue:function(a,b,e){var f=null;if(e){f=0;e=1;for(var g=0;8>g;g++)f+=a[b+7-g]*e,e*=256}else f=(a[b]+(a[b+1]<<8)|a[b+2]<<16)+16777216*a[b+3],0!=a[b+4]&&(f+=4294967296*a[b+4]);return f},shortValue:function(a,b){return a[b]+(a[b+1]<<8)},createUint8Array:function(a,b){return Z.uInt8ArraySupported?
new Uint8Array(a,b):new Z.Utils.TypedArray(a,b)},TypedArray:function(a){var b;if("number"===typeof a){b=Array(a);for(var e=0;e<a;++e)b[e]=0}else b=a.slice(0);b.subarray=Z.Utils.arraySubarraySimple;b.buffer=b;b.byteLength=b.length;b.set=Z.Utils.setSimple;"object"===typeof a&&a.buffer&&(b.buffer=a.buffer);return b},setSimple:function(a,b){2>arguments.length&&(b=0);for(var e=0,f=a.length;e<f;++e,++b)this[b]=a[e]&255},encodeBase64:function(a){var b,e,f,g,k=0,l=0,E="",E=[];if(!a)return a;do b=a[k++],e=
a[k++],f=a[k++],g=b<<16|e<<8|f,b=g>>18&63,e=g>>12&63,f=g>>6&63,g&=63,E[l++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g);while(k<a.length);E=E.join("");a=a.length%3;return(a?E.slice(0,a-3):E)+"===".slice(a||3)},validateResponseArrayFunctionality:function(){"ZoomifyZIFFile"!=
Z.tileSource&&("ZoomifyPFFFile"!=Z.tileSource||null!==Z.tileHandlerPathFull)||Z.responseArraySupported||Z.responseArrayPrototyped||(Z.Utils.defineObjectProperty(XMLHttpRequest.prototype,"response",{get:function(){return(new VBArray(this.responseBody)).toArray()}}),Z.responseArrayPrototyped=!0)},setObjectProperty:function(a,b,e){-1!=Z.definedObjectPropertiesArr.indexOf(b)?a[b]=e.value:(Z.Utils.defineObjectProperty(a,b,e),Z.definedObjectPropertiesArr[Z.definedObjectPropertiesArr.length]=b)},defineObjectProperty:function(a,
b,e){Z.definePropertySupported?Object.defineProperty(a,b,e):(delete a[b],"get"in e&&a.__defineGetter__(b,e.get),"set"in e&&a.__defineSetter__(b,e.set),"value"in e&&(a.__defineSetter__(b,function(a){this.__defineGetter__(b,function(){return a});return a}),a[b]=e.value))},createImageElementFromBytes:function(a,b){function e(a){f.onload=null;f.onabort=null;f.onerror=null;g&&window.clearTimeout(g);window.setTimeout(function(){b(f)},1)}var f=new Image,g=null,k=parseFloat(this.getResource("z139")),l=function(){e(!1)};
f.onload=function(){e(!0)};f.onabort=l;f.onerror=l;g=window.setTimeout(function(){console.log(Z.Utils.getResource("z253"));e(!1)},k);f.src=a},getCurrentUTCDateAsString:function(){var a=new Date,b=a.getUTCFullYear(),e=(10>a.getUTCMonth()+1?"0":"")+(a.getUTCMonth()+1),f=(10>a.getUTCDate()?"0":"")+a.getUTCDate(),g=(10>a.getUTCHours()?"0":"")+a.getUTCHours(),k=(10>a.getUTCMinutes()?"0":"")+a.getUTCMinutes(),a=(10>a.getUTCSeconds()?"0":"")+a.getUTCSeconds();return b+e+f+"-"+g+k+a},cacheProofPath:function(a){a+=
"?t"+(new Date).getTime().toString()+"n"+Z.cacheProofCounter.toString();Z.cacheProofCounter+=1;return a},easing:function(a,b,e,f,g){if("undefined"===typeof g||null===g)g=Z.smoothZoomEasing;var k=b;if(Z.smoothZoom&&1<g)switch(g){case 2:e/=f;e--;k=(b-a)*(e*e*e*e*e+1)+a;break;case 3:k=(b-a)*(-Math.pow(2,-10*e/f)+1)+a;break;case 4:b-=a,k=1>(e/=f/2)?b/2*e*e*e*e*e+a:b/2*((e-=2)*e*e*e*e+2)+a}return k},functionCallWithDelay:function(a,b){window.setTimeout(a,b)},nodeIsInViewer:function(a){for(var b=!1;0==
b;)if(a)a.id?"ViewerDisplay"==a.id?b=!0:a=a.parentNode:a=a.parentNode;else break;return b},pointIsInViewer:function(a){var b=!1,e=document.getElementById(Z.pageContainerID);if(e){var f=parseFloat(Z.Utils.getElementStyleProperty(e,"width")),g=parseFloat(Z.Utils.getElementStyleProperty(e,"height")),k=Z.Utils.getElementPosition(e);isNaN(f)||isNaN(g)||isNaN(k.x)||isNaN(k.y)||(e=k.x,k=k.y,a.x>e&&a.x<e+f&&a.y>k&&a.y<k+g&&(b=!0))}return b},roundToFixed:function(a,b){var e=Math.round(a).toString().length,
e=b-e,e=Math.pow(10,0>e?0:e);return a=Math.round(a*e)/e},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},getSign:function(a){return a?0>a?-1:1:0},drawCrosshairs:function(a,b,e,f){if("undefined"===typeof a||null===a)a=Z.ViewerDisplay;if("undefined"===typeof b||null===b)b=Z.viewportCurrent.getViewW();if("undefined"===typeof e||null===e)e=Z.viewportCurrent.getViewH();if("undefined"===typeof f||null===f)f="#696969";var g=document.getElementById("viewportCenterLineHorizontal"),k=
document.getElementById("viewportCenterLineVertical");(k||g)&&Z.Utils.hideCrosshairs();g=Z.Utils.createContainerElement("div","viewportCenterLineHorizontal","inline-block","absolute","visible",b+"px","1px","0px",e/2+"px","solid","1px","transparent","0px","0px","normal",null,!0,f);k=Z.Utils.createContainerElement("div","viewportCenterLineVertical","inline-block","absolute","visible","1px",e+"px",b/2+"px","0px","solid","1px","transparent","0px","0px","normal",null,!0,f);a.appendChild(g);a.appendChild(k)},
hideCrosshairs:function(a){if("undefined"===typeof a||null===a)a=Z.ViewerDisplay;var b=document.getElementById("viewportCenterLineHorizontal"),e=document.getElementById("viewportCenterLineVertical");b&&a.removeChild(e);e&&a.removeChild(b)},configureHelpDisplay:function(){var a=Z.helpW,b=Z.helpH;a>=Z.viewerW&&(a=Z.viewerW-80);b>=Z.viewerH&&(b=Z.viewerH-80);var e=Z.helpL?Z.helpL:(Z.viewerW-a)/2,f=Z.helpT?Z.helpT:(Z.viewerH-b)/2,g=this.getResource("UI_HELPSCREENCOLOR"),k=this.getResource("UI_HELPBUTTONCOLOR");
Z.HelpDisplay=this.createContainerElement("div","HelpDisplay","inline-block","absolute","hidden",a+"px",b+"px",e+"px",f+"px","solid","1px",g,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.HelpDisplay);e=Z.Utils.createContainerElement("div","helpTextBox","inline-block","absolute","auto",a-50+"px",b-74+"px","4px","4px","solid","1px","white","0px","20px",null);e.style.overflowY=Z.mobileDevice?"scroll":"auto";Z.HelpDisplay.appendChild(e);Z.help=document.getElementById("helpTextBox");Z.HelpDisplay.style.zIndex=
(Z.baseZIndex+38).toString();b=b-18-5;a-=66;e=this.getResource("z423");k=new Z.Utils.Button("buttonHelpOk",e,null,null,null,null,"56px","18px",a+"px",b+"px","mousedown",this.helpOkButtonHandler,"z342OK","solid","1px",k,"0px","0px");Z.HelpDisplay.appendChild(k.elmt);Z.HelpDisplay.style.display="none"},helpOkButtonHandler:function(a){Z.Utils.hideHelp();return!0},showHelp:function(a){Z.HelpDisplay||Z.Utils.configureHelpDisplay();Z.help&&(Z.help.innerHTML=Z.helpCustom?Z.helpContent:unescape(a),Z.HelpDisplay.style.display=
"inline-block"!=Z.HelpDisplay.style.display?"inline-block":"none",document.getElementById("buttonHelpOk").style.display="inline-block")},hideHelp:function(){Z.HelpDisplay.style.display="none"},configureMessageDisplay:function(){var a=parseInt(this.getResource("z437"),10),b=parseInt(this.getResource("z436"),10),e=Z.Utils.getMessageDisplayCoords("6",a,Z.viewerW,Z.viewerH),f=this.getResource("z159"),g=this.getResource("z158");Z.MessageDisplay=this.createContainerElement("div","MessageDisplay","inline-block",
"absolute","auto",a+"px",b+"px",e.x+"px",e.y+"px","solid","1px",f,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.MessageDisplay);Z.MessageDisplay.style.zIndex=(Z.baseZIndex+40).toString();e=Z.Utils.createTextElement("messageBox","",a-18+"px",b-40+"px","4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.MessageDisplay.appendChild(e);Z.messages=document.getElementById("messageBox");b=b-18-5;a-=66;e=this.getResource("z438");g=new Z.Utils.Button("buttonMessageOk",
e,null,null,null,null,"56px","18px",a+"px",b+"px","mousedown",this.messageOkButtonHandler,"z362","solid","1px",g,"0px","0px");Z.MessageDisplay.appendChild(g.elmt)},getMessageDisplayCoords:function(a,b,e,f){switch(a){case "1":f=a=40;break;case "2":a=e/2-b/2;f=40;break;case "3":a=e-b-80;f=40;break;case "4":a=e-b-40;f=0<Z.toolbarVisible&&8!=Z.toolbarVisible?f-120:f-80;break;case "5":a=e/2-b/2;f=0<Z.toolbarVisible&&8!=Z.toolbarVisible?f-120:f-80;break;case "6":a=40;f=0<Z.toolbarVisible&&8!=Z.toolbarVisible?
f-120:f-80;break;default:a=e-b,f=40}return new Z.Utils.Point(a,f)},messageOkButtonHandler:function(a){Z.Utils.hideMessage();Z.Viewport&&Z.coordinatesVisible&&Z.Viewport.setCoordinatesDisplayVisibility(!1);return!0},messageCancelButtonHandler:function(a){Z.Utils.hideMessage();return!1},showMessage:function(a,b,e,f,g,k){if(Z.messagesVisible){Z.MessageDisplay||Z.Utils.configureMessageDisplay();if("undefined"===typeof k||null===k)k="6";var l=parseInt(this.getResource("z437"),10);k=Z.Utils.getMessageDisplayCoords(k,
l,Z.viewerW,Z.viewerH);Z.MessageDisplay.style.left=k.x+"px";Z.MessageDisplay.style.top=k.y+"px";Z.MessageDisplay.messageTimer&&Z.Utils.hideMessageTimerHandler();k=!0;g&&(-1!=Z.Utils.arrayIndexOf(Z.messageDisplayList,a)?k=!1:Z.messageDisplayList[Z.messageDisplayList.length]=a);if(k&&(Z.messages&&(Z.messages.value=a),Z.MessageDisplay.style.display="inline-block","undefined"!==typeof f&&null!==f&&(a=document.getElementById("textBoxFor-messageBox"))&&(a.firstChild.style.textAlign=f),f=document.getElementById("buttonMessageOk"),
a=parseInt(this.getResource("z436"),10),"undefined"!==typeof b&&null!==b&&b?(f.style.display="inline-block",Z.MessageDisplay.style.height=a+"px"):(f.style.display="none",Z.MessageDisplay.style.height=a-22+"px"),"undefined"!==typeof e&&null!==e&&!isNaN(e))){"undefined"!==typeof Z.MessageDisplay.messageTimer&&null!==Z.MessageDisplay.messageTimer&&window.clearTimeout(Z.MessageDisplay.messageTimer);if("undefined"===typeof e||null===e)e=3E3;Z.MessageDisplay.messageTimer=window.setTimeout(Z.Utils.hideMessageTimerHandler,
e)}}},getMessage:function(){var a="";Z.messages&&Z.Utils.stringValidate(Z.messages.value)&&(a=Z.messages.value);return a},hideMessage:function(){Z.MessageDisplay&&(Z.MessageDisplay.style.display="none")},hideMessageTimerHandler:function(){Z.MessageDisplay.messageTimer&&(window.clearTimeout(Z.MessageDisplay.messageTimer),Z.MessageDisplay.messageTimer=null);Z.Utils.hideMessage()},uploadProgress:function(a){var b=Z.saveImageMessage;a.lengthComputable?(a=Math.round(100*a.loaded/a.total),b+=a.toString()+
"%"):b+=Z.Utils.getResource("ERROR_IMAGESAVEUNABLETOCOMPUTEPROGRESS");Z.Utils.showMessage(b,!1,"none","center")},configureCoordinatesDisplay:function(){var a=parseInt(this.getResource("z417"),10),b=parseInt(this.getResource("z415"),10),e=Z.viewerW-a-20,f=Z.viewerH-b-50,g=this.getResource("z99");Z.CoordinatesDisplay=this.createContainerElement("div","CoordinatesDisplay","inline-block","absolute","auto",a+"px",b+"px",e+"px",f+"px","solid","1px",g,"0px","0px","normal");Z.ViewerDisplay.appendChild(Z.CoordinatesDisplay);
Z.CoordinatesDisplay.style.zIndex=(Z.baseZIndex+14).toString();e=Z.geoCoordinatesVisible?Z.Utils.getResource("UI_GEOCOORDINATESDISPLAYTEXT"):"IIIFImageServer"==Z.tileSource?Z.Utils.getResource("UI_IIIFCOORDINATESDISPLAYTEXT"):Z.Utils.getResource("z416");e=Z.Utils.createTextElement("coordsLabelBox",e,a-18+"px","32px","4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.CoordinatesDisplay.appendChild(e);if(e=document.getElementById("textBoxFor-coordsLabelBox"))e.firstChild.style.textAlign=
"center";e=Z.Utils.createTextElement("coordsDisplayBox","",a-18+"px","18px","4px","50px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.CoordinatesDisplay.appendChild(e);Z.coordinates=document.getElementById("coordsDisplayBox");if(e=document.getElementById("textBoxFor-coordsDisplayBox"))e.firstChild.style.textAlign="center";a=Z.Utils.createTextElement("coordsSaveBox","",a-18+"px",b-96+"px","4px","82px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",
null);Z.CoordinatesDisplay.appendChild(a);Z.coordinatesSave=document.getElementById("coordsSaveBox");if(a=document.getElementById("textBoxFor-coordsSaveBox"))a.firstChild.style.textAlign="center"},showCoordinates:function(a){Z.CoordinatesDisplay||Z.Utils.configureCoordinatesDisplay();Z.coordinates&&(Z.coordinates.value=a)},saveCoordinates:function(a){Z.CoordinatesDisplay||Z.Utils.configureCoordinatesDisplay();Z.coordinatesSave&&(Z.coordinatesSave.value+=a+"\n")},configureTraceDisplay:function(){if("undefined"!==
typeof Z.Viewport&&null!==Z.Viewport){var a=Z.viewerH-330,b=this.getResource("z229");Z.TraceDisplay=this.createContainerElement("div","TraceDisplay","inline-block","absolute","auto","280px","280px","10px",a+"px","solid","1px",b,"0px","10px","normal");Z.ViewerDisplay.appendChild(Z.TraceDisplay);Z.TraceDisplay.style.zIndex=(Z.baseZIndex+34).toString();a=Z.Utils.getResource("UI_TRACEDISPLAYTITLE");a=Z.Utils.createTextElement("debugTraces",a,"265px","155px","10px","10px","5px","solid","1px",!0,"verdana",
"12px","none",null,1,"auto","auto",null);Z.TraceDisplay.appendChild(a);Z.traces=document.getElementById("debugTraces");var a=parseInt(Z.Utils.getResource("DEFAULT_TRACEDISPLAYTEXTFONTSIZE"),10),b=parseInt(Z.Utils.getResource("DEFAULT_TRACEDISPLAYTEXTPADDINGSMALL"),10),e=textH=16,f=a-2,g=Z.Utils.createContainerElement("div","labelTileStatusTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),k=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYTILESTATUSTEXT"));
g.appendChild(k);Z.TraceDisplay.appendChild(g);if(g=document.getElementById("labelTileStatusTextBox"))k=g.style,k.width="275px",k.height=e+"px",k.left="10px",k.top="183px",Z.Utils.setTextNodeStyle(g,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","center","none");g=17;k=Z.Utils.createTextElement("tilesRequiredTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(k);if(k=document.getElementById("textBoxFor-tilesRequiredTextElement")){var l=
k.style;l.width="37px";l.height=textH+"px";l.left=g+"px";l.top="198px";Z.Utils.setTextAreaStyle(k,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px");g+=45}k=Z.Utils.createTextElement("tilesCachedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(k);if(k=document.getElementById("textBoxFor-tilesCachedTextElement"))l=k.style,l.width="37px",l.height=textH+"px",
l.left=g+"px",l.top="198px",Z.Utils.setTextAreaStyle(k,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px"),g+=45;k=Z.Utils.createTextElement("tilesRequestedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(k);if(k=document.getElementById("textBoxFor-tilesRequestedTextElement"))l=k.style,l.width="37px",l.height=textH+"px",l.left=g+"px",l.top="198px",Z.Utils.setTextAreaStyle(k,
"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px"),g+=45;k=Z.Utils.createTextElement("tilesLoadedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(k);if(k=document.getElementById("textBoxFor-tilesLoadedTextElement"))l=k.style,l.width="37px",l.height=textH+"px",l.left=g+"px",l.top="198px",Z.Utils.setTextAreaStyle(k,"black","verdana",a+"px","none","normal","normal",
"normal","normal","1em","center","none",b+"px"),g+=45;k=Z.Utils.createTextElement("tilesDisplayedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(k);if(k=document.getElementById("textBoxFor-tilesDisplayedTextElement"))l=k.style,l.width="37px",l.height=textH+"px",l.left=g+"px",l.top="198px",Z.Utils.setTextAreaStyle(k,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",
b+"px"),g+=45;k=Z.Utils.createTextElement("tilesWaitingTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(k);if(k=document.getElementById("textBoxFor-tilesWaitingTextElement"))l=k.style,l.width="37px",l.height=textH+"px",l.left=g+"px",l.top="198px",Z.Utils.setTextAreaStyle(k,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px");g=Z.Utils.createContainerElement("div",
"labelElapsedTimeTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYELAPSEDTIMETEXT"));g.appendChild(k);Z.TraceDisplay.appendChild(g);if(g=document.getElementById("labelElapsedTimeTextBox"))k=g.style,k.width="85px",k.height=e+"px",k.left="15px",k.top="224px",Z.Utils.setTextNodeStyle(g,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","left",
"none");g=Z.Utils.createTextElement("tilesTimeElapsedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(g);if(g=document.getElementById("textBoxFor-tilesTimeElapsedTextElement"))k=g.style,k.width="50px",k.height=textH+"px",k.left="67.5px",k.top="220px",Z.Utils.setTextAreaStyle(g,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px");g=Z.Utils.createContainerElement("div",
"labelTilesPerSecondTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);k=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYTILESPERSECONDTEXT"));g.appendChild(k);Z.TraceDisplay.appendChild(g);if(g=document.getElementById("labelTilesPerSecondTextBox"))k=g.style,k.width="85px",k.height=e+"px",k.left="130px",k.top="224px",Z.Utils.setTextNodeStyle(g,"black","verdana",f+"px","none","normal","normal","normal","normal","1em",
"left","none");e=Z.Utils.createTextElement("tilesPerSecondTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(e);if(e=document.getElementById("textBoxFor-tilesPerSecondTextElement"))f=e.style,f.width="50px",f.height=textH+"px",f.left="215px",f.top="220px",Z.Utils.setTextAreaStyle(e,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px");a=58;b=10;e=this.getResource("z228");
f=this.getResource("z446");f=new this.Button("buttonShowGlobals",f,null,null,null,null,a+"px","42px",b+"px","249px","mousedown",this.showGlobals,"z382","solid","1px",e,"0px","0px");Z.TraceDisplay.appendChild(f.elmt);b+=a+10;f=this.getResource("z449");f=new this.Button("buttonToggleDisplay",f,null,null,null,null,a+"px","42px",b+"px","249px","mousedown",Z.Viewport.buttonToggleDisplayHandler,"z390","solid","1px",e,"0px","0px");Z.TraceDisplay.appendChild(f.elmt);b+=a+10;f=this.getResource("z447");f=new this.Button("buttonToggleBackfill",
f,null,null,null,null,a+"px","42px",b+"px","249px","mousedown",Z.Viewport.buttonToggleBackfillHandler,"z388","solid","1px",e,"0px","0px");Z.TraceDisplay.appendChild(f.elmt);b+=a+10;a+=12;f=this.getResource("z448");a=new this.Button("buttonToggleConstrainPan",f,null,null,null,null,a+"px","42px",b+"px","249px","mousedown",Z.Viewport.toggleConstrainPan,"z389","solid","1px",e,"0px","0px");Z.TraceDisplay.appendChild(a.elmt)}else window.setTimeout(function(){Z.Utils.configureTraceDisplay()},100)},showTraces:function(){Z.TraceDisplay?
Z.TraceDisplay.style.display="inline-block":Z.Utils.configureTraceDisplay()},hideTraces:function(){Z.TraceDisplay.style.display="none"},trace:function(a,b,e){b=b?"\n":"";e=e?"\n\n":"\n";Z.TraceDisplay||Z.Utils.configureTraceDisplay();Z.traces&&(Z.traces.value+=b+a+e,2==Z.debug&&(Z.traces.scrollTop=Z.traces.scrollHeight))},traceTileStatus:function(a,b,e,f,g,k){if(!(l&&E&&n&&w&&G&&K))var l=document.getElementById("tilesRequiredTextElement"),E=document.getElementById("tilesCachedTextElement"),n=document.getElementById("tilesRequestedTextElement"),
w=document.getElementById("tilesLoadedTextElement"),G=document.getElementById("tilesDisplayedTextElement"),K=document.getElementById("tilesWaitingTextElement");l&&E&&n&&w&&G&&K&&("undefined"!==typeof a&&null!==a&&(l.value=a.toString()),"undefined"!==typeof b&&null!==b&&(E.value=b.toString()),"undefined"!==typeof e&&null!==e&&(n.value=e.toString()),"undefined"!==typeof f&&null!==f&&(w.value=f.toString()),"undefined"!==typeof g&&null!==g&&(G.value=g.toString()),"undefined"!==typeof k&&null!==k&&(K.value=
k.toString()))},traceTileSpeed:function(a,b){if(!e||!f)var e=document.getElementById("tilesTimeElapsedTextElement"),f=document.getElementById("tilesPerSecondTextElement");e&&f&&("undefined"!==typeof a&&null!==a&&(e.value=a.toString()),"undefined"!==typeof b&&null!==b&&(f.value=Math.round(b).toString()))},showGlobals:function(){var a;a="\n                            ZOOMIFY IMAGE VIEWER - CURRENT VALUES\n";a+="\n";a+="VIEW:    ";a+="Z.imageX="+Z.imageX+",   ";a+="Z.imageY="+Z.imageY+",   ";a+="Z.imageZ="+
Z.imageZ+",   ";a+="Z.imageR="+Z.imageR+",   ";a+="Z.priorX="+Z.priorX+",   ";a+="Z.priorY="+Z.priorY+",   ";a+="Z.priorZ="+Z.priorZ+",   ";a+="Z.priorR="+Z.priorR+",   ";a+="\n";a+="IMAGE & SKIN:    ";a+="Z.imagePath="+Z.imagePath+",   ";a+="Z.skinPath="+Z.skinPath+",   ";a+="Z.skinMode="+Z.skinMode+",   ";a+="Z.imageW="+Z.imageW+",   ";a+="Z.imageH="+Z.imageH+",   ";a+="tierCount="+Z.Viewport.getTierCount()+",   ";a+="z320="+Z.Viewport.getTileW()+",   ";a+="z319="+Z.Viewport.getTileH()+"\n";a+=
"\n";a+="PAGE & BROWSER:    ";a+="Z.pageContainer="+Z.pageContainer+",   ";a+="Z.browser="+Z.browser+",   ";a+="Z.browserVersion="+Z.browserVersion+",   ";a+="Z.canvasSupported="+Z.canvasSupported+",   ";a+="Z.cssTransformsSupported="+Z.cssTransformsSupported+",   ";a+="Z.cssTransformProperty="+Z.cssTransformProperty+",   ";a+="Z.cssTransformNoUnits="+Z.cssTransformNoUnits+",   ";a+="Z.alphaSupported="+Z.alphaSupported+",   ";a+="Z.renderQuality="+Z.renderQuality+",   ";a+="Z.ellipseDrawingSupported="+
Z.ellipseDrawingSupported+",   ";a+="Z.rotationSupported="+Z.rotationSupported+",   ";a+="Z.fullScreenSupported="+Z.fullScreenSupported+",   ";a+="Z.float32ArraySupported="+Z.float32ArraySupported+",   ";a+="Z.uInt8ArraySupported="+Z.uInt8ArraySupported+",   ";a+="Z.xmlHttpRequestSupport="+Z.xmlHttpRequestSupport+",   ";a+="Z.definePropertySupported="+Z.definePropertySupported+",   ";a+="Z.responseArraySupported="+Z.responseArraySupported+",   ";a+="Z.responseArrayPrototyped="+Z.responseArrayPrototyped+
",   ";a+="Z.mobileDevice="+Z.mobileDevice+",   ";a+="Z.singleFileSupported="+Z.singleFileSupported+",   ";a+="Z.localUse="+Z.localUse+"\n";a+="\n";a+="VIEWER OPTIONS & DEFAULTS:    ";a+="Z.initialX="+Z.initialX+",   ";a+="Z.initialY="+Z.initialY+",   ";a+="Z.initialZ="+Z.initialZ+",   ";a+="Z.minZ="+Z.minZ+",   ";a+="Z.maxZ="+Z.maxZ+",   ";a+="Z.fitZ="+Z.fitZ+",   ";a+="Z.zoomSpeed="+Z.zoomSpeed+",   ";a+="Z.panSpeed="+Z.panSpeed+",   ";a+="Z.fadeInSpeed="+Z.fadeInSpeed+",   ";a+="Z.toolbarVisible="+
Z.toolbarVisible+",   ";a+="Z.toolbarW="+Z.toolbarW+",   ";a+="Z.toolbarCurrentW="+Z.toolbarCurrentW+",   ";a+="Z.toolbarH="+Z.toolbarH+",   ";a+="Z.toolbarPosition="+Z.toolbarPosition+",   ";a+="Z.tooltipsVisible="+Z.tooltipsVisible+",   ";a+="Z.helpVisible="+Z.helpVisible+",   ";a+="Z.navigatorVisible="+Z.navigatorVisible+",   ";a+="Z.navigatorW="+Z.navigatorW+",   ";a+="Z.navigatorH="+Z.navigatorH+",   ";a+="Z.navigatorL="+Z.navigatorL+",   ";a+="Z.navigatorT="+Z.navigatorT+",   ";a+="Z.navigatorFit="+
Z.navigatorFit+",   ";a+="Z.clickZoom="+Z.clickZoom+",   ";a+="Z.clickPan="+Z.clickPan+",   ";a+="Z.mousePan="+Z.mousePan+",   ";a+="Z.keys="+Z.keys+",   ";a+="Z.constrainPan="+Z.constrainPan+",   ";a+="Z.constrainPanStrict="+Z.constrainPanStrict+",   ";a+="Z.smoothPan="+Z.smoothPan+",   ";a+="Z.smoothPanEasing="+Z.smoothPanEasing+",   ";a+="Watermark alpha = "+Z.Utils.getResource("z234")+",   ";a+="Z.watermarkPath="+Z.watermarkPath+",   ";a+="Z.copyrightPath="+Z.copyrightPath+",   ";a+="Z.hotspotPath="+
Z.hotspotPath+",   ";a+="Z.tourPath="+Z.tourPath+",   ";a+="Z.slidePath="+Z.slidePath+",   ";a+="Z.slideTransitionSpeed="+Z.slideTransitionSpeed+",   ";a+="Z.audioContent="+Z.audioContent+",   ";a+="Z.audioMuted="+Z.audioMuted+",   ";a+="Z.magnifierVisible="+Z.magnifierVisible+",   ";a+="Z.magnifierW="+Z.magnifierW+",   ";a+="Z.magnifierH="+Z.magnifierH+",   ";a+="Z.magnifierL="+Z.magnifierL+",   ";a+="Z.magnifierT="+Z.magnifierT+",   ";a+="Z.annotationPath="+Z.annotationPath+",   ";a+="Z.fileHandlerPath="+
Z.fileHandlerPath+",   ";a+="Z.saveImageHandlerPath="+Z.saveImageHandlerPath+",   ";a+="Z.fileHandlerPath="+Z.fileHandlerPath+",   ";a+="Z.trackingPath="+Z.trackingPath+",   ";a+="Z.minimizeVisible="+Z.minimizeVisible+",   ";a+="Z.sliderZoomVisible="+Z.sliderZoomVisible+",   ";a+="Z.zoomButtonsVisible="+Z.zoomButtonsVisible+",   ";a+="Z.panButtonsVisible="+Z.panButtonsVisible+",   ";a+="Z.resetVisible="+Z.resetVisible+",   ";a+="Z.fullScreenVisible="+Z.fullScreenVisible+",   ";a+="Z.fullPageVisible="+
Z.fullPageVisible+",   ";a+="Z.initialFullPage="+Z.initialFullPage+",   ";a+="Z.measureVisible="+Z.measureVisible+",   ";a+="Z.captionTextColor="+Z.captionTextColor+",   ";a+="Z.captionBackColor="+Z.captionBackColor+",   ";a+="Z.labelLineColor="+Z.labelLineColor+",   ";a+="Z.labelFillColor="+Z.labelFillColor+",   ";a+="Z.captionTextVisible="+Z.captionTextVisible+",   ";a+="Z.captionBackVisible="+Z.captionBackVisible+",   ";a+="Z.labelFillVisible="+Z.labelFillVisible+",   ";a+="Z.labelLineVisible="+
Z.labelLineVisible+",   ";a+="Z.rotationVisible="+Z.rotationVisible+",   ";a+="Z.rotationFree="+Z.rotationFree+",   ";a+="Z.initialRotation="+Z.initialRotation+",   ";a+="Z.virtualPointerVisible="+Z.virtualPointerVisible+",   ";a+="Z.virtualPointerPath="+Z.virtualPointerPath+",   ";a+="Z.crosshairsVisible="+Z.crosshairsVisible+",   ";a+="Z.rulerVisible="+Z.rulerVisible+",   ";a+="Z.units="+Z.units+",   ";a+="Z.unitsPerImage="+Z.unitsPerImage+",   ";a+="Z.pixelsPerUnit="+Z.pixelsPerUnit+",   ";a+=
"Z.sourceMagnification="+Z.sourceMagnification+",   ";a+="Z.rulerListType="+Z.rulerListType+",   ";a+="Z.rulerW="+Z.rulerW+",   ";a+="Z.rulerH="+Z.rulerH+",   ";a+="Z.rulerL="+Z.rulerL+",   ";a+="Z.rulerT="+Z.rulerT+",   ";a+="Z.coordinatesVisible="+Z.coordinatesVisible+",   ";a+="Z.imageFiltersVisible="+Z.imageFiltersVisible+",   ";a+="Z.progressVisible="+Z.progressVisible+",   ";a+="Z.logoVisible="+Z.logoVisible+",   ";a+="Z.logoLinkURL="+Z.logoLinkURL+",   ";a+="Z.logoCustomPath="+Z.logoCustomPath+
",   ";a+="Z.canvas="+Z.canvas+",   ";a+="Z.debug="+Z.debug+",   ";a+="Z.imageProperties="+Z.imageProperties+",   ";a+="Z.serverIP="+Z.serverIP+",   ";a+="Z.serverPort="+Z.serverPort+",   ";a+="Z.tileHandlerPath="+Z.tileHandlerPath+",   ";a+="Z.tileHandlerPathFull="+Z.tileHandlerPathFull+",   ";a+="Z.tileSource="+Z.tileSource+",   ";a+="Z.tileType="+Z.tileType+",   ";a+="Z.freehandVisible="+Z.freehandVisible+",   ";a+="Z.textVisible="+Z.textVisible+",   ";a+="Z.shapeVisible="+Z.shapeVisible+",   ";
a+="Z.rectangleVisible="+Z.rectangleVisible+",   ";a+="Z.polygonVisible="+Z.polygonVisible+",   ";a+="\n";a+="INTERNAL VALUES:    ";a+="\n";a+="displayW="+Z.Viewport.getDisplayW()+",   ";a+="displayH="+Z.Viewport.getDisplayH()+",   ";a+="tierCurrent="+Z.Viewport.getTierCurrent()+",   ";a+="tierBackfill="+Z.Viewport.getTierBackfill()+",   ";a+="tierBackfillDynamic="+Z.Viewport.getTierBackfillDynamic()+",   ";a+="tierBackfillOversize="+Z.Viewport.getTierBackfillOversize()+",   ";a+="tierScale="+Z.Viewport.getTierScale()+
",   ";a+="z315="+Z.Viewport.getTiersScaleUpMax()+",   ";a+="z314="+Z.Viewport.getTiersScaleDownMax()+",   ";a+="z316="+Z.Viewport.getTilesCacheMax()+",   ";a+="Z.useCanvas="+Z.useCanvas+"\n";a+="Z.specialStorageEnabled="+Z.specialStorageEnabled+"\n";a+="Z.editMode="+Z.editMode+"\n";a+="Z.labelMode="+Z.labelMode+"\n";a+="Z.editing="+Z.editing+"\n";a+="\n";a+="INTERNAL LISTS:    ";a+="tierWs="+Z.Viewport.getTierWs()+",   ";a+="tierHs="+Z.Viewport.getTierHs()+",   ";a+="tierTileCounts="+Z.Viewport.getTierTileCounts()+
",   ";a+="tilesLoadingNames="+Z.Viewport.getTilesLoadingNames()+"\n";a+="\n";alert(a)}};
